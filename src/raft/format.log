S0|T0 is made                                                                                                     
                                       S1|T0 is made                                                              
                                                                             S2|T0 is made                        
                                       S1|T0 is not leader                                                        
S0|T0 is not leader                                                                                               
                                                                             S2|T0 is not leader                  
                                                                             S2|T0 is not leader                  
                                       S1|T0 is not leader                                                        
S0|T0 is not leader                                                                                               
                                                                             S2|T0 is not leader                  
S0|T0 is not leader                                                                                               
                                       S1|T0 is not leader                                                        
S0|T0 is not leader                                                                                               
                                       S1|T0 is not leader                                                        
                                                                             S2|T0 is not leader                  
S0|T0 is not leader                                                                                               
                                                                             S2|T0 is not leader                  
                                       S1|T0 is not leader                                                        
                                       S1|T1 starts to join election                                              
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 1                                                                 
                                                                             S2|T1 save persist| votedFor: -1|    
                                                                             logsLen: 1                           
S0|T1 save persist| votedFor: -1|                                                                                 
logsLen: 1                                                                                                        
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 1                           
                                                                             S2|T1 votes for S1[RequestVote]      
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 1                                                                                                        
S0|T1 votes for S1[RequestVote]                                                                                   
                                       S1|T1 becomes the leader, and starts                                       
                                       heatbeats                                                                  
                                       S1|T1 ends this round                                                      
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 1                                                                                                        
S0|T1 appends logs from S1| logLen:                                                                               
1[AppendEntry]                                                                                                    
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:0| matchidx:0| nextidx:1                                          
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 1                           
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             1[AppendEntry]                       
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:0| matchidx:0| nextidx:1                                          
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 2                                                                 
                                       S1|T1 receive commands | logLen:                                           
                                       2[Start]                                                                   
                                                                             S2|T1 is not leader                  
S0|T1 is not leader                                                                                               
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 2                                                                                                        
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 2                           
S0|T1 appends logs from S1| logLen:                                                                               
2[AppendEntry]                                                                                                    
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             2[AppendEntry]                       
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:1| matchidx:1| nextidx:2                                          
                                       S1|T1 update commitIndex as 1                                              
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:1| matchidx:1| nextidx:2                                          
                                       S1|T1 starts to apply entries                                              
                                       [1:1][ApplyEntry]                                                          
                                       S1|T1 finishes applying entries                                            
                                       [1:1][ApplyEntry]                                                          
S0|T1 is not leader                                                                                               
                                                                             S2|T1 is not leader                  
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 2                           
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             2[AppendEntry]                       
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 2                                                                                                        
S0|T1 appends logs from S1| logLen:                                                                               
2[AppendEntry]                                                                                                    
                                                                             S2|T1 starts to apply entries        
                                                                             [1:1][ApplyEntry]                    
                                                                             S2|T1 finishes applying entries      
                                                                             [1:1][ApplyEntry]                    
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:0| matchidx:1| nextidx:2                                          
S0|T1 starts to apply entries                                                                                     
[1:1][ApplyEntry]                                                                                                 
S0|T1 finishes applying entries                                                                                   
[1:1][ApplyEntry]                                                                                                 
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:0| matchidx:1| nextidx:2                                          
                                                                             S2|T1 is not leader                  
S0|T1 is not leader                                                                                               
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 2                                                                                                        
S0|T1 appends logs from S1| logLen:                                                                               
2[AppendEntry]                                                                                                    
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 2                           
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             2[AppendEntry]                       
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:0| matchidx:1| nextidx:2                                          
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:0| matchidx:1| nextidx:2                                          
S0|T1 is not leader                                                                                               
                                                                             S2|T1 is not leader                  
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 2                           
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 2                                                                                                        
S0|T1 appends logs from S1| logLen:                                                                               
2[AppendEntry]                                                                                                    
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             2[AppendEntry]                       
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:0| matchidx:1| nextidx:2                                          
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:0| matchidx:1| nextidx:2                                          
                                                                             S2|T1 is not leader                  
S0|T1 is not leader                                                                                               
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 2                           
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 2                                                                                                        
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             2[AppendEntry]                       
S0|T1 appends logs from S1| logLen:                                                                               
2[AppendEntry]                                                                                                    
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:0| matchidx:1| nextidx:2                                          
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:0| matchidx:1| nextidx:2                                          
S0|T1 is not leader                                                                                               
                                                                             S2|T1 is not leader                  
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 2                           
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             2[AppendEntry]                       
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 2                                                                                                        
S0|T1 appends logs from S1| logLen:                                                                               
2[AppendEntry]                                                                                                    
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:0| matchidx:1| nextidx:2                                          
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:0| matchidx:1| nextidx:2                                          
S0|T1 is not leader                                                                                               
                                                                             S2|T1 is not leader                  
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 2                                                                                                        
S0|T1 appends logs from S1| logLen:                                                                               
2[AppendEntry]                                                                                                    
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 2                           
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             2[AppendEntry]                       
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:0| matchidx:1| nextidx:2                                          
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:0| matchidx:1| nextidx:2                                          
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 3                                                                 
                                       S1|T1 receive commands | logLen:                                           
                                       3[Start]                                                                   
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 4                                                                 
                                       S1|T1 receive commands | logLen:                                           
                                       4[Start]                                                                   
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 5                                                                 
                                       S1|T1 receive commands | logLen:                                           
                                       5[Start]                                                                   
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 6                                                                 
                                       S1|T1 receive commands | logLen:                                           
                                       6[Start]                                                                   
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 7                                                                 
                                       S1|T1 receive commands | logLen:                                           
                                       7[Start]                                                                   
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 8                                                                 
                                       S1|T1 receive commands | logLen:                                           
                                       8[Start]                                                                   
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 9                                                                 
                                       S1|T1 receive commands | logLen:                                           
                                       9[Start]                                                                   
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 10                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       10[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 11                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       11[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 12                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       12[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 13                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       13[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 14                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       14[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 15                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       15[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 16                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       16[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 17                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       17[Start]                                                                  
S0|T1 is not leader                                                                                               
                                                                             S2|T1 is not leader                  
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 17                          
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 17                                                                                                       
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             17[AppendEntry]                      
S0|T1 appends logs from S1| logLen:                                                                               
17[AppendEntry]                                                                                                   
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:15| matchidx:16| nextidx:17                                       
                                       S1|T1 update commitIndex as 16                                             
                                       S1|T1 starts to apply entries                                              
                                       [2:16][ApplyEntry]                                                         
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:15| matchidx:16| nextidx:17                                       
                                       S1|T1 Snapshot until index 9| logLen:                                      
                                       17                                                                         
                                       S1|T1 finishes applying entries                                            
                                       [2:16][ApplyEntry]                                                         
S0|T1 is not leader                                                                                               
                                                                             S2|T1 is not leader                  
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 17                          
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 17                                                                                                       
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             17[AppendEntry]                      
S0|T1 appends logs from S1| logLen:                                                                               
17[AppendEntry]                                                                                                   
                                                                             S2|T1 starts to apply entries        
                                                                             [2:16][ApplyEntry]                   
S0|T1 starts to apply entries                                                                                     
[2:16][ApplyEntry]                                                                                                
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:0| matchidx:16| nextidx:17                                        
                                                                             S2|T1 Snapshot until index 9| logLen:
                                                                             17                                   
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:0| matchidx:16| nextidx:17                                        
                                                                             S2|T1 finishes applying entries      
                                                                             [2:16][ApplyEntry]                   
S0|T1 Snapshot until index 9| logLen:                                                                             
17                                                                                                                
S0|T1 finishes applying entries                                                                                   
[2:16][ApplyEntry]                                                                                                
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 18                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       18[Start]                                                                  
                                                                             S2|T1 is not leader                  
S0|T1 is not leader                                                                                               
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 18                                                                                                       
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 18                          
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             18[AppendEntry]                      
S0|T1 appends logs from S1| logLen:                                                                               
18[AppendEntry]                                                                                                   
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:1| matchidx:17| nextidx:18                                        
                                       S1|T1 update commitIndex as 17                                             
                                       S1|T1 starts to apply entries                                              
                                       [17:17][ApplyEntry]                                                        
                                       S1|T1 finishes applying entries                                            
                                       [17:17][ApplyEntry]                                                        
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:1| matchidx:17| nextidx:18                                        
                                                                             S2|T1 is not leader                  
S0|T1 is not leader                                                                                               
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 18                                                                                                       
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 18                          
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             18[AppendEntry]                      
S0|T1 appends logs from S1| logLen:                                                                               
18[AppendEntry]                                                                                                   
                                                                             S2|T1 starts to apply entries        
                                                                             [17:17][ApplyEntry]                  
                                                                             S2|T1 finishes applying entries      
                                                                             [17:17][ApplyEntry]                  
S0|T1 starts to apply entries                                                                                     
[17:17][ApplyEntry]                                                                                               
S0|T1 finishes applying entries                                                                                   
[17:17][ApplyEntry]                                                                                               
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:0| matchidx:17| nextidx:18                                        
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:0| matchidx:17| nextidx:18                                        
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 19                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       19[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 20                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       20[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 21                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       21[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 22                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       22[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 23                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       23[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 24                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       24[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 25                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       25[Start]                                                                  
                                                                             S2|T1 is not leader                  
S0|T1 is not leader                                                                                               
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 25                                                                                                       
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 25                          
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             25[AppendEntry]                      
S0|T1 appends logs from S1| logLen:                                                                               
25[AppendEntry]                                                                                                   
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:7| matchidx:24| nextidx:25                                        
                                       S1|T1 update commitIndex as 24                                             
                                       S1|T1 starts to apply entries                                              
                                       [18:24][ApplyEntry]                                                        
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:7| matchidx:24| nextidx:25                                        
                                       S1|T1 Snapshot until index 19|                                             
                                       logLen: 25                                                                 
                                       S1|T1 finishes applying entries                                            
                                       [18:24][ApplyEntry]                                                        
                                                                             S2|T1 is not leader                  
S0|T1 is not leader                                                                                               
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 25                                                                                                       
S0|T1 appends logs from S1| logLen:                                                                               
25[AppendEntry]                                                                                                   
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 25                          
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             25[AppendEntry]                      
S0|T1 starts to apply entries                                                                                     
[18:24][ApplyEntry]                                                                                               
                                                                             S2|T1 starts to apply entries        
                                                                             [18:24][ApplyEntry]                  
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:0| matchidx:24| nextidx:25                                        
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:0| matchidx:24| nextidx:25                                        
S0|T1 Snapshot until index 19| logLen:                                                                            
25                                                                                                                
                                                                             S2|T1 Snapshot until index 19|       
                                                                             logLen: 25                           
S0|T1 finishes applying entries                                                                                   
[18:24][ApplyEntry]                                                                                               
                                                                             S2|T1 finishes applying entries      
                                                                             [18:24][ApplyEntry]                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 26                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       26[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 27                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       27[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 28                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       28[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 29                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       29[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 30                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       30[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 31                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       31[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 32                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       32[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 33                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       33[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 34                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       34[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 35                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       35[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 36                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       36[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 37                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       37[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 38                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       38[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 39                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       39[Start]                                                                  
                                                                             S2|T1 is not leader                  
S0|T1 is not leader                                                                                               
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 39                          
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             39[AppendEntry]                      
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:14| matchidx:38| nextidx:39                                       
                                       S1|T1 update commitIndex as 38                                             
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 39                                                                                                       
                                       S1|T1 starts to apply entries                                              
                                       [25:38][ApplyEntry]                                                        
S0|T1 appends logs from S1| logLen:                                                                               
39[AppendEntry]                                                                                                   
                                       S1|T1 Snapshot until index 29|                                             
                                       logLen: 39                                                                 
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:14| matchidx:38| nextidx:39                                       
                                       S1|T1 finishes applying entries                                            
                                       [25:38][ApplyEntry]                                                        
                                                                             S2|T1 is not leader                  
S0|T1 is not leader                                                                                               
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 39                          
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             39[AppendEntry]                      
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 39                                                                                                       
S0|T1 appends logs from S1| logLen:                                                                               
39[AppendEntry]                                                                                                   
                                                                             S2|T1 starts to apply entries        
                                                                             [25:38][ApplyEntry]                  
S0|T1 starts to apply entries                                                                                     
[25:38][ApplyEntry]                                                                                               
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:0| matchidx:38| nextidx:39                                        
                                                                             S2|T1 Snapshot until index 29|       
                                                                             logLen: 39                           
                                                                             S2|T1 finishes applying entries      
                                                                             [25:38][ApplyEntry]                  
S0|T1 Snapshot until index 29| logLen:                                                                            
39                                                                                                                
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:0| matchidx:38| nextidx:39                                        
S0|T1 finishes applying entries                                                                                   
[25:38][ApplyEntry]                                                                                               
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 40                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       40[Start]                                                                  
                                                                             S2|T1 is not leader                  
S0|T1 is not leader                                                                                               
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 40                                                                                                       
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 40                          
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             40[AppendEntry]                      
S0|T1 appends logs from S1| logLen:                                                                               
40[AppendEntry]                                                                                                   
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:1| matchidx:39| nextidx:40                                        
                                       S1|T1 update commitIndex as 39                                             
                                       S1|T1 starts to apply entries                                              
                                       [39:39][ApplyEntry]                                                        
                                       S1|T1 finishes applying entries                                            
                                       [39:39][ApplyEntry]                                                        
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:1| matchidx:39| nextidx:40                                        
                                       S1|T1 Snapshot until index 39|                                             
                                       logLen: 40                                                                 
                                                                             S2|T1 is not leader                  
S0|T1 is not leader                                                                                               
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 40                          
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 40                                                                                                       
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             40[AppendEntry]                      
S0|T1 appends logs from S1| logLen:                                                                               
40[AppendEntry]                                                                                                   
                                                                             S2|T1 starts to apply entries        
                                                                             [39:39][ApplyEntry]                  
S0|T1 starts to apply entries                                                                                     
[39:39][ApplyEntry]                                                                                               
                                                                             S2|T1 finishes applying entries      
                                                                             [39:39][ApplyEntry]                  
S0|T1 finishes applying entries                                                                                   
[39:39][ApplyEntry]                                                                                               
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:0| matchidx:39| nextidx:40                                        
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:0| matchidx:39| nextidx:40                                        
                                                                             S2|T1 Snapshot until index 39|       
                                                                             logLen: 40                           
S0|T1 Snapshot until index 39| logLen:                                                                            
40                                                                                                                
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 41                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       41[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 42                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       42[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 43                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       43[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 44                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       44[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 45                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       45[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 46                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       46[Start]                                                                  
S0|T1 is not leader                                                                                               
                                                                             S2|T1 is not leader                  
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 46                                                                                                       
S0|T1 appends logs from S1| logLen:                                                                               
46[AppendEntry]                                                                                                   
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 46                          
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             46[AppendEntry]                      
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:6| matchidx:45| nextidx:46                                        
                                       S1|T1 update commitIndex as 45                                             
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:6| matchidx:45| nextidx:46                                        
                                       S1|T1 starts to apply entries                                              
                                       [40:45][ApplyEntry]                                                        
                                       S1|T1 finishes applying entries                                            
                                       [40:45][ApplyEntry]                                                        
S0|T1 is not leader                                                                                               
                                                                             S2|T1 is not leader                  
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 46                                                                                                       
S0|T1 appends logs from S1| logLen:                                                                               
46[AppendEntry]                                                                                                   
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 46                          
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             46[AppendEntry]                      
S0|T1 starts to apply entries                                                                                     
[40:45][ApplyEntry]                                                                                               
S0|T1 finishes applying entries                                                                                   
[40:45][ApplyEntry]                                                                                               
                                                                             S2|T1 starts to apply entries        
                                                                             [40:45][ApplyEntry]                  
                                                                             S2|T1 finishes applying entries      
                                                                             [40:45][ApplyEntry]                  
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:0| matchidx:45| nextidx:46                                        
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:0| matchidx:45| nextidx:46                                        
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 47                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       47[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 48                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       48[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 49                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       49[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 50                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       50[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 51                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       51[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 52                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       52[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 53                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       53[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 54                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       54[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 55                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       55[Start]                                                                  
S0|T1 is not leader                                                                                               
                                                                             S2|T1 is not leader                  
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 55                                                                                                       
S0|T1 appends logs from S1| logLen:                                                                               
55[AppendEntry]                                                                                                   
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 55                          
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             55[AppendEntry]                      
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:9| matchidx:54| nextidx:55                                        
                                       S1|T1 update commitIndex as 54                                             
                                       S1|T1 starts to apply entries                                              
                                       [46:54][ApplyEntry]                                                        
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:9| matchidx:54| nextidx:55                                        
                                       S1|T1 Snapshot until index 49|                                             
                                       logLen: 55                                                                 
                                       S1|T1 finishes applying entries                                            
                                       [46:54][ApplyEntry]                                                        
                                                                             S2|T1 is not leader                  
S0|T1 is not leader                                                                                               
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 55                          
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             55[AppendEntry]                      
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 55                                                                                                       
S0|T1 appends logs from S1| logLen:                                                                               
55[AppendEntry]                                                                                                   
                                                                             S2|T1 starts to apply entries        
                                                                             [46:54][ApplyEntry]                  
S0|T1 starts to apply entries                                                                                     
[46:54][ApplyEntry]                                                                                               
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:0| matchidx:54| nextidx:55                                        
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:0| matchidx:54| nextidx:55                                        
                                                                             S2|T1 Snapshot until index 49|       
                                                                             logLen: 55                           
                                                                             S2|T1 finishes applying entries      
                                                                             [46:54][ApplyEntry]                  
S0|T1 Snapshot until index 49| logLen:                                                                            
55                                                                                                                
S0|T1 finishes applying entries                                                                                   
[46:54][ApplyEntry]                                                                                               
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 56                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       56[Start]                                                                  
S0|T1 is not leader                                                                                               
                                                                             S2|T1 is not leader                  
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 56                                                                                                       
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 56                          
S0|T1 appends logs from S1| logLen:                                                                               
56[AppendEntry]                                                                                                   
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             56[AppendEntry]                      
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:1| matchidx:55| nextidx:56                                        
                                       S1|T1 update commitIndex as 55                                             
                                       S1|T1 starts to apply entries                                              
                                       [55:55][ApplyEntry]                                                        
                                       S1|T1 finishes applying entries                                            
                                       [55:55][ApplyEntry]                                                        
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:1| matchidx:55| nextidx:56                                        
S0|T1 is not leader                                                                                               
                                                                             S2|T1 is not leader                  
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 56                          
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 56                                                                                                       
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             56[AppendEntry]                      
S0|T1 appends logs from S1| logLen:                                                                               
56[AppendEntry]                                                                                                   
S0|T1 starts to apply entries                                                                                     
[55:55][ApplyEntry]                                                                                               
S0|T1 finishes applying entries                                                                                   
[55:55][ApplyEntry]                                                                                               
                                                                             S2|T1 starts to apply entries        
                                                                             [55:55][ApplyEntry]                  
                                                                             S2|T1 finishes applying entries      
                                                                             [55:55][ApplyEntry]                  
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:0| matchidx:55| nextidx:56                                        
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:0| matchidx:55| nextidx:56                                        
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 57                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       57[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 58                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       58[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 59                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       59[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 60                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       60[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 61                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       61[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 62                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       62[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 63                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       63[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 64                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       64[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 65                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       65[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 66                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       66[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 67                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       67[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 68                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       68[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 69                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       69[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 70                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       70[Start]                                                                  
S0|T1 is not leader                                                                                               
                                                                             S2|T1 is not leader                  
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 70                                                                                                       
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 70                          
S0|T1 appends logs from S1| logLen:                                                                               
70[AppendEntry]                                                                                                   
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             70[AppendEntry]                      
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:14| matchidx:69| nextidx:70                                       
                                       S1|T1 update commitIndex as 69                                             
                                       S1|T1 starts to apply entries                                              
                                       [56:69][ApplyEntry]                                                        
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:14| matchidx:69| nextidx:70                                       
                                       S1|T1 Snapshot until index 59|                                             
                                       logLen: 70                                                                 
                                       S1|T1 finishes applying entries                                            
                                       [56:69][ApplyEntry]                                                        
                                       S1|T1 Snapshot until index 69|                                             
                                       logLen: 70                                                                 
                                                                             S2|T1 is not leader                  
S0|T1 is not leader                                                                                               
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 70                                                                                                       
S0|T1 appends logs from S1| logLen:                                                                               
70[AppendEntry]                                                                                                   
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 70                          
S0|T1 starts to apply entries                                                                                     
[56:69][ApplyEntry]                                                                                               
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             70[AppendEntry]                      
                                                                             S2|T1 starts to apply entries        
                                                                             [56:69][ApplyEntry]                  
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:0| matchidx:69| nextidx:70                                        
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:0| matchidx:69| nextidx:70                                        
S0|T1 Snapshot until index 59| logLen:                                                                            
70                                                                                                                
S0|T1 finishes applying entries                                                                                   
[56:69][ApplyEntry]                                                                                               
                                                                             S2|T1 Snapshot until index 59|       
                                                                             logLen: 70                           
                                                                             S2|T1 finishes applying entries      
                                                                             [56:69][ApplyEntry]                  
S0|T1 Snapshot until index 69| logLen:                                                                            
70                                                                                                                
                                                                             S2|T1 Snapshot until index 69|       
                                                                             logLen: 70                           
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 71                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       71[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 72                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       72[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 73                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       73[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 74                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       74[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 75                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       75[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 76                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       76[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 77                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       77[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 78                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       78[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 79                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       79[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 80                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       80[Start]                                                                  
S0|T1 is not leader                                                                                               
                                                                             S2|T1 is not leader                  
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 80                                                                                                       
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 80                          
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             80[AppendEntry]                      
S0|T1 appends logs from S1| logLen:                                                                               
80[AppendEntry]                                                                                                   
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:10| matchidx:79| nextidx:80                                       
                                       S1|T1 update commitIndex as 79                                             
                                       S1|T1 starts to apply entries                                              
                                       [70:79][ApplyEntry]                                                        
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:10| matchidx:79| nextidx:80                                       
                                       S1|T1 finishes applying entries                                            
                                       [70:79][ApplyEntry]                                                        
                                       S1|T1 Snapshot until index 79|                                             
                                       logLen: 80                                                                 
S0|T1 is not leader                                                                                               
                                                                             S2|T1 is not leader                  
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 80                          
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             80[AppendEntry]                      
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 80                                                                                                       
S0|T1 appends logs from S1| logLen:                                                                               
80[AppendEntry]                                                                                                   
                                                                             S2|T1 starts to apply entries        
                                                                             [70:79][ApplyEntry]                  
S0|T1 starts to apply entries                                                                                     
[70:79][ApplyEntry]                                                                                               
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:0| matchidx:79| nextidx:80                                        
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:0| matchidx:79| nextidx:80                                        
                                                                             S2|T1 finishes applying entries      
                                                                             [70:79][ApplyEntry]                  
S0|T1 finishes applying entries                                                                                   
[70:79][ApplyEntry]                                                                                               
S0|T1 Snapshot until index 79| logLen:                                                                            
80                                                                                                                
                                                                             S2|T1 Snapshot until index 79|       
                                                                             logLen: 80                           
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 81                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       81[Start]                                                                  
                                                                             S2|T1 is not leader                  
S0|T1 is not leader                                                                                               
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 81                          
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             81[AppendEntry]                      
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 81                                                                                                       
S0|T1 appends logs from S1| logLen:                                                                               
81[AppendEntry]                                                                                                   
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:1| matchidx:80| nextidx:81                                        
                                       S1|T1 update commitIndex as 80                                             
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:1| matchidx:80| nextidx:81                                        
                                       S1|T1 starts to apply entries                                              
                                       [80:80][ApplyEntry]                                                        
                                       S1|T1 finishes applying entries                                            
                                       [80:80][ApplyEntry]                                                        
                                                                             S2|T1 is not leader                  
S0|T1 is not leader                                                                                               
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 81                                                                                                       
S0|T1 appends logs from S1| logLen:                                                                               
81[AppendEntry]                                                                                                   
S0|T1 starts to apply entries                                                                                     
[80:80][ApplyEntry]                                                                                               
S0|T1 finishes applying entries                                                                                   
[80:80][ApplyEntry]                                                                                               
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:0| matchidx:80| nextidx:81                                        
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 81                          
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             81[AppendEntry]                      
                                                                             S2|T1 starts to apply entries        
                                                                             [80:80][ApplyEntry]                  
                                                                             S2|T1 finishes applying entries      
                                                                             [80:80][ApplyEntry]                  
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:0| matchidx:80| nextidx:81                                        
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 82                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       82[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 83                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       83[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 84                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       84[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 85                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       85[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 86                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       86[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 87                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       87[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 88                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       88[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 89                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       89[Start]                                                                  
                                                                             S2|T1 is not leader                  
S0|T1 is not leader                                                                                               
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 89                                                                                                       
S0|T1 appends logs from S1| logLen:                                                                               
89[AppendEntry]                                                                                                   
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 89                          
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             89[AppendEntry]                      
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:8| matchidx:88| nextidx:89                                        
                                       S1|T1 update commitIndex as 88                                             
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:8| matchidx:88| nextidx:89                                        
                                       S1|T1 starts to apply entries                                              
                                       [81:88][ApplyEntry]                                                        
                                       S1|T1 finishes applying entries                                            
                                       [81:88][ApplyEntry]                                                        
                                                                             S2|T1 is not leader                  
S0|T1 is not leader                                                                                               
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 89                          
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 89                                                                                                       
S0|T1 appends logs from S1| logLen:                                                                               
89[AppendEntry]                                                                                                   
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             89[AppendEntry]                      
S0|T1 starts to apply entries                                                                                     
[81:88][ApplyEntry]                                                                                               
                                                                             S2|T1 starts to apply entries        
                                                                             [81:88][ApplyEntry]                  
S0|T1 finishes applying entries                                                                                   
[81:88][ApplyEntry]                                                                                               
                                                                             S2|T1 finishes applying entries      
                                                                             [81:88][ApplyEntry]                  
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:0| matchidx:88| nextidx:89                                        
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:0| matchidx:88| nextidx:89                                        
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 90                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       90[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 91                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       91[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 92                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       92[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 93                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       93[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 94                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       94[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 95                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       95[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 96                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       96[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 97                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       97[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 98                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       98[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 99                                                                
                                       S1|T1 receive commands | logLen:                                           
                                       99[Start]                                                                  
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 100                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       100[Start]                                                                 
S0|T1 is not leader                                                                                               
                                                                             S2|T1 is not leader                  
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 100                                                                                                      
S0|T1 appends logs from S1| logLen:                                                                               
100[AppendEntry]                                                                                                  
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 100                         
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             100[AppendEntry]                     
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:11| matchidx:99| nextidx:100                                      
                                       S1|T1 update commitIndex as 99                                             
                                       S1|T1 starts to apply entries                                              
                                       [89:99][ApplyEntry]                                                        
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:11| matchidx:99| nextidx:100                                      
                                       S1|T1 Snapshot until index 89|                                             
                                       logLen: 100                                                                
                                       S1|T1 finishes applying entries                                            
                                       [89:99][ApplyEntry]                                                        
                                       S1|T1 Snapshot until index 99|                                             
                                       logLen: 100                                                                
                                                                             S2|T1 is not leader                  
S0|T1 is not leader                                                                                               
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 100                         
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 100                                                                                                      
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             100[AppendEntry]                     
S0|T1 appends logs from S1| logLen:                                                                               
100[AppendEntry]                                                                                                  
                                                                             S2|T1 starts to apply entries        
                                                                             [89:99][ApplyEntry]                  
S0|T1 starts to apply entries                                                                                     
[89:99][ApplyEntry]                                                                                               
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:0| matchidx:99| nextidx:100                                       
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:0| matchidx:99| nextidx:100                                       
                                                                             S2|T1 Snapshot until index 89|       
                                                                             logLen: 100                          
S0|T1 Snapshot until index 89| logLen:                                                                            
100                                                                                                               
                                                                             S2|T1 finishes applying entries      
                                                                             [89:99][ApplyEntry]                  
S0|T1 finishes applying entries                                                                                   
[89:99][ApplyEntry]                                                                                               
                                                                             S2|T1 Snapshot until index 99|       
                                                                             logLen: 100                          
S0|T1 Snapshot until index 99| logLen:                                                                            
100                                                                                                               
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 101                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       101[Start]                                                                 
S0|T1 is not leader                                                                                               
                                                                             S2|T1 is not leader                  
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 101                         
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 101                                                                                                      
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             101[AppendEntry]                     
S0|T1 appends logs from S1| logLen:                                                                               
101[AppendEntry]                                                                                                  
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:1| matchidx:100| nextidx:101                                      
                                       S1|T1 update commitIndex as 100                                            
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:1| matchidx:100| nextidx:101                                      
                                       S1|T1 starts to apply entries                                              
                                       [100:100][ApplyEntry]                                                      
                                       S1|T1 finishes applying entries                                            
                                       [100:100][ApplyEntry]                                                      
S0|T1 is not leader                                                                                               
                                                                             S2|T1 is not leader                  
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 101                                                                                                      
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 101                         
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             101[AppendEntry]                     
S0|T1 appends logs from S1| logLen:                                                                               
101[AppendEntry]                                                                                                  
                                                                             S2|T1 starts to apply entries        
                                                                             [100:100][ApplyEntry]                
                                                                             S2|T1 finishes applying entries      
                                                                             [100:100][ApplyEntry]                
S0|T1 starts to apply entries                                                                                     
[100:100][ApplyEntry]                                                                                             
S0|T1 finishes applying entries                                                                                   
[100:100][ApplyEntry]                                                                                             
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:0| matchidx:100| nextidx:101                                      
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:0| matchidx:100| nextidx:101                                      
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 102                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       102[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 103                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       103[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 104                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       104[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 105                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       105[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 106                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       106[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 107                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       107[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 108                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       108[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 109                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       109[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 110                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       110[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 111                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       111[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 112                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       112[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 113                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       113[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 114                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       114[Start]                                                                 
S0|T1 is not leader                                                                                               
                                                                             S2|T1 is not leader                  
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 114                                                                                                      
S0|T1 appends logs from S1| logLen:                                                                               
114[AppendEntry]                                                                                                  
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 114                         
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             114[AppendEntry]                     
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:13| matchidx:113|                                                 
                                       nextidx:114                                                                
                                       S1|T1 update commitIndex as 113                                            
                                       S1|T1 starts to apply entries                                              
                                       [101:113][ApplyEntry]                                                      
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:13| matchidx:113|                                                 
                                       nextidx:114                                                                
                                       S1|T1 Snapshot until index 109|                                            
                                       logLen: 114                                                                
                                       S1|T1 finishes applying entries                                            
                                       [101:113][ApplyEntry]                                                      
S0|T1 is not leader                                                                                               
                                                                             S2|T1 is not leader                  
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 114                         
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             114[AppendEntry]                     
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 114                                                                                                      
                                                                             S2|T1 starts to apply entries        
                                                                             [101:113][ApplyEntry]                
S0|T1 appends logs from S1| logLen:                                                                               
114[AppendEntry]                                                                                                  
S0|T1 starts to apply entries                                                                                     
[101:113][ApplyEntry]                                                                                             
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:0| matchidx:113| nextidx:114                                      
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:0| matchidx:113| nextidx:114                                      
                                                                             S2|T1 Snapshot until index 109|      
                                                                             logLen: 114                          
S0|T1 Snapshot until index 109|                                                                                   
logLen: 114                                                                                                       
                                                                             S2|T1 finishes applying entries      
                                                                             [101:113][ApplyEntry]                
S0|T1 finishes applying entries                                                                                   
[101:113][ApplyEntry]                                                                                             
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 115                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       115[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 116                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       116[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 117                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       117[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 118                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       118[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 119                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       119[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 120                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       120[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 121                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       121[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 122                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       122[Start]                                                                 
                                                                             S2|T1 is not leader                  
S0|T1 is not leader                                                                                               
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 122                         
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             122[AppendEntry]                     
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 122                                                                                                      
S0|T1 appends logs from S1| logLen:                                                                               
122[AppendEntry]                                                                                                  
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:8| matchidx:121| nextidx:122                                      
                                       S1|T1 update commitIndex as 121                                            
                                       S1|T1 starts to apply entries                                              
                                       [114:121][ApplyEntry]                                                      
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:8| matchidx:121| nextidx:122                                      
                                       S1|T1 Snapshot until index 119|                                            
                                       logLen: 122                                                                
                                       S1|T1 finishes applying entries                                            
                                       [114:121][ApplyEntry]                                                      
S0|T1 is not leader                                                                                               
                                                                             S2|T1 is not leader                  
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 122                                                                                                      
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 122                         
S0|T1 appends logs from S1| logLen:                                                                               
122[AppendEntry]                                                                                                  
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             122[AppendEntry]                     
S0|T1 starts to apply entries                                                                                     
[114:121][ApplyEntry]                                                                                             
                                                                             S2|T1 starts to apply entries        
                                                                             [114:121][ApplyEntry]                
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:0| matchidx:121| nextidx:122                                      
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:0| matchidx:121| nextidx:122                                      
                                                                             S2|T1 Snapshot until index 119|      
                                                                             logLen: 122                          
                                                                             S2|T1 finishes applying entries      
                                                                             [114:121][ApplyEntry]                
S0|T1 Snapshot until index 119|                                                                                   
logLen: 122                                                                                                       
S0|T1 finishes applying entries                                                                                   
[114:121][ApplyEntry]                                                                                             
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 123                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       123[Start]                                                                 
                                                                             S2|T1 is not leader                  
S0|T1 is not leader                                                                                               
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 123                                                                                                      
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 123                         
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             123[AppendEntry]                     
S0|T1 appends logs from S1| logLen:                                                                               
123[AppendEntry]                                                                                                  
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:1| matchidx:122| nextidx:123                                      
                                       S1|T1 update commitIndex as 122                                            
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:1| matchidx:122| nextidx:123                                      
                                       S1|T1 starts to apply entries                                              
                                       [122:122][ApplyEntry]                                                      
                                       S1|T1 finishes applying entries                                            
                                       [122:122][ApplyEntry]                                                      
                                                                             S2|T1 is not leader                  
S0|T1 is not leader                                                                                               
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 123                         
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             123[AppendEntry]                     
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 123                                                                                                      
S0|T1 appends logs from S1| logLen:                                                                               
123[AppendEntry]                                                                                                  
                                                                             S2|T1 starts to apply entries        
                                                                             [122:122][ApplyEntry]                
                                                                             S2|T1 finishes applying entries      
                                                                             [122:122][ApplyEntry]                
S0|T1 starts to apply entries                                                                                     
[122:122][ApplyEntry]                                                                                             
S0|T1 finishes applying entries                                                                                   
[122:122][ApplyEntry]                                                                                             
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:0| matchidx:122| nextidx:123                                      
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:0| matchidx:122| nextidx:123                                      
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 124                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       124[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 125                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       125[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 126                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       126[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 127                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       127[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 128                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       128[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 129                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       129[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 130                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       130[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 131                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       131[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 132                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       132[Start]                                                                 
                                                                             S2|T1 is not leader                  
S0|T1 is not leader                                                                                               
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 132                         
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 132                                                                                                      
S0|T1 appends logs from S1| logLen:                                                                               
132[AppendEntry]                                                                                                  
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             132[AppendEntry]                     
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:9| matchidx:131| nextidx:132                                      
                                       S1|T1 update commitIndex as 131                                            
                                       S1|T1 starts to apply entries                                              
                                       [123:131][ApplyEntry]                                                      
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:9| matchidx:131| nextidx:132                                      
                                       S1|T1 Snapshot until index 129|                                            
                                       logLen: 132                                                                
                                       S1|T1 finishes applying entries                                            
                                       [123:131][ApplyEntry]                                                      
S0|T1 is not leader                                                                                               
                                                                             S2|T1 is not leader                  
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 132                         
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 132                                                                                                      
S0|T1 appends logs from S1| logLen:                                                                               
132[AppendEntry]                                                                                                  
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             132[AppendEntry]                     
S0|T1 starts to apply entries                                                                                     
[123:131][ApplyEntry]                                                                                             
                                                                             S2|T1 starts to apply entries        
                                                                             [123:131][ApplyEntry]                
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:0| matchidx:131| nextidx:132                                      
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:0| matchidx:131| nextidx:132                                      
S0|T1 Snapshot until index 129|                                                                                   
logLen: 132                                                                                                       
                                                                             S2|T1 Snapshot until index 129|      
                                                                             logLen: 132                          
                                                                             S2|T1 finishes applying entries      
                                                                             [123:131][ApplyEntry]                
S0|T1 finishes applying entries                                                                                   
[123:131][ApplyEntry]                                                                                             
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 133                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       133[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 134                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       134[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 135                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       135[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 136                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       136[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 137                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       137[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 138                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       138[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 139                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       139[Start]                                                                 
S0|T1 is not leader                                                                                               
                                                                             S2|T1 is not leader                  
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 139                         
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 139                                                                                                      
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             139[AppendEntry]                     
S0|T1 appends logs from S1| logLen:                                                                               
139[AppendEntry]                                                                                                  
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:7| matchidx:138| nextidx:139                                      
                                       S1|T1 update commitIndex as 138                                            
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:7| matchidx:138| nextidx:139                                      
                                       S1|T1 starts to apply entries                                              
                                       [132:138][ApplyEntry]                                                      
                                       S1|T1 finishes applying entries                                            
                                       [132:138][ApplyEntry]                                                      
S0|T1 is not leader                                                                                               
                                                                             S2|T1 is not leader                  
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 139                         
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             139[AppendEntry]                     
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 139                                                                                                      
S0|T1 appends logs from S1| logLen:                                                                               
139[AppendEntry]                                                                                                  
                                                                             S2|T1 starts to apply entries        
                                                                             [132:138][ApplyEntry]                
                                                                             S2|T1 finishes applying entries      
                                                                             [132:138][ApplyEntry]                
S0|T1 starts to apply entries                                                                                     
[132:138][ApplyEntry]                                                                                             
S0|T1 finishes applying entries                                                                                   
[132:138][ApplyEntry]                                                                                             
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:0| matchidx:138| nextidx:139                                      
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:0| matchidx:138| nextidx:139                                      
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 140                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       140[Start]                                                                 
                                                                             S2|T1 is not leader                  
S0|T1 is not leader                                                                                               
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 140                         
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 140                                                                                                      
S0|T1 appends logs from S1| logLen:                                                                               
140[AppendEntry]                                                                                                  
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             140[AppendEntry]                     
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:1| matchidx:139| nextidx:140                                      
                                       S1|T1 update commitIndex as 139                                            
                                       S1|T1 starts to apply entries                                              
                                       [139:139][ApplyEntry]                                                      
                                       S1|T1 finishes applying entries                                            
                                       [139:139][ApplyEntry]                                                      
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:1| matchidx:139| nextidx:140                                      
                                       S1|T1 Snapshot until index 139|                                            
                                       logLen: 140                                                                
S0|T1 is not leader                                                                                               
                                                                             S2|T1 is not leader                  
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 140                         
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             140[AppendEntry]                     
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 140                                                                                                      
S0|T1 appends logs from S1| logLen:                                                                               
140[AppendEntry]                                                                                                  
S0|T1 starts to apply entries                                                                                     
[139:139][ApplyEntry]                                                                                             
S0|T1 finishes applying entries                                                                                   
[139:139][ApplyEntry]                                                                                             
                                                                             S2|T1 starts to apply entries        
                                                                             [139:139][ApplyEntry]                
                                                                             S2|T1 finishes applying entries      
                                                                             [139:139][ApplyEntry]                
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:0| matchidx:139| nextidx:140                                      
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:0| matchidx:139| nextidx:140                                      
S0|T1 Snapshot until index 139|                                                                                   
logLen: 140                                                                                                       
                                                                             S2|T1 Snapshot until index 139|      
                                                                             logLen: 140                          
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 141                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       141[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 142                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       142[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 143                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       143[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 144                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       144[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 145                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       145[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 146                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       146[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 147                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       147[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 148                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       148[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 149                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       149[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 150                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       150[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 151                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       151[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 152                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       152[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 153                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       153[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 154                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       154[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 155                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       155[Start]                                                                 
                                                                             S2|T1 is not leader                  
S0|T1 is not leader                                                                                               
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 155                                                                                                      
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 155                         
S0|T1 appends logs from S1| logLen:                                                                               
155[AppendEntry]                                                                                                  
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             155[AppendEntry]                     
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:15| matchidx:154|                                                 
                                       nextidx:155                                                                
                                       S1|T1 update commitIndex as 154                                            
                                       S1|T1 starts to apply entries                                              
                                       [140:154][ApplyEntry]                                                      
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:15| matchidx:154|                                                 
                                       nextidx:155                                                                
                                       S1|T1 Snapshot until index 149|                                            
                                       logLen: 155                                                                
                                       S1|T1 finishes applying entries                                            
                                       [140:154][ApplyEntry]                                                      
S0|T1 is not leader                                                                                               
                                                                             S2|T1 is not leader                  
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 155                                                                                                      
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 155                         
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             155[AppendEntry]                     
S0|T1 appends logs from S1| logLen:                                                                               
155[AppendEntry]                                                                                                  
                                                                             S2|T1 starts to apply entries        
                                                                             [140:154][ApplyEntry]                
S0|T1 starts to apply entries                                                                                     
[140:154][ApplyEntry]                                                                                             
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:0| matchidx:154| nextidx:155                                      
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:0| matchidx:154| nextidx:155                                      
S0|T1 Snapshot until index 149|                                                                                   
logLen: 155                                                                                                       
S0|T1 finishes applying entries                                                                                   
[140:154][ApplyEntry]                                                                                             
                                                                             S2|T1 Snapshot until index 149|      
                                                                             logLen: 155                          
                                                                             S2|T1 finishes applying entries      
                                                                             [140:154][ApplyEntry]                
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 156                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       156[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 157                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       157[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 158                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       158[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 159                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       159[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 160                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       160[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 161                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       161[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 162                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       162[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 163                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       163[Start]                                                                 
                                                                             S2|T1 is not leader                  
S0|T1 is not leader                                                                                               
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 163                                                                                                      
S0|T1 appends logs from S1| logLen:                                                                               
163[AppendEntry]                                                                                                  
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 163                         
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             163[AppendEntry]                     
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:8| matchidx:162| nextidx:163                                      
                                       S1|T1 update commitIndex as 162                                            
                                       S1|T1 starts to apply entries                                              
                                       [155:162][ApplyEntry]                                                      
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:8| matchidx:162| nextidx:163                                      
                                       S1|T1 Snapshot until index 159|                                            
                                       logLen: 163                                                                
                                       S1|T1 finishes applying entries                                            
                                       [155:162][ApplyEntry]                                                      
S0|T1 is not leader                                                                                               
                                                                             S2|T1 is not leader                  
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 163                                                                                                      
S0|T1 appends logs from S1| logLen:                                                                               
163[AppendEntry]                                                                                                  
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 163                         
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             163[AppendEntry]                     
S0|T1 starts to apply entries                                                                                     
[155:162][ApplyEntry]                                                                                             
                                                                             S2|T1 starts to apply entries        
                                                                             [155:162][ApplyEntry]                
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:0| matchidx:162| nextidx:163                                      
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:0| matchidx:162| nextidx:163                                      
S0|T1 Snapshot until index 159|                                                                                   
logLen: 163                                                                                                       
S0|T1 finishes applying entries                                                                                   
[155:162][ApplyEntry]                                                                                             
                                                                             S2|T1 Snapshot until index 159|      
                                                                             logLen: 163                          
                                                                             S2|T1 finishes applying entries      
                                                                             [155:162][ApplyEntry]                
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 164                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       164[Start]                                                                 
                                                                             S2|T1 is not leader                  
S0|T1 is not leader                                                                                               
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 164                         
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             164[AppendEntry]                     
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 164                                                                                                      
S0|T1 appends logs from S1| logLen:                                                                               
164[AppendEntry]                                                                                                  
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:1| matchidx:163| nextidx:164                                      
                                       S1|T1 update commitIndex as 163                                            
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:1| matchidx:163| nextidx:164                                      
                                       S1|T1 starts to apply entries                                              
                                       [163:163][ApplyEntry]                                                      
                                       S1|T1 finishes applying entries                                            
                                       [163:163][ApplyEntry]                                                      
                                                                             S2|T1 is not leader                  
S0|T1 is not leader                                                                                               
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 164                         
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             164[AppendEntry]                     
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 164                                                                                                      
S0|T1 appends logs from S1| logLen:                                                                               
164[AppendEntry]                                                                                                  
                                                                             S2|T1 starts to apply entries        
                                                                             [163:163][ApplyEntry]                
                                                                             S2|T1 finishes applying entries      
                                                                             [163:163][ApplyEntry]                
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:0| matchidx:163| nextidx:164                                      
S0|T1 starts to apply entries                                                                                     
[163:163][ApplyEntry]                                                                                             
S0|T1 finishes applying entries                                                                                   
[163:163][ApplyEntry]                                                                                             
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:0| matchidx:163| nextidx:164                                      
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 165                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       165[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 166                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       166[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 167                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       167[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 168                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       168[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 169                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       169[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 170                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       170[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 171                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       171[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 172                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       172[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 173                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       173[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 174                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       174[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 175                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       175[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 176                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       176[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 177                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       177[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 178                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       178[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 179                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       179[Start]                                                                 
S0|T1 is not leader                                                                                               
                                                                             S2|T1 is not leader                  
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 179                                                                                                      
S0|T1 appends logs from S1| logLen:                                                                               
179[AppendEntry]                                                                                                  
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 179                         
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             179[AppendEntry]                     
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:15| matchidx:178|                                                 
                                       nextidx:179                                                                
                                       S1|T1 update commitIndex as 178                                            
                                       S1|T1 starts to apply entries                                              
                                       [164:178][ApplyEntry]                                                      
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:15| matchidx:178|                                                 
                                       nextidx:179                                                                
                                       S1|T1 Snapshot until index 169|                                            
                                       logLen: 179                                                                
                                       S1|T1 finishes applying entries                                            
                                       [164:178][ApplyEntry]                                                      
S0|T1 is not leader                                                                                               
                                                                             S2|T1 is not leader                  
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 179                                                                                                      
S0|T1 appends logs from S1| logLen:                                                                               
179[AppendEntry]                                                                                                  
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 179                         
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             179[AppendEntry]                     
S0|T1 starts to apply entries                                                                                     
[164:178][ApplyEntry]                                                                                             
                                                                             S2|T1 starts to apply entries        
                                                                             [164:178][ApplyEntry]                
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:0| matchidx:178| nextidx:179                                      
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:0| matchidx:178| nextidx:179                                      
S0|T1 Snapshot until index 169|                                                                                   
logLen: 179                                                                                                       
S0|T1 finishes applying entries                                                                                   
[164:178][ApplyEntry]                                                                                             
                                                                             S2|T1 Snapshot until index 169|      
                                                                             logLen: 179                          
                                                                             S2|T1 finishes applying entries      
                                                                             [164:178][ApplyEntry]                
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 180                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       180[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 181                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       181[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 182                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       182[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 183                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       183[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 184                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       184[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 185                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       185[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 186                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       186[Start]                                                                 
                                                                             S2|T1 is not leader                  
S0|T1 is not leader                                                                                               
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 186                                                                                                      
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 186                         
S0|T1 appends logs from S1| logLen:                                                                               
186[AppendEntry]                                                                                                  
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             186[AppendEntry]                     
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:7| matchidx:185| nextidx:186                                      
                                       S1|T1 update commitIndex as 185                                            
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:7| matchidx:185| nextidx:186                                      
                                       S1|T1 starts to apply entries                                              
                                       [179:185][ApplyEntry]                                                      
                                       S1|T1 Snapshot until index 179|                                            
                                       logLen: 186                                                                
                                       S1|T1 finishes applying entries                                            
                                       [179:185][ApplyEntry]                                                      
S0|T1 is not leader                                                                                               
                                                                             S2|T1 is not leader                  
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 186                                                                                                      
S0|T1 appends logs from S1| logLen:                                                                               
186[AppendEntry]                                                                                                  
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 186                         
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             186[AppendEntry]                     
S0|T1 starts to apply entries                                                                                     
[179:185][ApplyEntry]                                                                                             
                                                                             S2|T1 starts to apply entries        
                                                                             [179:185][ApplyEntry]                
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:0| matchidx:185| nextidx:186                                      
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:0| matchidx:185| nextidx:186                                      
S0|T1 Snapshot until index 179|                                                                                   
logLen: 186                                                                                                       
                                                                             S2|T1 Snapshot until index 179|      
                                                                             logLen: 186                          
S0|T1 finishes applying entries                                                                                   
[179:185][ApplyEntry]                                                                                             
                                                                             S2|T1 finishes applying entries      
                                                                             [179:185][ApplyEntry]                
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 187                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       187[Start]                                                                 
                                                                             S2|T1 is not leader                  
S0|T1 is not leader                                                                                               
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 187                         
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 187                                                                                                      
S0|T1 appends logs from S1| logLen:                                                                               
187[AppendEntry]                                                                                                  
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             187[AppendEntry]                     
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:1| matchidx:186| nextidx:187                                      
                                       S1|T1 update commitIndex as 186                                            
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:1| matchidx:186| nextidx:187                                      
                                       S1|T1 starts to apply entries                                              
                                       [186:186][ApplyEntry]                                                      
                                       S1|T1 finishes applying entries                                            
                                       [186:186][ApplyEntry]                                                      
                                                                             S2|T1 is not leader                  
S0|T1 is not leader                                                                                               
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 187                                                                                                      
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 187                         
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             187[AppendEntry]                     
S0|T1 appends logs from S1| logLen:                                                                               
187[AppendEntry]                                                                                                  
                                                                             S2|T1 starts to apply entries        
                                                                             [186:186][ApplyEntry]                
                                                                             S2|T1 finishes applying entries      
                                                                             [186:186][ApplyEntry]                
S0|T1 starts to apply entries                                                                                     
[186:186][ApplyEntry]                                                                                             
S0|T1 finishes applying entries                                                                                   
[186:186][ApplyEntry]                                                                                             
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:0| matchidx:186| nextidx:187                                      
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:0| matchidx:186| nextidx:187                                      
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 188                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       188[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 189                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       189[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 190                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       190[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 191                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       191[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 192                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       192[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 193                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       193[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 194                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       194[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 195                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       195[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 196                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       196[Start]                                                                 
                                                                             S2|T1 is not leader                  
S0|T1 is not leader                                                                                               
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 196                                                                                                      
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 196                         
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             196[AppendEntry]                     
S0|T1 appends logs from S1| logLen:                                                                               
196[AppendEntry]                                                                                                  
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:9| matchidx:195| nextidx:196                                      
                                       S1|T1 update commitIndex as 195                                            
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:9| matchidx:195| nextidx:196                                      
                                       S1|T1 starts to apply entries                                              
                                       [187:195][ApplyEntry]                                                      
                                       S1|T1 Snapshot until index 189|                                            
                                       logLen: 196                                                                
                                       S1|T1 finishes applying entries                                            
                                       [187:195][ApplyEntry]                                                      
                                                                             S2|T1 is not leader                  
S0|T1 is not leader                                                                                               
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 196                                                                                                      
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 196                         
S0|T1 appends logs from S1| logLen:                                                                               
196[AppendEntry]                                                                                                  
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             196[AppendEntry]                     
S0|T1 starts to apply entries                                                                                     
[187:195][ApplyEntry]                                                                                             
                                                                             S2|T1 starts to apply entries        
                                                                             [187:195][ApplyEntry]                
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:0| matchidx:195| nextidx:196                                      
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:0| matchidx:195| nextidx:196                                      
S0|T1 Snapshot until index 189|                                                                                   
logLen: 196                                                                                                       
                                                                             S2|T1 Snapshot until index 189|      
                                                                             logLen: 196                          
S0|T1 finishes applying entries                                                                                   
[187:195][ApplyEntry]                                                                                             
                                                                             S2|T1 finishes applying entries      
                                                                             [187:195][ApplyEntry]                
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 197                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       197[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 198                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       198[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 199                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       199[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 200                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       200[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 201                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       201[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 202                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       202[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 203                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       203[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 204                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       204[Start]                                                                 
                                                                             S2|T1 is not leader                  
S0|T1 is not leader                                                                                               
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 204                         
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 204                                                                                                      
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             204[AppendEntry]                     
S0|T1 appends logs from S1| logLen:                                                                               
204[AppendEntry]                                                                                                  
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:8| matchidx:203| nextidx:204                                      
                                       S1|T1 update commitIndex as 203                                            
                                       S1|T1 starts to apply entries                                              
                                       [196:203][ApplyEntry]                                                      
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:8| matchidx:203| nextidx:204                                      
                                       S1|T1 Snapshot until index 199|                                            
                                       logLen: 204                                                                
                                       S1|T1 finishes applying entries                                            
                                       [196:203][ApplyEntry]                                                      
                                                                             S2|T1 is not leader                  
S0|T1 is not leader                                                                                               
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 204                         
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             204[AppendEntry]                     
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 204                                                                                                      
S0|T1 appends logs from S1| logLen:                                                                               
204[AppendEntry]                                                                                                  
                                                                             S2|T1 starts to apply entries        
                                                                             [196:203][ApplyEntry]                
S0|T1 starts to apply entries                                                                                     
[196:203][ApplyEntry]                                                                                             
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:0| matchidx:203| nextidx:204                                      
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:0| matchidx:203| nextidx:204                                      
                                                                             S2|T1 Snapshot until index 199|      
                                                                             logLen: 204                          
                                                                             S2|T1 finishes applying entries      
                                                                             [196:203][ApplyEntry]                
S0|T1 Snapshot until index 199|                                                                                   
logLen: 204                                                                                                       
S0|T1 finishes applying entries                                                                                   
[196:203][ApplyEntry]                                                                                             
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 205                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       205[Start]                                                                 
S0|T1 is not leader                                                                                               
                                                                             S2|T1 is not leader                  
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 205                         
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 205                                                                                                      
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             205[AppendEntry]                     
S0|T1 appends logs from S1| logLen:                                                                               
205[AppendEntry]                                                                                                  
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:1| matchidx:204| nextidx:205                                      
                                       S1|T1 update commitIndex as 204                                            
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:1| matchidx:204| nextidx:205                                      
                                       S1|T1 starts to apply entries                                              
                                       [204:204][ApplyEntry]                                                      
                                       S1|T1 finishes applying entries                                            
                                       [204:204][ApplyEntry]                                                      
                                                                             S2|T1 is not leader                  
S0|T1 is not leader                                                                                               
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 205                                                                                                      
S0|T1 appends logs from S1| logLen:                                                                               
205[AppendEntry]                                                                                                  
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 205                         
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             205[AppendEntry]                     
S0|T1 starts to apply entries                                                                                     
[204:204][ApplyEntry]                                                                                             
S0|T1 finishes applying entries                                                                                   
[204:204][ApplyEntry]                                                                                             
                                                                             S2|T1 starts to apply entries        
                                                                             [204:204][ApplyEntry]                
                                                                             S2|T1 finishes applying entries      
                                                                             [204:204][ApplyEntry]                
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:0| matchidx:204| nextidx:205                                      
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:0| matchidx:204| nextidx:205                                      
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 206                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       206[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 207                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       207[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 208                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       208[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 209                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       209[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 210                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       210[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 211                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       211[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 212                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       212[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 213                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       213[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 214                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       214[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 215                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       215[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 216                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       216[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 217                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       217[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 218                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       218[Start]                                                                 
                                       S1|T1 save persist| votedFor: 1|                                           
                                       logsLen: 219                                                               
                                       S1|T1 receive commands | logLen:                                           
                                       219[Start]                                                                 
                                                                             S2|T1 is not leader                  
S0|T1 is not leader                                                                                               
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 219                                                                                                      
S0|T1 appends logs from S1| logLen:                                                                               
219[AppendEntry]                                                                                                  
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 219                         
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             219[AppendEntry]                     
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:14| matchidx:218|                                                 
                                       nextidx:219                                                                
                                       S1|T1 update commitIndex as 218                                            
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:14| matchidx:218|                                                 
                                       nextidx:219                                                                
                                       S1|T1 starts to apply entries                                              
                                       [205:218][ApplyEntry]                                                      
                                       S1|T1 Snapshot until index 209|                                            
                                       logLen: 219                                                                
                                       S1|T1 finishes applying entries                                            
                                       [205:218][ApplyEntry]                                                      
                                                                             S2|T1 is not leader                  
S0|T1 is not leader                                                                                               
S0|T1 save persist| votedFor: 1|                                                                                  
logsLen: 219                                                                                                      
S0|T1 appends logs from S1| logLen:                                                                               
219[AppendEntry]                                                                                                  
                                                                             S2|T1 save persist| votedFor: 1|     
                                                                             logsLen: 219                         
                                                                             S2|T1 appends logs from S1| logLen:  
                                                                             219[AppendEntry]                     
S0|T1 starts to apply entries                                                                                     
[205:218][ApplyEntry]                                                                                             
                                                                             S2|T1 starts to apply entries        
                                                                             [205:218][ApplyEntry]                
                                       S1|T1 replica entries to S0|                                               
                                       entrylen:0| matchidx:218| nextidx:219                                      
                                       S1|T1 replica entries to S2|                                               
                                       entrylen:0| matchidx:218| nextidx:219                                      
S0|T1 Snapshot until index 209|                                                                                   
logLen: 219                                                                                                       
                                                                             S2|T1 Snapshot until index 209|      
                                                                             logLen: 219                          
                                                                             S2|T1 finishes applying entries      
                                                                             [205:218][ApplyEntry]                
S0|T1 finishes applying entries                                                                                   
[205:218][ApplyEntry]                                                                                             
S0|T0 is made                                                                                                     
                                       S1|T0 is made                                                              
                                                                             S2|T0 is made                        
S0|T1 is not leader                                                                                               
                                                                             S2|T1 is not leader                  
S0|T0 is not leader                                                                                               
                                       S1|T0 is not leader                                                        
                                                                             S2|T0 is not leader                  
S0|T0 is not leader                                                                                               
                                       S1|T0 is not leader                                                        
                                                                             S2|T0 is not leader                  
                                       S1|T0 is not leader                                                        
S0|T0 is not leader                                                                                               
                                                                             S2|T0 is not leader                  
                                                                             S2|T0 is not leader                  
                                       S1|T0 is not leader                                                        
S0|T0 is not leader                                                                                               
                                       S1|T0 is not leader                                                        
                                                                             S2|T0 is not leader                  
S0|T0 is not leader                                                                                               
                                                                             S2|T1 starts to join election        
                                                                             S2|T1 save persist| votedFor: 2|     
                                                                             logsLen: 1                           
                                       S1|T1 save persist| votedFor: -1|                                          
                                       logsLen: 1                                                                 
S0|T1 save persist| votedFor: -1|                                                                                 
logsLen: 1                                                                                                        
                                       S1|T1 save persist| votedFor: 2|                                           
                                       logsLen: 1                                                                 
                                       S1|T1 votes for S2[RequestVote]                                            
S0|T1 save persist| votedFor: 2|                                                                                  
logsLen: 1                                                                                                        
S0|T1 votes for S2[RequestVote]                                                                                   
                                                                             S2|T1 becomes the leader, and starts 
                                                                             heatbeats                            
                                                                             S2|T1 ends this round                
S0|T1 save persist| votedFor: 2|                                                                                  
logsLen: 1                                                                                                        
                                       S1|T1 save persist| votedFor: 2|                                           
                                       logsLen: 1                                                                 
S0|T1 appends logs from S2| logLen:                                                                               
1[AppendEntry]                                                                                                    
                                       S1|T1 appends logs from S2| logLen:                                        
                                       1[AppendEntry]                                                             
                                                                             S2|T1 replica entries to S1|         
                                                                             entrylen:0| matchidx:0| nextidx:1    
                                                                             S2|T1 replica entries to S0|         
                                                                             entrylen:0| matchidx:0| nextidx:1    
                                                                             S2|T1 save persist| votedFor: 2|     
                                                                             logsLen: 2                           
                                                                             S2|T1 receive commands | logLen:     
                                                                             2[Start]                             
S0|T1 is not leader                                                                                               
                                       S1|T1 is not leader                                                        
S0|T1 save persist| votedFor: 2|                                                                                  
logsLen: 2                                                                                                        
S0|T1 appends logs from S2| logLen:                                                                               
2[AppendEntry]                                                                                                    
                                       S1|T1 save persist| votedFor: 2|                                           
                                       logsLen: 2                                                                 
                                       S1|T1 appends logs from S2| logLen:                                        
                                       2[AppendEntry]                                                             
                                                                             S2|T1 replica entries to S0|         
                                                                             entrylen:1| matchidx:1| nextidx:2    
                                                                             S2|T1 update commitIndex as 1        
                                                                             S2|T1 starts to apply entries        
                                                                             [1:1][ApplyEntry]                    
                                                                             S2|T1 finishes applying entries      
                                                                             [1:1][ApplyEntry]                    
                                                                             S2|T1 replica entries to S1|         
                                                                             entrylen:1| matchidx:1| nextidx:2    
S0|T1 is not leader                                                                                               
                                       S1|T1 is not leader                                                        
                                       S1|T1 save persist| votedFor: 2|                                           
                                       logsLen: 2                                                                 
                                       S1|T1 appends logs from S2| logLen:                                        
                                       2[AppendEntry]                                                             
S0|T1 save persist| votedFor: 2|                                                                                  
logsLen: 2                                                                                                        
S0|T1 appends logs from S2| logLen:                                                                               
2[AppendEntry]                                                                                                    
                                       S1|T1 starts to apply entries                                              
                                       [1:1][ApplyEntry]                                                          
                                       S1|T1 finishes applying entries                                            
                                       [1:1][ApplyEntry]                                                          
S0|T1 starts to apply entries                                                                                     
[1:1][ApplyEntry]                                                                                                 
S0|T1 finishes applying entries                                                                                   
[1:1][ApplyEntry]                                                                                                 
                                                                             S2|T1 replica entries to S1|         
                                                                             entrylen:0| matchidx:1| nextidx:2    
                                                                             S2|T1 replica entries to S0|         
                                                                             entrylen:0| matchidx:1| nextidx:2    
S0|T1 is not leader                                                                                               
                                       S1|T1 is not leader                                                        
S0|T1 save persist| votedFor: 2|                                                                                  
logsLen: 2                                                                                                        
                                       S1|T1 save persist| votedFor: 2|                                           
                                       logsLen: 2                                                                 
                                       S1|T1 appends logs from S2| logLen:                                        
                                       2[AppendEntry]                                                             
S0|T1 appends logs from S2| logLen:                                                                               
2[AppendEntry]                                                                                                    
                                                                             S2|T1 replica entries to S1|         
                                                                             entrylen:0| matchidx:1| nextidx:2    
                                                                             S2|T1 replica entries to S0|         
                                                                             entrylen:0| matchidx:1| nextidx:2    
                                       S1|T1 is not leader                                                        
S0|T1 is not leader                                                                                               
                                       S1|T1 save persist| votedFor: 2|                                           
                                       logsLen: 2                                                                 
                                       S1|T1 appends logs from S2| logLen:                                        
                                       2[AppendEntry]                                                             
S0|T1 save persist| votedFor: 2|                                                                                  
logsLen: 2                                                                                                        
S0|T1 appends logs from S2| logLen:                                                                               
2[AppendEntry]                                                                                                    
                                                                             S2|T1 replica entries to S1|         
                                                                             entrylen:0| matchidx:1| nextidx:2    
                                                                             S2|T1 replica entries to S0|         
                                                                             entrylen:0| matchidx:1| nextidx:2    
S0|T1 is not leader                                                                                               
                                       S1|T1 is not leader                                                        
                                       S1|T1 save persist| votedFor: 2|                                           
                                       logsLen: 2                                                                 
                                       S1|T1 appends logs from S2| logLen:                                        
                                       2[AppendEntry]                                                             
S0|T1 save persist| votedFor: 2|                                                                                  
logsLen: 2                                                                                                        
S0|T1 appends logs from S2| logLen:                                                                               
2[AppendEntry]                                                                                                    
                                                                             S2|T1 replica entries to S1|         
                                                                             entrylen:0| matchidx:1| nextidx:2    
                                                                             S2|T1 replica entries to S0|         
                                                                             entrylen:0| matchidx:1| nextidx:2    
S0|T1 is not leader                                                                                               
                                       S1|T1 is not leader                                                        
                                       S1|T1 save persist| votedFor: 2|                                           
                                       logsLen: 2                                                                 
S0|T1 save persist| votedFor: 2|                                                                                  
logsLen: 2                                                                                                        
                                       S1|T1 appends logs from S2| logLen:                                        
                                       2[AppendEntry]                                                             
S0|T1 appends logs from S2| logLen:                                                                               
2[AppendEntry]                                                                                                    
                                                                             S2|T1 replica entries to S1|         
                                                                             entrylen:0| matchidx:1| nextidx:2    
                                                                             S2|T1 replica entries to S0|         
                                                                             entrylen:0| matchidx:1| nextidx:2    
                                       S1|T1 is not leader                                                        
S0|T1 is not leader                                                                                               
S0|T1 save persist| votedFor: 2|                                                                                  
logsLen: 2                                                                                                        
                                       S1|T1 save persist| votedFor: 2|                                           
                                       logsLen: 2                                                                 
                                       S1|T1 appends logs from S2| logLen:                                        
                                       2[AppendEntry]                                                             
S0|T1 appends logs from S2| logLen:                                                                               
2[AppendEntry]                                                                                                    
                                                                             S2|T1 replica entries to S1|         
                                                                             entrylen:0| matchidx:1| nextidx:2    
                                                                             S2|T1 replica entries to S0|         
                                                                             entrylen:0| matchidx:1| nextidx:2    
S0 is disconnected                                                                                                
                                                                             S2|T1 save persist| votedFor: 2|     
                                                                             logsLen: 3                           
                                                                             S2|T1 receive commands | logLen:     
                                                                             3[Start]                             
                                       S1|T1 is not leader                                                        
S0|T1 is not leader                                                                                               
                                       S1|T1 save persist| votedFor: 2|                                           
                                       logsLen: 3                                                                 
                                       S1|T1 appends logs from S2| logLen:                                        
                                       3[AppendEntry]                                                             
                                                                             S2|T1 replica entries to S1|         
                                                                             entrylen:1| matchidx:2| nextidx:3    
                                                                             S2|T1 update commitIndex as 2        
                                                                             S2|T1 starts to apply entries        
                                                                             [2:2][ApplyEntry]                    
                                                                             S2|T1 finishes applying entries      
                                                                             [2:2][ApplyEntry]                    
S0|T1 is not leader                                                                                               
                                       S1|T1 is not leader                                                        
                                       S1|T1 save persist| votedFor: 2|                                           
                                       logsLen: 3                                                                 
                                       S1|T1 appends logs from S2| logLen:                                        
                                       3[AppendEntry]                                                             
                                       S1|T1 starts to apply entries                                              
                                       [2:2][ApplyEntry]                                                          
                                       S1|T1 finishes applying entries                                            
                                       [2:2][ApplyEntry]                                                          
                                                                             S2|T1 replica entries to S1|         
                                                                             entrylen:0| matchidx:2| nextidx:3    
                                                                             S2|T1 save persist| votedFor: 2|     
                                                                             logsLen: 4                           
                                                                             S2|T1 receive commands | logLen:     
                                                                             4[Start]                             
                                                                             S2|T1 save persist| votedFor: 2|     
                                                                             logsLen: 5                           
                                                                             S2|T1 receive commands | logLen:     
                                                                             5[Start]                             
                                                                             S2|T1 save persist| votedFor: 2|     
                                                                             logsLen: 6                           
                                                                             S2|T1 receive commands | logLen:     
                                                                             6[Start]                             
                                                                             S2|T1 save persist| votedFor: 2|     
                                                                             logsLen: 7                           
                                                                             S2|T1 receive commands | logLen:     
                                                                             7[Start]                             
                                                                             S2|T1 save persist| votedFor: 2|     
                                                                             logsLen: 8                           
                                                                             S2|T1 receive commands | logLen:     
                                                                             8[Start]                             
                                                                             S2|T1 save persist| votedFor: 2|     
                                                                             logsLen: 9                           
                                                                             S2|T1 receive commands | logLen:     
                                                                             9[Start]                             
                                                                             S2|T1 save persist| votedFor: 2|     
                                                                             logsLen: 10                          
                                                                             S2|T1 receive commands | logLen:     
                                                                             10[Start]                            
                                                                             S2|T1 save persist| votedFor: 2|     
                                                                             logsLen: 11                          
                                                                             S2|T1 receive commands | logLen:     
                                                                             11[Start]                            
                                                                             S2|T1 save persist| votedFor: 2|     
                                                                             logsLen: 12                          
                                                                             S2|T1 receive commands | logLen:     
                                                                             12[Start]                            
                                                                             S2|T1 save persist| votedFor: 2|     
                                                                             logsLen: 13                          
                                                                             S2|T1 receive commands | logLen:     
                                                                             13[Start]                            
                                                                             S2|T1 save persist| votedFor: 2|     
                                                                             logsLen: 14                          
                                                                             S2|T1 receive commands | logLen:     
                                                                             14[Start]                            
                                                                             S2|T1 save persist| votedFor: 2|     
                                                                             logsLen: 15                          
                                                                             S2|T1 receive commands | logLen:     
                                                                             15[Start]                            
                                                                             S2|T1 save persist| votedFor: 2|     
                                                                             logsLen: 16                          
                                                                             S2|T1 receive commands | logLen:     
                                                                             16[Start]                            
                                                                             S2|T1 save persist| votedFor: 2|     
                                                                             logsLen: 17                          
                                                                             S2|T1 receive commands | logLen:     
                                                                             17[Start]                            
S0|T1 is not leader                                                                                               
                                       S1|T1 is not leader                                                        
                                       S1|T1 save persist| votedFor: 2|                                           
                                       logsLen: 17                                                                
                                       S1|T1 appends logs from S2| logLen:                                        
                                       17[AppendEntry]                                                            
                                                                             S2|T1 replica entries to S1|         
                                                                             entrylen:14| matchidx:16| nextidx:17 
                                                                             S2|T1 update commitIndex as 16       
                                                                             S2|T1 starts to apply entries        
                                                                             [3:16][ApplyEntry]                   
                                                                             S2|T1 Snapshot until index 9| logLen:
                                                                             17                                   
                                                                             S2|T1 finishes applying entries      
                                                                             [3:16][ApplyEntry]                   
                                       S1|T1 is not leader                                                        
                                                                             S2|T1 send rpc to S0|base: 9| next: 2
S0|T1 is not leader                                                                                               
                                       S1|T1 save persist| votedFor: 2|                                           
                                       logsLen: 17                                                                
                                       S1|T1 appends logs from S2| logLen:                                        
                                       17[AppendEntry]                                                            
                                       S1|T1 starts to apply entries                                              
                                       [3:16][ApplyEntry]                                                         
                                                                             S2|T1 replica entries to S1|         
                                                                             entrylen:0| matchidx:16| nextidx:17  
                                       S1|T1 Snapshot until index 9| logLen:                                      
                                       17                                                                         
                                       S1|T1 finishes applying entries                                            
                                       [3:16][ApplyEntry]                                                         
S0 is connected again                                                                                             
                                                                             S2|T1 save persist| votedFor: 2|     
                                                                             logsLen: 18                          
                                                                             S2|T1 receive commands | logLen:     
                                                                             18[Start]                            
                                       S1|T1 is not leader                                                        
S0|T1 is not leader                                                                                               
                                                                             S2|T1 send rpc to S0|base: 9| next: 2
S0|T1 receive rpc from S2                                                                                         
S0|T1 update rfstate| Base:9|                                                                                     
LogLen:10                                                                                                         
                                       S1|T1 save persist| votedFor: 2|                                           
                                       logsLen: 18                                                                
S0|T1 applys snapshot from S2                                                                                     
                                       S1|T1 appends logs from S2| logLen:                                        
                                       18[AppendEntry]                                                            
                                                                             S2|T1 installs snapshot to S0|       
                                                                             nextId:10| matchId:9                 
                                                                             S2|T1 replica entries to S1|         
                                                                             entrylen:1| matchidx:17| nextidx:18  
                                                                             S2|T1 update commitIndex as 17       
                                                                             S2|T1 starts to apply entries        
                                                                             [17:17][ApplyEntry]                  
                                                                             S2|T1 finishes applying entries      
                                                                             [17:17][ApplyEntry]                  
S0|T1 is not leader                                                                                               
                                       S1|T1 is not leader                                                        
                                       S1|T1 save persist| votedFor: 2|                                           
                                       logsLen: 18                                                                
                                       S1|T1 appends logs from S2| logLen:                                        
                                       18[AppendEntry]                                                            
S0|T1 save persist| votedFor: 2|                                                                                  
logsLen: 18                                                                                                       
                                       S1|T1 starts to apply entries                                              
                                       [17:17][ApplyEntry]                                                        
S0|T1 appends logs from S2| logLen:                                                                               
18[AppendEntry]                                                                                                   
                                       S1|T1 finishes applying entries                                            
                                       [17:17][ApplyEntry]                                                        
S0|T1 starts to apply entries                                                                                     
[10:17][ApplyEntry]                                                                                               
S0|T1 finishes applying entries                                                                                   
[10:17][ApplyEntry]                                                                                               
                                                                             S2|T1 replica entries to S1|         
                                                                             entrylen:0| matchidx:17| nextidx:18  
                                                                             S2|T1 replica entries to S0|         
                                                                             entrylen:8| matchidx:17| nextidx:18  
S0|T1 is not leader                                                                                               
                                       S1|T1 is not leader                                                        
S0|T1 save persist| votedFor: 2|                                                                                  
logsLen: 18                                                                                                       
                                       S1|T1 save persist| votedFor: 2|                                           
                                       logsLen: 18                                                                
                                       S1|T1 appends logs from S2| logLen:                                        
                                       18[AppendEntry]                                                            
S0|T1 appends logs from S2| logLen:                                                                               
18[AppendEntry]                                                                                                   
                                                                             S2|T1 replica entries to S0|         
                                                                             entrylen:0| matchidx:17| nextidx:18  
                                                                             S2|T1 replica entries to S1|         
                                                                             entrylen:0| matchidx:17| nextidx:18  
S0|T1 is not leader                                                                                               
                                       S1|T1 is not leader                                                        
S0|T1 save persist| votedFor: 2|                                                                                  
logsLen: 18                                                                                                       
                                       S1|T1 save persist| votedFor: 2|                                           
                                       logsLen: 18                                                                
                                       S1|T1 appends logs from S2| logLen:                                        
                                       18[AppendEntry]                                                            
S0|T1 appends logs from S2| logLen:                                                                               
18[AppendEntry]                                                                                                   
                                                                             S2|T1 replica entries to S0|         
                                                                             entrylen:0| matchidx:17| nextidx:18  
                                                                             S2|T1 replica entries to S1|         
                                                                             entrylen:0| matchidx:17| nextidx:18  
                                       S1|T1 is not leader                                                        
S0|T1 is not leader                                                                                               
S0|T1 save persist| votedFor: 2|                                                                                  
logsLen: 18                                                                                                       
                                       S1|T1 save persist| votedFor: 2|                                           
                                       logsLen: 18                                                                
                                       S1|T1 appends logs from S2| logLen:                                        
                                       18[AppendEntry]                                                            
S0|T1 appends logs from S2| logLen:                                                                               
18[AppendEntry]                                                                                                   
                                                                             S2|T1 replica entries to S1|         
                                                                             entrylen:0| matchidx:17| nextidx:18  
                                                                             S2|T1 replica entries to S0|         
                                                                             entrylen:0| matchidx:17| nextidx:18  
                                       S1|T1 is not leader                                                        
S0|T1 is not leader                                                                                               
                                       S1|T1 save persist| votedFor: 2|                                           
                                       logsLen: 18                                                                
                                       S1|T1 appends logs from S2| logLen:                                        
                                       18[AppendEntry]                                                            
S0|T1 save persist| votedFor: 2|                                                                                  
logsLen: 18                                                                                                       
S0|T1 appends logs from S2| logLen:                                                                               
18[AppendEntry]                                                                                                   
                                                                             S2|T1 replica entries to S0|         
                                                                             entrylen:0| matchidx:17| nextidx:18  
                                                                             S2|T1 replica entries to S1|         
                                                                             entrylen:0| matchidx:17| nextidx:18  
                                                                             S2 is disconnected                   
S0|T1 is not leader                                                                                               
                                       S1|T1 is not leader                                                        
                                       S1|T1 is not leader                                                        
S0|T1 is not leader                                                                                               
                                       S1|T1 is not leader                                                        
S0|T1 is not leader                                                                                               
                                       S1|T1 is not leader                                                        
S0|T1 is not leader                                                                                               
                                                                             S2|T1 fails to install snapshot to S0
S0|T1 is not leader                                                                                               
                                       S1|T1 is not leader                                                        
S0|T1 is not leader                                                                                               
                                       S1|T1 is not leader                                                        
                                       S1|T2 starts to join election                                              
                                       S1|T2 save persist| votedFor: 1|                                           
                                       logsLen: 18                                                                
S0|T2 save persist| votedFor: -1|                                                                                 
logsLen: 18                                                                                                       
S0|T2 save persist| votedFor: 1|                                                                                  
logsLen: 18                                                                                                       
S0|T2 votes for S1[RequestVote]                                                                                   
                                       S1|T2 becomes the leader, and starts                                       
                                       heatbeats                                                                  
S0|T2 save persist| votedFor: 1|                                                                                  
logsLen: 18                                                                                                       
S0|T2 appends logs from S1| logLen:                                                                               
18[AppendEntry]                                                                                                   
                                       S1|T2 replica entries to S0|                                               
                                       entrylen:0| matchidx:17| nextidx:18                                        
                                       S1|T2 save persist| votedFor: 1|                                           
                                       logsLen: 19                                                                
                                       S1|T2 receive commands | logLen:                                           
                                       19[Start]                                                                  
S0|T2 is not leader                                                                                               
S0|T2 save persist| votedFor: 1|                                                                                  
logsLen: 19                                                                                                       
S0|T2 appends logs from S1| logLen:                                                                               
19[AppendEntry]                                                                                                   
                                       S1|T2 replica entries to S0|                                               
                                       entrylen:1| matchidx:18| nextidx:19                                        
                                       S1|T2 update commitIndex as 18                                             
                                       S1|T2 starts to apply entries                                              
                                       [18:18][ApplyEntry]                                                        
                                       S1|T2 finishes applying entries                                            
                                       [18:18][ApplyEntry]                                                        
S0|T2 is not leader                                                                                               
S0|T2 save persist| votedFor: 1|                                                                                  
logsLen: 19                                                                                                       
S0|T2 appends logs from S1| logLen:                                                                               
19[AppendEntry]                                                                                                   
S0|T2 starts to apply entries                                                                                     
[18:18][ApplyEntry]                                                                                               
S0|T2 finishes applying entries                                                                                   
[18:18][ApplyEntry]                                                                                               
                                       S1|T2 replica entries to S0|                                               
                                       entrylen:0| matchidx:18| nextidx:19                                        
                                       S1|T2 save persist| votedFor: 1|                                           
                                       logsLen: 20                                                                
                                       S1|T2 receive commands | logLen:                                           
                                       20[Start]                                                                  
S0|T2 is not leader                                                                                               
S0|T2 save persist| votedFor: 1|                                                                                  
logsLen: 20                                                                                                       
S0|T2 appends logs from S1| logLen:                                                                               
20[AppendEntry]                                                                                                   
                                       S1|T2 replica entries to S0|                                               
                                       entrylen:1| matchidx:19| nextidx:20                                        
                                       S1|T2 update commitIndex as 19                                             
                                       S1|T2 starts to apply entries                                              
                                       [19:19][ApplyEntry]                                                        
                                       S1|T2 finishes applying entries                                            
                                       [19:19][ApplyEntry]                                                        
                                       S1|T2 Snapshot until index 19|                                             
                                       logLen: 20                                                                 
S0|T2 is not leader                                                                                               
                                       S1|T2 send rpc to S2|base: 19| next:                                       
                                       18                                                                         
S0|T2 save persist| votedFor: 1|                                                                                  
logsLen: 20                                                                                                       
S0|T2 appends logs from S1| logLen:                                                                               
20[AppendEntry]                                                                                                   
S0|T2 starts to apply entries                                                                                     
[19:19][ApplyEntry]                                                                                               
S0|T2 finishes applying entries                                                                                   
[19:19][ApplyEntry]                                                                                               
                                       S1|T2 replica entries to S0|                                               
                                       entrylen:0| matchidx:19| nextidx:20                                        
S0|T2 Snapshot until index 19| logLen:                                                                            
20                                                                                                                
                                                                             S2 is connected again                
                                       S1|T2 save persist| votedFor: 1|                                           
                                       logsLen: 21                                                                
                                       S1|T2 receive commands | logLen:                                           
                                       21[Start]                                                                  
S0|T2 is not leader                                                                                               
                                       S1|T2 send rpc to S2|base: 19| next:                                       
                                       18                                                                         
                                                                             S2|T1 receive rpc from S1            
                                       S1|T2 rejects to append entries from                                       
                                       S2 | out of date term[AppendEntry]                                         
S0|T2 save persist| votedFor: 1|                                                                                  
logsLen: 21                                                                                                       
S0|T2 appends logs from S1| logLen:                                                                               
21[AppendEntry]                                                                                                   
S0|T2 rejects to append entries from                                                                              
S2 | out of date term[AppendEntry]                                                                                
                                                                             S2|T2 save persist| votedFor: 2|     
                                                                             logsLen: 18                          
                                                                             S2|T2 update rfstate| Base:19|       
                                                                             LogLen:20                            
                                       S1|T2 replica entries to S0|                                               
                                       entrylen:1| matchidx:20| nextidx:21                                        
                                                                             S2|T2 lost leadership, state: 0      
                                       S1|T2 update commitIndex as 20                                             
                                                                             S2|T2 applys snapshot from S1        
                                       S1|T2 starts to apply entries                                              
                                       [20:20][ApplyEntry]                                                        
                                                                             S2|T2 lost leadership, state: 0      
                                       S1|T2 finishes applying entries                                            
                                       [20:20][ApplyEntry]                                                        
                                       S1|T2 installs snapshot to S2|                                             
                                       nextId:20| matchId:19                                                      
                                                                             S2|T2 is not leader                  
S0|T2 is not leader                                                                                               
S0|T2 save persist| votedFor: 1|                                                                                  
logsLen: 21                                                                                                       
                                                                             S2|T2 save persist| votedFor: 2|     
                                                                             logsLen: 21                          
                                                                             S2|T2 appends logs from S1| logLen:  
                                                                             21[AppendEntry]                      
S0|T2 appends logs from S1| logLen:                                                                               
21[AppendEntry]                                                                                                   
                                                                             S2|T2 starts to apply entries        
                                                                             [20:20][ApplyEntry]                  
S0|T2 starts to apply entries                                                                                     
[20:20][ApplyEntry]                                                                                               
S0|T2 finishes applying entries                                                                                   
[20:20][ApplyEntry]                                                                                               
                                                                             S2|T2 finishes applying entries      
                                                                             [20:20][ApplyEntry]                  
                                       S1|T2 replica entries to S2|                                               
                                       entrylen:1| matchidx:20| nextidx:21                                        
                                       S1|T2 replica entries to S0|                                               
                                       entrylen:0| matchidx:20| nextidx:21                                        
S0|T2 is not leader                                                                                               
                                                                             S2|T2 is not leader                  
                                                                             S2|T2 save persist| votedFor: 2|     
                                                                             logsLen: 21                          
                                                                             S2|T2 appends logs from S1| logLen:  
                                                                             21[AppendEntry]                      
S0|T2 save persist| votedFor: 1|                                                                                  
logsLen: 21                                                                                                       
S0|T2 appends logs from S1| logLen:                                                                               
21[AppendEntry]                                                                                                   
                                       S1|T2 replica entries to S2|                                               
                                       entrylen:0| matchidx:20| nextidx:21                                        
                                       S1|T2 replica entries to S0|                                               
                                       entrylen:0| matchidx:20| nextidx:21                                        
S0|T2 is not leader                                                                                               
                                                                             S2|T2 is not leader                  
S0|T2 save persist| votedFor: 1|                                                                                  
logsLen: 21                                                                                                       
                                                                             S2|T2 save persist| votedFor: 2|     
                                                                             logsLen: 21                          
S0|T2 appends logs from S1| logLen:                                                                               
21[AppendEntry]                                                                                                   
                                                                             S2|T2 appends logs from S1| logLen:  
                                                                             21[AppendEntry]                      
                                       S1|T2 replica entries to S2|                                               
                                       entrylen:0| matchidx:20| nextidx:21                                        
                                       S1|T2 replica entries to S0|                                               
                                       entrylen:0| matchidx:20| nextidx:21                                        
S0|T2 is not leader                                                                                               
                                                                             S2|T2 is not leader                  
                                                                             S2|T2 save persist| votedFor: 2|     
                                                                             logsLen: 21                          
                                                                             S2|T2 appends logs from S1| logLen:  
                                                                             21[AppendEntry]                      
S0|T2 save persist| votedFor: 1|                                                                                  
logsLen: 21                                                                                                       
S0|T2 appends logs from S1| logLen:                                                                               
21[AppendEntry]                                                                                                   
                                       S1|T2 replica entries to S2|                                               
                                       entrylen:0| matchidx:20| nextidx:21                                        
                                       S1|T2 replica entries to S0|                                               
                                       entrylen:0| matchidx:20| nextidx:21                                        
                                                                             S2|T2 is not leader                  
S0|T2 is not leader                                                                                               
                                                                             S2|T2 save persist| votedFor: 2|     
                                                                             logsLen: 21                          
                                                                             S2|T2 appends logs from S1| logLen:  
                                                                             21[AppendEntry]                      
S0|T2 save persist| votedFor: 1|                                                                                  
logsLen: 21                                                                                                       
S0|T2 appends logs from S1| logLen:                                                                               
21[AppendEntry]                                                                                                   
                                       S1|T2 replica entries to S2|                                               
                                       entrylen:0| matchidx:20| nextidx:21                                        
                                       S1|T2 replica entries to S0|                                               
                                       entrylen:0| matchidx:20| nextidx:21                                        
                                                                             S2 is disconnected                   
                                       S1|T2 save persist| votedFor: 1|                                           
                                       logsLen: 22                                                                
                                       S1|T2 receive commands | logLen:                                           
                                       22[Start]                                                                  
                                                                             S2|T2 is not leader                  
S0|T2 is not leader                                                                                               
S0|T2 save persist| votedFor: 1|                                                                                  
logsLen: 22                                                                                                       
S0|T2 appends logs from S1| logLen:                                                                               
22[AppendEntry]                                                                                                   
                                       S1|T2 replica entries to S0|                                               
                                       entrylen:1| matchidx:21| nextidx:22                                        
                                       S1|T2 update commitIndex as 21                                             
                                       S1|T2 starts to apply entries                                              
                                       [21:21][ApplyEntry]                                                        
                                       S1|T2 finishes applying entries                                            
                                       [21:21][ApplyEntry]                                                        
S0|T2 is not leader                                                                                               
                                                                             S2|T2 is not leader                  
S0|T2 save persist| votedFor: 1|                                                                                  
logsLen: 22                                                                                                       
S0|T2 appends logs from S1| logLen:                                                                               
22[AppendEntry]                                                                                                   
S0|T2 starts to apply entries                                                                                     
[21:21][ApplyEntry]                                                                                               
S0|T2 finishes applying entries                                                                                   
[21:21][ApplyEntry]                                                                                               
                                       S1|T2 replica entries to S0|                                               
                                       entrylen:0| matchidx:21| nextidx:22                                        
                                       S1|T2 save persist| votedFor: 1|                                           
                                       logsLen: 23                                                                
                                       S1|T2 receive commands | logLen:                                           
                                       23[Start]                                                                  
                                       S1|T2 save persist| votedFor: 1|                                           
                                       logsLen: 24                                                                
                                       S1|T2 receive commands | logLen:                                           
                                       24[Start]                                                                  
                                       S1|T2 save persist| votedFor: 1|                                           
                                       logsLen: 25                                                                
                                       S1|T2 receive commands | logLen:                                           
                                       25[Start]                                                                  
                                       S1|T2 save persist| votedFor: 1|                                           
                                       logsLen: 26                                                                
                                       S1|T2 receive commands | logLen:                                           
                                       26[Start]                                                                  
                                       S1|T2 save persist| votedFor: 1|                                           
                                       logsLen: 27                                                                
                                       S1|T2 receive commands | logLen:                                           
                                       27[Start]                                                                  
                                       S1|T2 save persist| votedFor: 1|                                           
                                       logsLen: 28                                                                
                                       S1|T2 receive commands | logLen:                                           
                                       28[Start]                                                                  
                                       S1|T2 save persist| votedFor: 1|                                           
                                       logsLen: 29                                                                
                                       S1|T2 receive commands | logLen:                                           
                                       29[Start]                                                                  
                                       S1|T2 save persist| votedFor: 1|                                           
                                       logsLen: 30                                                                
                                       S1|T2 receive commands | logLen:                                           
                                       30[Start]                                                                  
                                       S1|T2 save persist| votedFor: 1|                                           
                                       logsLen: 31                                                                
                                       S1|T2 receive commands | logLen:                                           
                                       31[Start]                                                                  
                                       S1|T2 save persist| votedFor: 1|                                           
                                       logsLen: 32                                                                
                                       S1|T2 receive commands | logLen:                                           
                                       32[Start]                                                                  
                                       S1|T2 save persist| votedFor: 1|                                           
                                       logsLen: 33                                                                
                                       S1|T2 receive commands | logLen:                                           
                                       33[Start]                                                                  
S0|T2 is not leader                                                                                               
                                                                             S2|T2 is not leader                  
S0|T2 save persist| votedFor: 1|                                                                                  
logsLen: 33                                                                                                       
S0|T2 appends logs from S1| logLen:                                                                               
33[AppendEntry]                                                                                                   
                                       S1|T2 replica entries to S0|                                               
                                       entrylen:11| matchidx:32| nextidx:33                                       
                                       S1|T2 update commitIndex as 32                                             
                                       S1|T2 starts to apply entries                                              
                                       [22:32][ApplyEntry]                                                        
                                       S1|T2 Snapshot until index 29|                                             
                                       logLen: 33                                                                 
                                       S1|T2 finishes applying entries                                            
                                       [22:32][ApplyEntry]                                                        
                                                                             S2|T2 is not leader                  
S0|T2 is not leader                                                                                               
                                       S1|T2 send rpc to S2|base: 29| next:                                       
                                       21                                                                         
S0|T2 save persist| votedFor: 1|                                                                                  
logsLen: 33                                                                                                       
S0|T2 appends logs from S1| logLen:                                                                               
33[AppendEntry]                                                                                                   
S0|T2 starts to apply entries                                                                                     
[22:32][ApplyEntry]                                                                                               
                                       S1|T2 replica entries to S0|                                               
                                       entrylen:0| matchidx:32| nextidx:33                                        
S0|T2 Snapshot until index 29| logLen:                                                                            
33                                                                                                                
S0|T2 finishes applying entries                                                                                   
[22:32][ApplyEntry]                                                                                               
                                                                             S2 is connected again                
                                       S1|T2 save persist| votedFor: 1|                                           
                                       logsLen: 34                                                                
                                       S1|T2 receive commands | logLen:                                           
                                       34[Start]                                                                  
                                                                             S2|T2 is not leader                  
S0|T2 is not leader                                                                                               
                                       S1|T2 send rpc to S2|base: 29| next:                                       
                                       21                                                                         
                                                                             S2|T2 receive rpc from S1            
                                                                             S2|T2 update rfstate| Base:29|       
                                                                             LogLen:30                            
                                                                             S2|T2 applys snapshot from S1        
S0|T2 save persist| votedFor: 1|                                                                                  
logsLen: 34                                                                                                       
S0|T2 appends logs from S1| logLen:                                                                               
34[AppendEntry]                                                                                                   
                                       S1|T2 installs snapshot to S2|                                             
                                       nextId:30| matchId:29                                                      
                                       S1|T2 replica entries to S0|                                               
                                       entrylen:1| matchidx:33| nextidx:34                                        
                                       S1|T2 update commitIndex as 33                                             
                                       S1|T2 starts to apply entries                                              
                                       [33:33][ApplyEntry]                                                        
                                       S1|T2 finishes applying entries                                            
                                       [33:33][ApplyEntry]                                                        
S0|T2 is not leader                                                                                               
                                                                             S2|T2 is not leader                  
S0|T2 save persist| votedFor: 1|                                                                                  
logsLen: 34                                                                                                       
S0|T2 appends logs from S1| logLen:                                                                               
34[AppendEntry]                                                                                                   
                                                                             S2|T2 save persist| votedFor: 2|     
                                                                             logsLen: 34                          
                                                                             S2|T2 appends logs from S1| logLen:  
                                                                             34[AppendEntry]                      
S0|T2 starts to apply entries                                                                                     
[33:33][ApplyEntry]                                                                                               
S0|T2 finishes applying entries                                                                                   
[33:33][ApplyEntry]                                                                                               
                                                                             S2|T2 starts to apply entries        
                                                                             [30:33][ApplyEntry]                  
                                                                             S2|T2 finishes applying entries      
                                                                             [30:33][ApplyEntry]                  
                                       S1|T2 replica entries to S0|                                               
                                       entrylen:0| matchidx:33| nextidx:34                                        
                                       S1|T2 replica entries to S2|                                               
                                       entrylen:4| matchidx:33| nextidx:34                                        
S0|T2 is not leader                                                                                               
                                                                             S2|T2 is not leader                  
                                                                             S2|T2 save persist| votedFor: 2|     
                                                                             logsLen: 34                          
                                                                             S2|T2 appends logs from S1| logLen:  
                                                                             34[AppendEntry]                      
S0|T2 save persist| votedFor: 1|                                                                                  
logsLen: 34                                                                                                       
S0|T2 appends logs from S1| logLen:                                                                               
34[AppendEntry]                                                                                                   
                                       S1|T2 replica entries to S2|                                               
                                       entrylen:0| matchidx:33| nextidx:34                                        
                                       S1|T2 replica entries to S0|                                               
                                       entrylen:0| matchidx:33| nextidx:34                                        
                                                                             S2|T2 is not leader                  
S0|T2 is not leader                                                                                               
                                                                             S2|T2 save persist| votedFor: 2|     
                                                                             logsLen: 34                          
S0|T2 save persist| votedFor: 1|                                                                                  
logsLen: 34                                                                                                       
                                                                             S2|T2 appends logs from S1| logLen:  
                                                                             34[AppendEntry]                      
S0|T2 appends logs from S1| logLen:                                                                               
34[AppendEntry]                                                                                                   
                                       S1|T2 replica entries to S2|                                               
                                       entrylen:0| matchidx:33| nextidx:34                                        
                                       S1|T2 replica entries to S0|                                               
                                       entrylen:0| matchidx:33| nextidx:34                                        
S0|T2 is not leader                                                                                               
                                                                             S2|T2 is not leader                  
S0|T2 save persist| votedFor: 1|                                                                                  
logsLen: 34                                                                                                       
S0|T2 appends logs from S1| logLen:                                                                               
34[AppendEntry]                                                                                                   
                                                                             S2|T2 save persist| votedFor: 2|     
                                                                             logsLen: 34                          
                                                                             S2|T2 appends logs from S1| logLen:  
                                                                             34[AppendEntry]                      
                                       S1|T2 replica entries to S2|                                               
                                       entrylen:0| matchidx:33| nextidx:34                                        
                                       S1|T2 replica entries to S0|                                               
                                       entrylen:0| matchidx:33| nextidx:34                                        
                                                                             S2|T2 is not leader                  
S0|T2 is not leader                                                                                               
S0|T2 save persist| votedFor: 1|                                                                                  
logsLen: 34                                                                                                       
                                                                             S2|T2 save persist| votedFor: 2|     
                                                                             logsLen: 34                          
S0|T2 appends logs from S1| logLen:                                                                               
34[AppendEntry]                                                                                                   
                                                                             S2|T2 appends logs from S1| logLen:  
                                                                             34[AppendEntry]                      
                                       S1|T2 replica entries to S0|                                               
                                       entrylen:0| matchidx:33| nextidx:34                                        
                                       S1|T2 replica entries to S2|                                               
                                       entrylen:0| matchidx:33| nextidx:34                                        
                                                                             S2|T2 is not leader                  
S0|T2 is not leader                                                                                               
S0|T2 save persist| votedFor: 1|                                                                                  
logsLen: 34                                                                                                       
S0|T2 appends logs from S1| logLen:                                                                               
34[AppendEntry]                                                                                                   
                                                                             S2|T2 save persist| votedFor: 2|     
                                                                             logsLen: 34                          
                                                                             S2|T2 appends logs from S1| logLen:  
                                                                             34[AppendEntry]                      
                                       S1|T2 replica entries to S0|                                               
                                       entrylen:0| matchidx:33| nextidx:34                                        
                                       S1|T2 replica entries to S2|                                               
                                       entrylen:0| matchidx:33| nextidx:34                                        
                                                                             S2 is disconnected                   
                                       S1|T2 save persist| votedFor: 1|                                           
                                       logsLen: 35                                                                
                                       S1|T2 receive commands | logLen:                                           
                                       35[Start]                                                                  
S0|T2 is not leader                                                                                               
                                                                             S2|T2 is not leader                  
S0|T2 save persist| votedFor: 1|                                                                                  
logsLen: 35                                                                                                       
S0|T2 appends logs from S1| logLen:                                                                               
35[AppendEntry]                                                                                                   
                                       S1|T2 replica entries to S0|                                               
                                       entrylen:1| matchidx:34| nextidx:35                                        
                                       S1|T2 update commitIndex as 34                                             
                                       S1|T2 starts to apply entries                                              
                                       [34:34][ApplyEntry]                                                        
                                       S1|T2 finishes applying entries                                            
                                       [34:34][ApplyEntry]                                                        
S0|T2 is not leader                                                                                               
                                                                             S2|T2 is not leader                  
S0|T2 save persist| votedFor: 1|                                                                                  
logsLen: 35                                                                                                       
S0|T2 appends logs from S1| logLen:                                                                               
35[AppendEntry]                                                                                                   
S0|T2 starts to apply entries                                                                                     
[34:34][ApplyEntry]                                                                                               
S0|T2 finishes applying entries                                                                                   
[34:34][ApplyEntry]                                                                                               
                                       S1|T2 replica entries to S0|                                               
                                       entrylen:0| matchidx:34| nextidx:35                                        
                                       S1|T2 save persist| votedFor: 1|                                           
                                       logsLen: 36                                                                
                                       S1|T2 receive commands | logLen:                                           
                                       36[Start]                                                                  
                                       S1|T2 save persist| votedFor: 1|                                           
                                       logsLen: 37                                                                
                                       S1|T2 receive commands | logLen:                                           
                                       37[Start]                                                                  
                                       S1|T2 save persist| votedFor: 1|                                           
                                       logsLen: 38                                                                
                                       S1|T2 receive commands | logLen:                                           
                                       38[Start]                                                                  
                                       S1|T2 save persist| votedFor: 1|                                           
                                       logsLen: 39                                                                
                                       S1|T2 receive commands | logLen:                                           
                                       39[Start]                                                                  
                                       S1|T2 save persist| votedFor: 1|                                           
                                       logsLen: 40                                                                
                                       S1|T2 receive commands | logLen:                                           
                                       40[Start]                                                                  
                                       S1|T2 save persist| votedFor: 1|                                           
                                       logsLen: 41                                                                
                                       S1|T2 receive commands | logLen:                                           
                                       41[Start]                                                                  
                                       S1|T2 save persist| votedFor: 1|                                           
                                       logsLen: 42                                                                
                                       S1|T2 receive commands | logLen:                                           
                                       42[Start]                                                                  
                                       S1|T2 save persist| votedFor: 1|                                           
                                       logsLen: 43                                                                
                                       S1|T2 receive commands | logLen:                                           
                                       43[Start]                                                                  
                                       S1|T2 save persist| votedFor: 1|                                           
                                       logsLen: 44                                                                
                                       S1|T2 receive commands | logLen:                                           
                                       44[Start]                                                                  
                                       S1|T2 save persist| votedFor: 1|                                           
                                       logsLen: 45                                                                
                                       S1|T2 receive commands | logLen:                                           
                                       45[Start]                                                                  
                                                                             S2|T2 is not leader                  
S0|T2 is not leader                                                                                               
S0|T2 save persist| votedFor: 1|                                                                                  
logsLen: 45                                                                                                       
S0|T2 appends logs from S1| logLen:                                                                               
45[AppendEntry]                                                                                                   
                                       S1|T2 replica entries to S0|                                               
                                       entrylen:10| matchidx:44| nextidx:45                                       
                                       S1|T2 update commitIndex as 44                                             
                                       S1|T2 starts to apply entries                                              
                                       [35:44][ApplyEntry]                                                        
                                       S1|T2 Snapshot until index 39|                                             
                                       logLen: 45                                                                 
                                       S1|T2 finishes applying entries                                            
                                       [35:44][ApplyEntry]                                                        
S0|T2 is not leader                                                                                               
                                                                             S2|T2 is not leader                  
                                       S1|T2 send rpc to S2|base: 39| next:                                       
                                       34                                                                         
S0|T2 save persist| votedFor: 1|                                                                                  
logsLen: 45                                                                                                       
S0|T2 appends logs from S1| logLen:                                                                               
45[AppendEntry]                                                                                                   
S0|T2 starts to apply entries                                                                                     
[35:44][ApplyEntry]                                                                                               
                                       S1|T2 replica entries to S0|                                               
                                       entrylen:0| matchidx:44| nextidx:45                                        
S0|T2 Snapshot until index 39| logLen:                                                                            
45                                                                                                                
S0|T2 finishes applying entries                                                                                   
[35:44][ApplyEntry]                                                                                               
                                                                             S2 is connected again                
                                       S1|T2 save persist| votedFor: 1|                                           
                                       logsLen: 46                                                                
                                       S1|T2 receive commands | logLen:                                           
                                       46[Start]                                                                  
                                                                             S2|T2 is not leader                  
S0|T2 is not leader                                                                                               
                                       S1|T2 send rpc to S2|base: 39| next:                                       
                                       34                                                                         
                                                                             S2|T2 receive rpc from S1            
                                                                             S2|T2 update rfstate| Base:39|       
                                                                             LogLen:40                            
S0|T2 save persist| votedFor: 1|                                                                                  
logsLen: 46                                                                                                       
                                                                             S2|T2 applys snapshot from S1        
S0|T2 appends logs from S1| logLen:                                                                               
46[AppendEntry]                                                                                                   
                                       S1|T2 installs snapshot to S2|                                             
                                       nextId:40| matchId:39                                                      
                                       S1|T2 replica entries to S0|                                               
                                       entrylen:1| matchidx:45| nextidx:46                                        
                                       S1|T2 update commitIndex as 45                                             
                                       S1|T2 starts to apply entries                                              
                                       [45:45][ApplyEntry]                                                        
                                       S1|T2 finishes applying entries                                            
                                       [45:45][ApplyEntry]                                                        
                                                                             S2|T2 is not leader                  
S0|T2 is not leader                                                                                               
S0|T2 save persist| votedFor: 1|                                                                                  
logsLen: 46                                                                                                       
S0|T2 appends logs from S1| logLen:                                                                               
46[AppendEntry]                                                                                                   
                                                                             S2|T2 save persist| votedFor: 2|     
                                                                             logsLen: 46                          
S0|T2 starts to apply entries                                                                                     
[45:45][ApplyEntry]                                                                                               
                                                                             S2|T2 appends logs from S1| logLen:  
                                                                             46[AppendEntry]                      
S0|T2 finishes applying entries                                                                                   
[45:45][ApplyEntry]                                                                                               
                                                                             S2|T2 starts to apply entries        
                                                                             [40:45][ApplyEntry]                  
                                                                             S2|T2 finishes applying entries      
                                                                             [40:45][ApplyEntry]                  
                                       S1|T2 replica entries to S0|                                               
                                       entrylen:0| matchidx:45| nextidx:46                                        
                                       S1|T2 replica entries to S2|                                               
                                       entrylen:6| matchidx:45| nextidx:46                                        
                                                                             S2|T2 is not leader                  
S0|T2 is not leader                                                                                               
S0|T2 save persist| votedFor: 1|                                                                                  
logsLen: 46                                                                                                       
S0|T2 appends logs from S1| logLen:                                                                               
46[AppendEntry]                                                                                                   
                                                                             S2|T2 save persist| votedFor: 2|     
                                                                             logsLen: 46                          
                                                                             S2|T2 appends logs from S1| logLen:  
                                                                             46[AppendEntry]                      
                                       S1|T2 replica entries to S0|                                               
                                       entrylen:0| matchidx:45| nextidx:46                                        
                                       S1|T2 replica entries to S2|                                               
                                       entrylen:0| matchidx:45| nextidx:46                                        
                                                                             S2|T2 is not leader                  
S0|T2 is not leader                                                                                               
S0|T2 save persist| votedFor: 1|                                                                                  
logsLen: 46                                                                                                       
S0|T2 appends logs from S1| logLen:                                                                               
46[AppendEntry]                                                                                                   
                                                                             S2|T2 save persist| votedFor: 2|     
                                                                             logsLen: 46                          
                                                                             S2|T2 appends logs from S1| logLen:  
                                                                             46[AppendEntry]                      
                                       S1|T2 replica entries to S0|                                               
                                       entrylen:0| matchidx:45| nextidx:46                                        
                                       S1|T2 replica entries to S2|                                               
                                       entrylen:0| matchidx:45| nextidx:46                                        
                                                                             S2|T2 is not leader                  
S0|T2 is not leader                                                                                               
                                                                             S2|T2 save persist| votedFor: 2|     
                                                                             logsLen: 46                          
S0|T2 save persist| votedFor: 1|                                                                                  
logsLen: 46                                                                                                       
                                                                             S2|T2 appends logs from S1| logLen:  
                                                                             46[AppendEntry]                      
S0|T2 appends logs from S1| logLen:                                                                               
46[AppendEntry]                                                                                                   
                                       S1|T2 replica entries to S2|                                               
                                       entrylen:0| matchidx:45| nextidx:46                                        
                                       S1|T2 replica entries to S0|                                               
                                       entrylen:0| matchidx:45| nextidx:46                                        
                                                                             S2|T2 is not leader                  
S0|T2 is not leader                                                                                               
S0|T2 save persist| votedFor: 1|                                                                                  
logsLen: 46                                                                                                       
                                                                             S2|T2 save persist| votedFor: 2|     
                                                                             logsLen: 46                          
S0|T2 appends logs from S1| logLen:                                                                               
46[AppendEntry]                                                                                                   
                                                                             S2|T2 appends logs from S1| logLen:  
                                                                             46[AppendEntry]                      
                                       S1|T2 replica entries to S2|                                               
                                       entrylen:0| matchidx:45| nextidx:46                                        
                                       S1|T2 replica entries to S0|                                               
                                       entrylen:0| matchidx:45| nextidx:46                                        
                                                                             S2|T2 is not leader                  
S0|T2 is not leader                                                                                               
                                                                             S2|T2 save persist| votedFor: 2|     
                                                                             logsLen: 46                          
S0|T2 save persist| votedFor: 1|                                                                                  
logsLen: 46                                                                                                       
S0|T2 appends logs from S1| logLen:                                                                               
46[AppendEntry]                                                                                                   
                                                                             S2|T2 appends logs from S1| logLen:  
                                                                             46[AppendEntry]                      
                                       S1|T2 replica entries to S0|                                               
                                       entrylen:0| matchidx:45| nextidx:46                                        
                                       S1|T2 replica entries to S2|                                               
                                       entrylen:0| matchidx:45| nextidx:46                                        
                                       S1 is disconnected                                                         
S0|T2 is not leader                                                                                               
                                                                             S2|T2 is not leader                  
                                                                             S2|T2 is not leader                  
S0|T2 is not leader                                                                                               
                                                                             S2|T2 is not leader                  
S0|T2 is not leader                                                                                               
S0|T2 is not leader                                                                                               
                                                                             S2|T2 is not leader                  
S0|T2 is not leader                                                                                               
                                                                             S2|T2 is not leader                  
S0|T2 is not leader                                                                                               
                                                                             S2|T2 is not leader                  
S0|T2 is not leader                                                                                               
                                                                             S2|T2 is not leader                  
                                                                             S2|T2 is not leader                  
S0|T2 is not leader                                                                                               
S0|T2 is not leader                                                                                               
                                                                             S2|T2 is not leader                  
S0|T3 starts to join election                                                                                     
S0|T3 save persist| votedFor: 0|                                                                                  
logsLen: 46                                                                                                       
                                                                             S2|T3 save persist| votedFor: -1|    
                                                                             logsLen: 46                          
                                                                             S2|T3 save persist| votedFor: 0|     
                                                                             logsLen: 46                          
                                                                             S2|T3 votes for S0[RequestVote]      
S0|T3 becomes the leader, and starts                                                                              
heatbeats                                                                                                         
                                                                             S2|T3 save persist| votedFor: 0|     
                                                                             logsLen: 46                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             46[AppendEntry]                      
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:45| nextidx:46                                                                               
S0|T3 save persist| votedFor: 0|                                                                                  
logsLen: 47                                                                                                       
S0|T3 receive commands | logLen:                                                                                  
47[Start]                                                                                                         
                                                                             S2|T3 is not leader                  
                                                                             S2|T3 save persist| votedFor: 0|     
                                                                             logsLen: 47                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             47[AppendEntry]                      
S0|T3 replica entries to S2|                                                                                      
entrylen:1| matchidx:46| nextidx:47                                                                               
S0|T3 update commitIndex as 46                                                                                    
S0|T3 starts to apply entries                                                                                     
[46:46][ApplyEntry]                                                                                               
S0|T3 finishes applying entries                                                                                   
[46:46][ApplyEntry]                                                                                               
                                                                             S2|T3 is not leader                  
                                                                             S2|T3 save persist| votedFor: 0|     
                                                                             logsLen: 47                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             47[AppendEntry]                      
                                                                             S2|T3 starts to apply entries        
                                                                             [46:46][ApplyEntry]                  
                                                                             S2|T3 finishes applying entries      
                                                                             [46:46][ApplyEntry]                  
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:46| nextidx:47                                                                               
S0|T3 save persist| votedFor: 0|                                                                                  
logsLen: 48                                                                                                       
S0|T3 receive commands | logLen:                                                                                  
48[Start]                                                                                                         
                                                                             S2|T3 is not leader                  
                                                                             S2|T3 save persist| votedFor: 0|     
                                                                             logsLen: 48                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             48[AppendEntry]                      
S0|T3 replica entries to S2|                                                                                      
entrylen:1| matchidx:47| nextidx:48                                                                               
S0|T3 update commitIndex as 47                                                                                    
S0|T3 starts to apply entries                                                                                     
[47:47][ApplyEntry]                                                                                               
S0|T3 finishes applying entries                                                                                   
[47:47][ApplyEntry]                                                                                               
                                                                             S2|T3 is not leader                  
                                                                             S2|T3 save persist| votedFor: 0|     
                                                                             logsLen: 48                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             48[AppendEntry]                      
                                                                             S2|T3 starts to apply entries        
                                                                             [47:47][ApplyEntry]                  
                                                                             S2|T3 finishes applying entries      
                                                                             [47:47][ApplyEntry]                  
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:47| nextidx:48                                                                               
                                       S1 is connected again                                                      
                                       S1|T2 save persist| votedFor: 1|                                           
                                       logsLen: 47                                                                
                                       S1|T2 receive commands | logLen:                                           
                                       47[Start]                                                                  
                                                                             S2|T3 is not leader                  
S0|T3 rejects to append entries from                                                                              
S1 | out of date term[AppendEntry]                                                                                
                                                                             S2|T3 save persist| votedFor: 0|     
                                                                             logsLen: 48                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             48[AppendEntry]                      
                                       S1|T3 save persist| votedFor: 1|                                           
                                       logsLen: 47                                                                
                                                                             S2|T3 rejects to append entries from 
                                                                             S1 | out of date term[AppendEntry]   
                                       S1|T3 save persist| votedFor: 1|                                           
                                       logsLen: 48                                                                
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:47| nextidx:48                                                                               
                                       S1|T3 appends logs from S0| logLen:                                        
                                       48[AppendEntry]                                                            
                                       S1|T3 starts to apply entries                                              
                                       [46:47][ApplyEntry]                                                        
                                       S1|T3 lost leadership, state: 0                                            
                                       S1|T3 lost leadership, state: 0                                            
                                       S1|T3 finishes applying entries                                            
                                       [46:47][ApplyEntry]                                                        
S0|T3 replica entries to S1|                                                                                      
entrylen:2| matchidx:47| nextidx:48                                                                               
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 is not leader                  
                                       S1|T3 save persist| votedFor: 1|                                           
                                       logsLen: 48                                                                
                                       S1|T3 appends logs from S0| logLen:                                        
                                       48[AppendEntry]                                                            
                                                                             S2|T3 save persist| votedFor: 0|     
                                                                             logsLen: 48                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             48[AppendEntry]                      
S0|T3 replica entries to S1|                                                                                      
entrylen:0| matchidx:47| nextidx:48                                                                               
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:47| nextidx:48                                                                               
                                                                             S2|T3 is not leader                  
                                       S1|T3 is not leader                                                        
                                       S1|T3 save persist| votedFor: 1|                                           
                                       logsLen: 48                                                                
                                       S1|T3 appends logs from S0| logLen:                                        
                                       48[AppendEntry]                                                            
                                                                             S2|T3 save persist| votedFor: 0|     
                                                                             logsLen: 48                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             48[AppendEntry]                      
S0|T3 replica entries to S1|                                                                                      
entrylen:0| matchidx:47| nextidx:48                                                                               
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:47| nextidx:48                                                                               
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 is not leader                  
                                                                             S2|T3 save persist| votedFor: 0|     
                                                                             logsLen: 48                          
                                       S1|T3 save persist| votedFor: 1|                                           
                                       logsLen: 48                                                                
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             48[AppendEntry]                      
                                       S1|T3 appends logs from S0| logLen:                                        
                                       48[AppendEntry]                                                            
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:47| nextidx:48                                                                               
S0|T3 replica entries to S1|                                                                                      
entrylen:0| matchidx:47| nextidx:48                                                                               
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 is not leader                  
                                       S1|T3 save persist| votedFor: 1|                                           
                                       logsLen: 48                                                                
                                                                             S2|T3 save persist| votedFor: 0|     
                                                                             logsLen: 48                          
                                       S1|T3 appends logs from S0| logLen:                                        
                                       48[AppendEntry]                                                            
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             48[AppendEntry]                      
S0|T3 replica entries to S1|                                                                                      
entrylen:0| matchidx:47| nextidx:48                                                                               
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:47| nextidx:48                                                                               
                                                                             S2|T3 is not leader                  
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 save persist| votedFor: 0|     
                                                                             logsLen: 48                          
                                       S1|T3 save persist| votedFor: 1|                                           
                                       logsLen: 48                                                                
                                       S1|T3 appends logs from S0| logLen:                                        
                                       48[AppendEntry]                                                            
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             48[AppendEntry]                      
S0|T3 replica entries to S1|                                                                                      
entrylen:0| matchidx:47| nextidx:48                                                                               
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:47| nextidx:48                                                                               
                                                                             S2|T3 is not leader                  
                                       S1|T3 is not leader                                                        
                                       S1|T3 save persist| votedFor: 1|                                           
                                       logsLen: 48                                                                
                                                                             S2|T3 save persist| votedFor: 0|     
                                                                             logsLen: 48                          
                                       S1|T3 appends logs from S0| logLen:                                        
                                       48[AppendEntry]                                                            
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             48[AppendEntry]                      
S0|T3 replica entries to S1|                                                                                      
entrylen:0| matchidx:47| nextidx:48                                                                               
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:47| nextidx:48                                                                               
                                                                             S2|T3 is not leader                  
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 save persist| votedFor: 0|     
                                                                             logsLen: 48                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             48[AppendEntry]                      
                                       S1|T3 save persist| votedFor: 1|                                           
                                       logsLen: 48                                                                
                                       S1|T3 appends logs from S0| logLen:                                        
                                       48[AppendEntry]                                                            
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:47| nextidx:48                                                                               
S0|T3 replica entries to S1|                                                                                      
entrylen:0| matchidx:47| nextidx:48                                                                               
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 is not leader                  
                                       S1|T3 save persist| votedFor: 1|                                           
                                       logsLen: 48                                                                
                                       S1|T3 appends logs from S0| logLen:                                        
                                       48[AppendEntry]                                                            
                                                                             S2|T3 save persist| votedFor: 0|     
                                                                             logsLen: 48                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             48[AppendEntry]                      
S0|T3 replica entries to S1|                                                                                      
entrylen:0| matchidx:47| nextidx:48                                                                               
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:47| nextidx:48                                                                               
                                                                             S2|T3 is not leader                  
                                       S1|T3 is not leader                                                        
                                       S1|T3 save persist| votedFor: 1|                                           
                                       logsLen: 48                                                                
                                       S1|T3 appends logs from S0| logLen:                                        
                                       48[AppendEntry]                                                            
                                                                             S2|T3 save persist| votedFor: 0|     
                                                                             logsLen: 48                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             48[AppendEntry]                      
S0|T3 replica entries to S1|                                                                                      
entrylen:0| matchidx:47| nextidx:48                                                                               
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:47| nextidx:48                                                                               
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 is not leader                  
                                                                             S2|T3 save persist| votedFor: 0|     
                                                                             logsLen: 48                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             48[AppendEntry]                      
                                       S1|T3 save persist| votedFor: 1|                                           
                                       logsLen: 48                                                                
                                       S1|T3 appends logs from S0| logLen:                                        
                                       48[AppendEntry]                                                            
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:47| nextidx:48                                                                               
S0|T3 replica entries to S1|                                                                                      
entrylen:0| matchidx:47| nextidx:48                                                                               
                                       S1|T3 fails to install snapshot to S2                                      
                                                                             S2|T3 is not leader                  
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 save persist| votedFor: 0|     
                                                                             logsLen: 48                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             48[AppendEntry]                      
                                       S1|T3 save persist| votedFor: 1|                                           
                                       logsLen: 48                                                                
                                       S1|T3 appends logs from S0| logLen:                                        
                                       48[AppendEntry]                                                            
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:47| nextidx:48                                                                               
S0|T3 replica entries to S1|                                                                                      
entrylen:0| matchidx:47| nextidx:48                                                                               
                                                                             S2|T3 is not leader                  
                                       S1|T3 is not leader                                                        
                                       S1|T3 save persist| votedFor: 1|                                           
                                       logsLen: 48                                                                
                                                                             S2|T3 save persist| votedFor: 0|     
                                                                             logsLen: 48                          
                                       S1|T3 appends logs from S0| logLen:                                        
                                       48[AppendEntry]                                                            
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             48[AppendEntry]                      
S0|T3 replica entries to S1|                                                                                      
entrylen:0| matchidx:47| nextidx:48                                                                               
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:47| nextidx:48                                                                               
                                                                             S2|T3 is not leader                  
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 save persist| votedFor: 0|     
                                                                             logsLen: 48                          
                                       S1|T3 save persist| votedFor: 1|                                           
                                       logsLen: 48                                                                
                                       S1|T3 appends logs from S0| logLen:                                        
                                       48[AppendEntry]                                                            
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             48[AppendEntry]                      
S0|T3 replica entries to S1|                                                                                      
entrylen:0| matchidx:47| nextidx:48                                                                               
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:47| nextidx:48                                                                               
                                                                             S2|T3 is not leader                  
                                       S1|T3 is not leader                                                        
                                       S1|T3 save persist| votedFor: 1|                                           
                                       logsLen: 48                                                                
                                       S1|T3 appends logs from S0| logLen:                                        
                                       48[AppendEntry]                                                            
                                                                             S2|T3 save persist| votedFor: 0|     
                                                                             logsLen: 48                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             48[AppendEntry]                      
S0|T3 replica entries to S1|                                                                                      
entrylen:0| matchidx:47| nextidx:48                                                                               
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:47| nextidx:48                                                                               
                                                                             S2|T3 is not leader                  
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 save persist| votedFor: 0|     
                                                                             logsLen: 48                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             48[AppendEntry]                      
                                       S1|T3 save persist| votedFor: 1|                                           
                                       logsLen: 48                                                                
                                       S1|T3 appends logs from S0| logLen:                                        
                                       48[AppendEntry]                                                            
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:47| nextidx:48                                                                               
S0|T3 replica entries to S1|                                                                                      
entrylen:0| matchidx:47| nextidx:48                                                                               
                                                                             S2|T3 is not leader                  
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 save persist| votedFor: 0|     
                                                                             logsLen: 48                          
                                       S1|T3 save persist| votedFor: 1|                                           
                                       logsLen: 48                                                                
                                       S1|T3 appends logs from S0| logLen:                                        
                                       48[AppendEntry]                                                            
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             48[AppendEntry]                      
S0|T3 replica entries to S1|                                                                                      
entrylen:0| matchidx:47| nextidx:48                                                                               
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:47| nextidx:48                                                                               
                                       S1|T3 fails to install snapshot to S2                                      
                                                                             S2|T3 is not leader                  
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 save persist| votedFor: 0|     
                                                                             logsLen: 48                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             48[AppendEntry]                      
                                       S1|T3 save persist| votedFor: 1|                                           
                                       logsLen: 48                                                                
                                       S1|T3 appends logs from S0| logLen:                                        
                                       48[AppendEntry]                                                            
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:47| nextidx:48                                                                               
S0|T3 replica entries to S1|                                                                                      
entrylen:0| matchidx:47| nextidx:48                                                                               
                                                                             S2|T3 is not leader                  
                                       S1|T3 is not leader                                                        
                                       S1|T3 save persist| votedFor: 1|                                           
                                       logsLen: 48                                                                
                                                                             S2|T3 save persist| votedFor: 0|     
                                                                             logsLen: 48                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             48[AppendEntry]                      
                                       S1|T3 appends logs from S0| logLen:                                        
                                       48[AppendEntry]                                                            
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:47| nextidx:48                                                                               
S0|T3 replica entries to S1|                                                                                      
entrylen:0| matchidx:47| nextidx:48                                                                               
                                                                             S2|T3 is not leader                  
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 save persist| votedFor: 0|     
                                                                             logsLen: 48                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             48[AppendEntry]                      
                                       S1|T3 save persist| votedFor: 1|                                           
                                       logsLen: 48                                                                
                                       S1|T3 appends logs from S0| logLen:                                        
                                       48[AppendEntry]                                                            
S0|T3 save persist| votedFor: 0|                                                                                  
logsLen: 49                                                                                                       
S0|T3 receive commands | logLen:                                                                                  
49[Start]                                                                                                         
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:47| nextidx:48                                                                               
S0|T3 replica entries to S1|                                                                                      
entrylen:0| matchidx:47| nextidx:48                                                                               
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 is not leader                  
                                       S1|T3 save persist| votedFor: 1|                                           
                                       logsLen: 49                                                                
                                                                             S2|T3 save persist| votedFor: 0|     
                                                                             logsLen: 49                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             49[AppendEntry]                      
                                       S1|T3 appends logs from S0| logLen:                                        
                                       49[AppendEntry]                                                            
S0|T3 replica entries to S2|                                                                                      
entrylen:1| matchidx:48| nextidx:49                                                                               
S0|T3 update commitIndex as 48                                                                                    
S0|T3 starts to apply entries                                                                                     
[48:48][ApplyEntry]                                                                                               
S0|T3 finishes applying entries                                                                                   
[48:48][ApplyEntry]                                                                                               
S0|T3 replica entries to S1|                                                                                      
entrylen:1| matchidx:48| nextidx:49                                                                               
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 is not leader                  
                                       S1|T3 save persist| votedFor: 1|                                           
                                       logsLen: 49                                                                
                                       S1|T3 appends logs from S0| logLen:                                        
                                       49[AppendEntry]                                                            
                                                                             S2|T3 save persist| votedFor: 0|     
                                                                             logsLen: 49                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             49[AppendEntry]                      
                                       S1|T3 starts to apply entries                                              
                                       [48:48][ApplyEntry]                                                        
                                       S1|T3 finishes applying entries                                            
                                       [48:48][ApplyEntry]                                                        
                                                                             S2|T3 starts to apply entries        
                                                                             [48:48][ApplyEntry]                  
                                                                             S2|T3 finishes applying entries      
                                                                             [48:48][ApplyEntry]                  
S0|T3 replica entries to S1|                                                                                      
entrylen:0| matchidx:48| nextidx:49                                                                               
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:48| nextidx:49                                                                               
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 is not leader                  
                                                                             S2|T3 save persist| votedFor: 0|     
                                                                             logsLen: 49                          
                                       S1|T3 save persist| votedFor: 1|                                           
                                       logsLen: 49                                                                
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             49[AppendEntry]                      
                                       S1|T3 appends logs from S0| logLen:                                        
                                       49[AppendEntry]                                                            
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:48| nextidx:49                                                                               
S0|T3 replica entries to S1|                                                                                      
entrylen:0| matchidx:48| nextidx:49                                                                               
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 is not leader                  
                                                                             S2|T3 save persist| votedFor: 0|     
                                                                             logsLen: 49                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             49[AppendEntry]                      
                                       S1|T3 save persist| votedFor: 1|                                           
                                       logsLen: 49                                                                
                                       S1|T3 appends logs from S0| logLen:                                        
                                       49[AppendEntry]                                                            
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:48| nextidx:49                                                                               
S0|T3 replica entries to S1|                                                                                      
entrylen:0| matchidx:48| nextidx:49                                                                               
                                                                             S2|T3 is not leader                  
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 save persist| votedFor: 0|     
                                                                             logsLen: 49                          
                                       S1|T3 save persist| votedFor: 1|                                           
                                       logsLen: 49                                                                
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             49[AppendEntry]                      
                                       S1|T3 appends logs from S0| logLen:                                        
                                       49[AppendEntry]                                                            
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:48| nextidx:49                                                                               
S0|T3 replica entries to S1|                                                                                      
entrylen:0| matchidx:48| nextidx:49                                                                               
                                                                             S2|T3 is not leader                  
                                       S1|T3 is not leader                                                        
                                       S1|T3 save persist| votedFor: 1|                                           
                                       logsLen: 49                                                                
                                                                             S2|T3 save persist| votedFor: 0|     
                                                                             logsLen: 49                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             49[AppendEntry]                      
                                       S1|T3 appends logs from S0| logLen:                                        
                                       49[AppendEntry]                                                            
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:48| nextidx:49                                                                               
S0|T3 replica entries to S1|                                                                                      
entrylen:0| matchidx:48| nextidx:49                                                                               
                                                                             S2|T3 is not leader                  
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 save persist| votedFor: 0|     
                                                                             logsLen: 49                          
                                       S1|T3 save persist| votedFor: 1|                                           
                                       logsLen: 49                                                                
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             49[AppendEntry]                      
                                       S1|T3 appends logs from S0| logLen:                                        
                                       49[AppendEntry]                                                            
                                       S1 is disconnected                                                         
S0|T3 save persist| votedFor: 0|                                                                                  
logsLen: 50                                                                                                       
S0|T3 receive commands | logLen:                                                                                  
50[Start]                                                                                                         
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:48| nextidx:49                                                                               
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 is not leader                  
                                                                             S2|T3 save persist| votedFor: 0|     
                                                                             logsLen: 50                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             50[AppendEntry]                      
S0|T3 replica entries to S2|                                                                                      
entrylen:1| matchidx:49| nextidx:50                                                                               
S0|T3 update commitIndex as 49                                                                                    
S0|T3 starts to apply entries                                                                                     
[49:49][ApplyEntry]                                                                                               
S0|T3 finishes applying entries                                                                                   
[49:49][ApplyEntry]                                                                                               
S0|T3 Snapshot until index 49| logLen:                                                                            
50                                                                                                                
                                                                             S2|T3 is not leader                  
                                       S1|T3 is not leader                                                        
S0|T3 send rpc to S1|base: 49| next:                                                                              
49                                                                                                                
                                                                             S2|T3 save persist| votedFor: 0|     
                                                                             logsLen: 50                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             50[AppendEntry]                      
                                                                             S2|T3 starts to apply entries        
                                                                             [49:49][ApplyEntry]                  
                                                                             S2|T3 finishes applying entries      
                                                                             [49:49][ApplyEntry]                  
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:49| nextidx:50                                                                               
                                                                             S2|T3 Snapshot until index 49|       
                                                                             logLen: 50                           
S0|T3 save persist| votedFor: 0|                                                                                  
logsLen: 51                                                                                                       
S0|T3 receive commands | logLen:                                                                                  
51[Start]                                                                                                         
S0|T3 save persist| votedFor: 0|                                                                                  
logsLen: 52                                                                                                       
S0|T3 receive commands | logLen:                                                                                  
52[Start]                                                                                                         
S0|T3 save persist| votedFor: 0|                                                                                  
logsLen: 53                                                                                                       
S0|T3 receive commands | logLen:                                                                                  
53[Start]                                                                                                         
S0|T3 save persist| votedFor: 0|                                                                                  
logsLen: 54                                                                                                       
S0|T3 receive commands | logLen:                                                                                  
54[Start]                                                                                                         
S0|T3 save persist| votedFor: 0|                                                                                  
logsLen: 55                                                                                                       
S0|T3 receive commands | logLen:                                                                                  
55[Start]                                                                                                         
S0|T3 save persist| votedFor: 0|                                                                                  
logsLen: 56                                                                                                       
S0|T3 receive commands | logLen:                                                                                  
56[Start]                                                                                                         
S0|T3 save persist| votedFor: 0|                                                                                  
logsLen: 57                                                                                                       
S0|T3 receive commands | logLen:                                                                                  
57[Start]                                                                                                         
                                                                             S2|T3 is not leader                  
                                       S1|T3 is not leader                                                        
S0|T3 send rpc to S1|base: 49| next:                                                                              
49                                                                                                                
                                                                             S2|T3 save persist| votedFor: 0|     
                                                                             logsLen: 57                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             57[AppendEntry]                      
S0|T3 replica entries to S2|                                                                                      
entrylen:7| matchidx:56| nextidx:57                                                                               
S0|T3 update commitIndex as 56                                                                                    
S0|T3 starts to apply entries                                                                                     
[50:56][ApplyEntry]                                                                                               
S0|T3 finishes applying entries                                                                                   
[50:56][ApplyEntry]                                                                                               
                                       S1|T3 is not leader                                                        
S0|T3 send rpc to S1|base: 49| next:                                                                              
49                                                                                                                
                                                                             S2|T3 is not leader                  
                                                                             S2|T3 save persist| votedFor: 0|     
                                                                             logsLen: 57                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             57[AppendEntry]                      
                                                                             S2|T3 starts to apply entries        
                                                                             [50:56][ApplyEntry]                  
                                                                             S2|T3 finishes applying entries      
                                                                             [50:56][ApplyEntry]                  
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:56| nextidx:57                                                                               
                                       S1 is connected again                                                      
S0|T3 save persist| votedFor: 0|                                                                                  
logsLen: 58                                                                                                       
S0|T3 receive commands | logLen:                                                                                  
58[Start]                                                                                                         
                                                                             S2|T3 is not leader                  
                                       S1|T3 is not leader                                                        
S0|T3 send rpc to S1|base: 49| next:                                                                              
49                                                                                                                
                                       S1|T3 receive rpc from S0                                                  
                                       S1|T3 update rfstate| Base:49|                                             
                                       LogLen:50                                                                  
                                       S1|T3 applys snapshot from S0                                              
                                                                             S2|T3 save persist| votedFor: 0|     
                                                                             logsLen: 58                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             58[AppendEntry]                      
S0|T3 installs snapshot to S1|                                                                                    
nextId:50| matchId:49                                                                                             
S0|T3 replica entries to S2|                                                                                      
entrylen:1| matchidx:57| nextidx:58                                                                               
S0|T3 update commitIndex as 57                                                                                    
S0|T3 starts to apply entries                                                                                     
[57:57][ApplyEntry]                                                                                               
S0|T3 finishes applying entries                                                                                   
[57:57][ApplyEntry]                                                                                               
                                                                             S2|T3 is not leader                  
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 save persist| votedFor: 0|     
                                                                             logsLen: 58                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             58[AppendEntry]                      
                                       S1|T3 save persist| votedFor: 1|                                           
                                       logsLen: 58                                                                
                                       S1|T3 appends logs from S0| logLen:                                        
                                       58[AppendEntry]                                                            
                                                                             S2|T3 starts to apply entries        
                                                                             [57:57][ApplyEntry]                  
                                                                             S2|T3 finishes applying entries      
                                                                             [57:57][ApplyEntry]                  
                                       S1|T3 starts to apply entries                                              
                                       [50:57][ApplyEntry]                                                        
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:57| nextidx:58                                                                               
                                       S1|T3 finishes applying entries                                            
                                       [50:57][ApplyEntry]                                                        
S0|T3 replica entries to S1|                                                                                      
entrylen:8| matchidx:57| nextidx:58                                                                               
                                       S1|T3 fails to install snapshot to S2                                      
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 is not leader                  
                                                                             S2|T3 save persist| votedFor: 0|     
                                                                             logsLen: 58                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             58[AppendEntry]                      
                                       S1|T3 save persist| votedFor: 1|                                           
                                       logsLen: 58                                                                
                                       S1|T3 appends logs from S0| logLen:                                        
                                       58[AppendEntry]                                                            
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:57| nextidx:58                                                                               
S0|T3 replica entries to S1|                                                                                      
entrylen:0| matchidx:57| nextidx:58                                                                               
                                                                             S2|T3 is not leader                  
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 save persist| votedFor: 0|     
                                                                             logsLen: 58                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             58[AppendEntry]                      
                                       S1|T3 save persist| votedFor: 1|                                           
                                       logsLen: 58                                                                
                                       S1|T3 appends logs from S0| logLen:                                        
                                       58[AppendEntry]                                                            
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:57| nextidx:58                                                                               
S0|T3 replica entries to S1|                                                                                      
entrylen:0| matchidx:57| nextidx:58                                                                               
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 is not leader                  
                                                                             S2|T3 save persist| votedFor: 0|     
                                                                             logsLen: 58                          
                                       S1|T3 save persist| votedFor: 1|                                           
                                       logsLen: 58                                                                
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             58[AppendEntry]                      
                                       S1|T3 appends logs from S0| logLen:                                        
                                       58[AppendEntry]                                                            
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:57| nextidx:58                                                                               
S0|T3 replica entries to S1|                                                                                      
entrylen:0| matchidx:57| nextidx:58                                                                               
                                                                             S2|T3 is not leader                  
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 save persist| votedFor: 0|     
                                                                             logsLen: 58                          
                                       S1|T3 save persist| votedFor: 1|                                           
                                       logsLen: 58                                                                
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             58[AppendEntry]                      
                                       S1|T3 appends logs from S0| logLen:                                        
                                       58[AppendEntry]                                                            
S0|T3 replica entries to S1|                                                                                      
entrylen:0| matchidx:57| nextidx:58                                                                               
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:57| nextidx:58                                                                               
S0|T3 fails to install snapshot to S1                                                                             
                                                                             S2|T3 is not leader                  
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 save persist| votedFor: 0|     
                                                                             logsLen: 58                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             58[AppendEntry]                      
                                       S1|T3 save persist| votedFor: 1|                                           
                                       logsLen: 58                                                                
                                       S1|T3 appends logs from S0| logLen:                                        
                                       58[AppendEntry]                                                            
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:57| nextidx:58                                                                               
S0|T3 replica entries to S1|                                                                                      
entrylen:0| matchidx:57| nextidx:58                                                                               
                                       S1 is disconnected                                                         
S0|T3 save persist| votedFor: 0|                                                                                  
logsLen: 59                                                                                                       
S0|T3 receive commands | logLen:                                                                                  
59[Start]                                                                                                         
                                                                             S2|T3 is not leader                  
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 save persist| votedFor: 0|     
                                                                             logsLen: 59                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             59[AppendEntry]                      
S0|T3 replica entries to S2|                                                                                      
entrylen:1| matchidx:58| nextidx:59                                                                               
S0|T3 update commitIndex as 58                                                                                    
S0|T3 starts to apply entries                                                                                     
[58:58][ApplyEntry]                                                                                               
S0|T3 finishes applying entries                                                                                   
[58:58][ApplyEntry]                                                                                               
                                                                             S2|T3 is not leader                  
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 save persist| votedFor: 0|     
                                                                             logsLen: 59                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             59[AppendEntry]                      
                                                                             S2|T3 starts to apply entries        
                                                                             [58:58][ApplyEntry]                  
                                                                             S2|T3 finishes applying entries      
                                                                             [58:58][ApplyEntry]                  
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:58| nextidx:59                                                                               
S0|T3 save persist| votedFor: 0|                                                                                  
logsLen: 60                                                                                                       
S0|T3 receive commands | logLen:                                                                                  
60[Start]                                                                                                         
S0|T3 save persist| votedFor: 0|                                                                                  
logsLen: 61                                                                                                       
S0|T3 receive commands | logLen:                                                                                  
61[Start]                                                                                                         
S0|T3 save persist| votedFor: 0|                                                                                  
logsLen: 62                                                                                                       
S0|T3 receive commands | logLen:                                                                                  
62[Start]                                                                                                         
S0|T3 save persist| votedFor: 0|                                                                                  
logsLen: 63                                                                                                       
S0|T3 receive commands | logLen:                                                                                  
63[Start]                                                                                                         
S0|T3 save persist| votedFor: 0|                                                                                  
logsLen: 64                                                                                                       
S0|T3 receive commands | logLen:                                                                                  
64[Start]                                                                                                         
S0|T3 save persist| votedFor: 0|                                                                                  
logsLen: 65                                                                                                       
S0|T3 receive commands | logLen:                                                                                  
65[Start]                                                                                                         
S0|T3 save persist| votedFor: 0|                                                                                  
logsLen: 66                                                                                                       
S0|T3 receive commands | logLen:                                                                                  
66[Start]                                                                                                         
S0|T3 save persist| votedFor: 0|                                                                                  
logsLen: 67                                                                                                       
S0|T3 receive commands | logLen:                                                                                  
67[Start]                                                                                                         
S0|T3 save persist| votedFor: 0|                                                                                  
logsLen: 68                                                                                                       
S0|T3 receive commands | logLen:                                                                                  
68[Start]                                                                                                         
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 is not leader                  
                                                                             S2|T3 save persist| votedFor: 0|     
                                                                             logsLen: 68                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             68[AppendEntry]                      
S0|T3 replica entries to S2|                                                                                      
entrylen:9| matchidx:67| nextidx:68                                                                               
S0|T3 update commitIndex as 67                                                                                    
S0|T3 starts to apply entries                                                                                     
[59:67][ApplyEntry]                                                                                               
S0|T3 Snapshot until index 59| logLen:                                                                            
68                                                                                                                
S0|T3 finishes applying entries                                                                                   
[59:67][ApplyEntry]                                                                                               
                                                                             S2|T3 is not leader                  
                                       S1|T3 is not leader                                                        
S0|T3 send rpc to S1|base: 59| next:                                                                              
58                                                                                                                
                                                                             S2|T3 save persist| votedFor: 0|     
                                                                             logsLen: 68                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             68[AppendEntry]                      
                                                                             S2|T3 starts to apply entries        
                                                                             [59:67][ApplyEntry]                  
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:67| nextidx:68                                                                               
                                                                             S2|T3 Snapshot until index 59|       
                                                                             logLen: 68                           
                                                                             S2|T3 finishes applying entries      
                                                                             [59:67][ApplyEntry]                  
                                       S1 is connected again                                                      
S0|T3 save persist| votedFor: 0|                                                                                  
logsLen: 69                                                                                                       
S0|T3 receive commands | logLen:                                                                                  
69[Start]                                                                                                         
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 is not leader                  
S0|T3 send rpc to S1|base: 59| next:                                                                              
58                                                                                                                
                                       S1|T3 receive rpc from S0                                                  
                                       S1|T3 update rfstate| Base:59|                                             
                                       LogLen:60                                                                  
                                       S1|T3 applys snapshot from S0                                              
                                                                             S2|T3 save persist| votedFor: 0|     
                                                                             logsLen: 69                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             69[AppendEntry]                      
S0|T3 installs snapshot to S1|                                                                                    
nextId:60| matchId:59                                                                                             
S0|T3 replica entries to S2|                                                                                      
entrylen:1| matchidx:68| nextidx:69                                                                               
S0|T3 update commitIndex as 68                                                                                    
S0|T3 starts to apply entries                                                                                     
[68:68][ApplyEntry]                                                                                               
S0|T3 finishes applying entries                                                                                   
[68:68][ApplyEntry]                                                                                               
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 is not leader                  
                                                                             S2|T3 save persist| votedFor: 0|     
                                                                             logsLen: 69                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             69[AppendEntry]                      
                                                                             S2|T3 starts to apply entries        
                                                                             [68:68][ApplyEntry]                  
                                                                             S2|T3 finishes applying entries      
                                                                             [68:68][ApplyEntry]                  
                                       S1|T3 save persist| votedFor: 1|                                           
                                       logsLen: 69                                                                
                                       S1|T3 appends logs from S0| logLen:                                        
                                       69[AppendEntry]                                                            
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:68| nextidx:69                                                                               
                                       S1|T3 starts to apply entries                                              
                                       [60:68][ApplyEntry]                                                        
                                       S1|T3 finishes applying entries                                            
                                       [60:68][ApplyEntry]                                                        
S0|T3 replica entries to S1|                                                                                      
entrylen:9| matchidx:68| nextidx:69                                                                               
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 is not leader                  
                                       S1|T3 save persist| votedFor: 1|                                           
                                       logsLen: 69                                                                
                                                                             S2|T3 save persist| votedFor: 0|     
                                                                             logsLen: 69                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             69[AppendEntry]                      
                                       S1|T3 appends logs from S0| logLen:                                        
                                       69[AppendEntry]                                                            
S0|T3 replica entries to S1|                                                                                      
entrylen:0| matchidx:68| nextidx:69                                                                               
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:68| nextidx:69                                                                               
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 is not leader                  
                                       S1|T3 save persist| votedFor: 1|                                           
                                       logsLen: 69                                                                
                                                                             S2|T3 save persist| votedFor: 0|     
                                                                             logsLen: 69                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             69[AppendEntry]                      
                                       S1|T3 appends logs from S0| logLen:                                        
                                       69[AppendEntry]                                                            
S0|T3 replica entries to S1|                                                                                      
entrylen:0| matchidx:68| nextidx:69                                                                               
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:68| nextidx:69                                                                               
S0|T3 fails to install snapshot to S1                                                                             
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 is not leader                  
                                       S1|T3 save persist| votedFor: 1|                                           
                                       logsLen: 69                                                                
                                       S1|T3 appends logs from S0| logLen:                                        
                                       69[AppendEntry]                                                            
                                                                             S2|T3 save persist| votedFor: 0|     
                                                                             logsLen: 69                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             69[AppendEntry]                      
S0|T3 replica entries to S1|                                                                                      
entrylen:0| matchidx:68| nextidx:69                                                                               
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:68| nextidx:69                                                                               
                                                                             S2|T3 is not leader                  
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 save persist| votedFor: 0|     
                                                                             logsLen: 69                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             69[AppendEntry]                      
                                       S1|T3 save persist| votedFor: 1|                                           
                                       logsLen: 69                                                                
                                       S1|T3 appends logs from S0| logLen:                                        
                                       69[AppendEntry]                                                            
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:68| nextidx:69                                                                               
S0|T3 replica entries to S1|                                                                                      
entrylen:0| matchidx:68| nextidx:69                                                                               
S0 is disconnected                                                                                                
                                                                             S2|T3 is not leader                  
                                       S1|T3 is not leader                                                        
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 is not leader                  
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 is not leader                  
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 is not leader                  
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 is not leader                  
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 is not leader                  
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 is not leader                  
                                       S1|T4 starts to join election                                              
                                       S1|T4 save persist| votedFor: 1|                                           
                                       logsLen: 69                                                                
                                                                             S2|T4 save persist| votedFor: -1|    
                                                                             logsLen: 69                          
                                                                             S2|T4 save persist| votedFor: 1|     
                                                                             logsLen: 69                          
                                                                             S2|T4 votes for S1[RequestVote]      
                                       S1|T4 becomes the leader, and starts                                       
                                       heatbeats                                                                  
                                                                             S2|T4 save persist| votedFor: 1|     
                                                                             logsLen: 69                          
                                                                             S2|T4 appends logs from S1| logLen:  
                                                                             69[AppendEntry]                      
                                       S1|T4 replica entries to S2|                                               
                                       entrylen:0| matchidx:68| nextidx:69                                        
                                       S1|T4 save persist| votedFor: 1|                                           
                                       logsLen: 70                                                                
                                       S1|T4 receive commands | logLen:                                           
                                       70[Start]                                                                  
                                                                             S2|T4 is not leader                  
                                                                             S2|T4 save persist| votedFor: 1|     
                                                                             logsLen: 70                          
                                                                             S2|T4 appends logs from S1| logLen:  
                                                                             70[AppendEntry]                      
                                       S1|T4 replica entries to S2|                                               
                                       entrylen:1| matchidx:69| nextidx:70                                        
                                       S1|T4 update commitIndex as 69                                             
                                       S1|T4 starts to apply entries                                              
                                       [69:69][ApplyEntry]                                                        
                                       S1|T4 finishes applying entries                                            
                                       [69:69][ApplyEntry]                                                        
                                       S1|T4 Snapshot until index 69|                                             
                                       logLen: 70                                                                 
S0|T3 fails to install snapshot to S1                                                                             
                                                                             S2|T4 is not leader                  
                                       S1|T4 send rpc to S0|base: 69| next:                                       
                                       69                                                                         
                                                                             S2|T4 save persist| votedFor: 1|     
                                                                             logsLen: 70                          
                                                                             S2|T4 appends logs from S1| logLen:  
                                                                             70[AppendEntry]                      
                                                                             S2|T4 starts to apply entries        
                                                                             [69:69][ApplyEntry]                  
                                                                             S2|T4 finishes applying entries      
                                                                             [69:69][ApplyEntry]                  
                                       S1|T4 replica entries to S2|                                               
                                       entrylen:0| matchidx:69| nextidx:70                                        
                                                                             S2|T4 Snapshot until index 69|       
                                                                             logLen: 70                           
                                       S1|T4 save persist| votedFor: 1|                                           
                                       logsLen: 71                                                                
                                       S1|T4 receive commands | logLen:                                           
                                       71[Start]                                                                  
                                       S1|T4 save persist| votedFor: 1|                                           
                                       logsLen: 72                                                                
                                       S1|T4 receive commands | logLen:                                           
                                       72[Start]                                                                  
                                       S1|T4 save persist| votedFor: 1|                                           
                                       logsLen: 73                                                                
                                       S1|T4 receive commands | logLen:                                           
                                       73[Start]                                                                  
                                       S1|T4 save persist| votedFor: 1|                                           
                                       logsLen: 74                                                                
                                       S1|T4 receive commands | logLen:                                           
                                       74[Start]                                                                  
                                       S1|T4 save persist| votedFor: 1|                                           
                                       logsLen: 75                                                                
                                       S1|T4 receive commands | logLen:                                           
                                       75[Start]                                                                  
                                       S1|T4 save persist| votedFor: 1|                                           
                                       logsLen: 76                                                                
                                       S1|T4 receive commands | logLen:                                           
                                       76[Start]                                                                  
                                       S1|T4 save persist| votedFor: 1|                                           
                                       logsLen: 77                                                                
                                       S1|T4 receive commands | logLen:                                           
                                       77[Start]                                                                  
                                       S1|T4 save persist| votedFor: 1|                                           
                                       logsLen: 78                                                                
                                       S1|T4 receive commands | logLen:                                           
                                       78[Start]                                                                  
                                                                             S2|T4 is not leader                  
                                       S1|T4 send rpc to S0|base: 69| next:                                       
                                       69                                                                         
                                                                             S2|T4 save persist| votedFor: 1|     
                                                                             logsLen: 78                          
                                                                             S2|T4 appends logs from S1| logLen:  
                                                                             78[AppendEntry]                      
                                       S1|T4 replica entries to S2|                                               
                                       entrylen:8| matchidx:77| nextidx:78                                        
                                       S1|T4 update commitIndex as 77                                             
                                       S1|T4 starts to apply entries                                              
                                       [70:77][ApplyEntry]                                                        
                                       S1|T4 finishes applying entries                                            
                                       [70:77][ApplyEntry]                                                        
                                                                             S2|T4 is not leader                  
                                       S1|T4 send rpc to S0|base: 69| next:                                       
                                       69                                                                         
                                                                             S2|T4 save persist| votedFor: 1|     
                                                                             logsLen: 78                          
                                                                             S2|T4 appends logs from S1| logLen:  
                                                                             78[AppendEntry]                      
                                                                             S2|T4 starts to apply entries        
                                                                             [70:77][ApplyEntry]                  
                                                                             S2|T4 finishes applying entries      
                                                                             [70:77][ApplyEntry]                  
                                       S1|T4 replica entries to S2|                                               
                                       entrylen:0| matchidx:77| nextidx:78                                        
S0 is connected again                                                                                             
                                       S1|T4 save persist| votedFor: 1|                                           
                                       logsLen: 79                                                                
                                       S1|T4 receive commands | logLen:                                           
                                       79[Start]                                                                  
                                                                             S2|T4 is not leader                  
                                       S1|T4 send rpc to S0|base: 69| next:                                       
                                       69                                                                         
                                       S1|T4 rejects to append entries from                                       
                                       S0 | out of date term[AppendEntry]                                         
S0|T3 receive rpc from S1                                                                                         
                                                                             S2|T4 save persist| votedFor: 1|     
                                                                             logsLen: 79                          
S0|T4 save persist| votedFor: 0|                                                                                  
logsLen: 69                                                                                                       
                                                                             S2|T4 appends logs from S1| logLen:  
                                                                             79[AppendEntry]                      
S0|T4 update rfstate| Base:69|                                                                                    
LogLen:70                                                                                                         
                                                                             S2|T4 rejects to append entries from 
                                                                             S0 | out of date term[AppendEntry]   
S0|T4 lost leadership, state: 0                                                                                   
S0|T4 applys snapshot from S1                                                                                     
                                       S1|T4 replica entries to S2|                                               
                                       entrylen:1| matchidx:78| nextidx:79                                        
                                       S1|T4 update commitIndex as 78                                             
S0|T4 lost leadership, state: 0                                                                                   
                                       S1|T4 starts to apply entries                                              
                                       [78:78][ApplyEntry]                                                        
                                       S1|T4 finishes applying entries                                            
                                       [78:78][ApplyEntry]                                                        
                                       S1|T4 installs snapshot to S0|                                             
                                       nextId:70| matchId:69                                                      
S0|T4 is not leader                                                                                               
                                                                             S2|T4 is not leader                  
                                                                             S2|T4 save persist| votedFor: 1|     
                                                                             logsLen: 79                          
                                                                             S2|T4 appends logs from S1| logLen:  
                                                                             79[AppendEntry]                      
S0|T4 save persist| votedFor: 0|                                                                                  
logsLen: 79                                                                                                       
                                                                             S2|T4 starts to apply entries        
                                                                             [78:78][ApplyEntry]                  
S0|T4 appends logs from S1| logLen:                                                                               
79[AppendEntry]                                                                                                   
                                                                             S2|T4 finishes applying entries      
                                                                             [78:78][ApplyEntry]                  
S0|T4 starts to apply entries                                                                                     
[70:78][ApplyEntry]                                                                                               
S0|T4 finishes applying entries                                                                                   
[70:78][ApplyEntry]                                                                                               
                                       S1|T4 replica entries to S2|                                               
                                       entrylen:0| matchidx:78| nextidx:79                                        
                                       S1|T4 replica entries to S0|                                               
                                       entrylen:9| matchidx:78| nextidx:79                                        
                                                                             S2|T4 is not leader                  
S0|T4 is not leader                                                                                               
S0|T4 save persist| votedFor: 0|                                                                                  
logsLen: 79                                                                                                       
S0|T4 appends logs from S1| logLen:                                                                               
79[AppendEntry]                                                                                                   
                                                                             S2|T4 save persist| votedFor: 1|     
                                                                             logsLen: 79                          
                                                                             S2|T4 appends logs from S1| logLen:  
                                                                             79[AppendEntry]                      
                                       S1|T4 replica entries to S0|                                               
                                       entrylen:0| matchidx:78| nextidx:79                                        
                                       S1|T4 replica entries to S2|                                               
                                       entrylen:0| matchidx:78| nextidx:79                                        
S0|T4 is not leader                                                                                               
                                                                             S2|T4 is not leader                  
S0|T4 save persist| votedFor: 0|                                                                                  
logsLen: 79                                                                                                       
                                                                             S2|T4 save persist| votedFor: 1|     
                                                                             logsLen: 79                          
S0|T4 appends logs from S1| logLen:                                                                               
79[AppendEntry]                                                                                                   
                                                                             S2|T4 appends logs from S1| logLen:  
                                                                             79[AppendEntry]                      
                                       S1|T4 replica entries to S0|                                               
                                       entrylen:0| matchidx:78| nextidx:79                                        
                                       S1|T4 replica entries to S2|                                               
                                       entrylen:0| matchidx:78| nextidx:79                                        
                                                                             S2|T4 is not leader                  
S0|T4 is not leader                                                                                               
                                                                             S2|T4 save persist| votedFor: 1|     
                                                                             logsLen: 79                          
S0|T4 save persist| votedFor: 0|                                                                                  
logsLen: 79                                                                                                       
                                                                             S2|T4 appends logs from S1| logLen:  
                                                                             79[AppendEntry]                      
S0|T4 appends logs from S1| logLen:                                                                               
79[AppendEntry]                                                                                                   
                                       S1|T4 replica entries to S2|                                               
                                       entrylen:0| matchidx:78| nextidx:79                                        
                                       S1|T4 replica entries to S0|                                               
                                       entrylen:0| matchidx:78| nextidx:79                                        
                                                                             S2|T4 is not leader                  
S0|T4 is not leader                                                                                               
S0|T4 save persist| votedFor: 0|                                                                                  
logsLen: 79                                                                                                       
                                                                             S2|T4 save persist| votedFor: 1|     
                                                                             logsLen: 79                          
                                                                             S2|T4 appends logs from S1| logLen:  
                                                                             79[AppendEntry]                      
S0|T4 appends logs from S1| logLen:                                                                               
79[AppendEntry]                                                                                                   
                                       S1|T4 replica entries to S2|                                               
                                       entrylen:0| matchidx:78| nextidx:79                                        
                                       S1|T4 replica entries to S0|                                               
                                       entrylen:0| matchidx:78| nextidx:79                                        
                                                                             S2 is disconnected                   
                                       S1|T4 save persist| votedFor: 1|                                           
                                       logsLen: 80                                                                
                                       S1|T4 receive commands | logLen:                                           
                                       80[Start]                                                                  
S0|T4 is not leader                                                                                               
                                                                             S2|T4 is not leader                  
S0|T4 save persist| votedFor: 0|                                                                                  
logsLen: 80                                                                                                       
S0|T4 appends logs from S1| logLen:                                                                               
80[AppendEntry]                                                                                                   
                                       S1|T4 replica entries to S0|                                               
                                       entrylen:1| matchidx:79| nextidx:80                                        
                                       S1|T4 update commitIndex as 79                                             
                                       S1|T4 starts to apply entries                                              
                                       [79:79][ApplyEntry]                                                        
                                       S1|T4 finishes applying entries                                            
                                       [79:79][ApplyEntry]                                                        
                                       S1|T4 Snapshot until index 79|                                             
                                       logLen: 80                                                                 
S0|T4 is not leader                                                                                               
                                                                             S2|T4 is not leader                  
                                       S1|T4 send rpc to S2|base: 79| next:                                       
                                       79                                                                         
S0|T4 save persist| votedFor: 0|                                                                                  
logsLen: 80                                                                                                       
S0|T4 appends logs from S1| logLen:                                                                               
80[AppendEntry]                                                                                                   
S0|T4 starts to apply entries                                                                                     
[79:79][ApplyEntry]                                                                                               
S0|T4 finishes applying entries                                                                                   
[79:79][ApplyEntry]                                                                                               
                                       S1|T4 replica entries to S0|                                               
                                       entrylen:0| matchidx:79| nextidx:80                                        
S0|T4 Snapshot until index 79| logLen:                                                                            
80                                                                                                                
                                       S1|T4 save persist| votedFor: 1|                                           
                                       logsLen: 81                                                                
                                       S1|T4 receive commands | logLen:                                           
                                       81[Start]                                                                  
                                       S1|T4 save persist| votedFor: 1|                                           
                                       logsLen: 82                                                                
                                       S1|T4 receive commands | logLen:                                           
                                       82[Start]                                                                  
                                       S1|T4 save persist| votedFor: 1|                                           
                                       logsLen: 83                                                                
                                       S1|T4 receive commands | logLen:                                           
                                       83[Start]                                                                  
                                       S1|T4 save persist| votedFor: 1|                                           
                                       logsLen: 84                                                                
                                       S1|T4 receive commands | logLen:                                           
                                       84[Start]                                                                  
                                       S1|T4 save persist| votedFor: 1|                                           
                                       logsLen: 85                                                                
                                       S1|T4 receive commands | logLen:                                           
                                       85[Start]                                                                  
                                       S1|T4 save persist| votedFor: 1|                                           
                                       logsLen: 86                                                                
                                       S1|T4 receive commands | logLen:                                           
                                       86[Start]                                                                  
                                       S1|T4 save persist| votedFor: 1|                                           
                                       logsLen: 87                                                                
                                       S1|T4 receive commands | logLen:                                           
                                       87[Start]                                                                  
                                       S1|T4 save persist| votedFor: 1|                                           
                                       logsLen: 88                                                                
                                       S1|T4 receive commands | logLen:                                           
                                       88[Start]                                                                  
                                       S1|T4 save persist| votedFor: 1|                                           
                                       logsLen: 89                                                                
                                       S1|T4 receive commands | logLen:                                           
                                       89[Start]                                                                  
                                       S1|T4 save persist| votedFor: 1|                                           
                                       logsLen: 90                                                                
                                       S1|T4 receive commands | logLen:                                           
                                       90[Start]                                                                  
                                       S1|T4 save persist| votedFor: 1|                                           
                                       logsLen: 91                                                                
                                       S1|T4 receive commands | logLen:                                           
                                       91[Start]                                                                  
                                       S1|T4 save persist| votedFor: 1|                                           
                                       logsLen: 92                                                                
                                       S1|T4 receive commands | logLen:                                           
                                       92[Start]                                                                  
                                                                             S2|T4 is not leader                  
S0|T4 is not leader                                                                                               
                                       S1|T4 send rpc to S2|base: 79| next:                                       
                                       79                                                                         
S0|T4 save persist| votedFor: 0|                                                                                  
logsLen: 92                                                                                                       
S0|T4 appends logs from S1| logLen:                                                                               
92[AppendEntry]                                                                                                   
                                       S1|T4 replica entries to S0|                                               
                                       entrylen:12| matchidx:91| nextidx:92                                       
                                       S1|T4 update commitIndex as 91                                             
                                       S1|T4 starts to apply entries                                              
                                       [80:91][ApplyEntry]                                                        
                                       S1|T4 Snapshot until index 89|                                             
                                       logLen: 92                                                                 
                                       S1|T4 finishes applying entries                                            
                                       [80:91][ApplyEntry]                                                        
                                       S1|T4 fails to install snapshot to S0                                      
                                                                             S2|T4 is not leader                  
S0|T4 is not leader                                                                                               
                                       S1|T4 send rpc to S2|base: 89| next:                                       
                                       79                                                                         
S0|T4 save persist| votedFor: 0|                                                                                  
logsLen: 92                                                                                                       
S0|T4 appends logs from S1| logLen:                                                                               
92[AppendEntry]                                                                                                   
S0|T4 starts to apply entries                                                                                     
[80:91][ApplyEntry]                                                                                               
                                       S1|T4 replica entries to S0|                                               
                                       entrylen:0| matchidx:91| nextidx:92                                        
S0|T4 Snapshot until index 89| logLen:                                                                            
92                                                                                                                
S0|T4 finishes applying entries                                                                                   
[80:91][ApplyEntry]                                                                                               
                                                                             S2 is connected again                
                                       S1|T4 save persist| votedFor: 1|                                           
                                       logsLen: 93                                                                
                                       S1|T4 receive commands | logLen:                                           
                                       93[Start]                                                                  
S0|T4 is not leader                                                                                               
                                                                             S2|T4 is not leader                  
                                       S1|T4 send rpc to S2|base: 89| next:                                       
                                       79                                                                         
                                                                             S2|T4 receive rpc from S1            
                                                                             S2|T4 update rfstate| Base:89|       
                                                                             LogLen:90                            
S0|T4 save persist| votedFor: 0|                                                                                  
logsLen: 93                                                                                                       
S0|T4 appends logs from S1| logLen:                                                                               
93[AppendEntry]                                                                                                   
                                                                             S2|T4 applys snapshot from S1        
                                       S1|T4 replica entries to S0|                                               
                                       entrylen:1| matchidx:92| nextidx:93                                        
                                       S1|T4 update commitIndex as 92                                             
                                       S1|T4 starts to apply entries                                              
                                       [92:92][ApplyEntry]                                                        
                                       S1|T4 finishes applying entries                                            
                                       [92:92][ApplyEntry]                                                        
                                       S1|T4 installs snapshot to S2|                                             
                                       nextId:90| matchId:89                                                      
S0|T4 is not leader                                                                                               
                                                                             S2|T4 is not leader                  
S0|T4 save persist| votedFor: 0|                                                                                  
logsLen: 93                                                                                                       
S0|T4 appends logs from S1| logLen:                                                                               
93[AppendEntry]                                                                                                   
                                                                             S2|T4 save persist| votedFor: 1|     
                                                                             logsLen: 93                          
                                                                             S2|T4 appends logs from S1| logLen:  
                                                                             93[AppendEntry]                      
S0|T4 starts to apply entries                                                                                     
[92:92][ApplyEntry]                                                                                               
S0|T4 finishes applying entries                                                                                   
[92:92][ApplyEntry]                                                                                               
                                                                             S2|T4 starts to apply entries        
                                                                             [90:92][ApplyEntry]                  
                                                                             S2|T4 finishes applying entries      
                                                                             [90:92][ApplyEntry]                  
                                       S1|T4 replica entries to S0|                                               
                                       entrylen:0| matchidx:92| nextidx:93                                        
                                       S1|T4 replica entries to S2|                                               
                                       entrylen:3| matchidx:92| nextidx:93                                        
                                                                             S2|T4 is not leader                  
S0|T4 is not leader                                                                                               
S0|T4 save persist| votedFor: 0|                                                                                  
logsLen: 93                                                                                                       
S0|T4 appends logs from S1| logLen:                                                                               
93[AppendEntry]                                                                                                   
                                                                             S2|T4 save persist| votedFor: 1|     
                                                                             logsLen: 93                          
                                                                             S2|T4 appends logs from S1| logLen:  
                                                                             93[AppendEntry]                      
                                       S1|T4 replica entries to S0|                                               
                                       entrylen:0| matchidx:92| nextidx:93                                        
                                       S1|T4 replica entries to S2|                                               
                                       entrylen:0| matchidx:92| nextidx:93                                        
                                       S1|T4 fails to install snapshot to S0                                      
                                                                             S2|T4 is not leader                  
S0|T4 is not leader                                                                                               
S0|T4 save persist| votedFor: 0|                                                                                  
logsLen: 93                                                                                                       
                                                                             S2|T4 save persist| votedFor: 1|     
                                                                             logsLen: 93                          
                                                                             S2|T4 appends logs from S1| logLen:  
                                                                             93[AppendEntry]                      
S0|T4 appends logs from S1| logLen:                                                                               
93[AppendEntry]                                                                                                   
                                       S1|T4 replica entries to S2|                                               
                                       entrylen:0| matchidx:92| nextidx:93                                        
                                       S1|T4 replica entries to S0|                                               
                                       entrylen:0| matchidx:92| nextidx:93                                        
                                                                             S2|T4 is not leader                  
S0|T4 is not leader                                                                                               
                                                                             S2|T4 save persist| votedFor: 1|     
                                                                             logsLen: 93                          
S0|T4 save persist| votedFor: 0|                                                                                  
logsLen: 93                                                                                                       
S0|T4 appends logs from S1| logLen:                                                                               
93[AppendEntry]                                                                                                   
                                                                             S2|T4 appends logs from S1| logLen:  
                                                                             93[AppendEntry]                      
                                       S1|T4 replica entries to S2|                                               
                                       entrylen:0| matchidx:92| nextidx:93                                        
                                       S1|T4 replica entries to S0|                                               
                                       entrylen:0| matchidx:92| nextidx:93                                        
S0|T4 is not leader                                                                                               
                                                                             S2|T4 is not leader                  
S0|T4 save persist| votedFor: 0|                                                                                  
logsLen: 93                                                                                                       
                                                                             S2|T4 save persist| votedFor: 1|     
                                                                             logsLen: 93                          
S0|T4 appends logs from S1| logLen:                                                                               
93[AppendEntry]                                                                                                   
                                                                             S2|T4 appends logs from S1| logLen:  
                                                                             93[AppendEntry]                      
                                       S1|T4 replica entries to S0|                                               
                                       entrylen:0| matchidx:92| nextidx:93                                        
                                       S1|T4 replica entries to S2|                                               
                                       entrylen:0| matchidx:92| nextidx:93                                        
S0|T4 is not leader                                                                                               
                                                                             S2|T4 is not leader                  
S0|T4 save persist| votedFor: 0|                                                                                  
logsLen: 93                                                                                                       
                                                                             S2|T4 save persist| votedFor: 1|     
                                                                             logsLen: 93                          
S0|T4 appends logs from S1| logLen:                                                                               
93[AppendEntry]                                                                                                   
                                                                             S2|T4 appends logs from S1| logLen:  
                                                                             93[AppendEntry]                      
                                       S1|T4 replica entries to S2|                                               
                                       entrylen:0| matchidx:92| nextidx:93                                        
                                       S1|T4 replica entries to S0|                                               
                                       entrylen:0| matchidx:92| nextidx:93                                        
                                                                             S2 is disconnected                   
                                       S1|T4 save persist| votedFor: 1|                                           
                                       logsLen: 94                                                                
                                       S1|T4 receive commands | logLen:                                           
                                       94[Start]                                                                  
                                                                             S2|T4 is not leader                  
S0|T4 is not leader                                                                                               
S0|T4 save persist| votedFor: 0|                                                                                  
logsLen: 94                                                                                                       
S0|T4 appends logs from S1| logLen:                                                                               
94[AppendEntry]                                                                                                   
                                       S1|T4 replica entries to S0|                                               
                                       entrylen:1| matchidx:93| nextidx:94                                        
                                       S1|T4 update commitIndex as 93                                             
                                       S1|T4 starts to apply entries                                              
                                       [93:93][ApplyEntry]                                                        
                                       S1|T4 finishes applying entries                                            
                                       [93:93][ApplyEntry]                                                        
                                                                             S2|T4 is not leader                  
S0|T4 is not leader                                                                                               
S0|T4 save persist| votedFor: 0|                                                                                  
logsLen: 94                                                                                                       
S0|T4 appends logs from S1| logLen:                                                                               
94[AppendEntry]                                                                                                   
S0|T4 starts to apply entries                                                                                     
[93:93][ApplyEntry]                                                                                               
S0|T4 finishes applying entries                                                                                   
[93:93][ApplyEntry]                                                                                               
                                       S1|T4 replica entries to S0|                                               
                                       entrylen:0| matchidx:93| nextidx:94                                        
                                       S1|T4 save persist| votedFor: 1|                                           
                                       logsLen: 95                                                                
                                       S1|T4 receive commands | logLen:                                           
                                       95[Start]                                                                  
                                       S1|T4 save persist| votedFor: 1|                                           
                                       logsLen: 96                                                                
                                       S1|T4 receive commands | logLen:                                           
                                       96[Start]                                                                  
                                       S1|T4 save persist| votedFor: 1|                                           
                                       logsLen: 97                                                                
                                       S1|T4 receive commands | logLen:                                           
                                       97[Start]                                                                  
                                       S1|T4 save persist| votedFor: 1|                                           
                                       logsLen: 98                                                                
                                       S1|T4 receive commands | logLen:                                           
                                       98[Start]                                                                  
                                       S1|T4 save persist| votedFor: 1|                                           
                                       logsLen: 99                                                                
                                       S1|T4 receive commands | logLen:                                           
                                       99[Start]                                                                  
                                       S1|T4 save persist| votedFor: 1|                                           
                                       logsLen: 100                                                               
                                       S1|T4 receive commands | logLen:                                           
                                       100[Start]                                                                 
                                       S1|T4 save persist| votedFor: 1|                                           
                                       logsLen: 101                                                               
                                       S1|T4 receive commands | logLen:                                           
                                       101[Start]                                                                 
                                       S1|T4 save persist| votedFor: 1|                                           
                                       logsLen: 102                                                               
                                       S1|T4 receive commands | logLen:                                           
                                       102[Start]                                                                 
                                       S1|T4 save persist| votedFor: 1|                                           
                                       logsLen: 103                                                               
                                       S1|T4 receive commands | logLen:                                           
                                       103[Start]                                                                 
                                       S1|T4 save persist| votedFor: 1|                                           
                                       logsLen: 104                                                               
                                       S1|T4 receive commands | logLen:                                           
                                       104[Start]                                                                 
                                       S1|T4 save persist| votedFor: 1|                                           
                                       logsLen: 105                                                               
                                       S1|T4 receive commands | logLen:                                           
                                       105[Start]                                                                 
                                       S1|T4 save persist| votedFor: 1|                                           
                                       logsLen: 106                                                               
                                       S1|T4 receive commands | logLen:                                           
                                       106[Start]                                                                 
                                       S1|T4 save persist| votedFor: 1|                                           
                                       logsLen: 107                                                               
                                       S1|T4 receive commands | logLen:                                           
                                       107[Start]                                                                 
                                       S1|T4 save persist| votedFor: 1|                                           
                                       logsLen: 108                                                               
                                       S1|T4 receive commands | logLen:                                           
                                       108[Start]                                                                 
S0|T4 is not leader                                                                                               
                                                                             S2|T4 is not leader                  
S0|T4 save persist| votedFor: 0|                                                                                  
logsLen: 108                                                                                                      
S0|T4 appends logs from S1| logLen:                                                                               
108[AppendEntry]                                                                                                  
                                       S1|T4 replica entries to S0|                                               
                                       entrylen:14| matchidx:107|                                                 
                                       nextidx:108                                                                
                                       S1|T4 update commitIndex as 107                                            
                                       S1|T4 starts to apply entries                                              
                                       [94:107][ApplyEntry]                                                       
                                       S1|T4 Snapshot until index 99|                                             
                                       logLen: 108                                                                
                                       S1|T4 finishes applying entries                                            
                                       [94:107][ApplyEntry]                                                       
S0|T4 is not leader                                                                                               
                                       S1|T4 send rpc to S2|base: 99| next:                                       
                                       93                                                                         
                                                                             S2|T4 is not leader                  
S0|T4 save persist| votedFor: 0|                                                                                  
logsLen: 108                                                                                                      
S0|T4 appends logs from S1| logLen:                                                                               
108[AppendEntry]                                                                                                  
S0|T4 starts to apply entries                                                                                     
[94:107][ApplyEntry]                                                                                              
                                       S1|T4 replica entries to S0|                                               
                                       entrylen:0| matchidx:107| nextidx:108                                      
S0|T4 Snapshot until index 99| logLen:                                                                            
108                                                                                                               
S0|T4 finishes applying entries                                                                                   
[94:107][ApplyEntry]                                                                                              
                                                                             S2 is connected again                
                                       S1|T4 save persist| votedFor: 1|                                           
                                       logsLen: 109                                                               
                                       S1|T4 receive commands | logLen:                                           
                                       109[Start]                                                                 
                                                                             S2|T4 is not leader                  
S0|T4 is not leader                                                                                               
                                       S1|T4 send rpc to S2|base: 99| next:                                       
                                       93                                                                         
                                                                             S2|T4 receive rpc from S1            
                                                                             S2|T4 update rfstate| Base:99|       
                                                                             LogLen:100                           
S0|T4 save persist| votedFor: 0|                                                                                  
logsLen: 109                                                                                                      
S0|T4 appends logs from S1| logLen:                                                                               
109[AppendEntry]                                                                                                  
                                                                             S2|T4 applys snapshot from S1        
                                       S1|T4 installs snapshot to S2|                                             
                                       nextId:100| matchId:99                                                     
                                       S1|T4 replica entries to S0|                                               
                                       entrylen:1| matchidx:108| nextidx:109                                      
                                       S1|T4 update commitIndex as 108                                            
                                       S1|T4 starts to apply entries                                              
                                       [108:108][ApplyEntry]                                                      
                                       S1|T4 finishes applying entries                                            
                                       [108:108][ApplyEntry]                                                      
                                                                             S2|T4 is not leader                  
S0|T4 is not leader                                                                                               
S0|T4 save persist| votedFor: 0|                                                                                  
logsLen: 109                                                                                                      
S0|T4 appends logs from S1| logLen:                                                                               
109[AppendEntry]                                                                                                  
S0|T4 starts to apply entries                                                                                     
[108:108][ApplyEntry]                                                                                             
S0|T4 finishes applying entries                                                                                   
[108:108][ApplyEntry]                                                                                             
                                       S1|T4 replica entries to S0|                                               
                                       entrylen:0| matchidx:108| nextidx:109                                      
                                                                             S2|T4 save persist| votedFor: 1|     
                                                                             logsLen: 109                         
                                                                             S2|T4 appends logs from S1| logLen:  
                                                                             109[AppendEntry]                     
                                                                             S2|T4 starts to apply entries        
                                                                             [100:108][ApplyEntry]                
                                                                             S2|T4 finishes applying entries      
                                                                             [100:108][ApplyEntry]                
                                       S1|T4 replica entries to S2|                                               
                                       entrylen:9| matchidx:108| nextidx:109                                      
                                                                             S2|T4 is not leader                  
S0|T4 is not leader                                                                                               
                                                                             S2|T4 save persist| votedFor: 1|     
                                                                             logsLen: 109                         
                                                                             S2|T4 appends logs from S1| logLen:  
                                                                             109[AppendEntry]                     
S0|T4 save persist| votedFor: 0|                                                                                  
logsLen: 109                                                                                                      
S0|T4 appends logs from S1| logLen:                                                                               
109[AppendEntry]                                                                                                  
                                       S1|T4 replica entries to S2|                                               
                                       entrylen:0| matchidx:108| nextidx:109                                      
                                       S1|T4 replica entries to S0|                                               
                                       entrylen:0| matchidx:108| nextidx:109                                      
                                                                             S2|T4 is not leader                  
S0|T4 is not leader                                                                                               
                                                                             S2|T4 save persist| votedFor: 1|     
                                                                             logsLen: 109                         
                                                                             S2|T4 appends logs from S1| logLen:  
                                                                             109[AppendEntry]                     
S0|T4 save persist| votedFor: 0|                                                                                  
logsLen: 109                                                                                                      
S0|T4 appends logs from S1| logLen:                                                                               
109[AppendEntry]                                                                                                  
                                       S1|T4 replica entries to S2|                                               
                                       entrylen:0| matchidx:108| nextidx:109                                      
                                       S1|T4 replica entries to S0|                                               
                                       entrylen:0| matchidx:108| nextidx:109                                      
                                                                             S2|T4 is not leader                  
S0|T4 is not leader                                                                                               
                                                                             S2|T4 save persist| votedFor: 1|     
                                                                             logsLen: 109                         
S0|T4 save persist| votedFor: 0|                                                                                  
logsLen: 109                                                                                                      
S0|T4 appends logs from S1| logLen:                                                                               
109[AppendEntry]                                                                                                  
                                                                             S2|T4 appends logs from S1| logLen:  
                                                                             109[AppendEntry]                     
                                       S1|T4 replica entries to S2|                                               
                                       entrylen:0| matchidx:108| nextidx:109                                      
                                       S1|T4 replica entries to S0|                                               
                                       entrylen:0| matchidx:108| nextidx:109                                      
                                                                             S2|T4 is not leader                  
S0|T4 is not leader                                                                                               
                                                                             S2|T4 save persist| votedFor: 1|     
                                                                             logsLen: 109                         
S0|T4 save persist| votedFor: 0|                                                                                  
logsLen: 109                                                                                                      
                                                                             S2|T4 appends logs from S1| logLen:  
                                                                             109[AppendEntry]                     
S0|T4 appends logs from S1| logLen:                                                                               
109[AppendEntry]                                                                                                  
                                       S1|T4 replica entries to S0|                                               
                                       entrylen:0| matchidx:108| nextidx:109                                      
                                       S1|T4 replica entries to S2|                                               
                                       entrylen:0| matchidx:108| nextidx:109                                      
                                       S1 is disconnected                                                         
S0|T4 is not leader                                                                                               
                                                                             S2|T4 is not leader                  
S0|T4 is not leader                                                                                               
                                                                             S2|T4 is not leader                  
S0|T4 is not leader                                                                                               
                                                                             S2|T4 is not leader                  
S0|T4 is not leader                                                                                               
                                                                             S2|T4 is not leader                  
                                                                             S2|T4 is not leader                  
S0|T4 is not leader                                                                                               
                                                                             S2|T4 is not leader                  
S0|T4 is not leader                                                                                               
S0|T5 starts to join election                                                                                     
S0|T5 save persist| votedFor: 0|                                                                                  
logsLen: 109                                                                                                      
                                                                             S2|T5 save persist| votedFor: -1|    
                                                                             logsLen: 109                         
                                                                             S2|T5 save persist| votedFor: 0|     
                                                                             logsLen: 109                         
                                                                             S2|T5 votes for S0[RequestVote]      
S0|T5 becomes the leader, and starts                                                                              
heatbeats                                                                                                         
                                                                             S2|T5 save persist| votedFor: 0|     
                                                                             logsLen: 109                         
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             109[AppendEntry]                     
S0|T5 replica entries to S2|                                                                                      
entrylen:0| matchidx:108| nextidx:109                                                                             
S0|T5 save persist| votedFor: 0|                                                                                  
logsLen: 110                                                                                                      
S0|T5 receive commands | logLen:                                                                                  
110[Start]                                                                                                        
                                                                             S2|T5 is not leader                  
                                                                             S2|T5 save persist| votedFor: 0|     
                                                                             logsLen: 110                         
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             110[AppendEntry]                     
S0|T5 replica entries to S2|                                                                                      
entrylen:1| matchidx:109| nextidx:110                                                                             
S0|T5 update commitIndex as 109                                                                                   
S0|T5 starts to apply entries                                                                                     
[109:109][ApplyEntry]                                                                                             
S0|T5 finishes applying entries                                                                                   
[109:109][ApplyEntry]                                                                                             
S0|T5 Snapshot until index 109|                                                                                   
logLen: 110                                                                                                       
                                       S1|T4 fails to install snapshot to S2                                      
                                                                             S2|T5 is not leader                  
S0|T5 send rpc to S1|base: 109| next:                                                                             
109                                                                                                               
                                                                             S2|T5 save persist| votedFor: 0|     
                                                                             logsLen: 110                         
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             110[AppendEntry]                     
                                                                             S2|T5 starts to apply entries        
                                                                             [109:109][ApplyEntry]                
                                                                             S2|T5 finishes applying entries      
                                                                             [109:109][ApplyEntry]                
S0|T5 replica entries to S2|                                                                                      
entrylen:0| matchidx:109| nextidx:110                                                                             
                                                                             S2|T5 Snapshot until index 109|      
                                                                             logLen: 110                          
S0|T5 save persist| votedFor: 0|                                                                                  
logsLen: 111                                                                                                      
S0|T5 receive commands | logLen:                                                                                  
111[Start]                                                                                                        
                                                                             S2|T5 is not leader                  
S0|T5 send rpc to S1|base: 109| next:                                                                             
109                                                                                                               
                                                                             S2|T5 save persist| votedFor: 0|     
                                                                             logsLen: 111                         
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             111[AppendEntry]                     
S0|T5 replica entries to S2|                                                                                      
entrylen:1| matchidx:110| nextidx:111                                                                             
S0|T5 update commitIndex as 110                                                                                   
S0|T5 starts to apply entries                                                                                     
[110:110][ApplyEntry]                                                                                             
S0|T5 finishes applying entries                                                                                   
[110:110][ApplyEntry]                                                                                             
                                                                             S2|T5 is not leader                  
S0|T5 send rpc to S1|base: 109| next:                                                                             
109                                                                                                               
                                                                             S2|T5 save persist| votedFor: 0|     
                                                                             logsLen: 111                         
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             111[AppendEntry]                     
                                                                             S2|T5 starts to apply entries        
                                                                             [110:110][ApplyEntry]                
                                                                             S2|T5 finishes applying entries      
                                                                             [110:110][ApplyEntry]                
S0|T5 replica entries to S2|                                                                                      
entrylen:0| matchidx:110| nextidx:111                                                                             
                                       S1 is connected again                                                      
                                       S1|T4 save persist| votedFor: 1|                                           
                                       logsLen: 110                                                               
                                       S1|T4 receive commands | logLen:                                           
                                       110[Start]                                                                 
                                                                             S2|T5 is not leader                  
S0|T5 send rpc to S1|base: 109| next:                                                                             
109                                                                                                               
                                                                             S2|T5 rejects to append entries from 
                                                                             S1 | out of date term[AppendEntry]   
S0|T5 rejects to append entries from                                                                              
S1 | out of date term[AppendEntry]                                                                                
                                       S1|T4 receive rpc from S0                                                  
                                                                             S2|T5 save persist| votedFor: 0|     
                                                                             logsLen: 111                         
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             111[AppendEntry]                     
                                       S1|T5 save persist| votedFor: 1|                                           
                                       logsLen: 110                                                               
                                       S1|T5 update rfstate| Base:109|                                            
                                       LogLen:110                                                                 
S0|T5 replica entries to S2|                                                                                      
entrylen:0| matchidx:110| nextidx:111                                                                             
                                       S1|T5 lost leadership, state: 0                                            
                                       S1|T5 applys snapshot from S0                                              
                                       S1|T5 lost leadership, state: 0                                            
S0|T5 installs snapshot to S1|                                                                                    
nextId:110| matchId:109                                                                                           
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 is not leader                  
                                       S1|T5 save persist| votedFor: 1|                                           
                                       logsLen: 111                                                               
                                                                             S2|T5 save persist| votedFor: 0|     
                                                                             logsLen: 111                         
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             111[AppendEntry]                     
                                       S1|T5 appends logs from S0| logLen:                                        
                                       111[AppendEntry]                                                           
                                       S1|T5 starts to apply entries                                              
                                       [110:110][ApplyEntry]                                                      
                                       S1|T5 finishes applying entries                                            
                                       [110:110][ApplyEntry]                                                      
S0|T5 replica entries to S2|                                                                                      
entrylen:0| matchidx:110| nextidx:111                                                                             
S0|T5 replica entries to S1|                                                                                      
entrylen:1| matchidx:110| nextidx:111                                                                             
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 is not leader                  
                                       S1|T5 save persist| votedFor: 1|                                           
                                       logsLen: 111                                                               
                                       S1|T5 appends logs from S0| logLen:                                        
                                       111[AppendEntry]                                                           
                                                                             S2|T5 save persist| votedFor: 0|     
                                                                             logsLen: 111                         
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             111[AppendEntry]                     
S0|T5 replica entries to S1|                                                                                      
entrylen:0| matchidx:110| nextidx:111                                                                             
S0|T5 replica entries to S2|                                                                                      
entrylen:0| matchidx:110| nextidx:111                                                                             
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 is not leader                  
                                                                             S2|T5 save persist| votedFor: 0|     
                                                                             logsLen: 111                         
                                       S1|T5 save persist| votedFor: 1|                                           
                                       logsLen: 111                                                               
                                       S1|T5 appends logs from S0| logLen:                                        
                                       111[AppendEntry]                                                           
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             111[AppendEntry]                     
S0|T5 replica entries to S2|                                                                                      
entrylen:0| matchidx:110| nextidx:111                                                                             
S0|T5 replica entries to S1|                                                                                      
entrylen:0| matchidx:110| nextidx:111                                                                             
                                       S1|T5 fails to install snapshot to S2                                      
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 is not leader                  
                                                                             S2|T5 save persist| votedFor: 0|     
                                                                             logsLen: 111                         
                                       S1|T5 save persist| votedFor: 1|                                           
                                       logsLen: 111                                                               
                                       S1|T5 appends logs from S0| logLen:                                        
                                       111[AppendEntry]                                                           
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             111[AppendEntry]                     
S0|T5 replica entries to S2|                                                                                      
entrylen:0| matchidx:110| nextidx:111                                                                             
S0|T5 replica entries to S1|                                                                                      
entrylen:0| matchidx:110| nextidx:111                                                                             
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 is not leader                  
                                                                             S2|T5 save persist| votedFor: 0|     
                                                                             logsLen: 111                         
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             111[AppendEntry]                     
                                       S1|T5 save persist| votedFor: 1|                                           
                                       logsLen: 111                                                               
                                       S1|T5 appends logs from S0| logLen:                                        
                                       111[AppendEntry]                                                           
S0|T5 replica entries to S2|                                                                                      
entrylen:0| matchidx:110| nextidx:111                                                                             
S0|T5 replica entries to S1|                                                                                      
entrylen:0| matchidx:110| nextidx:111                                                                             
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 is not leader                  
                                                                             S2|T5 save persist| votedFor: 0|     
                                                                             logsLen: 111                         
                                       S1|T5 save persist| votedFor: 1|                                           
                                       logsLen: 111                                                               
                                       S1|T5 appends logs from S0| logLen:                                        
                                       111[AppendEntry]                                                           
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             111[AppendEntry]                     
S0|T5 replica entries to S1|                                                                                      
entrylen:0| matchidx:110| nextidx:111                                                                             
S0|T5 replica entries to S2|                                                                                      
entrylen:0| matchidx:110| nextidx:111                                                                             
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 is not leader                  
                                       S1|T5 save persist| votedFor: 1|                                           
                                       logsLen: 111                                                               
                                       S1|T5 appends logs from S0| logLen:                                        
                                       111[AppendEntry]                                                           
                                                                             S2|T5 save persist| votedFor: 0|     
                                                                             logsLen: 111                         
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             111[AppendEntry]                     
S0|T5 replica entries to S1|                                                                                      
entrylen:0| matchidx:110| nextidx:111                                                                             
S0|T5 replica entries to S2|                                                                                      
entrylen:0| matchidx:110| nextidx:111                                                                             
                                                                             S2|T5 is not leader                  
                                       S1|T5 is not leader                                                        
                                       S1|T5 save persist| votedFor: 1|                                           
                                       logsLen: 111                                                               
                                                                             S2|T5 save persist| votedFor: 0|     
                                                                             logsLen: 111                         
                                       S1|T5 appends logs from S0| logLen:                                        
                                       111[AppendEntry]                                                           
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             111[AppendEntry]                     
S0|T5 replica entries to S1|                                                                                      
entrylen:0| matchidx:110| nextidx:111                                                                             
S0|T5 replica entries to S2|                                                                                      
entrylen:0| matchidx:110| nextidx:111                                                                             
                                                                             S2|T5 is not leader                  
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 save persist| votedFor: 0|     
                                                                             logsLen: 111                         
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             111[AppendEntry]                     
                                       S1|T5 save persist| votedFor: 1|                                           
                                       logsLen: 111                                                               
                                       S1|T5 appends logs from S0| logLen:                                        
                                       111[AppendEntry]                                                           
S0|T5 replica entries to S1|                                                                                      
entrylen:0| matchidx:110| nextidx:111                                                                             
S0|T5 replica entries to S2|                                                                                      
entrylen:0| matchidx:110| nextidx:111                                                                             
                                       S1|T5 fails to install snapshot to S0                                      
                                                                             S2|T5 is not leader                  
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 save persist| votedFor: 0|     
                                                                             logsLen: 111                         
                                       S1|T5 save persist| votedFor: 1|                                           
                                       logsLen: 111                                                               
                                       S1|T5 appends logs from S0| logLen:                                        
                                       111[AppendEntry]                                                           
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             111[AppendEntry]                     
S0|T5 replica entries to S2|                                                                                      
entrylen:0| matchidx:110| nextidx:111                                                                             
S0|T5 replica entries to S1|                                                                                      
entrylen:0| matchidx:110| nextidx:111                                                                             
                                                                             S2|T5 is not leader                  
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 save persist| votedFor: 0|     
                                                                             logsLen: 111                         
                                       S1|T5 save persist| votedFor: 1|                                           
                                       logsLen: 111                                                               
                                       S1|T5 appends logs from S0| logLen:                                        
                                       111[AppendEntry]                                                           
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             111[AppendEntry]                     
S0|T5 replica entries to S1|                                                                                      
entrylen:0| matchidx:110| nextidx:111                                                                             
S0|T5 replica entries to S2|                                                                                      
entrylen:0| matchidx:110| nextidx:111                                                                             
S0|T5 fails to install snapshot to S1                                                                             
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 is not leader                  
                                                                             S2|T5 save persist| votedFor: 0|     
                                                                             logsLen: 111                         
                                       S1|T5 save persist| votedFor: 1|                                           
                                       logsLen: 111                                                               
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             111[AppendEntry]                     
                                       S1|T5 appends logs from S0| logLen:                                        
                                       111[AppendEntry]                                                           
S0|T5 replica entries to S2|                                                                                      
entrylen:0| matchidx:110| nextidx:111                                                                             
S0|T5 replica entries to S1|                                                                                      
entrylen:0| matchidx:110| nextidx:111                                                                             
S0|T5 fails to install snapshot to S1                                                                             
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 is not leader                  
                                                                             S2|T5 save persist| votedFor: 0|     
                                                                             logsLen: 111                         
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             111[AppendEntry]                     
                                       S1|T5 save persist| votedFor: 1|                                           
                                       logsLen: 111                                                               
                                       S1|T5 appends logs from S0| logLen:                                        
                                       111[AppendEntry]                                                           
S0|T5 replica entries to S2|                                                                                      
entrylen:0| matchidx:110| nextidx:111                                                                             
S0|T5 replica entries to S1|                                                                                      
entrylen:0| matchidx:110| nextidx:111                                                                             
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 is not leader                  
                                                                             S2|T5 save persist| votedFor: 0|     
                                                                             logsLen: 111                         
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             111[AppendEntry]                     
                                       S1|T5 save persist| votedFor: 1|                                           
                                       logsLen: 111                                                               
                                       S1|T5 appends logs from S0| logLen:                                        
                                       111[AppendEntry]                                                           
S0|T5 replica entries to S2|                                                                                      
entrylen:0| matchidx:110| nextidx:111                                                                             
S0|T5 replica entries to S1|                                                                                      
entrylen:0| matchidx:110| nextidx:111                                                                             
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 is not leader                  
                                                                             S2|T5 save persist| votedFor: 0|     
                                                                             logsLen: 111                         
                                       S1|T5 save persist| votedFor: 1|                                           
                                       logsLen: 111                                                               
                                       S1|T5 appends logs from S0| logLen:                                        
                                       111[AppendEntry]                                                           
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             111[AppendEntry]                     
S0|T5 replica entries to S1|                                                                                      
entrylen:0| matchidx:110| nextidx:111                                                                             
S0|T5 replica entries to S2|                                                                                      
entrylen:0| matchidx:110| nextidx:111                                                                             
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 is not leader                  
                                                                             S2|T5 save persist| votedFor: 0|     
                                                                             logsLen: 111                         
                                       S1|T5 save persist| votedFor: 1|                                           
                                       logsLen: 111                                                               
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             111[AppendEntry]                     
                                       S1|T5 appends logs from S0| logLen:                                        
                                       111[AppendEntry]                                                           
S0|T5 replica entries to S2|                                                                                      
entrylen:0| matchidx:110| nextidx:111                                                                             
S0|T5 replica entries to S1|                                                                                      
entrylen:0| matchidx:110| nextidx:111                                                                             
S0|T5 fails to install snapshot to S1                                                                             
                                                                             S2|T5 is not leader                  
                                       S1|T5 is not leader                                                        
                                       S1|T5 save persist| votedFor: 1|                                           
                                       logsLen: 111                                                               
                                       S1|T5 appends logs from S0| logLen:                                        
                                       111[AppendEntry]                                                           
                                                                             S2|T5 save persist| votedFor: 0|     
                                                                             logsLen: 111                         
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             111[AppendEntry]                     
S0|T5 replica entries to S1|                                                                                      
entrylen:0| matchidx:110| nextidx:111                                                                             
S0|T5 replica entries to S2|                                                                                      
entrylen:0| matchidx:110| nextidx:111                                                                             
                                                                             S2|T5 is not leader                  
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 save persist| votedFor: 0|     
                                                                             logsLen: 111                         
                                       S1|T5 save persist| votedFor: 1|                                           
                                       logsLen: 111                                                               
                                       S1|T5 appends logs from S0| logLen:                                        
                                       111[AppendEntry]                                                           
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             111[AppendEntry]                     
S0|T5 replica entries to S1|                                                                                      
entrylen:0| matchidx:110| nextidx:111                                                                             
S0|T5 replica entries to S2|                                                                                      
entrylen:0| matchidx:110| nextidx:111                                                                             
                                                                             S2|T5 is not leader                  
                                       S1|T5 is not leader                                                        
S0|T5 save persist| votedFor: 0|                                                                                  
logsLen: 112                                                                                                      
S0|T5 receive commands | logLen:                                                                                  
112[Start]                                                                                                        
                                       S1|T5 save persist| votedFor: 1|                                           
                                       logsLen: 112                                                               
                                       S1|T5 appends logs from S0| logLen:                                        
                                       112[AppendEntry]                                                           
                                                                             S2|T5 save persist| votedFor: 0|     
                                                                             logsLen: 112                         
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             112[AppendEntry]                     
S0|T5 replica entries to S1|                                                                                      
entrylen:1| matchidx:111| nextidx:112                                                                             
S0|T5 update commitIndex as 111                                                                                   
S0|T5 starts to apply entries                                                                                     
[111:111][ApplyEntry]                                                                                             
S0|T5 finishes applying entries                                                                                   
[111:111][ApplyEntry]                                                                                             
S0|T5 replica entries to S2|                                                                                      
entrylen:1| matchidx:111| nextidx:112                                                                             
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 is not leader                  
                                       S1|T5 save persist| votedFor: 1|                                           
                                       logsLen: 112                                                               
                                       S1|T5 appends logs from S0| logLen:                                        
                                       112[AppendEntry]                                                           
                                                                             S2|T5 save persist| votedFor: 0|     
                                                                             logsLen: 112                         
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             112[AppendEntry]                     
                                       S1|T5 starts to apply entries                                              
                                       [111:111][ApplyEntry]                                                      
                                       S1|T5 finishes applying entries                                            
                                       [111:111][ApplyEntry]                                                      
                                                                             S2|T5 starts to apply entries        
                                                                             [111:111][ApplyEntry]                
                                                                             S2|T5 finishes applying entries      
                                                                             [111:111][ApplyEntry]                
S0|T5 replica entries to S1|                                                                                      
entrylen:0| matchidx:111| nextidx:112                                                                             
S0|T5 replica entries to S2|                                                                                      
entrylen:0| matchidx:111| nextidx:112                                                                             
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 is not leader                  
                                       S1|T5 save persist| votedFor: 1|                                           
                                       logsLen: 112                                                               
                                                                             S2|T5 save persist| votedFor: 0|     
                                                                             logsLen: 112                         
                                       S1|T5 appends logs from S0| logLen:                                        
                                       112[AppendEntry]                                                           
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             112[AppendEntry]                     
S0|T5 replica entries to S1|                                                                                      
entrylen:0| matchidx:111| nextidx:112                                                                             
S0|T5 replica entries to S2|                                                                                      
entrylen:0| matchidx:111| nextidx:112                                                                             
                                                                             S2|T5 is not leader                  
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 save persist| votedFor: 0|     
                                                                             logsLen: 112                         
                                       S1|T5 save persist| votedFor: 1|                                           
                                       logsLen: 112                                                               
                                       S1|T5 appends logs from S0| logLen:                                        
                                       112[AppendEntry]                                                           
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             112[AppendEntry]                     
S0|T5 replica entries to S1|                                                                                      
entrylen:0| matchidx:111| nextidx:112                                                                             
S0|T5 replica entries to S2|                                                                                      
entrylen:0| matchidx:111| nextidx:112                                                                             
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 is not leader                  
                                       S1|T5 save persist| votedFor: 1|                                           
                                       logsLen: 112                                                               
                                                                             S2|T5 save persist| votedFor: 0|     
                                                                             logsLen: 112                         
                                       S1|T5 appends logs from S0| logLen:                                        
                                       112[AppendEntry]                                                           
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             112[AppendEntry]                     
S0|T5 replica entries to S1|                                                                                      
entrylen:0| matchidx:111| nextidx:112                                                                             
S0|T5 replica entries to S2|                                                                                      
entrylen:0| matchidx:111| nextidx:112                                                                             
                                                                             S2|T5 is not leader                  
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 save persist| votedFor: 0|     
                                                                             logsLen: 112                         
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             112[AppendEntry]                     
                                       S1|T5 save persist| votedFor: 1|                                           
                                       logsLen: 112                                                               
                                       S1|T5 appends logs from S0| logLen:                                        
                                       112[AppendEntry]                                                           
S0|T5 replica entries to S2|                                                                                      
entrylen:0| matchidx:111| nextidx:112                                                                             
S0|T5 replica entries to S1|                                                                                      
entrylen:0| matchidx:111| nextidx:112                                                                             
                                       S1 is disconnected                                                         
S0|T5 save persist| votedFor: 0|                                                                                  
logsLen: 113                                                                                                      
S0|T5 receive commands | logLen:                                                                                  
113[Start]                                                                                                        
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 is not leader                  
                                                                             S2|T5 save persist| votedFor: 0|     
                                                                             logsLen: 113                         
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             113[AppendEntry]                     
S0|T5 replica entries to S2|                                                                                      
entrylen:1| matchidx:112| nextidx:113                                                                             
S0|T5 update commitIndex as 112                                                                                   
S0|T5 starts to apply entries                                                                                     
[112:112][ApplyEntry]                                                                                             
S0|T5 finishes applying entries                                                                                   
[112:112][ApplyEntry]                                                                                             
                                                                             S2|T5 is not leader                  
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 save persist| votedFor: 0|     
                                                                             logsLen: 113                         
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             113[AppendEntry]                     
                                                                             S2|T5 starts to apply entries        
                                                                             [112:112][ApplyEntry]                
                                                                             S2|T5 finishes applying entries      
                                                                             [112:112][ApplyEntry]                
S0|T5 replica entries to S2|                                                                                      
entrylen:0| matchidx:112| nextidx:113                                                                             
S0|T5 fails to install snapshot to S1                                                                             
S0|T5 save persist| votedFor: 0|                                                                                  
logsLen: 114                                                                                                      
S0|T5 receive commands | logLen:                                                                                  
114[Start]                                                                                                        
S0|T5 save persist| votedFor: 0|                                                                                  
logsLen: 115                                                                                                      
S0|T5 receive commands | logLen:                                                                                  
115[Start]                                                                                                        
S0|T5 save persist| votedFor: 0|                                                                                  
logsLen: 116                                                                                                      
S0|T5 receive commands | logLen:                                                                                  
116[Start]                                                                                                        
S0|T5 save persist| votedFor: 0|                                                                                  
logsLen: 117                                                                                                      
S0|T5 receive commands | logLen:                                                                                  
117[Start]                                                                                                        
S0|T5 save persist| votedFor: 0|                                                                                  
logsLen: 118                                                                                                      
S0|T5 receive commands | logLen:                                                                                  
118[Start]                                                                                                        
S0|T5 save persist| votedFor: 0|                                                                                  
logsLen: 119                                                                                                      
S0|T5 receive commands | logLen:                                                                                  
119[Start]                                                                                                        
                                                                             S2|T5 is not leader                  
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 save persist| votedFor: 0|     
                                                                             logsLen: 119                         
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             119[AppendEntry]                     
S0|T5 replica entries to S2|                                                                                      
entrylen:6| matchidx:118| nextidx:119                                                                             
S0|T5 update commitIndex as 118                                                                                   
S0|T5 starts to apply entries                                                                                     
[113:118][ApplyEntry]                                                                                             
S0|T5 finishes applying entries                                                                                   
[113:118][ApplyEntry]                                                                                             
                                                                             S2|T5 is not leader                  
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 save persist| votedFor: 0|     
                                                                             logsLen: 119                         
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             119[AppendEntry]                     
                                                                             S2|T5 starts to apply entries        
                                                                             [113:118][ApplyEntry]                
                                                                             S2|T5 finishes applying entries      
                                                                             [113:118][ApplyEntry]                
S0|T5 replica entries to S2|                                                                                      
entrylen:0| matchidx:118| nextidx:119                                                                             
                                       S1 is connected again                                                      
S0|T5 save persist| votedFor: 0|                                                                                  
logsLen: 120                                                                                                      
S0|T5 receive commands | logLen:                                                                                  
120[Start]                                                                                                        
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 is not leader                  
                                                                             S2|T5 save persist| votedFor: 0|     
                                                                             logsLen: 120                         
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             120[AppendEntry]                     
                                       S1|T5 save persist| votedFor: 1|                                           
                                       logsLen: 120                                                               
                                       S1|T5 appends logs from S0| logLen:                                        
                                       120[AppendEntry]                                                           
                                       S1|T5 starts to apply entries                                              
                                       [112:118][ApplyEntry]                                                      
S0|T5 replica entries to S2|                                                                                      
entrylen:1| matchidx:119| nextidx:120                                                                             
                                       S1|T5 finishes applying entries                                            
                                       [112:118][ApplyEntry]                                                      
S0|T5 update commitIndex as 119                                                                                   
S0|T5 starts to apply entries                                                                                     
[119:119][ApplyEntry]                                                                                             
S0|T5 finishes applying entries                                                                                   
[119:119][ApplyEntry]                                                                                             
S0|T5 replica entries to S1|                                                                                      
entrylen:8| matchidx:119| nextidx:120                                                                             
S0|T5 Snapshot until index 119|                                                                                   
logLen: 120                                                                                                       
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 is not leader                  
                                       S1|T5 save persist| votedFor: 1|                                           
                                       logsLen: 120                                                               
                                       S1|T5 appends logs from S0| logLen:                                        
                                       120[AppendEntry]                                                           
                                                                             S2|T5 save persist| votedFor: 0|     
                                                                             logsLen: 120                         
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             120[AppendEntry]                     
                                       S1|T5 starts to apply entries                                              
                                       [119:119][ApplyEntry]                                                      
                                       S1|T5 finishes applying entries                                            
                                       [119:119][ApplyEntry]                                                      
                                                                             S2|T5 starts to apply entries        
                                                                             [119:119][ApplyEntry]                
                                                                             S2|T5 finishes applying entries      
                                                                             [119:119][ApplyEntry]                
S0|T5 replica entries to S1|                                                                                      
entrylen:0| matchidx:119| nextidx:120                                                                             
S0|T5 replica entries to S2|                                                                                      
entrylen:0| matchidx:119| nextidx:120                                                                             
                                       S1|T5 Snapshot until index 119|                                            
                                       logLen: 120                                                                
                                                                             S2|T5 Snapshot until index 119|      
                                                                             logLen: 120                          
                                                                             S2|T5 is not leader                  
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 save persist| votedFor: 0|     
                                                                             logsLen: 120                         
                                       S1|T5 save persist| votedFor: 1|                                           
                                       logsLen: 120                                                               
                                       S1|T5 appends logs from S0| logLen:                                        
                                       120[AppendEntry]                                                           
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             120[AppendEntry]                     
S0|T5 replica entries to S2|                                                                                      
entrylen:0| matchidx:119| nextidx:120                                                                             
S0|T5 replica entries to S1|                                                                                      
entrylen:0| matchidx:119| nextidx:120                                                                             
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 is not leader                  
                                       S1|T5 save persist| votedFor: 1|                                           
                                       logsLen: 120                                                               
                                                                             S2|T5 save persist| votedFor: 0|     
                                                                             logsLen: 120                         
                                       S1|T5 appends logs from S0| logLen:                                        
                                       120[AppendEntry]                                                           
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             120[AppendEntry]                     
S0|T5 replica entries to S1|                                                                                      
entrylen:0| matchidx:119| nextidx:120                                                                             
S0|T5 replica entries to S2|                                                                                      
entrylen:0| matchidx:119| nextidx:120                                                                             
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 is not leader                  
                                                                             S2|T5 save persist| votedFor: 0|     
                                                                             logsLen: 120                         
                                       S1|T5 save persist| votedFor: 1|                                           
                                       logsLen: 120                                                               
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             120[AppendEntry]                     
                                       S1|T5 appends logs from S0| logLen:                                        
                                       120[AppendEntry]                                                           
S0|T5 replica entries to S2|                                                                                      
entrylen:0| matchidx:119| nextidx:120                                                                             
S0|T5 replica entries to S1|                                                                                      
entrylen:0| matchidx:119| nextidx:120                                                                             
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 is not leader                  
                                                                             S2|T5 save persist| votedFor: 0|     
                                                                             logsLen: 120                         
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             120[AppendEntry]                     
                                       S1|T5 save persist| votedFor: 1|                                           
                                       logsLen: 120                                                               
                                       S1|T5 appends logs from S0| logLen:                                        
                                       120[AppendEntry]                                                           
S0|T5 replica entries to S2|                                                                                      
entrylen:0| matchidx:119| nextidx:120                                                                             
S0|T5 replica entries to S1|                                                                                      
entrylen:0| matchidx:119| nextidx:120                                                                             
                                                                             S2|T5 is not leader                  
                                       S1|T5 is not leader                                                        
                                       S1|T5 save persist| votedFor: 1|                                           
                                       logsLen: 120                                                               
                                                                             S2|T5 save persist| votedFor: 0|     
                                                                             logsLen: 120                         
                                       S1|T5 appends logs from S0| logLen:                                        
                                       120[AppendEntry]                                                           
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             120[AppendEntry]                     
S0|T5 replica entries to S1|                                                                                      
entrylen:0| matchidx:119| nextidx:120                                                                             
S0|T5 replica entries to S2|                                                                                      
entrylen:0| matchidx:119| nextidx:120                                                                             
                                       S1 is disconnected                                                         
S0|T5 save persist| votedFor: 0|                                                                                  
logsLen: 121                                                                                                      
S0|T5 receive commands | logLen:                                                                                  
121[Start]                                                                                                        
                                                                             S2|T5 is not leader                  
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 save persist| votedFor: 0|     
                                                                             logsLen: 121                         
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             121[AppendEntry]                     
S0|T5 replica entries to S2|                                                                                      
entrylen:1| matchidx:120| nextidx:121                                                                             
S0|T5 update commitIndex as 120                                                                                   
S0|T5 starts to apply entries                                                                                     
[120:120][ApplyEntry]                                                                                             
S0|T5 finishes applying entries                                                                                   
[120:120][ApplyEntry]                                                                                             
                                       S1|T5 fails to install snapshot to S2                                      
                                                                             S2|T5 is not leader                  
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 save persist| votedFor: 0|     
                                                                             logsLen: 121                         
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             121[AppendEntry]                     
                                                                             S2|T5 starts to apply entries        
                                                                             [120:120][ApplyEntry]                
                                                                             S2|T5 finishes applying entries      
                                                                             [120:120][ApplyEntry]                
S0|T5 replica entries to S2|                                                                                      
entrylen:0| matchidx:120| nextidx:121                                                                             
S0|T5 save persist| votedFor: 0|                                                                                  
logsLen: 122                                                                                                      
S0|T5 receive commands | logLen:                                                                                  
122[Start]                                                                                                        
S0|T5 save persist| votedFor: 0|                                                                                  
logsLen: 123                                                                                                      
S0|T5 receive commands | logLen:                                                                                  
123[Start]                                                                                                        
S0|T5 save persist| votedFor: 0|                                                                                  
logsLen: 124                                                                                                      
S0|T5 receive commands | logLen:                                                                                  
124[Start]                                                                                                        
S0|T5 save persist| votedFor: 0|                                                                                  
logsLen: 125                                                                                                      
S0|T5 receive commands | logLen:                                                                                  
125[Start]                                                                                                        
S0|T5 save persist| votedFor: 0|                                                                                  
logsLen: 126                                                                                                      
S0|T5 receive commands | logLen:                                                                                  
126[Start]                                                                                                        
S0|T5 save persist| votedFor: 0|                                                                                  
logsLen: 127                                                                                                      
S0|T5 receive commands | logLen:                                                                                  
127[Start]                                                                                                        
S0|T5 save persist| votedFor: 0|                                                                                  
logsLen: 128                                                                                                      
S0|T5 receive commands | logLen:                                                                                  
128[Start]                                                                                                        
S0|T5 save persist| votedFor: 0|                                                                                  
logsLen: 129                                                                                                      
S0|T5 receive commands | logLen:                                                                                  
129[Start]                                                                                                        
S0|T5 save persist| votedFor: 0|                                                                                  
logsLen: 130                                                                                                      
S0|T5 receive commands | logLen:                                                                                  
130[Start]                                                                                                        
S0|T5 save persist| votedFor: 0|                                                                                  
logsLen: 131                                                                                                      
S0|T5 receive commands | logLen:                                                                                  
131[Start]                                                                                                        
S0|T5 save persist| votedFor: 0|                                                                                  
logsLen: 132                                                                                                      
S0|T5 receive commands | logLen:                                                                                  
132[Start]                                                                                                        
S0|T5 save persist| votedFor: 0|                                                                                  
logsLen: 133                                                                                                      
S0|T5 receive commands | logLen:                                                                                  
133[Start]                                                                                                        
S0|T5 save persist| votedFor: 0|                                                                                  
logsLen: 134                                                                                                      
S0|T5 receive commands | logLen:                                                                                  
134[Start]                                                                                                        
S0|T5 save persist| votedFor: 0|                                                                                  
logsLen: 135                                                                                                      
S0|T5 receive commands | logLen:                                                                                  
135[Start]                                                                                                        
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 is not leader                  
                                                                             S2|T5 save persist| votedFor: 0|     
                                                                             logsLen: 135                         
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             135[AppendEntry]                     
S0|T5 replica entries to S2|                                                                                      
entrylen:14| matchidx:134| nextidx:135                                                                            
S0|T5 update commitIndex as 134                                                                                   
S0|T5 starts to apply entries                                                                                     
[121:134][ApplyEntry]                                                                                             
S0|T5 Snapshot until index 129|                                                                                   
logLen: 135                                                                                                       
S0|T5 finishes applying entries                                                                                   
[121:134][ApplyEntry]                                                                                             
                                                                             S2|T5 is not leader                  
                                       S1|T5 is not leader                                                        
S0|T5 send rpc to S1|base: 129| next:                                                                             
120                                                                                                               
                                                                             S2|T5 save persist| votedFor: 0|     
                                                                             logsLen: 135                         
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             135[AppendEntry]                     
                                                                             S2|T5 starts to apply entries        
                                                                             [121:134][ApplyEntry]                
S0|T5 replica entries to S2|                                                                                      
entrylen:0| matchidx:134| nextidx:135                                                                             
                                                                             S2|T5 Snapshot until index 129|      
                                                                             logLen: 135                          
                                                                             S2|T5 finishes applying entries      
                                                                             [121:134][ApplyEntry]                
                                       S1 is connected again                                                      
S0|T5 save persist| votedFor: 0|                                                                                  
logsLen: 136                                                                                                      
S0|T5 receive commands | logLen:                                                                                  
136[Start]                                                                                                        
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 is not leader                  
S0|T5 send rpc to S1|base: 129| next:                                                                             
120                                                                                                               
                                       S1|T5 receive rpc from S0                                                  
                                       S1|T5 update rfstate| Base:129|                                            
                                       LogLen:130                                                                 
                                                                             S2|T5 save persist| votedFor: 0|     
                                                                             logsLen: 136                         
                                       S1|T5 applys snapshot from S0                                              
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             136[AppendEntry]                     
S0|T5 installs snapshot to S1|                                                                                    
nextId:130| matchId:129                                                                                           
S0|T5 replica entries to S2|                                                                                      
entrylen:1| matchidx:135| nextidx:136                                                                             
S0|T5 update commitIndex as 135                                                                                   
S0|T5 starts to apply entries                                                                                     
[135:135][ApplyEntry]                                                                                             
S0|T5 finishes applying entries                                                                                   
[135:135][ApplyEntry]                                                                                             
                                                                             S2|T5 is not leader                  
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 save persist| votedFor: 0|     
                                                                             logsLen: 136                         
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             136[AppendEntry]                     
                                       S1|T5 save persist| votedFor: 1|                                           
                                       logsLen: 136                                                               
                                       S1|T5 appends logs from S0| logLen:                                        
                                       136[AppendEntry]                                                           
                                                                             S2|T5 starts to apply entries        
                                                                             [135:135][ApplyEntry]                
                                                                             S2|T5 finishes applying entries      
                                                                             [135:135][ApplyEntry]                
                                       S1|T5 starts to apply entries                                              
                                       [130:135][ApplyEntry]                                                      
                                       S1|T5 finishes applying entries                                            
                                       [130:135][ApplyEntry]                                                      
S0|T5 replica entries to S2|                                                                                      
entrylen:0| matchidx:135| nextidx:136                                                                             
S0|T5 replica entries to S1|                                                                                      
entrylen:6| matchidx:135| nextidx:136                                                                             
                                                                             S2|T5 is not leader                  
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 save persist| votedFor: 0|     
                                                                             logsLen: 136                         
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             136[AppendEntry]                     
                                       S1|T5 save persist| votedFor: 1|                                           
                                       logsLen: 136                                                               
                                       S1|T5 appends logs from S0| logLen:                                        
                                       136[AppendEntry]                                                           
S0|T5 replica entries to S2|                                                                                      
entrylen:0| matchidx:135| nextidx:136                                                                             
S0|T5 replica entries to S1|                                                                                      
entrylen:0| matchidx:135| nextidx:136                                                                             
                                                                             S2|T5 is not leader                  
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 save persist| votedFor: 0|     
                                                                             logsLen: 136                         
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             136[AppendEntry]                     
                                       S1|T5 save persist| votedFor: 1|                                           
                                       logsLen: 136                                                               
                                       S1|T5 appends logs from S0| logLen:                                        
                                       136[AppendEntry]                                                           
S0|T5 replica entries to S2|                                                                                      
entrylen:0| matchidx:135| nextidx:136                                                                             
S0|T5 replica entries to S1|                                                                                      
entrylen:0| matchidx:135| nextidx:136                                                                             
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 is not leader                  
                                                                             S2|T5 save persist| votedFor: 0|     
                                                                             logsLen: 136                         
                                       S1|T5 save persist| votedFor: 1|                                           
                                       logsLen: 136                                                               
                                       S1|T5 appends logs from S0| logLen:                                        
                                       136[AppendEntry]                                                           
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             136[AppendEntry]                     
S0|T5 replica entries to S1|                                                                                      
entrylen:0| matchidx:135| nextidx:136                                                                             
S0|T5 replica entries to S2|                                                                                      
entrylen:0| matchidx:135| nextidx:136                                                                             
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 is not leader                  
                                       S1|T5 save persist| votedFor: 1|                                           
                                       logsLen: 136                                                               
                                                                             S2|T5 save persist| votedFor: 0|     
                                                                             logsLen: 136                         
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             136[AppendEntry]                     
                                       S1|T5 appends logs from S0| logLen:                                        
                                       136[AppendEntry]                                                           
S0|T5 replica entries to S2|                                                                                      
entrylen:0| matchidx:135| nextidx:136                                                                             
S0|T5 replica entries to S1|                                                                                      
entrylen:0| matchidx:135| nextidx:136                                                                             
                                       S1|T5 fails to install snapshot to S2                                      
S0 is disconnected                                                                                                
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 is not leader                  
                                                                             S2|T5 is not leader                  
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 is not leader                  
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 is not leader                  
                                       S1|T5 is not leader                                                        
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 is not leader                  
                                       S1|T6 starts to join election                                              
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 136                                                               
                                                                             S2|T6 save persist| votedFor: -1|    
                                                                             logsLen: 136                         
                                                                             S2|T6 save persist| votedFor: 1|     
                                                                             logsLen: 136                         
                                                                             S2|T6 votes for S1[RequestVote]      
                                       S1|T6 becomes the leader, and starts                                       
                                       heatbeats                                                                  
                                                                             S2|T6 save persist| votedFor: 1|     
                                                                             logsLen: 136                         
                                                                             S2|T6 appends logs from S1| logLen:  
                                                                             136[AppendEntry]                     
                                       S1|T6 replica entries to S2|                                               
                                       entrylen:0| matchidx:135| nextidx:136                                      
                                                                             S2|T6 is not leader                  
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 137                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       137[Start]                                                                 
                                                                             S2|T6 save persist| votedFor: 1|     
                                                                             logsLen: 137                         
                                                                             S2|T6 appends logs from S1| logLen:  
                                                                             137[AppendEntry]                     
                                       S1|T6 replica entries to S2|                                               
                                       entrylen:1| matchidx:136| nextidx:137                                      
                                       S1|T6 update commitIndex as 136                                            
                                       S1|T6 starts to apply entries                                              
                                       [136:136][ApplyEntry]                                                      
                                       S1|T6 finishes applying entries                                            
                                       [136:136][ApplyEntry]                                                      
                                                                             S2|T6 is not leader                  
                                                                             S2|T6 save persist| votedFor: 1|     
                                                                             logsLen: 137                         
                                                                             S2|T6 appends logs from S1| logLen:  
                                                                             137[AppendEntry]                     
                                                                             S2|T6 starts to apply entries        
                                                                             [136:136][ApplyEntry]                
                                                                             S2|T6 finishes applying entries      
                                                                             [136:136][ApplyEntry]                
                                       S1|T6 replica entries to S2|                                               
                                       entrylen:0| matchidx:136| nextidx:137                                      
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 138                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       138[Start]                                                                 
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 139                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       139[Start]                                                                 
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 140                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       140[Start]                                                                 
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 141                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       141[Start]                                                                 
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 142                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       142[Start]                                                                 
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 143                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       143[Start]                                                                 
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 144                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       144[Start]                                                                 
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 145                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       145[Start]                                                                 
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 146                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       146[Start]                                                                 
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 147                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       147[Start]                                                                 
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 148                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       148[Start]                                                                 
                                                                             S2|T6 is not leader                  
                                                                             S2|T6 save persist| votedFor: 1|     
                                                                             logsLen: 148                         
                                                                             S2|T6 appends logs from S1| logLen:  
                                                                             148[AppendEntry]                     
                                       S1|T6 replica entries to S2|                                               
                                       entrylen:11| matchidx:147|                                                 
                                       nextidx:148                                                                
                                       S1|T6 update commitIndex as 147                                            
                                       S1|T6 starts to apply entries                                              
                                       [137:147][ApplyEntry]                                                      
                                       S1|T6 Snapshot until index 139|                                            
                                       logLen: 148                                                                
                                       S1|T6 finishes applying entries                                            
                                       [137:147][ApplyEntry]                                                      
                                                                             S2|T6 is not leader                  
                                       S1|T6 send rpc to S0|base: 139| next:                                      
                                       136                                                                        
                                                                             S2|T6 save persist| votedFor: 1|     
                                                                             logsLen: 148                         
                                                                             S2|T6 appends logs from S1| logLen:  
                                                                             148[AppendEntry]                     
                                                                             S2|T6 starts to apply entries        
                                                                             [137:147][ApplyEntry]                
                                       S1|T6 replica entries to S2|                                               
                                       entrylen:0| matchidx:147| nextidx:148                                      
                                                                             S2|T6 Snapshot until index 139|      
                                                                             logLen: 148                          
                                                                             S2|T6 finishes applying entries      
                                                                             [137:147][ApplyEntry]                
S0 is connected again                                                                                             
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 149                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       149[Start]                                                                 
                                                                             S2|T6 is not leader                  
                                       S1|T6 send rpc to S0|base: 139| next:                                      
                                       136                                                                        
S0|T5 receive rpc from S1                                                                                         
                                                                             S2|T6 rejects to append entries from 
                                                                             S0 | out of date term[AppendEntry]   
                                       S1|T6 rejects to append entries from                                       
                                       S0 | out of date term[AppendEntry]                                         
S0|T6 save persist| votedFor: 0|                                                                                  
logsLen: 136                                                                                                      
S0|T6 update rfstate| Base:139|                                                                                   
LogLen:140                                                                                                        
                                                                             S2|T6 save persist| votedFor: 1|     
                                                                             logsLen: 149                         
                                                                             S2|T6 appends logs from S1| logLen:  
                                                                             149[AppendEntry]                     
S0|T6 lost leadership, state: 0                                                                                   
S0|T6 applys snapshot from S1                                                                                     
S0|T6 lost leadership, state: 0                                                                                   
                                       S1|T6 installs snapshot to S0|                                             
                                       nextId:140| matchId:139                                                    
                                       S1|T6 replica entries to S2|                                               
                                       entrylen:1| matchidx:148| nextidx:149                                      
                                       S1|T6 update commitIndex as 148                                            
                                       S1|T6 starts to apply entries                                              
                                       [148:148][ApplyEntry]                                                      
                                       S1|T6 finishes applying entries                                            
                                       [148:148][ApplyEntry]                                                      
                                                                             S2|T6 is not leader                  
S0|T6 is not leader                                                                                               
                                                                             S2|T6 save persist| votedFor: 1|     
                                                                             logsLen: 149                         
                                                                             S2|T6 appends logs from S1| logLen:  
                                                                             149[AppendEntry]                     
                                                                             S2|T6 starts to apply entries        
                                                                             [148:148][ApplyEntry]                
S0|T6 save persist| votedFor: 0|                                                                                  
logsLen: 149                                                                                                      
                                                                             S2|T6 finishes applying entries      
                                                                             [148:148][ApplyEntry]                
S0|T6 appends logs from S1| logLen:                                                                               
149[AppendEntry]                                                                                                  
                                       S1|T6 replica entries to S2|                                               
                                       entrylen:0| matchidx:148| nextidx:149                                      
S0|T6 starts to apply entries                                                                                     
[140:148][ApplyEntry]                                                                                             
S0|T6 finishes applying entries                                                                                   
[140:148][ApplyEntry]                                                                                             
                                       S1|T6 replica entries to S0|                                               
                                       entrylen:9| matchidx:148| nextidx:149                                      
                                                                             S2|T6 is not leader                  
S0|T6 is not leader                                                                                               
                                                                             S2|T6 save persist| votedFor: 1|     
                                                                             logsLen: 149                         
S0|T6 save persist| votedFor: 0|                                                                                  
logsLen: 149                                                                                                      
                                                                             S2|T6 appends logs from S1| logLen:  
                                                                             149[AppendEntry]                     
S0|T6 appends logs from S1| logLen:                                                                               
149[AppendEntry]                                                                                                  
                                       S1|T6 replica entries to S2|                                               
                                       entrylen:0| matchidx:148| nextidx:149                                      
                                       S1|T6 replica entries to S0|                                               
                                       entrylen:0| matchidx:148| nextidx:149                                      
                                                                             S2|T6 is not leader                  
S0|T6 is not leader                                                                                               
                                                                             S2|T6 save persist| votedFor: 1|     
                                                                             logsLen: 149                         
                                                                             S2|T6 appends logs from S1| logLen:  
                                                                             149[AppendEntry]                     
S0|T6 save persist| votedFor: 0|                                                                                  
logsLen: 149                                                                                                      
S0|T6 appends logs from S1| logLen:                                                                               
149[AppendEntry]                                                                                                  
                                       S1|T6 replica entries to S2|                                               
                                       entrylen:0| matchidx:148| nextidx:149                                      
                                       S1|T6 replica entries to S0|                                               
                                       entrylen:0| matchidx:148| nextidx:149                                      
S0|T6 is not leader                                                                                               
                                                                             S2|T6 is not leader                  
S0|T6 save persist| votedFor: 0|                                                                                  
logsLen: 149                                                                                                      
                                                                             S2|T6 save persist| votedFor: 1|     
                                                                             logsLen: 149                         
                                                                             S2|T6 appends logs from S1| logLen:  
                                                                             149[AppendEntry]                     
S0|T6 appends logs from S1| logLen:                                                                               
149[AppendEntry]                                                                                                  
                                       S1|T6 replica entries to S0|                                               
                                       entrylen:0| matchidx:148| nextidx:149                                      
                                       S1|T6 replica entries to S2|                                               
                                       entrylen:0| matchidx:148| nextidx:149                                      
S0|T6 is not leader                                                                                               
                                                                             S2|T6 is not leader                  
                                                                             S2|T6 save persist| votedFor: 1|     
                                                                             logsLen: 149                         
                                                                             S2|T6 appends logs from S1| logLen:  
                                                                             149[AppendEntry]                     
S0|T6 save persist| votedFor: 0|                                                                                  
logsLen: 149                                                                                                      
S0|T6 appends logs from S1| logLen:                                                                               
149[AppendEntry]                                                                                                  
                                       S1|T6 replica entries to S2|                                               
                                       entrylen:0| matchidx:148| nextidx:149                                      
                                       S1|T6 replica entries to S0|                                               
                                       entrylen:0| matchidx:148| nextidx:149                                      
S0|T6 is not leader                                                                                               
                                                                             S2|T6 is not leader                  
S0|T6 save persist| votedFor: 0|                                                                                  
logsLen: 149                                                                                                      
S0|T6 appends logs from S1| logLen:                                                                               
149[AppendEntry]                                                                                                  
                                                                             S2|T6 save persist| votedFor: 1|     
                                                                             logsLen: 149                         
                                                                             S2|T6 appends logs from S1| logLen:  
                                                                             149[AppendEntry]                     
                                       S1|T6 replica entries to S0|                                               
                                       entrylen:0| matchidx:148| nextidx:149                                      
                                       S1|T6 replica entries to S2|                                               
                                       entrylen:0| matchidx:148| nextidx:149                                      
                                                                             S2 is disconnected                   
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 150                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       150[Start]                                                                 
                                                                             S2|T6 is not leader                  
S0|T6 is not leader                                                                                               
S0|T6 save persist| votedFor: 0|                                                                                  
logsLen: 150                                                                                                      
S0|T6 appends logs from S1| logLen:                                                                               
150[AppendEntry]                                                                                                  
                                       S1|T6 replica entries to S0|                                               
                                       entrylen:1| matchidx:149| nextidx:150                                      
                                       S1|T6 update commitIndex as 149                                            
                                       S1|T6 starts to apply entries                                              
                                       [149:149][ApplyEntry]                                                      
                                       S1|T6 finishes applying entries                                            
                                       [149:149][ApplyEntry]                                                      
                                       S1|T6 Snapshot until index 149|                                            
                                       logLen: 150                                                                
S0|T6 is not leader                                                                                               
                                       S1|T6 send rpc to S2|base: 149| next:                                      
                                       149                                                                        
                                                                             S2|T6 is not leader                  
S0|T6 save persist| votedFor: 0|                                                                                  
logsLen: 150                                                                                                      
S0|T6 appends logs from S1| logLen:                                                                               
150[AppendEntry]                                                                                                  
S0|T6 starts to apply entries                                                                                     
[149:149][ApplyEntry]                                                                                             
S0|T6 finishes applying entries                                                                                   
[149:149][ApplyEntry]                                                                                             
                                       S1|T6 replica entries to S0|                                               
                                       entrylen:0| matchidx:149| nextidx:150                                      
S0|T6 Snapshot until index 149|                                                                                   
logLen: 150                                                                                                       
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 151                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       151[Start]                                                                 
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 152                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       152[Start]                                                                 
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 153                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       153[Start]                                                                 
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 154                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       154[Start]                                                                 
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 155                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       155[Start]                                                                 
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 156                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       156[Start]                                                                 
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 157                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       157[Start]                                                                 
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 158                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       158[Start]                                                                 
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 159                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       159[Start]                                                                 
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 160                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       160[Start]                                                                 
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 161                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       161[Start]                                                                 
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 162                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       162[Start]                                                                 
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 163                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       163[Start]                                                                 
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 164                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       164[Start]                                                                 
S0|T6 is not leader                                                                                               
                                       S1|T6 send rpc to S2|base: 149| next:                                      
                                       149                                                                        
                                                                             S2|T6 is not leader                  
S0|T6 save persist| votedFor: 0|                                                                                  
logsLen: 164                                                                                                      
S0|T6 appends logs from S1| logLen:                                                                               
164[AppendEntry]                                                                                                  
                                       S1|T6 replica entries to S0|                                               
                                       entrylen:14| matchidx:163|                                                 
                                       nextidx:164                                                                
                                       S1|T6 update commitIndex as 163                                            
                                       S1|T6 starts to apply entries                                              
                                       [150:163][ApplyEntry]                                                      
                                       S1|T6 Snapshot until index 159|                                            
                                       logLen: 164                                                                
                                       S1|T6 finishes applying entries                                            
                                       [150:163][ApplyEntry]                                                      
S0|T6 is not leader                                                                                               
                                       S1|T6 send rpc to S2|base: 159| next:                                      
                                       149                                                                        
                                                                             S2|T6 is not leader                  
S0|T6 save persist| votedFor: 0|                                                                                  
logsLen: 164                                                                                                      
S0|T6 appends logs from S1| logLen:                                                                               
164[AppendEntry]                                                                                                  
S0|T6 starts to apply entries                                                                                     
[150:163][ApplyEntry]                                                                                             
                                       S1|T6 replica entries to S0|                                               
                                       entrylen:0| matchidx:163| nextidx:164                                      
S0|T6 Snapshot until index 159|                                                                                   
logLen: 164                                                                                                       
S0|T6 finishes applying entries                                                                                   
[150:163][ApplyEntry]                                                                                             
                                                                             S2 is connected again                
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 165                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       165[Start]                                                                 
                                                                             S2|T6 is not leader                  
S0|T6 is not leader                                                                                               
                                       S1|T6 send rpc to S2|base: 159| next:                                      
                                       149                                                                        
                                                                             S2|T6 receive rpc from S1            
                                                                             S2|T6 update rfstate| Base:159|      
                                                                             LogLen:160                           
S0|T6 save persist| votedFor: 0|                                                                                  
logsLen: 165                                                                                                      
S0|T6 appends logs from S1| logLen:                                                                               
165[AppendEntry]                                                                                                  
                                                                             S2|T6 applys snapshot from S1        
                                       S1|T6 installs snapshot to S2|                                             
                                       nextId:160| matchId:159                                                    
                                       S1|T6 replica entries to S0|                                               
                                       entrylen:1| matchidx:164| nextidx:165                                      
                                       S1|T6 update commitIndex as 164                                            
                                       S1|T6 starts to apply entries                                              
                                       [164:164][ApplyEntry]                                                      
                                       S1|T6 finishes applying entries                                            
                                       [164:164][ApplyEntry]                                                      
S0|T6 is not leader                                                                                               
                                                                             S2|T6 is not leader                  
S0|T6 save persist| votedFor: 0|                                                                                  
logsLen: 165                                                                                                      
                                                                             S2|T6 save persist| votedFor: 1|     
                                                                             logsLen: 165                         
S0|T6 appends logs from S1| logLen:                                                                               
165[AppendEntry]                                                                                                  
                                                                             S2|T6 appends logs from S1| logLen:  
                                                                             165[AppendEntry]                     
                                                                             S2|T6 starts to apply entries        
                                                                             [160:164][ApplyEntry]                
S0|T6 starts to apply entries                                                                                     
[164:164][ApplyEntry]                                                                                             
S0|T6 finishes applying entries                                                                                   
[164:164][ApplyEntry]                                                                                             
                                                                             S2|T6 finishes applying entries      
                                                                             [160:164][ApplyEntry]                
                                       S1|T6 replica entries to S2|                                               
                                       entrylen:5| matchidx:164| nextidx:165                                      
                                       S1|T6 replica entries to S0|                                               
                                       entrylen:0| matchidx:164| nextidx:165                                      
                                                                             S2|T6 is not leader                  
S0|T6 is not leader                                                                                               
S0|T6 save persist| votedFor: 0|                                                                                  
logsLen: 165                                                                                                      
S0|T6 appends logs from S1| logLen:                                                                               
165[AppendEntry]                                                                                                  
                                                                             S2|T6 save persist| votedFor: 1|     
                                                                             logsLen: 165                         
                                                                             S2|T6 appends logs from S1| logLen:  
                                                                             165[AppendEntry]                     
                                       S1|T6 replica entries to S0|                                               
                                       entrylen:0| matchidx:164| nextidx:165                                      
                                       S1|T6 replica entries to S2|                                               
                                       entrylen:0| matchidx:164| nextidx:165                                      
                                                                             S2|T6 is not leader                  
S0|T6 is not leader                                                                                               
S0|T6 save persist| votedFor: 0|                                                                                  
logsLen: 165                                                                                                      
                                                                             S2|T6 save persist| votedFor: 1|     
                                                                             logsLen: 165                         
                                                                             S2|T6 appends logs from S1| logLen:  
                                                                             165[AppendEntry]                     
S0|T6 appends logs from S1| logLen:                                                                               
165[AppendEntry]                                                                                                  
                                       S1|T6 replica entries to S2|                                               
                                       entrylen:0| matchidx:164| nextidx:165                                      
                                       S1|T6 replica entries to S0|                                               
                                       entrylen:0| matchidx:164| nextidx:165                                      
S0|T6 is not leader                                                                                               
                                                                             S2|T6 is not leader                  
S0|T6 save persist| votedFor: 0|                                                                                  
logsLen: 165                                                                                                      
                                                                             S2|T6 save persist| votedFor: 1|     
                                                                             logsLen: 165                         
S0|T6 appends logs from S1| logLen:                                                                               
165[AppendEntry]                                                                                                  
                                                                             S2|T6 appends logs from S1| logLen:  
                                                                             165[AppendEntry]                     
                                       S1|T6 replica entries to S2|                                               
                                       entrylen:0| matchidx:164| nextidx:165                                      
                                       S1|T6 replica entries to S0|                                               
                                       entrylen:0| matchidx:164| nextidx:165                                      
                                       S1|T6 fails to install snapshot to S0                                      
                                                                             S2|T6 is not leader                  
S0|T6 is not leader                                                                                               
S0|T6 save persist| votedFor: 0|                                                                                  
logsLen: 165                                                                                                      
                                                                             S2|T6 save persist| votedFor: 1|     
                                                                             logsLen: 165                         
                                                                             S2|T6 appends logs from S1| logLen:  
                                                                             165[AppendEntry]                     
S0|T6 appends logs from S1| logLen:                                                                               
165[AppendEntry]                                                                                                  
                                       S1|T6 replica entries to S2|                                               
                                       entrylen:0| matchidx:164| nextidx:165                                      
                                       S1|T6 replica entries to S0|                                               
                                       entrylen:0| matchidx:164| nextidx:165                                      
                                                                             S2 is disconnected                   
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 166                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       166[Start]                                                                 
                                                                             S2|T6 is not leader                  
S0|T6 is not leader                                                                                               
S0|T6 save persist| votedFor: 0|                                                                                  
logsLen: 166                                                                                                      
S0|T6 appends logs from S1| logLen:                                                                               
166[AppendEntry]                                                                                                  
                                       S1|T6 replica entries to S0|                                               
                                       entrylen:1| matchidx:165| nextidx:166                                      
                                       S1|T6 update commitIndex as 165                                            
                                       S1|T6 starts to apply entries                                              
                                       [165:165][ApplyEntry]                                                      
                                       S1|T6 finishes applying entries                                            
                                       [165:165][ApplyEntry]                                                      
S0|T6 is not leader                                                                                               
                                                                             S2|T6 is not leader                  
S0|T6 save persist| votedFor: 0|                                                                                  
logsLen: 166                                                                                                      
S0|T6 appends logs from S1| logLen:                                                                               
166[AppendEntry]                                                                                                  
S0|T6 starts to apply entries                                                                                     
[165:165][ApplyEntry]                                                                                             
S0|T6 finishes applying entries                                                                                   
[165:165][ApplyEntry]                                                                                             
                                       S1|T6 replica entries to S0|                                               
                                       entrylen:0| matchidx:165| nextidx:166                                      
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 167                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       167[Start]                                                                 
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 168                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       168[Start]                                                                 
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 169                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       169[Start]                                                                 
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 170                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       170[Start]                                                                 
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 171                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       171[Start]                                                                 
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 172                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       172[Start]                                                                 
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 173                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       173[Start]                                                                 
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 174                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       174[Start]                                                                 
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 175                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       175[Start]                                                                 
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 176                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       176[Start]                                                                 
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 177                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       177[Start]                                                                 
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 178                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       178[Start]                                                                 
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 179                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       179[Start]                                                                 
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 180                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       180[Start]                                                                 
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 181                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       181[Start]                                                                 
                                                                             S2|T6 is not leader                  
S0|T6 is not leader                                                                                               
S0|T6 save persist| votedFor: 0|                                                                                  
logsLen: 181                                                                                                      
S0|T6 appends logs from S1| logLen:                                                                               
181[AppendEntry]                                                                                                  
                                       S1|T6 replica entries to S0|                                               
                                       entrylen:15| matchidx:180|                                                 
                                       nextidx:181                                                                
                                       S1|T6 update commitIndex as 180                                            
                                       S1|T6 starts to apply entries                                              
                                       [166:180][ApplyEntry]                                                      
                                       S1|T6 Snapshot until index 169|                                            
                                       logLen: 181                                                                
                                       S1|T6 Snapshot until index 179|                                            
                                       logLen: 181                                                                
                                       S1|T6 finishes applying entries                                            
                                       [166:180][ApplyEntry]                                                      
S0|T6 is not leader                                                                                               
                                                                             S2|T6 is not leader                  
                                       S1|T6 send rpc to S2|base: 179| next:                                      
                                       165                                                                        
S0|T6 save persist| votedFor: 0|                                                                                  
logsLen: 181                                                                                                      
S0|T6 appends logs from S1| logLen:                                                                               
181[AppendEntry]                                                                                                  
S0|T6 starts to apply entries                                                                                     
[166:180][ApplyEntry]                                                                                             
                                       S1|T6 replica entries to S0|                                               
                                       entrylen:0| matchidx:180| nextidx:181                                      
S0|T6 Snapshot until index 169|                                                                                   
logLen: 181                                                                                                       
S0|T6 Snapshot until index 179|                                                                                   
logLen: 181                                                                                                       
S0|T6 finishes applying entries                                                                                   
[166:180][ApplyEntry]                                                                                             
                                                                             S2 is connected again                
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 182                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       182[Start]                                                                 
                                                                             S2|T6 is not leader                  
S0|T6 is not leader                                                                                               
                                       S1|T6 send rpc to S2|base: 179| next:                                      
                                       165                                                                        
                                                                             S2|T6 receive rpc from S1            
                                                                             S2|T6 update rfstate| Base:179|      
                                                                             LogLen:180                           
S0|T6 save persist| votedFor: 0|                                                                                  
logsLen: 182                                                                                                      
S0|T6 appends logs from S1| logLen:                                                                               
182[AppendEntry]                                                                                                  
                                                                             S2|T6 applys snapshot from S1        
                                       S1|T6 replica entries to S0|                                               
                                       entrylen:1| matchidx:181| nextidx:182                                      
                                       S1|T6 update commitIndex as 181                                            
                                       S1|T6 starts to apply entries                                              
                                       [181:181][ApplyEntry]                                                      
                                       S1|T6 finishes applying entries                                            
                                       [181:181][ApplyEntry]                                                      
                                       S1|T6 installs snapshot to S2|                                             
                                       nextId:180| matchId:179                                                    
S0|T6 is not leader                                                                                               
                                                                             S2|T6 is not leader                  
                                                                             S2|T6 save persist| votedFor: 1|     
                                                                             logsLen: 182                         
                                                                             S2|T6 appends logs from S1| logLen:  
                                                                             182[AppendEntry]                     
S0|T6 save persist| votedFor: 0|                                                                                  
logsLen: 182                                                                                                      
S0|T6 appends logs from S1| logLen:                                                                               
182[AppendEntry]                                                                                                  
                                                                             S2|T6 starts to apply entries        
                                                                             [180:181][ApplyEntry]                
                                                                             S2|T6 finishes applying entries      
                                                                             [180:181][ApplyEntry]                
S0|T6 starts to apply entries                                                                                     
[181:181][ApplyEntry]                                                                                             
S0|T6 finishes applying entries                                                                                   
[181:181][ApplyEntry]                                                                                             
                                       S1|T6 replica entries to S2|                                               
                                       entrylen:2| matchidx:181| nextidx:182                                      
                                       S1|T6 replica entries to S0|                                               
                                       entrylen:0| matchidx:181| nextidx:182                                      
                                                                             S2|T6 is not leader                  
S0|T6 is not leader                                                                                               
S0|T6 save persist| votedFor: 0|                                                                                  
logsLen: 182                                                                                                      
                                                                             S2|T6 save persist| votedFor: 1|     
                                                                             logsLen: 182                         
                                                                             S2|T6 appends logs from S1| logLen:  
                                                                             182[AppendEntry]                     
S0|T6 appends logs from S1| logLen:                                                                               
182[AppendEntry]                                                                                                  
                                       S1|T6 replica entries to S2|                                               
                                       entrylen:0| matchidx:181| nextidx:182                                      
                                       S1|T6 replica entries to S0|                                               
                                       entrylen:0| matchidx:181| nextidx:182                                      
S0|T6 is not leader                                                                                               
                                                                             S2|T6 is not leader                  
                                                                             S2|T6 save persist| votedFor: 1|     
                                                                             logsLen: 182                         
                                                                             S2|T6 appends logs from S1| logLen:  
                                                                             182[AppendEntry]                     
S0|T6 save persist| votedFor: 0|                                                                                  
logsLen: 182                                                                                                      
S0|T6 appends logs from S1| logLen:                                                                               
182[AppendEntry]                                                                                                  
                                       S1|T6 replica entries to S2|                                               
                                       entrylen:0| matchidx:181| nextidx:182                                      
                                       S1|T6 replica entries to S0|                                               
                                       entrylen:0| matchidx:181| nextidx:182                                      
                                                                             S2|T6 is not leader                  
S0|T6 is not leader                                                                                               
S0|T6 save persist| votedFor: 0|                                                                                  
logsLen: 182                                                                                                      
S0|T6 appends logs from S1| logLen:                                                                               
182[AppendEntry]                                                                                                  
                                                                             S2|T6 save persist| votedFor: 1|     
                                                                             logsLen: 182                         
                                                                             S2|T6 appends logs from S1| logLen:  
                                                                             182[AppendEntry]                     
                                       S1|T6 replica entries to S0|                                               
                                       entrylen:0| matchidx:181| nextidx:182                                      
                                       S1|T6 replica entries to S2|                                               
                                       entrylen:0| matchidx:181| nextidx:182                                      
                                                                             S2|T6 is not leader                  
S0|T6 is not leader                                                                                               
                                                                             S2|T6 save persist| votedFor: 1|     
                                                                             logsLen: 182                         
S0|T6 save persist| votedFor: 0|                                                                                  
logsLen: 182                                                                                                      
                                                                             S2|T6 appends logs from S1| logLen:  
                                                                             182[AppendEntry]                     
S0|T6 appends logs from S1| logLen:                                                                               
182[AppendEntry]                                                                                                  
                                       S1|T6 replica entries to S2|                                               
                                       entrylen:0| matchidx:181| nextidx:182                                      
                                       S1|T6 replica entries to S0|                                               
                                       entrylen:0| matchidx:181| nextidx:182                                      
                                                                             S2|T6 is not leader                  
S0|T6 is not leader                                                                                               
S0|T6 save persist| votedFor: 0|                                                                                  
logsLen: 182                                                                                                      
S0|T6 appends logs from S1| logLen:                                                                               
182[AppendEntry]                                                                                                  
                                                                             S2|T6 save persist| votedFor: 1|     
                                                                             logsLen: 182                         
                                                                             S2|T6 appends logs from S1| logLen:  
                                                                             182[AppendEntry]                     
                                       S1|T6 replica entries to S0|                                               
                                       entrylen:0| matchidx:181| nextidx:182                                      
                                       S1|T6 replica entries to S2|                                               
                                       entrylen:0| matchidx:181| nextidx:182                                      
                                       S1 is disconnected                                                         
S0|T6 is not leader                                                                                               
                                                                             S2|T6 is not leader                  
                                                                             S2|T6 is not leader                  
S0|T6 is not leader                                                                                               
S0|T6 is not leader                                                                                               
                                                                             S2|T6 is not leader                  
                                       S1|T6 fails to install snapshot to S2                                      
                                                                             S2|T6 is not leader                  
S0|T6 is not leader                                                                                               
S0|T6 is not leader                                                                                               
                                                                             S2|T6 is not leader                  
                                                                             S2|T7 starts to join election        
                                                                             S2|T7 save persist| votedFor: 2|     
                                                                             logsLen: 182                         
S0|T7 save persist| votedFor: -1|                                                                                 
logsLen: 182                                                                                                      
S0|T7 save persist| votedFor: 2|                                                                                  
logsLen: 182                                                                                                      
S0|T7 votes for S2[RequestVote]                                                                                   
                                                                             S2|T7 becomes the leader, and starts 
                                                                             heatbeats                            
                                                                             S2|T7 save persist| votedFor: 2|     
                                                                             logsLen: 183                         
                                                                             S2|T7 receive commands | logLen:     
                                                                             183[Start]                           
S0|T7 save persist| votedFor: 2|                                                                                  
logsLen: 182                                                                                                      
S0|T7 appends logs from S2| logLen:                                                                               
182[AppendEntry]                                                                                                  
                                                                             S2|T7 replica entries to S0|         
                                                                             entrylen:0| matchidx:181| nextidx:182
S0|T7 is not leader                                                                                               
S0|T7 save persist| votedFor: 2|                                                                                  
logsLen: 183                                                                                                      
S0|T7 appends logs from S2| logLen:                                                                               
183[AppendEntry]                                                                                                  
                                                                             S2|T7 replica entries to S0|         
                                                                             entrylen:1| matchidx:182| nextidx:183
                                                                             S2|T7 update commitIndex as 182      
                                                                             S2|T7 starts to apply entries        
                                                                             [182:182][ApplyEntry]                
                                                                             S2|T7 finishes applying entries      
                                                                             [182:182][ApplyEntry]                
S0|T7 is not leader                                                                                               
S0|T7 save persist| votedFor: 2|                                                                                  
logsLen: 183                                                                                                      
S0|T7 appends logs from S2| logLen:                                                                               
183[AppendEntry]                                                                                                  
S0|T7 starts to apply entries                                                                                     
[182:182][ApplyEntry]                                                                                             
S0|T7 finishes applying entries                                                                                   
[182:182][ApplyEntry]                                                                                             
                                                                             S2|T7 replica entries to S0|         
                                                                             entrylen:0| matchidx:182| nextidx:183
                                                                             S2|T7 save persist| votedFor: 2|     
                                                                             logsLen: 184                         
                                                                             S2|T7 receive commands | logLen:     
                                                                             184[Start]                           
                                                                             S2|T7 save persist| votedFor: 2|     
                                                                             logsLen: 185                         
                                                                             S2|T7 receive commands | logLen:     
                                                                             185[Start]                           
                                                                             S2|T7 save persist| votedFor: 2|     
                                                                             logsLen: 186                         
                                                                             S2|T7 receive commands | logLen:     
                                                                             186[Start]                           
                                                                             S2|T7 save persist| votedFor: 2|     
                                                                             logsLen: 187                         
                                                                             S2|T7 receive commands | logLen:     
                                                                             187[Start]                           
                                                                             S2|T7 save persist| votedFor: 2|     
                                                                             logsLen: 188                         
                                                                             S2|T7 receive commands | logLen:     
                                                                             188[Start]                           
                                                                             S2|T7 save persist| votedFor: 2|     
                                                                             logsLen: 189                         
                                                                             S2|T7 receive commands | logLen:     
                                                                             189[Start]                           
                                                                             S2|T7 save persist| votedFor: 2|     
                                                                             logsLen: 190                         
                                                                             S2|T7 receive commands | logLen:     
                                                                             190[Start]                           
                                                                             S2|T7 save persist| votedFor: 2|     
                                                                             logsLen: 191                         
                                                                             S2|T7 receive commands | logLen:     
                                                                             191[Start]                           
                                                                             S2|T7 save persist| votedFor: 2|     
                                                                             logsLen: 192                         
                                                                             S2|T7 receive commands | logLen:     
                                                                             192[Start]                           
S0|T7 is not leader                                                                                               
S0|T7 save persist| votedFor: 2|                                                                                  
logsLen: 192                                                                                                      
S0|T7 appends logs from S2| logLen:                                                                               
192[AppendEntry]                                                                                                  
                                                                             S2|T7 replica entries to S0|         
                                                                             entrylen:9| matchidx:191| nextidx:192
                                                                             S2|T7 update commitIndex as 191      
                                                                             S2|T7 starts to apply entries        
                                                                             [183:191][ApplyEntry]                
                                                                             S2|T7 Snapshot until index 189|      
                                                                             logLen: 192                          
                                                                             S2|T7 finishes applying entries      
                                                                             [183:191][ApplyEntry]                
S0|T7 is not leader                                                                                               
                                                                             S2|T7 send rpc to S1|base: 189| next:
                                                                             182                                  
S0|T7 save persist| votedFor: 2|                                                                                  
logsLen: 192                                                                                                      
S0|T7 appends logs from S2| logLen:                                                                               
192[AppendEntry]                                                                                                  
S0|T7 starts to apply entries                                                                                     
[183:191][ApplyEntry]                                                                                             
                                                                             S2|T7 replica entries to S0|         
                                                                             entrylen:0| matchidx:191| nextidx:192
S0|T7 Snapshot until index 189|                                                                                   
logLen: 192                                                                                                       
S0|T7 finishes applying entries                                                                                   
[183:191][ApplyEntry]                                                                                             
                                       S1 is connected again                                                      
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 183                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       183[Start]                                                                 
S0|T7 is not leader                                                                                               
                                                                             S2|T7 send rpc to S1|base: 189| next:
                                                                             182                                  
S0|T7 save persist| votedFor: 2|                                                                                  
logsLen: 192                                                                                                      
                                       S1|T6 receive rpc from S2                                                  
                                                                             S2|T7 rejects to append entries from 
                                                                             S1 | out of date term[AppendEntry]   
S0|T7 appends logs from S2| logLen:                                                                               
192[AppendEntry]                                                                                                  
                                       S1|T7 save persist| votedFor: 1|                                           
                                       logsLen: 183                                                               
S0|T7 rejects to append entries from                                                                              
S1 | out of date term[AppendEntry]                                                                                
                                       S1|T7 update rfstate| Base:189|                                            
                                       LogLen:190                                                                 
                                       S1|T7 lost leadership, state: 0                                            
                                                                             S2|T7 replica entries to S0|         
                                                                             entrylen:0| matchidx:191| nextidx:192
                                       S1|T7 applys snapshot from S2                                              
                                       S1|T7 lost leadership, state: 0                                            
                                                                             S2|T7 installs snapshot to S1|       
                                                                             nextId:190| matchId:189              
S0|T7 is not leader                                                                                               
                                       S1|T7 is not leader                                                        
S0|T7 save persist| votedFor: 2|                                                                                  
logsLen: 192                                                                                                      
                                       S1|T7 save persist| votedFor: 1|                                           
                                       logsLen: 192                                                               
S0|T7 appends logs from S2| logLen:                                                                               
192[AppendEntry]                                                                                                  
                                       S1|T7 appends logs from S2| logLen:                                        
                                       192[AppendEntry]                                                           
                                       S1|T7 starts to apply entries                                              
                                       [190:191][ApplyEntry]                                                      
                                       S1|T7 finishes applying entries                                            
                                       [190:191][ApplyEntry]                                                      
                                                                             S2|T7 replica entries to S0|         
                                                                             entrylen:0| matchidx:191| nextidx:192
                                                                             S2|T7 replica entries to S1|         
                                                                             entrylen:2| matchidx:191| nextidx:192
                                       S1|T7 fails to install snapshot to S2                                      
                                       S1|T7 fails to install snapshot to S2                                      
                                       S1|T7 is not leader                                                        
S0|T7 is not leader                                                                                               
                                       S1|T7 save persist| votedFor: 1|                                           
                                       logsLen: 192                                                               
S0|T7 save persist| votedFor: 2|                                                                                  
logsLen: 192                                                                                                      
S0|T7 appends logs from S2| logLen:                                                                               
192[AppendEntry]                                                                                                  
                                       S1|T7 appends logs from S2| logLen:                                        
                                       192[AppendEntry]                                                           
                                                                             S2|T7 replica entries to S0|         
                                                                             entrylen:0| matchidx:191| nextidx:192
                                                                             S2|T7 replica entries to S1|         
                                                                             entrylen:0| matchidx:191| nextidx:192
                                       S1|T7 is not leader                                                        
S0|T7 is not leader                                                                                               
                                       S1|T7 save persist| votedFor: 1|                                           
                                       logsLen: 192                                                               
S0|T7 save persist| votedFor: 2|                                                                                  
logsLen: 192                                                                                                      
S0|T7 appends logs from S2| logLen:                                                                               
192[AppendEntry]                                                                                                  
                                       S1|T7 appends logs from S2| logLen:                                        
                                       192[AppendEntry]                                                           
                                                                             S2|T7 replica entries to S0|         
                                                                             entrylen:0| matchidx:191| nextidx:192
                                                                             S2|T7 replica entries to S1|         
                                                                             entrylen:0| matchidx:191| nextidx:192
                                       S1|T7 is not leader                                                        
S0|T7 is not leader                                                                                               
                                       S1|T7 save persist| votedFor: 1|                                           
                                       logsLen: 192                                                               
                                       S1|T7 appends logs from S2| logLen:                                        
                                       192[AppendEntry]                                                           
S0|T7 save persist| votedFor: 2|                                                                                  
logsLen: 192                                                                                                      
S0|T7 appends logs from S2| logLen:                                                                               
192[AppendEntry]                                                                                                  
                                                                             S2|T7 replica entries to S1|         
                                                                             entrylen:0| matchidx:191| nextidx:192
                                                                             S2|T7 replica entries to S0|         
                                                                             entrylen:0| matchidx:191| nextidx:192
S0|T7 is not leader                                                                                               
                                       S1|T7 is not leader                                                        
                                       S1|T7 save persist| votedFor: 1|                                           
                                       logsLen: 192                                                               
                                       S1|T7 appends logs from S2| logLen:                                        
                                       192[AppendEntry]                                                           
S0|T7 save persist| votedFor: 2|                                                                                  
logsLen: 192                                                                                                      
S0|T7 appends logs from S2| logLen:                                                                               
192[AppendEntry]                                                                                                  
                                                                             S2|T7 replica entries to S1|         
                                                                             entrylen:0| matchidx:191| nextidx:192
                                                                             S2|T7 replica entries to S0|         
                                                                             entrylen:0| matchidx:191| nextidx:192
S0|T7 is not leader                                                                                               
                                       S1|T7 is not leader                                                        
                                       S1|T7 save persist| votedFor: 1|                                           
                                       logsLen: 192                                                               
S0|T7 save persist| votedFor: 2|                                                                                  
logsLen: 192                                                                                                      
                                       S1|T7 appends logs from S2| logLen:                                        
                                       192[AppendEntry]                                                           
S0|T7 appends logs from S2| logLen:                                                                               
192[AppendEntry]                                                                                                  
                                                                             S2|T7 replica entries to S1|         
                                                                             entrylen:0| matchidx:191| nextidx:192
                                                                             S2|T7 replica entries to S0|         
                                                                             entrylen:0| matchidx:191| nextidx:192
                                       S1|T7 fails to install snapshot to S2                                      
S0|T7 is not leader                                                                                               
                                       S1|T7 is not leader                                                        
                                       S1|T7 save persist| votedFor: 1|                                           
                                       logsLen: 192                                                               
S0|T7 save persist| votedFor: 2|                                                                                  
logsLen: 192                                                                                                      
                                       S1|T7 appends logs from S2| logLen:                                        
                                       192[AppendEntry]                                                           
S0|T7 appends logs from S2| logLen:                                                                               
192[AppendEntry]                                                                                                  
                                                                             S2|T7 replica entries to S0|         
                                                                             entrylen:0| matchidx:191| nextidx:192
                                                                             S2|T7 replica entries to S1|         
                                                                             entrylen:0| matchidx:191| nextidx:192
                                       S1|T7 is not leader                                                        
S0|T7 is not leader                                                                                               
                                       S1|T7 save persist| votedFor: 1|                                           
                                       logsLen: 192                                                               
S0|T7 save persist| votedFor: 2|                                                                                  
logsLen: 192                                                                                                      
                                       S1|T7 appends logs from S2| logLen:                                        
                                       192[AppendEntry]                                                           
S0|T7 appends logs from S2| logLen:                                                                               
192[AppendEntry]                                                                                                  
                                                                             S2|T7 replica entries to S1|         
                                                                             entrylen:0| matchidx:191| nextidx:192
                                                                             S2|T7 replica entries to S0|         
                                                                             entrylen:0| matchidx:191| nextidx:192
                                       S1|T7 is not leader                                                        
S0|T7 is not leader                                                                                               
                                       S1|T7 save persist| votedFor: 1|                                           
                                       logsLen: 192                                                               
S0|T7 save persist| votedFor: 2|                                                                                  
logsLen: 192                                                                                                      
                                       S1|T7 appends logs from S2| logLen:                                        
                                       192[AppendEntry]                                                           
S0|T7 appends logs from S2| logLen:                                                                               
192[AppendEntry]                                                                                                  
                                                                             S2|T7 replica entries to S1|         
                                                                             entrylen:0| matchidx:191| nextidx:192
                                                                             S2|T7 replica entries to S0|         
                                                                             entrylen:0| matchidx:191| nextidx:192
S0|T7 is not leader                                                                                               
                                       S1|T7 is not leader                                                        
                                       S1|T7 save persist| votedFor: 1|                                           
                                       logsLen: 192                                                               
                                       S1|T7 appends logs from S2| logLen:                                        
                                       192[AppendEntry]                                                           
S0|T7 save persist| votedFor: 2|                                                                                  
logsLen: 192                                                                                                      
S0|T7 appends logs from S2| logLen:                                                                               
192[AppendEntry]                                                                                                  
                                                                             S2|T7 replica entries to S1|         
                                                                             entrylen:0| matchidx:191| nextidx:192
                                                                             S2|T7 replica entries to S0|         
                                                                             entrylen:0| matchidx:191| nextidx:192
S0|T7 is not leader                                                                                               
                                       S1|T7 is not leader                                                        
                                       S1|T7 save persist| votedFor: 1|                                           
                                       logsLen: 192                                                               
                                       S1|T7 appends logs from S2| logLen:                                        
                                       192[AppendEntry]                                                           
S0|T7 save persist| votedFor: 2|                                                                                  
logsLen: 192                                                                                                      
S0|T7 appends logs from S2| logLen:                                                                               
192[AppendEntry]                                                                                                  
                                                                             S2|T7 replica entries to S0|         
                                                                             entrylen:0| matchidx:191| nextidx:192
                                                                             S2|T7 replica entries to S1|         
                                                                             entrylen:0| matchidx:191| nextidx:192
S0|T7 fails to install snapshot to S1                                                                             
                                       S1|T7 is not leader                                                        
S0|T7 is not leader                                                                                               
S0|T7 save persist| votedFor: 2|                                                                                  
logsLen: 192                                                                                                      
S0|T7 appends logs from S2| logLen:                                                                               
192[AppendEntry]                                                                                                  
                                       S1|T7 save persist| votedFor: 1|                                           
                                       logsLen: 192                                                               
                                       S1|T7 appends logs from S2| logLen:                                        
                                       192[AppendEntry]                                                           
                                                                             S2|T7 replica entries to S0|         
                                                                             entrylen:0| matchidx:191| nextidx:192
                                                                             S2|T7 replica entries to S1|         
                                                                             entrylen:0| matchidx:191| nextidx:192
                                       S1|T7 is not leader                                                        
S0|T7 is not leader                                                                                               
S0|T7 save persist| votedFor: 2|                                                                                  
logsLen: 192                                                                                                      
S0|T7 appends logs from S2| logLen:                                                                               
192[AppendEntry]                                                                                                  
                                       S1|T7 save persist| votedFor: 1|                                           
                                       logsLen: 192                                                               
                                       S1|T7 appends logs from S2| logLen:                                        
                                       192[AppendEntry]                                                           
                                                                             S2|T7 replica entries to S0|         
                                                                             entrylen:0| matchidx:191| nextidx:192
                                                                             S2|T7 replica entries to S1|         
                                                                             entrylen:0| matchidx:191| nextidx:192
                                       S1|T7 is not leader                                                        
S0|T7 is not leader                                                                                               
                                       S1|T7 save persist| votedFor: 1|                                           
                                       logsLen: 192                                                               
                                       S1|T7 appends logs from S2| logLen:                                        
                                       192[AppendEntry]                                                           
S0|T7 save persist| votedFor: 2|                                                                                  
logsLen: 192                                                                                                      
S0|T7 appends logs from S2| logLen:                                                                               
192[AppendEntry]                                                                                                  
                                                                             S2|T7 replica entries to S1|         
                                                                             entrylen:0| matchidx:191| nextidx:192
                                                                             S2|T7 replica entries to S0|         
                                                                             entrylen:0| matchidx:191| nextidx:192
S0|T7 is not leader                                                                                               
                                       S1|T7 is not leader                                                        
S0|T7 save persist| votedFor: 2|                                                                                  
logsLen: 192                                                                                                      
S0|T7 appends logs from S2| logLen:                                                                               
192[AppendEntry]                                                                                                  
                                       S1|T7 save persist| votedFor: 1|                                           
                                       logsLen: 192                                                               
                                       S1|T7 appends logs from S2| logLen:                                        
                                       192[AppendEntry]                                                           
                                                                             S2|T7 replica entries to S0|         
                                                                             entrylen:0| matchidx:191| nextidx:192
                                                                             S2|T7 replica entries to S1|         
                                                                             entrylen:0| matchidx:191| nextidx:192
                                       S1|T7 is not leader                                                        
S0|T7 is not leader                                                                                               
                                       S1|T7 save persist| votedFor: 1|                                           
                                       logsLen: 192                                                               
S0|T7 save persist| votedFor: 2|                                                                                  
logsLen: 192                                                                                                      
                                       S1|T7 appends logs from S2| logLen:                                        
                                       192[AppendEntry]                                                           
S0|T7 appends logs from S2| logLen:                                                                               
192[AppendEntry]                                                                                                  
                                                                             S2|T7 replica entries to S1|         
                                                                             entrylen:0| matchidx:191| nextidx:192
                                                                             S2|T7 replica entries to S0|         
                                                                             entrylen:0| matchidx:191| nextidx:192
S0|T7 is not leader                                                                                               
                                       S1|T7 is not leader                                                        
                                       S1|T7 save persist| votedFor: 1|                                           
                                       logsLen: 192                                                               
                                       S1|T7 appends logs from S2| logLen:                                        
                                       192[AppendEntry]                                                           
S0|T7 save persist| votedFor: 2|                                                                                  
logsLen: 192                                                                                                      
S0|T7 appends logs from S2| logLen:                                                                               
192[AppendEntry]                                                                                                  
                                                                             S2|T7 replica entries to S1|         
                                                                             entrylen:0| matchidx:191| nextidx:192
                                                                             S2|T7 replica entries to S0|         
                                                                             entrylen:0| matchidx:191| nextidx:192
S0|T7 is not leader                                                                                               
                                       S1|T7 is not leader                                                        
S0|T7 save persist| votedFor: 2|                                                                                  
logsLen: 192                                                                                                      
                                       S1|T7 save persist| votedFor: 1|                                           
                                       logsLen: 192                                                               
                                       S1|T7 appends logs from S2| logLen:                                        
                                       192[AppendEntry]                                                           
S0|T7 appends logs from S2| logLen:                                                                               
192[AppendEntry]                                                                                                  
                                                                             S2|T7 replica entries to S1|         
                                                                             entrylen:0| matchidx:191| nextidx:192
                                                                             S2|T7 replica entries to S0|         
                                                                             entrylen:0| matchidx:191| nextidx:192
S0|T7 is not leader                                                                                               
                                       S1|T7 is not leader                                                        
                                       S1|T7 save persist| votedFor: 1|                                           
                                       logsLen: 192                                                               
                                       S1|T7 appends logs from S2| logLen:                                        
                                       192[AppendEntry]                                                           
S0|T7 save persist| votedFor: 2|                                                                                  
logsLen: 192                                                                                                      
S0|T7 appends logs from S2| logLen:                                                                               
192[AppendEntry]                                                                                                  
                                                                             S2|T7 save persist| votedFor: 2|     
                                                                             logsLen: 193                         
                                                                             S2|T7 receive commands | logLen:     
                                                                             193[Start]                           
                                                                             S2|T7 replica entries to S1|         
                                                                             entrylen:0| matchidx:191| nextidx:192
                                                                             S2|T7 replica entries to S0|         
                                                                             entrylen:0| matchidx:191| nextidx:192
S0|T7 is not leader                                                                                               
                                       S1|T7 is not leader                                                        
S0|T7 save persist| votedFor: 2|                                                                                  
logsLen: 193                                                                                                      
                                       S1|T7 save persist| votedFor: 1|                                           
                                       logsLen: 193                                                               
                                       S1|T7 appends logs from S2| logLen:                                        
                                       193[AppendEntry]                                                           
S0|T7 appends logs from S2| logLen:                                                                               
193[AppendEntry]                                                                                                  
                                                                             S2|T7 replica entries to S1|         
                                                                             entrylen:1| matchidx:192| nextidx:193
                                                                             S2|T7 update commitIndex as 192      
                                                                             S2|T7 starts to apply entries        
                                                                             [192:192][ApplyEntry]                
                                                                             S2|T7 finishes applying entries      
                                                                             [192:192][ApplyEntry]                
                                                                             S2|T7 replica entries to S0|         
                                                                             entrylen:1| matchidx:192| nextidx:193
S0|T7 is not leader                                                                                               
                                       S1|T7 is not leader                                                        
                                       S1|T7 save persist| votedFor: 1|                                           
                                       logsLen: 193                                                               
S0|T7 save persist| votedFor: 2|                                                                                  
logsLen: 193                                                                                                      
                                       S1|T7 appends logs from S2| logLen:                                        
                                       193[AppendEntry]                                                           
S0|T7 appends logs from S2| logLen:                                                                               
193[AppendEntry]                                                                                                  
                                       S1|T7 starts to apply entries                                              
                                       [192:192][ApplyEntry]                                                      
                                       S1|T7 finishes applying entries                                            
                                       [192:192][ApplyEntry]                                                      
S0|T7 starts to apply entries                                                                                     
[192:192][ApplyEntry]                                                                                             
S0|T7 finishes applying entries                                                                                   
[192:192][ApplyEntry]                                                                                             
                                                                             S2|T7 replica entries to S1|         
                                                                             entrylen:0| matchidx:192| nextidx:193
                                                                             S2|T7 replica entries to S0|         
                                                                             entrylen:0| matchidx:192| nextidx:193
                                       S1|T7 is not leader                                                        
S0|T7 is not leader                                                                                               
                                       S1|T7 save persist| votedFor: 1|                                           
                                       logsLen: 193                                                               
                                       S1|T7 appends logs from S2| logLen:                                        
                                       193[AppendEntry]                                                           
S0|T7 save persist| votedFor: 2|                                                                                  
logsLen: 193                                                                                                      
S0|T7 appends logs from S2| logLen:                                                                               
193[AppendEntry]                                                                                                  
                                                                             S2|T7 replica entries to S1|         
                                                                             entrylen:0| matchidx:192| nextidx:193
                                                                             S2|T7 replica entries to S0|         
                                                                             entrylen:0| matchidx:192| nextidx:193
                                       S1|T7 is not leader                                                        
S0|T7 is not leader                                                                                               
                                       S1|T7 save persist| votedFor: 1|                                           
                                       logsLen: 193                                                               
S0|T7 save persist| votedFor: 2|                                                                                  
logsLen: 193                                                                                                      
                                       S1|T7 appends logs from S2| logLen:                                        
                                       193[AppendEntry]                                                           
S0|T7 appends logs from S2| logLen:                                                                               
193[AppendEntry]                                                                                                  
                                                                             S2|T7 replica entries to S0|         
                                                                             entrylen:0| matchidx:192| nextidx:193
                                                                             S2|T7 replica entries to S1|         
                                                                             entrylen:0| matchidx:192| nextidx:193
                                       S1|T7 is not leader                                                        
S0|T7 is not leader                                                                                               
                                       S1|T7 save persist| votedFor: 1|                                           
                                       logsLen: 193                                                               
                                       S1|T7 appends logs from S2| logLen:                                        
                                       193[AppendEntry]                                                           
S0|T7 save persist| votedFor: 2|                                                                                  
logsLen: 193                                                                                                      
S0|T7 appends logs from S2| logLen:                                                                               
193[AppendEntry]                                                                                                  
                                                                             S2|T7 replica entries to S1|         
                                                                             entrylen:0| matchidx:192| nextidx:193
                                                                             S2|T7 replica entries to S0|         
                                                                             entrylen:0| matchidx:192| nextidx:193
S0|T7 is not leader                                                                                               
                                       S1|T7 is not leader                                                        
                                       S1|T7 save persist| votedFor: 1|                                           
                                       logsLen: 193                                                               
                                       S1|T7 appends logs from S2| logLen:                                        
                                       193[AppendEntry]                                                           
S0|T7 save persist| votedFor: 2|                                                                                  
logsLen: 193                                                                                                      
S0|T7 appends logs from S2| logLen:                                                                               
193[AppendEntry]                                                                                                  
                                                                             S2|T7 replica entries to S1|         
                                                                             entrylen:0| matchidx:192| nextidx:193
                                                                             S2|T7 replica entries to S0|         
                                                                             entrylen:0| matchidx:192| nextidx:193
                                       S1|T7 is not leader                                                        
S0|T7 is not leader                                                                                               
S0|T7 save persist| votedFor: 2|                                                                                  
logsLen: 193                                                                                                      
                                       S1|T7 save persist| votedFor: 1|                                           
                                       logsLen: 193                                                               
S0|T7 appends logs from S2| logLen:                                                                               
193[AppendEntry]                                                                                                  
                                       S1|T7 appends logs from S2| logLen:                                        
                                       193[AppendEntry]                                                           
                                                                             S2|T7 replica entries to S0|         
                                                                             entrylen:0| matchidx:192| nextidx:193
                                                                             S2|T7 replica entries to S1|         
                                                                             entrylen:0| matchidx:192| nextidx:193
S0 is disconnected                                                                                                
                                                                             S2|T7 save persist| votedFor: 2|     
                                                                             logsLen: 194                         
                                                                             S2|T7 receive commands | logLen:     
                                                                             194[Start]                           
S0|T7 is not leader                                                                                               
                                       S1|T7 is not leader                                                        
                                       S1|T7 save persist| votedFor: 1|                                           
                                       logsLen: 194                                                               
                                       S1|T7 appends logs from S2| logLen:                                        
                                       194[AppendEntry]                                                           
                                                                             S2|T7 replica entries to S1|         
                                                                             entrylen:1| matchidx:193| nextidx:194
                                                                             S2|T7 update commitIndex as 193      
                                                                             S2|T7 starts to apply entries        
                                                                             [193:193][ApplyEntry]                
                                                                             S2|T7 finishes applying entries      
                                                                             [193:193][ApplyEntry]                
                                       S1|T7 is not leader                                                        
S0|T7 is not leader                                                                                               
                                       S1|T7 save persist| votedFor: 1|                                           
                                       logsLen: 194                                                               
                                       S1|T7 appends logs from S2| logLen:                                        
                                       194[AppendEntry]                                                           
                                       S1|T7 starts to apply entries                                              
                                       [193:193][ApplyEntry]                                                      
                                       S1|T7 finishes applying entries                                            
                                       [193:193][ApplyEntry]                                                      
                                                                             S2|T7 replica entries to S1|         
                                                                             entrylen:0| matchidx:193| nextidx:194
                                                                             S2|T7 save persist| votedFor: 2|     
                                                                             logsLen: 195                         
                                                                             S2|T7 receive commands | logLen:     
                                                                             195[Start]                           
                                                                             S2|T7 save persist| votedFor: 2|     
                                                                             logsLen: 196                         
                                                                             S2|T7 receive commands | logLen:     
                                                                             196[Start]                           
                                                                             S2|T7 save persist| votedFor: 2|     
                                                                             logsLen: 197                         
                                                                             S2|T7 receive commands | logLen:     
                                                                             197[Start]                           
                                                                             S2|T7 save persist| votedFor: 2|     
                                                                             logsLen: 198                         
                                                                             S2|T7 receive commands | logLen:     
                                                                             198[Start]                           
                                                                             S2|T7 save persist| votedFor: 2|     
                                                                             logsLen: 199                         
                                                                             S2|T7 receive commands | logLen:     
                                                                             199[Start]                           
                                                                             S2|T7 save persist| votedFor: 2|     
                                                                             logsLen: 200                         
                                                                             S2|T7 receive commands | logLen:     
                                                                             200[Start]                           
                                                                             S2|T7 save persist| votedFor: 2|     
                                                                             logsLen: 201                         
                                                                             S2|T7 receive commands | logLen:     
                                                                             201[Start]                           
                                                                             S2|T7 save persist| votedFor: 2|     
                                                                             logsLen: 202                         
                                                                             S2|T7 receive commands | logLen:     
                                                                             202[Start]                           
                                                                             S2|T7 save persist| votedFor: 2|     
                                                                             logsLen: 203                         
                                                                             S2|T7 receive commands | logLen:     
                                                                             203[Start]                           
                                                                             S2|T7 save persist| votedFor: 2|     
                                                                             logsLen: 204                         
                                                                             S2|T7 receive commands | logLen:     
                                                                             204[Start]                           
                                                                             S2|T7 save persist| votedFor: 2|     
                                                                             logsLen: 205                         
                                                                             S2|T7 receive commands | logLen:     
                                                                             205[Start]                           
                                                                             S2|T7 save persist| votedFor: 2|     
                                                                             logsLen: 206                         
                                                                             S2|T7 receive commands | logLen:     
                                                                             206[Start]                           
                                                                             S2|T7 save persist| votedFor: 2|     
                                                                             logsLen: 207                         
                                                                             S2|T7 receive commands | logLen:     
                                                                             207[Start]                           
                                                                             S2|T7 save persist| votedFor: 2|     
                                                                             logsLen: 208                         
                                                                             S2|T7 receive commands | logLen:     
                                                                             208[Start]                           
                                                                             S2|T7 save persist| votedFor: 2|     
                                                                             logsLen: 209                         
                                                                             S2|T7 receive commands | logLen:     
                                                                             209[Start]                           
                                       S1|T7 is not leader                                                        
S0|T7 is not leader                                                                                               
                                       S1|T7 save persist| votedFor: 1|                                           
                                       logsLen: 209                                                               
                                       S1|T7 appends logs from S2| logLen:                                        
                                       209[AppendEntry]                                                           
                                                                             S2|T7 replica entries to S1|         
                                                                             entrylen:15| matchidx:208|           
                                                                             nextidx:209                          
                                                                             S2|T7 update commitIndex as 208      
                                                                             S2|T7 starts to apply entries        
                                                                             [194:208][ApplyEntry]                
                                                                             S2|T7 Snapshot until index 199|      
                                                                             logLen: 209                          
                                                                             S2|T7 finishes applying entries      
                                                                             [194:208][ApplyEntry]                
S0|T7 is not leader                                                                                               
                                       S1|T7 is not leader                                                        
                                                                             S2|T7 send rpc to S0|base: 199| next:
                                                                             193                                  
                                       S1|T7 save persist| votedFor: 1|                                           
                                       logsLen: 209                                                               
                                       S1|T7 appends logs from S2| logLen:                                        
                                       209[AppendEntry]                                                           
                                       S1|T7 starts to apply entries                                              
                                       [194:208][ApplyEntry]                                                      
                                                                             S2|T7 replica entries to S1|         
                                                                             entrylen:0| matchidx:208| nextidx:209
                                       S1|T7 Snapshot until index 199|                                            
                                       logLen: 209                                                                
                                       S1|T7 finishes applying entries                                            
                                       [194:208][ApplyEntry]                                                      
S0 is connected again                                                                                             
                                                                             S2|T7 save persist| votedFor: 2|     
                                                                             logsLen: 210                         
                                                                             S2|T7 receive commands | logLen:     
                                                                             210[Start]                           
S0|T7 is not leader                                                                                               
                                       S1|T7 is not leader                                                        
                                                                             S2|T7 send rpc to S0|base: 199| next:
                                                                             193                                  
S0|T7 receive rpc from S2                                                                                         
S0|T7 update rfstate| Base:199|                                                                                   
LogLen:200                                                                                                        
                                       S1|T7 save persist| votedFor: 1|                                           
                                       logsLen: 210                                                               
S0|T7 applys snapshot from S2                                                                                     
                                       S1|T7 appends logs from S2| logLen:                                        
                                       210[AppendEntry]                                                           
                                                                             S2|T7 installs snapshot to S0|       
                                                                             nextId:200| matchId:199              
                                                                             S2|T7 replica entries to S1|         
                                                                             entrylen:1| matchidx:209| nextidx:210
                                                                             S2|T7 update commitIndex as 209      
                                                                             S2|T7 starts to apply entries        
                                                                             [209:209][ApplyEntry]                
                                                                             S2|T7 finishes applying entries      
                                                                             [209:209][ApplyEntry]                
                                                                             S2|T7 Snapshot until index 209|      
                                                                             logLen: 210                          
                                       S1|T7 is not leader                                                        
                                                                             S2|T7 send rpc to S0|base: 209| next:
                                                                             200                                  
S0|T7 is not leader                                                                                               
S0|T7 receive rpc from S2                                                                                         
S0|T7 update rfstate| Base:209|                                                                                   
LogLen:210                                                                                                        
                                       S1|T7 save persist| votedFor: 1|                                           
                                       logsLen: 210                                                               
                                       S1|T7 appends logs from S2| logLen:                                        
                                       210[AppendEntry]                                                           
S0|T7 applys snapshot from S2                                                                                     
                                       S1|T7 starts to apply entries                                              
                                       [209:209][ApplyEntry]                                                      
                                       S1|T7 finishes applying entries                                            
                                       [209:209][ApplyEntry]                                                      
                                                                             S2|T7 installs snapshot to S0|       
                                                                             nextId:210| matchId:209              
                                                                             S2|T7 replica entries to S1|         
                                                                             entrylen:0| matchidx:209| nextidx:210
                                       S1|T7 Snapshot until index 209|                                            
                                       logLen: 210                                                                
S0|T7 is not leader                                                                                               
                                       S1|T7 is not leader                                                        
S0|T7 save persist| votedFor: 2|                                                                                  
logsLen: 210                                                                                                      
S0|T7 appends logs from S2| logLen:                                                                               
210[AppendEntry]                                                                                                  
                                       S1|T7 save persist| votedFor: 1|                                           
                                       logsLen: 210                                                               
                                       S1|T7 appends logs from S2| logLen:                                        
                                       210[AppendEntry]                                                           
                                                                             S2|T7 replica entries to S0|         
                                                                             entrylen:0| matchidx:209| nextidx:210
                                                                             S2|T7 replica entries to S1|         
                                                                             entrylen:0| matchidx:209| nextidx:210
                                       S1|T7 is not leader                                                        
S0|T7 is not leader                                                                                               
                                       S1|T7 save persist| votedFor: 1|                                           
                                       logsLen: 210                                                               
S0|T7 save persist| votedFor: 2|                                                                                  
logsLen: 210                                                                                                      
                                       S1|T7 appends logs from S2| logLen:                                        
                                       210[AppendEntry]                                                           
S0|T7 appends logs from S2| logLen:                                                                               
210[AppendEntry]                                                                                                  
                                                                             S2|T7 replica entries to S1|         
                                                                             entrylen:0| matchidx:209| nextidx:210
                                                                             S2|T7 replica entries to S0|         
                                                                             entrylen:0| matchidx:209| nextidx:210
                                       S1|T7 is not leader                                                        
S0|T7 is not leader                                                                                               
                                       S1|T7 save persist| votedFor: 1|                                           
                                       logsLen: 210                                                               
                                       S1|T7 appends logs from S2| logLen:                                        
                                       210[AppendEntry]                                                           
S0|T7 save persist| votedFor: 2|                                                                                  
logsLen: 210                                                                                                      
S0|T7 appends logs from S2| logLen:                                                                               
210[AppendEntry]                                                                                                  
                                                                             S2|T7 replica entries to S1|         
                                                                             entrylen:0| matchidx:209| nextidx:210
                                                                             S2|T7 replica entries to S0|         
                                                                             entrylen:0| matchidx:209| nextidx:210
                                       S1|T7 is not leader                                                        
S0|T7 is not leader                                                                                               
                                       S1|T7 save persist| votedFor: 1|                                           
                                       logsLen: 210                                                               
S0|T7 save persist| votedFor: 2|                                                                                  
logsLen: 210                                                                                                      
                                       S1|T7 appends logs from S2| logLen:                                        
                                       210[AppendEntry]                                                           
S0|T7 appends logs from S2| logLen:                                                                               
210[AppendEntry]                                                                                                  
                                                                             S2|T7 replica entries to S1|         
                                                                             entrylen:0| matchidx:209| nextidx:210
                                                                             S2|T7 replica entries to S0|         
                                                                             entrylen:0| matchidx:209| nextidx:210
                                       S1|T7 is not leader                                                        
S0|T7 is not leader                                                                                               
                                       S1|T7 save persist| votedFor: 1|                                           
                                       logsLen: 210                                                               
                                       S1|T7 appends logs from S2| logLen:                                        
                                       210[AppendEntry]                                                           
S0|T7 save persist| votedFor: 2|                                                                                  
logsLen: 210                                                                                                      
S0|T7 appends logs from S2| logLen:                                                                               
210[AppendEntry]                                                                                                  
                                                                             S2|T7 replica entries to S1|         
                                                                             entrylen:0| matchidx:209| nextidx:210
                                                                             S2|T7 replica entries to S0|         
                                                                             entrylen:0| matchidx:209| nextidx:210
S0 is disconnected                                                                                                
                                                                             S2|T7 save persist| votedFor: 2|     
                                                                             logsLen: 211                         
                                                                             S2|T7 receive commands | logLen:     
                                                                             211[Start]                           
                                       S1|T7 is not leader                                                        
S0|T7 is not leader                                                                                               
                                       S1|T7 save persist| votedFor: 1|                                           
                                       logsLen: 211                                                               
                                       S1|T7 appends logs from S2| logLen:                                        
                                       211[AppendEntry]                                                           
                                                                             S2|T7 replica entries to S1|         
                                                                             entrylen:1| matchidx:210| nextidx:211
                                                                             S2|T7 update commitIndex as 210      
                                                                             S2|T7 starts to apply entries        
                                                                             [210:210][ApplyEntry]                
                                                                             S2|T7 finishes applying entries      
                                                                             [210:210][ApplyEntry]                
                                       S1|T7 is not leader                                                        
S0|T7 is not leader                                                                                               
                                       S1|T7 save persist| votedFor: 1|                                           
                                       logsLen: 211                                                               
                                       S1|T7 appends logs from S2| logLen:                                        
                                       211[AppendEntry]                                                           
                                       S1|T7 starts to apply entries                                              
                                       [210:210][ApplyEntry]                                                      
                                       S1|T7 finishes applying entries                                            
                                       [210:210][ApplyEntry]                                                      
                                                                             S2|T7 replica entries to S1|         
                                                                             entrylen:0| matchidx:210| nextidx:211
                                                                             S2|T7 save persist| votedFor: 2|     
                                                                             logsLen: 212                         
                                                                             S2|T7 receive commands | logLen:     
                                                                             212[Start]                           
                                                                             S2|T7 save persist| votedFor: 2|     
                                                                             logsLen: 213                         
                                                                             S2|T7 receive commands | logLen:     
                                                                             213[Start]                           
                                                                             S2|T7 save persist| votedFor: 2|     
                                                                             logsLen: 214                         
                                                                             S2|T7 receive commands | logLen:     
                                                                             214[Start]                           
                                                                             S2|T7 save persist| votedFor: 2|     
                                                                             logsLen: 215                         
                                                                             S2|T7 receive commands | logLen:     
                                                                             215[Start]                           
                                                                             S2|T7 save persist| votedFor: 2|     
                                                                             logsLen: 216                         
                                                                             S2|T7 receive commands | logLen:     
                                                                             216[Start]                           
                                                                             S2|T7 save persist| votedFor: 2|     
                                                                             logsLen: 217                         
                                                                             S2|T7 receive commands | logLen:     
                                                                             217[Start]                           
                                                                             S2|T7 save persist| votedFor: 2|     
                                                                             logsLen: 218                         
                                                                             S2|T7 receive commands | logLen:     
                                                                             218[Start]                           
                                                                             S2|T7 save persist| votedFor: 2|     
                                                                             logsLen: 219                         
                                                                             S2|T7 receive commands | logLen:     
                                                                             219[Start]                           
                                       S1|T7 is not leader                                                        
S0|T7 is not leader                                                                                               
                                       S1|T7 save persist| votedFor: 1|                                           
                                       logsLen: 219                                                               
                                       S1|T7 appends logs from S2| logLen:                                        
                                       219[AppendEntry]                                                           
                                                                             S2|T7 replica entries to S1|         
                                                                             entrylen:8| matchidx:218| nextidx:219
                                                                             S2|T7 update commitIndex as 218      
                                                                             S2|T7 starts to apply entries        
                                                                             [211:218][ApplyEntry]                
                                                                             S2|T7 finishes applying entries      
                                                                             [211:218][ApplyEntry]                
                                       S1|T7 is not leader                                                        
S0|T7 is not leader                                                                                               
                                       S1|T7 save persist| votedFor: 1|                                           
                                       logsLen: 219                                                               
                                       S1|T7 appends logs from S2| logLen:                                        
                                       219[AppendEntry]                                                           
                                       S1|T7 starts to apply entries                                              
                                       [211:218][ApplyEntry]                                                      
                                       S1|T7 finishes applying entries                                            
                                       [211:218][ApplyEntry]                                                      
                                                                             S2|T7 replica entries to S1|         
                                                                             entrylen:0| matchidx:218| nextidx:219
S0 is connected again                                                                                             
                                                                             S2|T7 save persist| votedFor: 2|     
                                                                             logsLen: 220                         
                                                                             S2|T7 receive commands | logLen:     
                                                                             220[Start]                           
                                       S1|T7 is not leader                                                        
S0|T7 is not leader                                                                                               
                                       S1|T7 save persist| votedFor: 1|                                           
                                       logsLen: 220                                                               
                                       S1|T7 appends logs from S2| logLen:                                        
                                       220[AppendEntry]                                                           
S0|T7 save persist| votedFor: 2|                                                                                  
logsLen: 220                                                                                                      
S0|T7 appends logs from S2| logLen:                                                                               
220[AppendEntry]                                                                                                  
S0|T7 starts to apply entries                                                                                     
[210:218][ApplyEntry]                                                                                             
                                                                             S2|T7 replica entries to S1|         
                                                                             entrylen:1| matchidx:219| nextidx:220
                                                                             S2|T7 update commitIndex as 219      
S0|T7 finishes applying entries                                                                                   
[210:218][ApplyEntry]                                                                                             
                                                                             S2|T7 starts to apply entries        
                                                                             [219:219][ApplyEntry]                
                                                                             S2|T7 finishes applying entries      
                                                                             [219:219][ApplyEntry]                
                                                                             S2|T7 replica entries to S0|         
                                                                             entrylen:10| matchidx:219|           
                                                                             nextidx:220                          
                                                                             S2|T7 Snapshot until index 219|      
                                                                             logLen: 220                          
S0|T7 is not leader                                                                                               
                                       S1|T7 is not leader                                                        
                                       S1|T7 save persist| votedFor: 1|                                           
                                       logsLen: 220                                                               
                                       S1|T7 appends logs from S2| logLen:                                        
                                       220[AppendEntry]                                                           
S0|T7 save persist| votedFor: 2|                                                                                  
logsLen: 220                                                                                                      
S0|T7 appends logs from S2| logLen:                                                                               
220[AppendEntry]                                                                                                  
                                       S1|T7 starts to apply entries                                              
                                       [219:219][ApplyEntry]                                                      
                                       S1|T7 finishes applying entries                                            
                                       [219:219][ApplyEntry]                                                      
                                                                             S2|T7 replica entries to S1|         
                                                                             entrylen:0| matchidx:219| nextidx:220
S0|T7 starts to apply entries                                                                                     
[219:219][ApplyEntry]                                                                                             
                                                                             S2|T7 replica entries to S0|         
                                                                             entrylen:0| matchidx:219| nextidx:220
S0|T7 finishes applying entries                                                                                   
[219:219][ApplyEntry]                                                                                             
                                       S1|T7 Snapshot until index 219|                                            
                                       logLen: 220                                                                
S0|T7 Snapshot until index 219|                                                                                   
logLen: 220                                                                                                       
S0|T7 is not leader                                                                                               
                                       S1|T7 is not leader                                                        
                                       S1|T7 save persist| votedFor: 1|                                           
                                       logsLen: 220                                                               
                                       S1|T7 appends logs from S2| logLen:                                        
                                       220[AppendEntry]                                                           
S0|T7 save persist| votedFor: 2|                                                                                  
logsLen: 220                                                                                                      
S0|T7 appends logs from S2| logLen:                                                                               
220[AppendEntry]                                                                                                  
                                                                             S2|T7 replica entries to S1|         
                                                                             entrylen:0| matchidx:219| nextidx:220
                                                                             S2|T7 replica entries to S0|         
                                                                             entrylen:0| matchidx:219| nextidx:220
                                                                             S2|T7 fails to install snapshot to S1
                                       S1|T7 is not leader                                                        
S0|T7 is not leader                                                                                               
                                       S1|T7 save persist| votedFor: 1|                                           
                                       logsLen: 220                                                               
S0|T7 save persist| votedFor: 2|                                                                                  
logsLen: 220                                                                                                      
S0|T7 appends logs from S2| logLen:                                                                               
220[AppendEntry]                                                                                                  
                                       S1|T7 appends logs from S2| logLen:                                        
                                       220[AppendEntry]                                                           
                                                                             S2|T7 replica entries to S0|         
                                                                             entrylen:0| matchidx:219| nextidx:220
                                                                             S2|T7 replica entries to S1|         
                                                                             entrylen:0| matchidx:219| nextidx:220
S0|T7 is not leader                                                                                               
                                       S1|T7 is not leader                                                        
S0|T7 save persist| votedFor: 2|                                                                                  
logsLen: 220                                                                                                      
                                       S1|T7 save persist| votedFor: 1|                                           
                                       logsLen: 220                                                               
S0|T7 appends logs from S2| logLen:                                                                               
220[AppendEntry]                                                                                                  
                                       S1|T7 appends logs from S2| logLen:                                        
                                       220[AppendEntry]                                                           
                                                                             S2|T7 replica entries to S0|         
                                                                             entrylen:0| matchidx:219| nextidx:220
                                                                             S2|T7 replica entries to S1|         
                                                                             entrylen:0| matchidx:219| nextidx:220
S0|T7 is not leader                                                                                               
                                       S1|T7 is not leader                                                        
                                       S1|T7 save persist| votedFor: 1|                                           
                                       logsLen: 220                                                               
S0|T7 save persist| votedFor: 2|                                                                                  
logsLen: 220                                                                                                      
S0|T7 appends logs from S2| logLen:                                                                               
220[AppendEntry]                                                                                                  
                                       S1|T7 appends logs from S2| logLen:                                        
                                       220[AppendEntry]                                                           
                                                                             S2|T7 replica entries to S0|         
                                                                             entrylen:0| matchidx:219| nextidx:220
                                                                             S2|T7 replica entries to S1|         
                                                                             entrylen:0| matchidx:219| nextidx:220
S0|T7 is not leader                                                                                               
                                       S1|T7 is not leader                                                        
                                       S1|T7 save persist| votedFor: 1|                                           
                                       logsLen: 220                                                               
S0|T7 save persist| votedFor: 2|                                                                                  
logsLen: 220                                                                                                      
S0|T7 appends logs from S2| logLen:                                                                               
220[AppendEntry]                                                                                                  
                                       S1|T7 appends logs from S2| logLen:                                        
                                       220[AppendEntry]                                                           
                                                                             S2|T7 replica entries to S0|         
                                                                             entrylen:0| matchidx:219| nextidx:220
                                                                             S2|T7 replica entries to S1|         
                                                                             entrylen:0| matchidx:219| nextidx:220
                                                                             S2 is disconnected                   
                                       S1|T7 is not leader                                                        
S0|T7 is not leader                                                                                               
S0|T7 is not leader                                                                                               
                                       S1|T7 is not leader                                                        
                                       S1|T7 is not leader                                                        
S0|T7 is not leader                                                                                               
S0|T7 is not leader                                                                                               
                                       S1|T7 is not leader                                                        
S0|T7 is not leader                                                                                               
                                       S1|T7 is not leader                                                        
                                       S1|T7 is not leader                                                        
S0|T7 is not leader                                                                                               
                                       S1|T7 is not leader                                                        
S0|T7 is not leader                                                                                               
                                       S1|T7 is not leader                                                        
S0|T7 is not leader                                                                                               
                                                                             S2|T7 fails to install snapshot to S0
S0|T7 is not leader                                                                                               
                                       S1|T7 is not leader                                                        
                                       S1|T8 starts to join election                                              
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 220                                                               
S0|T8 save persist| votedFor: -1|                                                                                 
logsLen: 220                                                                                                      
S0|T8 save persist| votedFor: 1|                                                                                  
logsLen: 220                                                                                                      
S0|T8 votes for S1[RequestVote]                                                                                   
                                       S1|T8 becomes the leader, and starts                                       
                                       heatbeats                                                                  
S0|T8 save persist| votedFor: 1|                                                                                  
logsLen: 220                                                                                                      
S0|T8 appends logs from S1| logLen:                                                                               
220[AppendEntry]                                                                                                  
                                       S1|T8 replica entries to S0|                                               
                                       entrylen:0| matchidx:219| nextidx:220                                      
S0|T8 is not leader                                                                                               
S0|T8 save persist| votedFor: 1|                                                                                  
logsLen: 220                                                                                                      
S0|T8 appends logs from S1| logLen:                                                                               
220[AppendEntry]                                                                                                  
                                       S1|T8 replica entries to S0|                                               
                                       entrylen:0| matchidx:219| nextidx:220                                      
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 221                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       221[Start]                                                                 
S0|T8 is not leader                                                                                               
S0|T8 save persist| votedFor: 1|                                                                                  
logsLen: 221                                                                                                      
S0|T8 appends logs from S1| logLen:                                                                               
221[AppendEntry]                                                                                                  
                                       S1|T8 replica entries to S0|                                               
                                       entrylen:1| matchidx:220| nextidx:221                                      
                                       S1|T8 update commitIndex as 220                                            
                                       S1|T8 starts to apply entries                                              
                                       [220:220][ApplyEntry]                                                      
                                       S1|T8 finishes applying entries                                            
                                       [220:220][ApplyEntry]                                                      
S0|T8 is not leader                                                                                               
S0|T8 save persist| votedFor: 1|                                                                                  
logsLen: 221                                                                                                      
S0|T8 appends logs from S1| logLen:                                                                               
221[AppendEntry]                                                                                                  
S0|T8 starts to apply entries                                                                                     
[220:220][ApplyEntry]                                                                                             
S0|T8 finishes applying entries                                                                                   
[220:220][ApplyEntry]                                                                                             
                                       S1|T8 replica entries to S0|                                               
                                       entrylen:0| matchidx:220| nextidx:221                                      
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 222                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       222[Start]                                                                 
S0|T8 is not leader                                                                                               
S0|T8 save persist| votedFor: 1|                                                                                  
logsLen: 222                                                                                                      
S0|T8 appends logs from S1| logLen:                                                                               
222[AppendEntry]                                                                                                  
                                       S1|T8 replica entries to S0|                                               
                                       entrylen:1| matchidx:221| nextidx:222                                      
                                       S1|T8 update commitIndex as 221                                            
                                       S1|T8 starts to apply entries                                              
                                       [221:221][ApplyEntry]                                                      
                                       S1|T8 finishes applying entries                                            
                                       [221:221][ApplyEntry]                                                      
S0|T8 is not leader                                                                                               
S0|T8 save persist| votedFor: 1|                                                                                  
logsLen: 222                                                                                                      
S0|T8 appends logs from S1| logLen:                                                                               
222[AppendEntry]                                                                                                  
S0|T8 starts to apply entries                                                                                     
[221:221][ApplyEntry]                                                                                             
S0|T8 finishes applying entries                                                                                   
[221:221][ApplyEntry]                                                                                             
                                       S1|T8 replica entries to S0|                                               
                                       entrylen:0| matchidx:221| nextidx:222                                      
                                                                             S2 is connected again                
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 223                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       223[Start]                                                                 
S0|T8 is not leader                                                                                               
                                       S1|T8 rejects to append entries from                                       
                                       S2 | out of date term[AppendEntry]                                         
S0|T8 rejects to append entries from                                                                              
S2 | out of date term[AppendEntry]                                                                                
                                                                             S2|T8 save persist| votedFor: 2|     
                                                                             logsLen: 220                         
S0|T8 save persist| votedFor: 1|                                                                                  
logsLen: 223                                                                                                      
                                                                             S2|T8 save persist| votedFor: 2|     
                                                                             logsLen: 223                         
                                                                             S2|T8 appends logs from S1| logLen:  
                                                                             223[AppendEntry]                     
S0|T8 appends logs from S1| logLen:                                                                               
223[AppendEntry]                                                                                                  
                                                                             S2|T8 starts to apply entries        
                                                                             [220:221][ApplyEntry]                
                                                                             S2|T8 finishes applying entries      
                                                                             [220:221][ApplyEntry]                
                                                                             S2|T8 lost leadership, state: 0      
                                                                             S2|T8 lost leadership, state: 0      
                                       S1|T8 replica entries to S0|                                               
                                       entrylen:1| matchidx:222| nextidx:223                                      
                                       S1|T8 update commitIndex as 222                                            
                                       S1|T8 replica entries to S2|                                               
                                       entrylen:3| matchidx:222| nextidx:223                                      
                                       S1|T8 starts to apply entries                                              
                                       [222:222][ApplyEntry]                                                      
                                       S1|T8 finishes applying entries                                            
                                       [222:222][ApplyEntry]                                                      
S0|T8 is not leader                                                                                               
                                                                             S2|T8 is not leader                  
S0|T8 save persist| votedFor: 1|                                                                                  
logsLen: 223                                                                                                      
S0|T8 appends logs from S1| logLen:                                                                               
223[AppendEntry]                                                                                                  
                                                                             S2|T8 save persist| votedFor: 2|     
                                                                             logsLen: 223                         
                                                                             S2|T8 appends logs from S1| logLen:  
                                                                             223[AppendEntry]                     
S0|T8 starts to apply entries                                                                                     
[222:222][ApplyEntry]                                                                                             
                                                                             S2|T8 starts to apply entries        
                                                                             [222:222][ApplyEntry]                
S0|T8 finishes applying entries                                                                                   
[222:222][ApplyEntry]                                                                                             
                                                                             S2|T8 finishes applying entries      
                                                                             [222:222][ApplyEntry]                
                                       S1|T8 replica entries to S0|                                               
                                       entrylen:0| matchidx:222| nextidx:223                                      
                                       S1|T8 replica entries to S2|                                               
                                       entrylen:0| matchidx:222| nextidx:223                                      
S0|T8 is not leader                                                                                               
                                                                             S2|T8 is not leader                  
                                                                             S2|T8 save persist| votedFor: 2|     
                                                                             logsLen: 223                         
                                                                             S2|T8 appends logs from S1| logLen:  
                                                                             223[AppendEntry]                     
S0|T8 save persist| votedFor: 1|                                                                                  
logsLen: 223                                                                                                      
S0|T8 appends logs from S1| logLen:                                                                               
223[AppendEntry]                                                                                                  
                                       S1|T8 replica entries to S2|                                               
                                       entrylen:0| matchidx:222| nextidx:223                                      
                                       S1|T8 replica entries to S0|                                               
                                       entrylen:0| matchidx:222| nextidx:223                                      
S0|T8 is not leader                                                                                               
                                                                             S2|T8 is not leader                  
                                                                             S2|T8 save persist| votedFor: 2|     
                                                                             logsLen: 223                         
                                                                             S2|T8 appends logs from S1| logLen:  
                                                                             223[AppendEntry]                     
S0|T8 save persist| votedFor: 1|                                                                                  
logsLen: 223                                                                                                      
S0|T8 appends logs from S1| logLen:                                                                               
223[AppendEntry]                                                                                                  
                                       S1|T8 replica entries to S2|                                               
                                       entrylen:0| matchidx:222| nextidx:223                                      
                                       S1|T8 replica entries to S0|                                               
                                       entrylen:0| matchidx:222| nextidx:223                                      
                                                                             S2|T8 is not leader                  
S0|T8 is not leader                                                                                               
S0|T8 save persist| votedFor: 1|                                                                                  
logsLen: 223                                                                                                      
                                                                             S2|T8 save persist| votedFor: 2|     
                                                                             logsLen: 223                         
S0|T8 appends logs from S1| logLen:                                                                               
223[AppendEntry]                                                                                                  
                                                                             S2|T8 appends logs from S1| logLen:  
                                                                             223[AppendEntry]                     
                                       S1|T8 replica entries to S0|                                               
                                       entrylen:0| matchidx:222| nextidx:223                                      
                                       S1|T8 replica entries to S2|                                               
                                       entrylen:0| matchidx:222| nextidx:223                                      
S0|T8 is not leader                                                                                               
                                                                             S2|T8 is not leader                  
S0|T8 save persist| votedFor: 1|                                                                                  
logsLen: 223                                                                                                      
                                                                             S2|T8 save persist| votedFor: 2|     
                                                                             logsLen: 223                         
S0|T8 appends logs from S1| logLen:                                                                               
223[AppendEntry]                                                                                                  
                                                                             S2|T8 appends logs from S1| logLen:  
                                                                             223[AppendEntry]                     
                                       S1|T8 replica entries to S0|                                               
                                       entrylen:0| matchidx:222| nextidx:223                                      
                                       S1|T8 replica entries to S2|                                               
                                       entrylen:0| matchidx:222| nextidx:223                                      
                                                                             S2 is disconnected                   
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 224                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       224[Start]                                                                 
S0|T8 is not leader                                                                                               
                                                                             S2|T8 is not leader                  
S0|T8 save persist| votedFor: 1|                                                                                  
logsLen: 224                                                                                                      
S0|T8 appends logs from S1| logLen:                                                                               
224[AppendEntry]                                                                                                  
                                       S1|T8 replica entries to S0|                                               
                                       entrylen:1| matchidx:223| nextidx:224                                      
                                       S1|T8 update commitIndex as 223                                            
                                       S1|T8 starts to apply entries                                              
                                       [223:223][ApplyEntry]                                                      
                                       S1|T8 finishes applying entries                                            
                                       [223:223][ApplyEntry]                                                      
                                                                             S2|T8 is not leader                  
S0|T8 is not leader                                                                                               
S0|T8 save persist| votedFor: 1|                                                                                  
logsLen: 224                                                                                                      
S0|T8 appends logs from S1| logLen:                                                                               
224[AppendEntry]                                                                                                  
S0|T8 starts to apply entries                                                                                     
[223:223][ApplyEntry]                                                                                             
S0|T8 finishes applying entries                                                                                   
[223:223][ApplyEntry]                                                                                             
                                       S1|T8 replica entries to S0|                                               
                                       entrylen:0| matchidx:223| nextidx:224                                      
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 225                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       225[Start]                                                                 
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 226                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       226[Start]                                                                 
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 227                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       227[Start]                                                                 
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 228                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       228[Start]                                                                 
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 229                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       229[Start]                                                                 
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 230                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       230[Start]                                                                 
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 231                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       231[Start]                                                                 
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 232                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       232[Start]                                                                 
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 233                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       233[Start]                                                                 
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 234                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       234[Start]                                                                 
S0|T8 is not leader                                                                                               
                                                                             S2|T8 is not leader                  
S0|T8 save persist| votedFor: 1|                                                                                  
logsLen: 234                                                                                                      
S0|T8 appends logs from S1| logLen:                                                                               
234[AppendEntry]                                                                                                  
                                       S1|T8 replica entries to S0|                                               
                                       entrylen:10| matchidx:233|                                                 
                                       nextidx:234                                                                
                                       S1|T8 update commitIndex as 233                                            
                                       S1|T8 starts to apply entries                                              
                                       [224:233][ApplyEntry]                                                      
                                       S1|T8 Snapshot until index 229|                                            
                                       logLen: 234                                                                
                                       S1|T8 finishes applying entries                                            
                                       [224:233][ApplyEntry]                                                      
                                                                             S2|T8 is not leader                  
S0|T8 is not leader                                                                                               
                                       S1|T8 send rpc to S2|base: 229| next:                                      
                                       223                                                                        
S0|T8 save persist| votedFor: 1|                                                                                  
logsLen: 234                                                                                                      
S0|T8 appends logs from S1| logLen:                                                                               
234[AppendEntry]                                                                                                  
S0|T8 starts to apply entries                                                                                     
[224:233][ApplyEntry]                                                                                             
                                       S1|T8 replica entries to S0|                                               
                                       entrylen:0| matchidx:233| nextidx:234                                      
S0|T8 Snapshot until index 229|                                                                                   
logLen: 234                                                                                                       
S0|T8 finishes applying entries                                                                                   
[224:233][ApplyEntry]                                                                                             
                                                                             S2 is connected again                
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 235                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       235[Start]                                                                 
                                                                             S2|T8 is not leader                  
S0|T8 is not leader                                                                                               
                                       S1|T8 send rpc to S2|base: 229| next:                                      
                                       223                                                                        
                                                                             S2|T8 receive rpc from S1            
                                                                             S2|T8 update rfstate| Base:229|      
                                                                             LogLen:230                           
S0|T8 save persist| votedFor: 1|                                                                                  
logsLen: 235                                                                                                      
S0|T8 appends logs from S1| logLen:                                                                               
235[AppendEntry]                                                                                                  
                                                                             S2|T8 applys snapshot from S1        
                                       S1|T8 installs snapshot to S2|                                             
                                       nextId:230| matchId:229                                                    
                                       S1|T8 replica entries to S0|                                               
                                       entrylen:1| matchidx:234| nextidx:235                                      
                                       S1|T8 update commitIndex as 234                                            
                                       S1|T8 starts to apply entries                                              
                                       [234:234][ApplyEntry]                                                      
                                       S1|T8 finishes applying entries                                            
                                       [234:234][ApplyEntry]                                                      
                                                                             S2|T8 is not leader                  
S0|T8 is not leader                                                                                               
S0|T8 save persist| votedFor: 1|                                                                                  
logsLen: 235                                                                                                      
S0|T8 appends logs from S1| logLen:                                                                               
235[AppendEntry]                                                                                                  
                                                                             S2|T8 save persist| votedFor: 2|     
                                                                             logsLen: 235                         
S0|T8 starts to apply entries                                                                                     
[234:234][ApplyEntry]                                                                                             
S0|T8 finishes applying entries                                                                                   
[234:234][ApplyEntry]                                                                                             
                                                                             S2|T8 appends logs from S1| logLen:  
                                                                             235[AppendEntry]                     
                                                                             S2|T8 starts to apply entries        
                                                                             [230:234][ApplyEntry]                
                                       S1|T8 replica entries to S0|                                               
                                       entrylen:0| matchidx:234| nextidx:235                                      
                                                                             S2|T8 finishes applying entries      
                                                                             [230:234][ApplyEntry]                
                                       S1|T8 replica entries to S2|                                               
                                       entrylen:5| matchidx:234| nextidx:235                                      
                                                                             S2|T8 is not leader                  
S0|T8 is not leader                                                                                               
S0|T8 save persist| votedFor: 1|                                                                                  
logsLen: 235                                                                                                      
                                                                             S2|T8 save persist| votedFor: 2|     
                                                                             logsLen: 235                         
                                                                             S2|T8 appends logs from S1| logLen:  
                                                                             235[AppendEntry]                     
S0|T8 appends logs from S1| logLen:                                                                               
235[AppendEntry]                                                                                                  
                                       S1|T8 replica entries to S2|                                               
                                       entrylen:0| matchidx:234| nextidx:235                                      
                                       S1|T8 replica entries to S0|                                               
                                       entrylen:0| matchidx:234| nextidx:235                                      
                                                                             S2|T8 is not leader                  
S0|T8 is not leader                                                                                               
S0|T8 save persist| votedFor: 1|                                                                                  
logsLen: 235                                                                                                      
                                                                             S2|T8 save persist| votedFor: 2|     
                                                                             logsLen: 235                         
S0|T8 appends logs from S1| logLen:                                                                               
235[AppendEntry]                                                                                                  
                                                                             S2|T8 appends logs from S1| logLen:  
                                                                             235[AppendEntry]                     
                                       S1|T8 replica entries to S0|                                               
                                       entrylen:0| matchidx:234| nextidx:235                                      
                                       S1|T8 replica entries to S2|                                               
                                       entrylen:0| matchidx:234| nextidx:235                                      
                                                                             S2|T8 is not leader                  
S0|T8 is not leader                                                                                               
                                                                             S2|T8 save persist| votedFor: 2|     
                                                                             logsLen: 235                         
S0|T8 save persist| votedFor: 1|                                                                                  
logsLen: 235                                                                                                      
S0|T8 appends logs from S1| logLen:                                                                               
235[AppendEntry]                                                                                                  
                                                                             S2|T8 appends logs from S1| logLen:  
                                                                             235[AppendEntry]                     
                                       S1|T8 replica entries to S0|                                               
                                       entrylen:0| matchidx:234| nextidx:235                                      
                                       S1|T8 replica entries to S2|                                               
                                       entrylen:0| matchidx:234| nextidx:235                                      
                                                                             S2|T8 is not leader                  
S0|T8 is not leader                                                                                               
                                                                             S2|T8 save persist| votedFor: 2|     
                                                                             logsLen: 235                         
                                                                             S2|T8 appends logs from S1| logLen:  
                                                                             235[AppendEntry]                     
S0|T8 save persist| votedFor: 1|                                                                                  
logsLen: 235                                                                                                      
S0|T8 appends logs from S1| logLen:                                                                               
235[AppendEntry]                                                                                                  
                                       S1|T8 replica entries to S2|                                               
                                       entrylen:0| matchidx:234| nextidx:235                                      
                                       S1|T8 replica entries to S0|                                               
                                       entrylen:0| matchidx:234| nextidx:235                                      
                                                                             S2 is disconnected                   
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 236                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       236[Start]                                                                 
                                                                             S2|T8 is not leader                  
S0|T8 is not leader                                                                                               
S0|T8 save persist| votedFor: 1|                                                                                  
logsLen: 236                                                                                                      
S0|T8 appends logs from S1| logLen:                                                                               
236[AppendEntry]                                                                                                  
                                       S1|T8 replica entries to S0|                                               
                                       entrylen:1| matchidx:235| nextidx:236                                      
                                       S1|T8 update commitIndex as 235                                            
                                       S1|T8 starts to apply entries                                              
                                       [235:235][ApplyEntry]                                                      
                                       S1|T8 finishes applying entries                                            
                                       [235:235][ApplyEntry]                                                      
S0|T8 is not leader                                                                                               
                                                                             S2|T8 is not leader                  
S0|T8 save persist| votedFor: 1|                                                                                  
logsLen: 236                                                                                                      
S0|T8 appends logs from S1| logLen:                                                                               
236[AppendEntry]                                                                                                  
S0|T8 starts to apply entries                                                                                     
[235:235][ApplyEntry]                                                                                             
S0|T8 finishes applying entries                                                                                   
[235:235][ApplyEntry]                                                                                             
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 237                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       237[Start]                                                                 
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 238                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       238[Start]                                                                 
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 239                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       239[Start]                                                                 
                                       S1|T8 replica entries to S0|                                               
                                       entrylen:0| matchidx:235| nextidx:236                                      
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 240                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       240[Start]                                                                 
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 241                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       241[Start]                                                                 
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 242                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       242[Start]                                                                 
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 243                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       243[Start]                                                                 
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 244                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       244[Start]                                                                 
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 245                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       245[Start]                                                                 
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 246                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       246[Start]                                                                 
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 247                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       247[Start]                                                                 
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 248                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       248[Start]                                                                 
S0|T8 is not leader                                                                                               
                                                                             S2|T8 is not leader                  
S0|T8 save persist| votedFor: 1|                                                                                  
logsLen: 248                                                                                                      
S0|T8 appends logs from S1| logLen:                                                                               
248[AppendEntry]                                                                                                  
                                       S1|T8 replica entries to S0|                                               
                                       entrylen:12| matchidx:247|                                                 
                                       nextidx:248                                                                
                                       S1|T8 update commitIndex as 247                                            
                                       S1|T8 starts to apply entries                                              
                                       [236:247][ApplyEntry]                                                      
                                       S1|T8 Snapshot until index 239|                                            
                                       logLen: 248                                                                
                                       S1|T8 finishes applying entries                                            
                                       [236:247][ApplyEntry]                                                      
S0|T8 is not leader                                                                                               
                                                                             S2|T8 is not leader                  
                                       S1|T8 send rpc to S2|base: 239| next:                                      
                                       235                                                                        
S0|T8 save persist| votedFor: 1|                                                                                  
logsLen: 248                                                                                                      
S0|T8 appends logs from S1| logLen:                                                                               
248[AppendEntry]                                                                                                  
S0|T8 starts to apply entries                                                                                     
[236:247][ApplyEntry]                                                                                             
                                       S1|T8 replica entries to S0|                                               
                                       entrylen:0| matchidx:247| nextidx:248                                      
S0|T8 Snapshot until index 239|                                                                                   
logLen: 248                                                                                                       
S0|T8 finishes applying entries                                                                                   
[236:247][ApplyEntry]                                                                                             
                                                                             S2 is connected again                
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 249                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       249[Start]                                                                 
                                                                             S2|T8 is not leader                  
S0|T8 is not leader                                                                                               
                                       S1|T8 send rpc to S2|base: 239| next:                                      
                                       235                                                                        
                                                                             S2|T8 receive rpc from S1            
                                                                             S2|T8 update rfstate| Base:239|      
                                                                             LogLen:240                           
S0|T8 save persist| votedFor: 1|                                                                                  
logsLen: 249                                                                                                      
S0|T8 appends logs from S1| logLen:                                                                               
249[AppendEntry]                                                                                                  
                                                                             S2|T8 applys snapshot from S1        
                                       S1|T8 installs snapshot to S2|                                             
                                       nextId:240| matchId:239                                                    
                                       S1|T8 replica entries to S0|                                               
                                       entrylen:1| matchidx:248| nextidx:249                                      
                                       S1|T8 update commitIndex as 248                                            
                                       S1|T8 starts to apply entries                                              
                                       [248:248][ApplyEntry]                                                      
                                       S1|T8 finishes applying entries                                            
                                       [248:248][ApplyEntry]                                                      
S0|T8 is not leader                                                                                               
                                                                             S2|T8 is not leader                  
S0|T8 save persist| votedFor: 1|                                                                                  
logsLen: 249                                                                                                      
S0|T8 appends logs from S1| logLen:                                                                               
249[AppendEntry]                                                                                                  
                                                                             S2|T8 save persist| votedFor: 2|     
                                                                             logsLen: 249                         
                                                                             S2|T8 appends logs from S1| logLen:  
                                                                             249[AppendEntry]                     
S0|T8 starts to apply entries                                                                                     
[248:248][ApplyEntry]                                                                                             
                                                                             S2|T8 starts to apply entries        
                                                                             [240:248][ApplyEntry]                
S0|T8 finishes applying entries                                                                                   
[248:248][ApplyEntry]                                                                                             
                                                                             S2|T8 finishes applying entries      
                                                                             [240:248][ApplyEntry]                
                                       S1|T8 replica entries to S0|                                               
                                       entrylen:0| matchidx:248| nextidx:249                                      
                                       S1|T8 replica entries to S2|                                               
                                       entrylen:9| matchidx:248| nextidx:249                                      
S0|T8 is not leader                                                                                               
                                                                             S2|T8 is not leader                  
                                       S1|T8 fails to install snapshot to S2                                      
                                                                             S2|T8 save persist| votedFor: 2|     
                                                                             logsLen: 249                         
S0|T8 save persist| votedFor: 1|                                                                                  
logsLen: 249                                                                                                      
S0|T8 appends logs from S1| logLen:                                                                               
249[AppendEntry]                                                                                                  
                                                                             S2|T8 appends logs from S1| logLen:  
                                                                             249[AppendEntry]                     
                                       S1|T8 replica entries to S0|                                               
                                       entrylen:0| matchidx:248| nextidx:249                                      
                                       S1|T8 replica entries to S2|                                               
                                       entrylen:0| matchidx:248| nextidx:249                                      
S0|T8 is not leader                                                                                               
                                                                             S2|T8 is not leader                  
                                                                             S2|T8 save persist| votedFor: 2|     
                                                                             logsLen: 249                         
S0|T8 save persist| votedFor: 1|                                                                                  
logsLen: 249                                                                                                      
S0|T8 appends logs from S1| logLen:                                                                               
249[AppendEntry]                                                                                                  
                                                                             S2|T8 appends logs from S1| logLen:  
                                                                             249[AppendEntry]                     
                                       S1|T8 replica entries to S0|                                               
                                       entrylen:0| matchidx:248| nextidx:249                                      
                                       S1|T8 replica entries to S2|                                               
                                       entrylen:0| matchidx:248| nextidx:249                                      
S0|T8 is not leader                                                                                               
                                                                             S2|T8 is not leader                  
                                                                             S2|T8 save persist| votedFor: 2|     
                                                                             logsLen: 249                         
                                                                             S2|T8 appends logs from S1| logLen:  
                                                                             249[AppendEntry]                     
S0|T8 save persist| votedFor: 1|                                                                                  
logsLen: 249                                                                                                      
S0|T8 appends logs from S1| logLen:                                                                               
249[AppendEntry]                                                                                                  
                                       S1|T8 replica entries to S2|                                               
                                       entrylen:0| matchidx:248| nextidx:249                                      
                                       S1|T8 replica entries to S0|                                               
                                       entrylen:0| matchidx:248| nextidx:249                                      
S0|T8 is not leader                                                                                               
                                                                             S2|T8 is not leader                  
S0|T8 save persist| votedFor: 1|                                                                                  
logsLen: 249                                                                                                      
                                                                             S2|T8 save persist| votedFor: 2|     
                                                                             logsLen: 249                         
                                                                             S2|T8 appends logs from S1| logLen:  
                                                                             249[AppendEntry]                     
S0|T8 appends logs from S1| logLen:                                                                               
249[AppendEntry]                                                                                                  
                                       S1|T8 replica entries to S2|                                               
                                       entrylen:0| matchidx:248| nextidx:249                                      
                                       S1|T8 replica entries to S0|                                               
                                       entrylen:0| matchidx:248| nextidx:249                                      
                                       S1 is disconnected                                                         
                                                                             S2|T8 is not leader                  
S0|T8 is not leader                                                                                               
S0|T8 is not leader                                                                                               
                                                                             S2|T8 is not leader                  
                                                                             S2|T8 is not leader                  
S0|T8 is not leader                                                                                               
S0|T8 is not leader                                                                                               
                                                                             S2|T8 is not leader                  
S0|T8 is not leader                                                                                               
                                                                             S2|T8 is not leader                  
S0|T8 is not leader                                                                                               
                                                                             S2|T8 is not leader                  
S0|T8 is not leader                                                                                               
                                                                             S2|T8 is not leader                  
                                                                             S2|T8 is not leader                  
S0|T8 is not leader                                                                                               
S0|T8 is not leader                                                                                               
                                                                             S2|T8 is not leader                  
S0|T9 starts to join election                                                                                     
S0|T9 save persist| votedFor: 0|                                                                                  
logsLen: 249                                                                                                      
                                                                             S2|T9 save persist| votedFor: -1|    
                                                                             logsLen: 249                         
                                                                             S2|T9 save persist| votedFor: 0|     
                                                                             logsLen: 249                         
                                                                             S2|T9 votes for S0[RequestVote]      
S0|T9 becomes the leader, and starts                                                                              
heatbeats                                                                                                         
                                                                             S2|T9 save persist| votedFor: 0|     
                                                                             logsLen: 249                         
                                                                             S2|T9 appends logs from S0| logLen:  
                                                                             249[AppendEntry]                     
S0|T9 replica entries to S2|                                                                                      
entrylen:0| matchidx:248| nextidx:249                                                                             
S0|T9 save persist| votedFor: 0|                                                                                  
logsLen: 250                                                                                                      
S0|T9 receive commands | logLen:                                                                                  
250[Start]                                                                                                        
                                                                             S2|T9 is not leader                  
                                                                             S2|T9 save persist| votedFor: 0|     
                                                                             logsLen: 250                         
                                                                             S2|T9 appends logs from S0| logLen:  
                                                                             250[AppendEntry]                     
S0|T9 replica entries to S2|                                                                                      
entrylen:1| matchidx:249| nextidx:250                                                                             
S0|T9 update commitIndex as 249                                                                                   
S0|T9 starts to apply entries                                                                                     
[249:249][ApplyEntry]                                                                                             
S0|T9 finishes applying entries                                                                                   
[249:249][ApplyEntry]                                                                                             
S0|T9 Snapshot until index 249|                                                                                   
logLen: 250                                                                                                       
S0|T9 send rpc to S1|base: 249| next:                                                                             
249                                                                                                               
                                                                             S2|T9 is not leader                  
                                                                             S2|T9 save persist| votedFor: 0|     
                                                                             logsLen: 250                         
                                                                             S2|T9 appends logs from S0| logLen:  
                                                                             250[AppendEntry]                     
                                                                             S2|T9 starts to apply entries        
                                                                             [249:249][ApplyEntry]                
                                                                             S2|T9 finishes applying entries      
                                                                             [249:249][ApplyEntry]                
S0|T9 replica entries to S2|                                                                                      
entrylen:0| matchidx:249| nextidx:250                                                                             
                                                                             S2|T9 Snapshot until index 249|      
                                                                             logLen: 250                          
S0|T9 save persist| votedFor: 0|                                                                                  
logsLen: 251                                                                                                      
S0|T9 receive commands | logLen:                                                                                  
251[Start]                                                                                                        
                                                                             S2|T9 is not leader                  
S0|T9 send rpc to S1|base: 249| next:                                                                             
249                                                                                                               
                                                                             S2|T9 save persist| votedFor: 0|     
                                                                             logsLen: 251                         
                                                                             S2|T9 appends logs from S0| logLen:  
                                                                             251[AppendEntry]                     
S0|T9 replica entries to S2|                                                                                      
entrylen:1| matchidx:250| nextidx:251                                                                             
S0|T9 update commitIndex as 250                                                                                   
S0|T9 starts to apply entries                                                                                     
[250:250][ApplyEntry]                                                                                             
S0|T9 finishes applying entries                                                                                   
[250:250][ApplyEntry]                                                                                             
                                                                             S2|T9 is not leader                  
S0|T9 send rpc to S1|base: 249| next:                                                                             
249                                                                                                               
                                                                             S2|T9 save persist| votedFor: 0|     
                                                                             logsLen: 251                         
                                                                             S2|T9 appends logs from S0| logLen:  
                                                                             251[AppendEntry]                     
                                                                             S2|T9 starts to apply entries        
                                                                             [250:250][ApplyEntry]                
                                                                             S2|T9 finishes applying entries      
                                                                             [250:250][ApplyEntry]                
S0|T9 replica entries to S2|                                                                                      
entrylen:0| matchidx:250| nextidx:251                                                                             
                                       S1 is connected again                                                      
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 250                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       250[Start]                                                                 
                                                                             S2|T9 is not leader                  
S0|T9 send rpc to S1|base: 249| next:                                                                             
249                                                                                                               
S0|T9 rejects to append entries from                                                                              
S1 | out of date term[AppendEntry]                                                                                
                                                                             S2|T9 save persist| votedFor: 0|     
                                                                             logsLen: 251                         
                                                                             S2|T9 appends logs from S0| logLen:  
                                                                             251[AppendEntry]                     
                                       S1|T8 receive rpc from S0                                                  
                                                                             S2|T9 rejects to append entries from 
                                                                             S1 | out of date term[AppendEntry]   
                                       S1|T9 save persist| votedFor: 1|                                           
                                       logsLen: 250                                                               
S0|T9 replica entries to S2|                                                                                      
entrylen:0| matchidx:250| nextidx:251                                                                             
                                       S1|T9 update rfstate| Base:249|                                            
                                       LogLen:250                                                                 
                                       S1|T9 applys snapshot from S0                                              
                                       S1|T9 lost leadership, state: 0                                            
                                       S1|T9 lost leadership, state: 0                                            
S0|T9 installs snapshot to S1|                                                                                    
nextId:250| matchId:249                                                                                           
                                       S1|T9 is not leader                                                        
                                                                             S2|T9 is not leader                  
                                                                             S2|T9 save persist| votedFor: 0|     
                                                                             logsLen: 251                         
                                       S1|T9 save persist| votedFor: 1|                                           
                                       logsLen: 251                                                               
                                       S1|T9 appends logs from S0| logLen:                                        
                                       251[AppendEntry]                                                           
                                                                             S2|T9 appends logs from S0| logLen:  
                                                                             251[AppendEntry]                     
                                       S1|T9 starts to apply entries                                              
                                       [250:250][ApplyEntry]                                                      
                                       S1|T9 finishes applying entries                                            
                                       [250:250][ApplyEntry]                                                      
S0|T9 replica entries to S2|                                                                                      
entrylen:0| matchidx:250| nextidx:251                                                                             
S0|T9 replica entries to S1|                                                                                      
entrylen:1| matchidx:250| nextidx:251                                                                             
                                                                             S2|T9 is not leader                  
                                       S1|T9 is not leader                                                        
                                                                             S2|T9 save persist| votedFor: 0|     
                                                                             logsLen: 251                         
                                                                             S2|T9 appends logs from S0| logLen:  
                                                                             251[AppendEntry]                     
                                       S1|T9 save persist| votedFor: 1|                                           
                                       logsLen: 251                                                               
                                       S1|T9 appends logs from S0| logLen:                                        
                                       251[AppendEntry]                                                           
S0|T9 replica entries to S2|                                                                                      
entrylen:0| matchidx:250| nextidx:251                                                                             
S0|T9 replica entries to S1|                                                                                      
entrylen:0| matchidx:250| nextidx:251                                                                             
                                       S1|T9 is not leader                                                        
                                                                             S2|T9 is not leader                  
                                       S1|T9 save persist| votedFor: 1|                                           
                                       logsLen: 251                                                               
                                       S1|T9 appends logs from S0| logLen:                                        
                                       251[AppendEntry]                                                           
                                                                             S2|T9 save persist| votedFor: 0|     
                                                                             logsLen: 251                         
                                                                             S2|T9 appends logs from S0| logLen:  
                                                                             251[AppendEntry]                     
S0|T9 replica entries to S1|                                                                                      
entrylen:0| matchidx:250| nextidx:251                                                                             
S0|T9 replica entries to S2|                                                                                      
entrylen:0| matchidx:250| nextidx:251                                                                             
                                                                             S2|T9 is not leader                  
                                       S1|T9 is not leader                                                        
                                                                             S2|T9 save persist| votedFor: 0|     
                                                                             logsLen: 251                         
                                                                             S2|T9 appends logs from S0| logLen:  
                                                                             251[AppendEntry]                     
                                       S1|T9 save persist| votedFor: 1|                                           
                                       logsLen: 251                                                               
                                       S1|T9 appends logs from S0| logLen:                                        
                                       251[AppendEntry]                                                           
S0|T9 replica entries to S2|                                                                                      
entrylen:0| matchidx:250| nextidx:251                                                                             
S0|T9 replica entries to S1|                                                                                      
entrylen:0| matchidx:250| nextidx:251                                                                             
                                       S1|T9 is not leader                                                        
                                                                             S2|T9 is not leader                  
                                       S1|T9 save persist| votedFor: 1|                                           
                                       logsLen: 251                                                               
                                       S1|T9 appends logs from S0| logLen:                                        
                                       251[AppendEntry]                                                           
                                                                             S2|T9 save persist| votedFor: 0|     
                                                                             logsLen: 251                         
                                                                             S2|T9 appends logs from S0| logLen:  
                                                                             251[AppendEntry]                     
S0|T9 replica entries to S1|                                                                                      
entrylen:0| matchidx:250| nextidx:251                                                                             
S0|T9 replica entries to S2|                                                                                      
entrylen:0| matchidx:250| nextidx:251                                                                             
                                       S1|T9 is not leader                                                        
                                                                             S2|T9 is not leader                  
                                                                             S2|T9 save persist| votedFor: 0|     
                                                                             logsLen: 251                         
                                                                             S2|T9 appends logs from S0| logLen:  
                                                                             251[AppendEntry]                     
                                       S1|T9 save persist| votedFor: 1|                                           
                                       logsLen: 251                                                               
                                       S1|T9 appends logs from S0| logLen:                                        
                                       251[AppendEntry]                                                           
S0|T9 replica entries to S2|                                                                                      
entrylen:0| matchidx:250| nextidx:251                                                                             
S0|T9 replica entries to S1|                                                                                      
entrylen:0| matchidx:250| nextidx:251                                                                             
                                       S1|T9 is not leader                                                        
                                                                             S2|T9 is not leader                  
                                       S1|T9 save persist| votedFor: 1|                                           
                                       logsLen: 251                                                               
                                       S1|T9 appends logs from S0| logLen:                                        
                                       251[AppendEntry]                                                           
                                                                             S2|T9 save persist| votedFor: 0|     
                                                                             logsLen: 251                         
                                                                             S2|T9 appends logs from S0| logLen:  
                                                                             251[AppendEntry]                     
S0|T9 replica entries to S1|                                                                                      
entrylen:0| matchidx:250| nextidx:251                                                                             
S0|T9 replica entries to S2|                                                                                      
entrylen:0| matchidx:250| nextidx:251                                                                             
                                       S1|T9 is not leader                                                        
                                                                             S2|T9 is not leader                  
                                                                             S2|T9 save persist| votedFor: 0|     
                                                                             logsLen: 251                         
                                                                             S2|T9 appends logs from S0| logLen:  
                                                                             251[AppendEntry]                     
                                       S1|T9 save persist| votedFor: 1|                                           
                                       logsLen: 251                                                               
                                       S1|T9 appends logs from S0| logLen:                                        
                                       251[AppendEntry]                                                           
S0|T9 replica entries to S2|                                                                                      
entrylen:0| matchidx:250| nextidx:251                                                                             
S0|T9 replica entries to S1|                                                                                      
entrylen:0| matchidx:250| nextidx:251                                                                             
                                                                             S2|T9 is not leader                  
                                       S1|T9 is not leader                                                        
                                                                             S2|T9 save persist| votedFor: 0|     
                                                                             logsLen: 251                         
                                                                             S2|T9 appends logs from S0| logLen:  
                                                                             251[AppendEntry]                     
                                       S1|T9 save persist| votedFor: 1|                                           
                                       logsLen: 251                                                               
                                       S1|T9 appends logs from S0| logLen:                                        
                                       251[AppendEntry]                                                           
S0|T9 replica entries to S2|                                                                                      
entrylen:0| matchidx:250| nextidx:251                                                                             
S0|T9 replica entries to S1|                                                                                      
entrylen:0| matchidx:250| nextidx:251                                                                             
                                       S1|T9 is not leader                                                        
                                                                             S2|T9 is not leader                  
                                       S1|T9 save persist| votedFor: 1|                                           
                                       logsLen: 251                                                               
                                       S1|T9 appends logs from S0| logLen:                                        
                                       251[AppendEntry]                                                           
                                                                             S2|T9 save persist| votedFor: 0|     
                                                                             logsLen: 251                         
                                                                             S2|T9 appends logs from S0| logLen:  
                                                                             251[AppendEntry]                     
S0|T9 replica entries to S1|                                                                                      
entrylen:0| matchidx:250| nextidx:251                                                                             
S0|T9 replica entries to S2|                                                                                      
entrylen:0| matchidx:250| nextidx:251                                                                             
                                                                             S2|T9 is not leader                  
                                       S1|T9 is not leader                                                        
                                                                             S2|T9 save persist| votedFor: 0|     
                                                                             logsLen: 251                         
                                       S1|T9 save persist| votedFor: 1|                                           
                                       logsLen: 251                                                               
                                                                             S2|T9 appends logs from S0| logLen:  
                                                                             251[AppendEntry]                     
                                       S1|T9 appends logs from S0| logLen:                                        
                                       251[AppendEntry]                                                           
S0|T9 replica entries to S2|                                                                                      
entrylen:0| matchidx:250| nextidx:251                                                                             
S0|T9 replica entries to S1|                                                                                      
entrylen:0| matchidx:250| nextidx:251                                                                             
                                                                             S2|T9 is not leader                  
                                       S1|T9 is not leader                                                        
                                       S1|T9 save persist| votedFor: 1|                                           
                                       logsLen: 251                                                               
                                                                             S2|T9 save persist| votedFor: 0|     
                                                                             logsLen: 251                         
                                       S1|T9 appends logs from S0| logLen:                                        
                                       251[AppendEntry]                                                           
                                                                             S2|T9 appends logs from S0| logLen:  
                                                                             251[AppendEntry]                     
S0|T9 replica entries to S1|                                                                                      
entrylen:0| matchidx:250| nextidx:251                                                                             
S0|T9 replica entries to S2|                                                                                      
entrylen:0| matchidx:250| nextidx:251                                                                             
                                                                             S2|T9 is not leader                  
                                       S1|T9 is not leader                                                        
                                       S1|T9 save persist| votedFor: 1|                                           
                                       logsLen: 251                                                               
                                       S1|T9 appends logs from S0| logLen:                                        
                                       251[AppendEntry]                                                           
                                                                             S2|T9 save persist| votedFor: 0|     
                                                                             logsLen: 251                         
                                                                             S2|T9 appends logs from S0| logLen:  
                                                                             251[AppendEntry]                     
S0|T9 replica entries to S1|                                                                                      
entrylen:0| matchidx:250| nextidx:251                                                                             
S0|T9 replica entries to S2|                                                                                      
entrylen:0| matchidx:250| nextidx:251                                                                             
                                       S1|T9 is not leader                                                        
                                                                             S2|T9 is not leader                  
                                       S1|T9 save persist| votedFor: 1|                                           
                                       logsLen: 251                                                               
                                       S1|T9 appends logs from S0| logLen:                                        
                                       251[AppendEntry]                                                           
                                                                             S2|T9 save persist| votedFor: 0|     
                                                                             logsLen: 251                         
                                                                             S2|T9 appends logs from S0| logLen:  
                                                                             251[AppendEntry]                     
S0|T9 replica entries to S1|                                                                                      
entrylen:0| matchidx:250| nextidx:251                                                                             
S0|T9 replica entries to S2|                                                                                      
entrylen:0| matchidx:250| nextidx:251                                                                             
                                       S1|T9 is not leader                                                        
                                                                             S2|T9 is not leader                  
                                                                             S2|T9 save persist| votedFor: 0|     
                                                                             logsLen: 251                         
                                                                             S2|T9 appends logs from S0| logLen:  
                                                                             251[AppendEntry]                     
                                       S1|T9 save persist| votedFor: 1|                                           
                                       logsLen: 251                                                               
                                       S1|T9 appends logs from S0| logLen:                                        
                                       251[AppendEntry]                                                           
S0|T9 replica entries to S2|                                                                                      
entrylen:0| matchidx:250| nextidx:251                                                                             
S0|T9 replica entries to S1|                                                                                      
entrylen:0| matchidx:250| nextidx:251                                                                             
                                       S1|T9 is not leader                                                        
                                                                             S2|T9 is not leader                  
                                                                             S2|T9 save persist| votedFor: 0|     
                                                                             logsLen: 251                         
                                                                             S2|T9 appends logs from S0| logLen:  
                                                                             251[AppendEntry]                     
                                       S1|T9 save persist| votedFor: 1|                                           
                                       logsLen: 251                                                               
                                       S1|T9 appends logs from S0| logLen:                                        
                                       251[AppendEntry]                                                           
S0|T9 replica entries to S2|                                                                                      
entrylen:0| matchidx:250| nextidx:251                                                                             
S0|T9 replica entries to S1|                                                                                      
entrylen:0| matchidx:250| nextidx:251                                                                             
                                       S1|T9 is not leader                                                        
                                                                             S2|T9 is not leader                  
                                       S1|T9 save persist| votedFor: 1|                                           
                                       logsLen: 251                                                               
                                                                             S2|T9 save persist| votedFor: 0|     
                                                                             logsLen: 251                         
                                       S1|T9 appends logs from S0| logLen:                                        
                                       251[AppendEntry]                                                           
                                                                             S2|T9 appends logs from S0| logLen:  
                                                                             251[AppendEntry]                     
S0|T9 replica entries to S1|                                                                                      
entrylen:0| matchidx:250| nextidx:251                                                                             
S0|T9 replica entries to S2|                                                                                      
entrylen:0| matchidx:250| nextidx:251                                                                             
                                                                             S2|T9 is not leader                  
                                       S1|T9 is not leader                                                        
                                                                             S2|T9 save persist| votedFor: 0|     
                                                                             logsLen: 251                         
                                                                             S2|T9 appends logs from S0| logLen:  
                                                                             251[AppendEntry]                     
                                       S1|T9 save persist| votedFor: 1|                                           
                                       logsLen: 251                                                               
                                       S1|T9 appends logs from S0| logLen:                                        
                                       251[AppendEntry]                                                           
S0|T9 replica entries to S2|                                                                                      
entrylen:0| matchidx:250| nextidx:251                                                                             
S0|T9 replica entries to S1|                                                                                      
entrylen:0| matchidx:250| nextidx:251                                                                             
                                       S1|T9 fails to install snapshot to S2                                      
                                                                             S2|T9 is not leader                  
                                       S1|T9 is not leader                                                        
                                       S1|T9 save persist| votedFor: 1|                                           
                                       logsLen: 251                                                               
                                                                             S2|T9 save persist| votedFor: 0|     
                                                                             logsLen: 251                         
                                                                             S2|T9 appends logs from S0| logLen:  
                                                                             251[AppendEntry]                     
                                       S1|T9 appends logs from S0| logLen:                                        
                                       251[AppendEntry]                                                           
S0|T9 replica entries to S2|                                                                                      
entrylen:0| matchidx:250| nextidx:251                                                                             
S0|T9 replica entries to S1|                                                                                      
entrylen:0| matchidx:250| nextidx:251                                                                             
S0|T9 save persist| votedFor: 0|                                                                                  
logsLen: 252                                                                                                      
S0|T9 receive commands | logLen:                                                                                  
252[Start]                                                                                                        
                                       S1|T9 is not leader                                                        
                                                                             S2|T9 is not leader                  
                                                                             S2|T9 save persist| votedFor: 0|     
                                                                             logsLen: 252                         
                                                                             S2|T9 appends logs from S0| logLen:  
                                                                             252[AppendEntry]                     
                                       S1|T9 save persist| votedFor: 1|                                           
                                       logsLen: 252                                                               
                                       S1|T9 appends logs from S0| logLen:                                        
                                       252[AppendEntry]                                                           
S0|T9 replica entries to S2|                                                                                      
entrylen:1| matchidx:251| nextidx:252                                                                             
S0|T9 update commitIndex as 251                                                                                   
S0|T9 starts to apply entries                                                                                     
[251:251][ApplyEntry]                                                                                             
S0|T9 finishes applying entries                                                                                   
[251:251][ApplyEntry]                                                                                             
S0|T9 replica entries to S1|                                                                                      
entrylen:1| matchidx:251| nextidx:252                                                                             
                                       S1|T9 is not leader                                                        
                                                                             S2|T9 is not leader                  
                                       S1|T9 save persist| votedFor: 1|                                           
                                       logsLen: 252                                                               
                                                                             S2|T9 save persist| votedFor: 0|     
                                                                             logsLen: 252                         
                                       S1|T9 appends logs from S0| logLen:                                        
                                       252[AppendEntry]                                                           
                                                                             S2|T9 appends logs from S0| logLen:  
                                                                             252[AppendEntry]                     
                                       S1|T9 starts to apply entries                                              
                                       [251:251][ApplyEntry]                                                      
                                       S1|T9 finishes applying entries                                            
                                       [251:251][ApplyEntry]                                                      
                                                                             S2|T9 starts to apply entries        
                                                                             [251:251][ApplyEntry]                
                                                                             S2|T9 finishes applying entries      
                                                                             [251:251][ApplyEntry]                
S0|T9 replica entries to S1|                                                                                      
entrylen:0| matchidx:251| nextidx:252                                                                             
S0|T9 replica entries to S2|                                                                                      
entrylen:0| matchidx:251| nextidx:252                                                                             
                                                                             S2|T9 is not leader                  
                                       S1|T9 is not leader                                                        
                                       S1|T9 save persist| votedFor: 1|                                           
                                       logsLen: 252                                                               
                                                                             S2|T9 save persist| votedFor: 0|     
                                                                             logsLen: 252                         
                                                                             S2|T9 appends logs from S0| logLen:  
                                                                             252[AppendEntry]                     
                                       S1|T9 appends logs from S0| logLen:                                        
                                       252[AppendEntry]                                                           
S0|T9 replica entries to S1|                                                                                      
entrylen:0| matchidx:251| nextidx:252                                                                             
S0|T9 replica entries to S2|                                                                                      
entrylen:0| matchidx:251| nextidx:252                                                                             
S0|T9 fails to install snapshot to S1                                                                             
                                                                             S2|T9 is not leader                  
                                       S1|T9 is not leader                                                        
                                       S1|T9 save persist| votedFor: 1|                                           
                                       logsLen: 252                                                               
                                                                             S2|T9 save persist| votedFor: 0|     
                                                                             logsLen: 252                         
                                                                             S2|T9 appends logs from S0| logLen:  
                                                                             252[AppendEntry]                     
                                       S1|T9 appends logs from S0| logLen:                                        
                                       252[AppendEntry]                                                           
S0|T9 replica entries to S2|                                                                                      
entrylen:0| matchidx:251| nextidx:252                                                                             
S0|T9 replica entries to S1|                                                                                      
entrylen:0| matchidx:251| nextidx:252                                                                             
                                                                             S2|T9 is not leader                  
                                       S1|T9 is not leader                                                        
                                                                             S2|T9 save persist| votedFor: 0|     
                                                                             logsLen: 252                         
                                       S1|T9 save persist| votedFor: 1|                                           
                                       logsLen: 252                                                               
                                       S1|T9 appends logs from S0| logLen:                                        
                                       252[AppendEntry]                                                           
                                                                             S2|T9 appends logs from S0| logLen:  
                                                                             252[AppendEntry]                     
S0|T9 replica entries to S1|                                                                                      
entrylen:0| matchidx:251| nextidx:252                                                                             
S0|T9 replica entries to S2|                                                                                      
entrylen:0| matchidx:251| nextidx:252                                                                             
                                                                             S2|T9 is not leader                  
                                       S1|T9 is not leader                                                        
                                       S1|T9 save persist| votedFor: 1|                                           
                                       logsLen: 252                                                               
                                       S1|T9 appends logs from S0| logLen:                                        
                                       252[AppendEntry]                                                           
                                                                             S2|T9 save persist| votedFor: 0|     
                                                                             logsLen: 252                         
                                                                             S2|T9 appends logs from S0| logLen:  
                                                                             252[AppendEntry]                     
S0|T9 replica entries to S1|                                                                                      
entrylen:0| matchidx:251| nextidx:252                                                                             
S0|T9 replica entries to S2|                                                                                      
entrylen:0| matchidx:251| nextidx:252                                                                             
                                       S1 is disconnected                                                         
S0|T9 save persist| votedFor: 0|                                                                                  
logsLen: 253                                                                                                      
S0|T9 receive commands | logLen:                                                                                  
253[Start]                                                                                                        
                                       S1|T9 is not leader                                                        
                                                                             S2|T9 is not leader                  
                                                                             S2|T9 save persist| votedFor: 0|     
                                                                             logsLen: 253                         
                                                                             S2|T9 appends logs from S0| logLen:  
                                                                             253[AppendEntry]                     
S0|T9 replica entries to S2|                                                                                      
entrylen:1| matchidx:252| nextidx:253                                                                             
S0|T9 update commitIndex as 252                                                                                   
S0|T9 starts to apply entries                                                                                     
[252:252][ApplyEntry]                                                                                             
S0|T9 finishes applying entries                                                                                   
[252:252][ApplyEntry]                                                                                             
                                                                             S2|T9 is not leader                  
                                       S1|T9 is not leader                                                        
                                                                             S2|T9 save persist| votedFor: 0|     
                                                                             logsLen: 253                         
                                                                             S2|T9 appends logs from S0| logLen:  
                                                                             253[AppendEntry]                     
                                                                             S2|T9 starts to apply entries        
                                                                             [252:252][ApplyEntry]                
                                                                             S2|T9 finishes applying entries      
                                                                             [252:252][ApplyEntry]                
S0|T9 replica entries to S2|                                                                                      
entrylen:0| matchidx:252| nextidx:253                                                                             
S0|T9 save persist| votedFor: 0|                                                                                  
logsLen: 254                                                                                                      
S0|T9 receive commands | logLen:                                                                                  
254[Start]                                                                                                        
S0|T9 save persist| votedFor: 0|                                                                                  
logsLen: 255                                                                                                      
S0|T9 receive commands | logLen:                                                                                  
255[Start]                                                                                                        
S0|T9 save persist| votedFor: 0|                                                                                  
logsLen: 256                                                                                                      
S0|T9 receive commands | logLen:                                                                                  
256[Start]                                                                                                        
S0|T9 save persist| votedFor: 0|                                                                                  
logsLen: 257                                                                                                      
S0|T9 receive commands | logLen:                                                                                  
257[Start]                                                                                                        
S0|T9 save persist| votedFor: 0|                                                                                  
logsLen: 258                                                                                                      
S0|T9 receive commands | logLen:                                                                                  
258[Start]                                                                                                        
S0|T9 save persist| votedFor: 0|                                                                                  
logsLen: 259                                                                                                      
S0|T9 receive commands | logLen:                                                                                  
259[Start]                                                                                                        
S0|T9 save persist| votedFor: 0|                                                                                  
logsLen: 260                                                                                                      
S0|T9 receive commands | logLen:                                                                                  
260[Start]                                                                                                        
                                                                             S2|T9 is not leader                  
                                       S1|T9 is not leader                                                        
                                                                             S2|T9 save persist| votedFor: 0|     
                                                                             logsLen: 260                         
                                                                             S2|T9 appends logs from S0| logLen:  
                                                                             260[AppendEntry]                     
S0|T9 replica entries to S2|                                                                                      
entrylen:7| matchidx:259| nextidx:260                                                                             
S0|T9 update commitIndex as 259                                                                                   
S0|T9 starts to apply entries                                                                                     
[253:259][ApplyEntry]                                                                                             
S0|T9 finishes applying entries                                                                                   
[253:259][ApplyEntry]                                                                                             
S0|T9 Snapshot until index 259|                                                                                   
logLen: 260                                                                                                       
                                                                             S2|T9 is not leader                  
                                       S1|T9 is not leader                                                        
S0|T9 send rpc to S1|base: 259| next:                                                                             
252                                                                                                               
                                                                             S2|T9 save persist| votedFor: 0|     
                                                                             logsLen: 260                         
                                                                             S2|T9 appends logs from S0| logLen:  
                                                                             260[AppendEntry]                     
                                                                             S2|T9 starts to apply entries        
                                                                             [253:259][ApplyEntry]                
                                                                             S2|T9 finishes applying entries      
                                                                             [253:259][ApplyEntry]                
S0|T9 replica entries to S2|                                                                                      
entrylen:0| matchidx:259| nextidx:260                                                                             
                                       S1 is connected again                                                      
S0|T9 save persist| votedFor: 0|                                                                                  
logsLen: 261                                                                                                      
S0|T9 receive commands | logLen:                                                                                  
261[Start]                                                                                                        
                                                                             S2|T9 Snapshot until index 259|      
                                                                             logLen: 260                          
                                       S1|T9 is not leader                                                        
                                                                             S2|T9 is not leader                  
S0|T9 send rpc to S1|base: 259| next:                                                                             
252                                                                                                               
                                       S1|T9 receive rpc from S0                                                  
                                       S1|T9 update rfstate| Base:259|                                            
                                       LogLen:260                                                                 
                                                                             S2|T9 save persist| votedFor: 0|     
                                                                             logsLen: 261                         
                                                                             S2|T9 appends logs from S0| logLen:  
                                                                             261[AppendEntry]                     
                                       S1|T9 applys snapshot from S0                                              
S0|T9 installs snapshot to S1|                                                                                    
nextId:260| matchId:259                                                                                           
S0|T9 replica entries to S2|                                                                                      
entrylen:1| matchidx:260| nextidx:261                                                                             
S0|T9 update commitIndex as 260                                                                                   
S0|T9 starts to apply entries                                                                                     
[260:260][ApplyEntry]                                                                                             
S0|T9 finishes applying entries                                                                                   
[260:260][ApplyEntry]                                                                                             
                                                                             S2|T9 is not leader                  
                                       S1|T9 is not leader                                                        
                                                                             S2|T9 save persist| votedFor: 0|     
                                                                             logsLen: 261                         
                                       S1|T9 save persist| votedFor: 1|                                           
                                       logsLen: 261                                                               
                                       S1|T9 appends logs from S0| logLen:                                        
                                       261[AppendEntry]                                                           
                                                                             S2|T9 appends logs from S0| logLen:  
                                                                             261[AppendEntry]                     
                                       S1|T9 starts to apply entries                                              
                                       [260:260][ApplyEntry]                                                      
                                                                             S2|T9 starts to apply entries        
                                                                             [260:260][ApplyEntry]                
                                       S1|T9 finishes applying entries                                            
                                       [260:260][ApplyEntry]                                                      
                                                                             S2|T9 finishes applying entries      
                                                                             [260:260][ApplyEntry]                
S0|T9 replica entries to S1|                                                                                      
entrylen:1| matchidx:260| nextidx:261                                                                             
S0|T9 replica entries to S2|                                                                                      
entrylen:0| matchidx:260| nextidx:261                                                                             
S0|T9 fails to install snapshot to S1                                                                             
                                       S1|T9 is not leader                                                        
                                                                             S2|T9 is not leader                  
                                                                             S2|T9 save persist| votedFor: 0|     
                                                                             logsLen: 261                         
                                       S1|T9 save persist| votedFor: 1|                                           
                                       logsLen: 261                                                               
                                                                             S2|T9 appends logs from S0| logLen:  
                                                                             261[AppendEntry]                     
                                       S1|T9 appends logs from S0| logLen:                                        
                                       261[AppendEntry]                                                           
S0|T9 replica entries to S2|                                                                                      
entrylen:0| matchidx:260| nextidx:261                                                                             
S0|T9 replica entries to S1|                                                                                      
entrylen:0| matchidx:260| nextidx:261                                                                             
                                       S1|T9 is not leader                                                        
                                                                             S2|T9 is not leader                  
                                                                             S2|T9 save persist| votedFor: 0|     
                                                                             logsLen: 261                         
                                                                             S2|T9 appends logs from S0| logLen:  
                                                                             261[AppendEntry]                     
                                       S1|T9 save persist| votedFor: 1|                                           
                                       logsLen: 261                                                               
                                       S1|T9 appends logs from S0| logLen:                                        
                                       261[AppendEntry]                                                           
S0|T9 replica entries to S2|                                                                                      
entrylen:0| matchidx:260| nextidx:261                                                                             
S0|T9 replica entries to S1|                                                                                      
entrylen:0| matchidx:260| nextidx:261                                                                             
                                                                             S2|T9 is not leader                  
                                       S1|T9 is not leader                                                        
                                                                             S2|T9 save persist| votedFor: 0|     
                                                                             logsLen: 261                         
                                                                             S2|T9 appends logs from S0| logLen:  
                                                                             261[AppendEntry]                     
                                       S1|T9 save persist| votedFor: 1|                                           
                                       logsLen: 261                                                               
                                       S1|T9 appends logs from S0| logLen:                                        
                                       261[AppendEntry]                                                           
S0|T9 replica entries to S2|                                                                                      
entrylen:0| matchidx:260| nextidx:261                                                                             
S0|T9 replica entries to S1|                                                                                      
entrylen:0| matchidx:260| nextidx:261                                                                             
                                       S1|T9 is not leader                                                        
                                                                             S2|T9 is not leader                  
                                                                             S2|T9 save persist| votedFor: 0|     
                                                                             logsLen: 261                         
                                                                             S2|T9 appends logs from S0| logLen:  
                                                                             261[AppendEntry]                     
                                       S1|T9 save persist| votedFor: 1|                                           
                                       logsLen: 261                                                               
                                       S1|T9 appends logs from S0| logLen:                                        
                                       261[AppendEntry]                                                           
S0|T9 replica entries to S2|                                                                                      
entrylen:0| matchidx:260| nextidx:261                                                                             
S0|T9 replica entries to S1|                                                                                      
entrylen:0| matchidx:260| nextidx:261                                                                             
                                       S1|T9 is not leader                                                        
                                                                             S2|T9 is not leader                  
                                       S1|T9 save persist| votedFor: 1|                                           
                                       logsLen: 261                                                               
                                                                             S2|T9 save persist| votedFor: 0|     
                                                                             logsLen: 261                         
                                       S1|T9 appends logs from S0| logLen:                                        
                                       261[AppendEntry]                                                           
                                                                             S2|T9 appends logs from S0| logLen:  
                                                                             261[AppendEntry]                     
S0|T9 replica entries to S1|                                                                                      
entrylen:0| matchidx:260| nextidx:261                                                                             
                                       S1 is disconnected                                                         
S0|T9 replica entries to S2|                                                                                      
entrylen:0| matchidx:260| nextidx:261                                                                             
S0|T9 save persist| votedFor: 0|                                                                                  
logsLen: 262                                                                                                      
S0|T9 receive commands | logLen:                                                                                  
262[Start]                                                                                                        
                                       S1|T9 is not leader                                                        
                                                                             S2|T9 is not leader                  
                                                                             S2|T9 save persist| votedFor: 0|     
                                                                             logsLen: 262                         
                                                                             S2|T9 appends logs from S0| logLen:  
                                                                             262[AppendEntry]                     
S0|T9 replica entries to S2|                                                                                      
entrylen:1| matchidx:261| nextidx:262                                                                             
S0|T9 update commitIndex as 261                                                                                   
S0|T9 starts to apply entries                                                                                     
[261:261][ApplyEntry]                                                                                             
S0|T9 finishes applying entries                                                                                   
[261:261][ApplyEntry]                                                                                             
                                       S1|T9 is not leader                                                        
                                                                             S2|T9 is not leader                  
                                                                             S2|T9 save persist| votedFor: 0|     
                                                                             logsLen: 262                         
                                                                             S2|T9 appends logs from S0| logLen:  
                                                                             262[AppendEntry]                     
                                                                             S2|T9 starts to apply entries        
                                                                             [261:261][ApplyEntry]                
                                                                             S2|T9 finishes applying entries      
                                                                             [261:261][ApplyEntry]                
S0|T9 replica entries to S2|                                                                                      
entrylen:0| matchidx:261| nextidx:262                                                                             
S0|T9 save persist| votedFor: 0|                                                                                  
logsLen: 263                                                                                                      
S0|T9 receive commands | logLen:                                                                                  
263[Start]                                                                                                        
S0|T9 save persist| votedFor: 0|                                                                                  
logsLen: 264                                                                                                      
S0|T9 receive commands | logLen:                                                                                  
264[Start]                                                                                                        
S0|T9 save persist| votedFor: 0|                                                                                  
logsLen: 265                                                                                                      
S0|T9 receive commands | logLen:                                                                                  
265[Start]                                                                                                        
S0|T9 save persist| votedFor: 0|                                                                                  
logsLen: 266                                                                                                      
S0|T9 receive commands | logLen:                                                                                  
266[Start]                                                                                                        
S0|T9 save persist| votedFor: 0|                                                                                  
logsLen: 267                                                                                                      
S0|T9 receive commands | logLen:                                                                                  
267[Start]                                                                                                        
S0|T9 save persist| votedFor: 0|                                                                                  
logsLen: 268                                                                                                      
S0|T9 receive commands | logLen:                                                                                  
268[Start]                                                                                                        
                                                                             S2|T9 is not leader                  
                                       S1|T9 is not leader                                                        
                                                                             S2|T9 save persist| votedFor: 0|     
                                                                             logsLen: 268                         
                                                                             S2|T9 appends logs from S0| logLen:  
                                                                             268[AppendEntry]                     
S0|T9 replica entries to S2|                                                                                      
entrylen:6| matchidx:267| nextidx:268                                                                             
S0|T9 update commitIndex as 267                                                                                   
S0|T9 starts to apply entries                                                                                     
[262:267][ApplyEntry]                                                                                             
S0|T9 finishes applying entries                                                                                   
[262:267][ApplyEntry]                                                                                             
                                                                             S2|T9 is not leader                  
                                       S1|T9 is not leader                                                        
                                                                             S2|T9 save persist| votedFor: 0|     
                                                                             logsLen: 268                         
                                                                             S2|T9 appends logs from S0| logLen:  
                                                                             268[AppendEntry]                     
                                                                             S2|T9 starts to apply entries        
                                                                             [262:267][ApplyEntry]                
                                                                             S2|T9 finishes applying entries      
                                                                             [262:267][ApplyEntry]                
S0|T9 replica entries to S2|                                                                                      
entrylen:0| matchidx:267| nextidx:268                                                                             
                                       S1 is connected again                                                      
S0|T9 save persist| votedFor: 0|                                                                                  
logsLen: 269                                                                                                      
S0|T9 receive commands | logLen:                                                                                  
269[Start]                                                                                                        
                                       S1|T9 is not leader                                                        
                                                                             S2|T9 is not leader                  
                                                                             S2|T9 save persist| votedFor: 0|     
                                                                             logsLen: 269                         
                                                                             S2|T9 appends logs from S0| logLen:  
                                                                             269[AppendEntry]                     
                                       S1|T9 save persist| votedFor: 1|                                           
                                       logsLen: 269                                                               
                                       S1|T9 appends logs from S0| logLen:                                        
                                       269[AppendEntry]                                                           
                                       S1|T9 starts to apply entries                                              
                                       [261:267][ApplyEntry]                                                      
                                       S1|T9 finishes applying entries                                            
                                       [261:267][ApplyEntry]                                                      
S0|T9 replica entries to S2|                                                                                      
entrylen:1| matchidx:268| nextidx:269                                                                             
S0|T9 update commitIndex as 268                                                                                   
S0|T9 starts to apply entries                                                                                     
[268:268][ApplyEntry]                                                                                             
S0|T9 finishes applying entries                                                                                   
[268:268][ApplyEntry]                                                                                             
S0|T9 replica entries to S1|                                                                                      
entrylen:8| matchidx:268| nextidx:269                                                                             
                                       S1|T9 is not leader                                                        
                                                                             S2|T9 is not leader                  
                                       S1|T9 save persist| votedFor: 1|                                           
                                       logsLen: 269                                                               
                                                                             S2|T9 save persist| votedFor: 0|     
                                                                             logsLen: 269                         
                                                                             S2|T9 appends logs from S0| logLen:  
                                                                             269[AppendEntry]                     
                                       S1|T9 appends logs from S0| logLen:                                        
                                       269[AppendEntry]                                                           
                                                                             S2|T9 starts to apply entries        
                                                                             [268:268][ApplyEntry]                
                                                                             S2|T9 finishes applying entries      
                                                                             [268:268][ApplyEntry]                
                                       S1|T9 starts to apply entries                                              
                                       [268:268][ApplyEntry]                                                      
                                       S1|T9 finishes applying entries                                            
                                       [268:268][ApplyEntry]                                                      
S0|T9 replica entries to S2|                                                                                      
entrylen:0| matchidx:268| nextidx:269                                                                             
S0|T9 replica entries to S1|                                                                                      
entrylen:0| matchidx:268| nextidx:269                                                                             
                                                                             S2|T9 is not leader                  
                                       S1|T9 is not leader                                                        
                                                                             S2|T9 save persist| votedFor: 0|     
                                                                             logsLen: 269                         
                                                                             S2|T9 appends logs from S0| logLen:  
                                                                             269[AppendEntry]                     
                                       S1|T9 save persist| votedFor: 1|                                           
                                       logsLen: 269                                                               
                                       S1|T9 appends logs from S0| logLen:                                        
                                       269[AppendEntry]                                                           
S0|T9 replica entries to S1|                                                                                      
entrylen:0| matchidx:268| nextidx:269                                                                             
S0|T9 replica entries to S2|                                                                                      
entrylen:0| matchidx:268| nextidx:269                                                                             
                                                                             S2|T9 is not leader                  
                                       S1|T9 is not leader                                                        
                                       S1|T9 save persist| votedFor: 1|                                           
                                       logsLen: 269                                                               
                                                                             S2|T9 save persist| votedFor: 0|     
                                                                             logsLen: 269                         
                                       S1|T9 appends logs from S0| logLen:                                        
                                       269[AppendEntry]                                                           
                                                                             S2|T9 appends logs from S0| logLen:  
                                                                             269[AppendEntry]                     
S0|T9 replica entries to S1|                                                                                      
entrylen:0| matchidx:268| nextidx:269                                                                             
S0|T9 replica entries to S2|                                                                                      
entrylen:0| matchidx:268| nextidx:269                                                                             
                                       S1|T9 is not leader                                                        
                                                                             S2|T9 is not leader                  
                                       S1|T9 save persist| votedFor: 1|                                           
                                       logsLen: 269                                                               
                                       S1|T9 appends logs from S0| logLen:                                        
                                       269[AppendEntry]                                                           
                                                                             S2|T9 save persist| votedFor: 0|     
                                                                             logsLen: 269                         
                                                                             S2|T9 appends logs from S0| logLen:  
                                                                             269[AppendEntry]                     
S0|T9 replica entries to S1|                                                                                      
entrylen:0| matchidx:268| nextidx:269                                                                             
S0|T9 replica entries to S2|                                                                                      
entrylen:0| matchidx:268| nextidx:269                                                                             
                                       S1|T9 is not leader                                                        
                                                                             S2|T9 is not leader                  
                                       S1|T9 save persist| votedFor: 1|                                           
                                       logsLen: 269                                                               
                                       S1|T9 appends logs from S0| logLen:                                        
                                       269[AppendEntry]                                                           
                                                                             S2|T9 save persist| votedFor: 0|     
                                                                             logsLen: 269                         
                                                                             S2|T9 appends logs from S0| logLen:  
                                                                             269[AppendEntry]                     
S0|T9 replica entries to S1|                                                                                      
entrylen:0| matchidx:268| nextidx:269                                                                             
S0|T9 replica entries to S2|                                                                                      
entrylen:0| matchidx:268| nextidx:269                                                                             
S0|T9 fails to install snapshot to S1                                                                             
S0 is disconnected                                                                                                
                                       S1|T9 is not leader                                                        
                                                                             S2|T9 is not leader                  
                                       S1|T9 is not leader                                                        
                                                                             S2|T9 is not leader                  
                                                                             S2|T9 is not leader                  
                                       S1|T9 is not leader                                                        
                                                                             S2|T9 is not leader                  
                                       S1|T9 is not leader                                                        
                                                                             S2|T9 is not leader                  
                                       S1|T9 is not leader                                                        
                                       S1|T9 is not leader                                                        
                                                                             S2|T9 is not leader                  
                                                                             S2|T9 is not leader                  
                                       S1|T9 is not leader                                                        
                                       S1|T9 is not leader                                                        
                                                                             S2|T9 is not leader                  
                                                                             S2|T10 starts to join election       
                                                                             S2|T10 save persist| votedFor: 2|    
                                                                             logsLen: 269                         
                                       S1|T10 save persist| votedFor: -1|                                         
                                       logsLen: 269                                                               
                                       S1|T10 save persist| votedFor: 2|                                          
                                       logsLen: 269                                                               
                                       S1|T10 votes for S2[RequestVote]                                           
                                                                             S2|T10 becomes the leader, and starts
                                                                             heatbeats                            
                                       S1|T10 save persist| votedFor: 2|                                          
                                       logsLen: 269                                                               
                                       S1|T10 appends logs from S2| logLen:                                       
                                       269[AppendEntry]                                                           
                                                                             S2|T10 replica entries to S1|        
                                                                             entrylen:0| matchidx:268| nextidx:269
                                                                             S2|T10 save persist| votedFor: 2|    
                                                                             logsLen: 270                         
                                                                             S2|T10 receive commands | logLen:    
                                                                             270[Start]                           
                                       S1|T10 is not leader                                                       
                                       S1|T10 save persist| votedFor: 2|                                          
                                       logsLen: 270                                                               
                                       S1|T10 appends logs from S2| logLen:                                       
                                       270[AppendEntry]                                                           
                                                                             S2|T10 replica entries to S1|        
                                                                             entrylen:1| matchidx:269| nextidx:270
                                                                             S2|T10 update commitIndex as 269     
                                                                             S2|T10 starts to apply entries       
                                                                             [269:269][ApplyEntry]                
                                                                             S2|T10 finishes applying entries     
                                                                             [269:269][ApplyEntry]                
                                                                             S2|T10 Snapshot until index 269|     
                                                                             logLen: 270                          
                                       S1|T10 is not leader                                                       
                                                                             S2|T10 send rpc to S0|base: 269|     
                                                                             next: 269                            
                                       S1|T10 save persist| votedFor: 2|                                          
                                       logsLen: 270                                                               
                                       S1|T10 appends logs from S2| logLen:                                       
                                       270[AppendEntry]                                                           
                                       S1|T10 starts to apply entries                                             
                                       [269:269][ApplyEntry]                                                      
                                       S1|T10 finishes applying entries                                           
                                       [269:269][ApplyEntry]                                                      
                                                                             S2|T10 replica entries to S1|        
                                                                             entrylen:0| matchidx:269| nextidx:270
                                       S1|T10 Snapshot until index 269|                                           
                                       logLen: 270                                                                
                                                                             S2|T10 save persist| votedFor: 2|    
                                                                             logsLen: 271                         
                                                                             S2|T10 receive commands | logLen:    
                                                                             271[Start]                           
                                       S1|T10 is not leader                                                       
                                                                             S2|T10 send rpc to S0|base: 269|     
                                                                             next: 269                            
                                       S1|T10 save persist| votedFor: 2|                                          
                                       logsLen: 271                                                               
                                       S1|T10 appends logs from S2| logLen:                                       
                                       271[AppendEntry]                                                           
                                                                             S2|T10 replica entries to S1|        
                                                                             entrylen:1| matchidx:270| nextidx:271
                                                                             S2|T10 update commitIndex as 270     
                                                                             S2|T10 starts to apply entries       
                                                                             [270:270][ApplyEntry]                
                                                                             S2|T10 finishes applying entries     
                                                                             [270:270][ApplyEntry]                
                                       S1|T10 is not leader                                                       
                                                                             S2|T10 send rpc to S0|base: 269|     
                                                                             next: 269                            
                                       S1|T10 save persist| votedFor: 2|                                          
                                       logsLen: 271                                                               
                                       S1|T10 appends logs from S2| logLen:                                       
                                       271[AppendEntry]                                                           
                                       S1|T10 starts to apply entries                                             
                                       [270:270][ApplyEntry]                                                      
                                       S1|T10 finishes applying entries                                           
                                       [270:270][ApplyEntry]                                                      
                                                                             S2|T10 replica entries to S1|        
                                                                             entrylen:0| matchidx:270| nextidx:271
S0 is connected again                                                                                             
                                                                             S2|T10 save persist| votedFor: 2|    
                                                                             logsLen: 272                         
                                                                             S2|T10 receive commands | logLen:    
                                                                             272[Start]                           
                                       S1|T10 is not leader                                                       
                                                                             S2|T10 send rpc to S0|base: 269|     
                                                                             next: 269                            
                                                                             S2|T10 rejects to append entries from
                                                                             S0 | out of date term[AppendEntry]   
S0|T9 receive rpc from S2                                                                                         
                                       S1|T10 rejects to append entries from                                      
                                       S0 | out of date term[AppendEntry]                                         
S0|T10 save persist| votedFor: 0|                                                                                 
logsLen: 269                                                                                                      
S0|T10 update rfstate| Base:269|                                                                                  
LogLen:270                                                                                                        
                                       S1|T10 save persist| votedFor: 2|                                          
                                       logsLen: 272                                                               
                                       S1|T10 appends logs from S2| logLen:                                       
                                       272[AppendEntry]                                                           
S0|T10 lost leadership, state: 0                                                                                  
S0|T10 lost leadership, state: 0                                                                                  
S0|T10 applys snapshot from S2                                                                                    
                                                                             S2|T10 installs snapshot to S0|      
                                                                             nextId:270| matchId:269              
                                                                             S2|T10 replica entries to S1|        
                                                                             entrylen:1| matchidx:271| nextidx:272
                                                                             S2|T10 update commitIndex as 271     
                                                                             S2|T10 starts to apply entries       
                                                                             [271:271][ApplyEntry]                
                                                                             S2|T10 finishes applying entries     
                                                                             [271:271][ApplyEntry]                
                                       S1|T10 is not leader                                                       
S0|T10 is not leader                                                                                              
                                       S1|T10 save persist| votedFor: 2|                                          
                                       logsLen: 272                                                               
                                       S1|T10 appends logs from S2| logLen:                                       
                                       272[AppendEntry]                                                           
S0|T10 save persist| votedFor: 0|                                                                                 
logsLen: 272                                                                                                      
S0|T10 appends logs from S2| logLen:                                                                              
272[AppendEntry]                                                                                                  
                                       S1|T10 starts to apply entries                                             
                                       [271:271][ApplyEntry]                                                      
                                       S1|T10 finishes applying entries                                           
                                       [271:271][ApplyEntry]                                                      
S0|T10 starts to apply entries                                                                                    
[270:271][ApplyEntry]                                                                                             
S0|T10 finishes applying entries                                                                                  
[270:271][ApplyEntry]                                                                                             
                                                                             S2|T10 replica entries to S1|        
                                                                             entrylen:0| matchidx:271| nextidx:272
                                                                             S2|T10 replica entries to S0|        
                                                                             entrylen:2| matchidx:271| nextidx:272
                                       S1|T10 is not leader                                                       
S0|T10 is not leader                                                                                              
S0|T10 save persist| votedFor: 0|                                                                                 
logsLen: 272                                                                                                      
S0|T10 appends logs from S2| logLen:                                                                              
272[AppendEntry]                                                                                                  
                                       S1|T10 save persist| votedFor: 2|                                          
                                       logsLen: 272                                                               
                                       S1|T10 appends logs from S2| logLen:                                       
                                       272[AppendEntry]                                                           
                                                                             S2|T10 replica entries to S0|        
                                                                             entrylen:0| matchidx:271| nextidx:272
                                                                             S2|T10 replica entries to S1|        
                                                                             entrylen:0| matchidx:271| nextidx:272
S0|T10 is not leader                                                                                              
                                       S1|T10 is not leader                                                       
S0|T10 save persist| votedFor: 0|                                                                                 
logsLen: 272                                                                                                      
                                       S1|T10 save persist| votedFor: 2|                                          
                                       logsLen: 272                                                               
S0|T10 appends logs from S2| logLen:                                                                              
272[AppendEntry]                                                                                                  
                                       S1|T10 appends logs from S2| logLen:                                       
                                       272[AppendEntry]                                                           
                                                                             S2|T10 replica entries to S0|        
                                                                             entrylen:0| matchidx:271| nextidx:272
                                                                             S2|T10 replica entries to S1|        
                                                                             entrylen:0| matchidx:271| nextidx:272
S0|T10 fails to install snapshot to S1                                                                            
S0|T10 is not leader                                                                                              
                                       S1|T10 is not leader                                                       
                                       S1|T10 save persist| votedFor: 2|                                          
                                       logsLen: 272                                                               
                                       S1|T10 appends logs from S2| logLen:                                       
                                       272[AppendEntry]                                                           
S0|T10 save persist| votedFor: 0|                                                                                 
logsLen: 272                                                                                                      
S0|T10 appends logs from S2| logLen:                                                                              
272[AppendEntry]                                                                                                  
                                                                             S2|T10 replica entries to S1|        
                                                                             entrylen:0| matchidx:271| nextidx:272
                                                                             S2|T10 replica entries to S0|        
                                                                             entrylen:0| matchidx:271| nextidx:272
                                                                             S2|T10 fails to install snapshot to  
                                                                             S0                                   
S0|T10 is not leader                                                                                              
                                       S1|T10 is not leader                                                       
                                       S1|T10 save persist| votedFor: 2|                                          
                                       logsLen: 272                                                               
                                       S1|T10 appends logs from S2| logLen:                                       
                                       272[AppendEntry]                                                           
S0|T10 save persist| votedFor: 0|                                                                                 
logsLen: 272                                                                                                      
S0|T10 appends logs from S2| logLen:                                                                              
272[AppendEntry]                                                                                                  
                                                                             S2|T10 replica entries to S1|        
                                                                             entrylen:0| matchidx:271| nextidx:272
                                                                             S2|T10 replica entries to S0|        
                                                                             entrylen:0| matchidx:271| nextidx:272
S0 is disconnected                                                                                                
                                                                             S2|T10 save persist| votedFor: 2|    
                                                                             logsLen: 273                         
                                                                             S2|T10 receive commands | logLen:    
                                                                             273[Start]                           
                                       S1|T10 is not leader                                                       
S0|T10 is not leader                                                                                              
                                       S1|T10 save persist| votedFor: 2|                                          
                                       logsLen: 273                                                               
                                       S1|T10 appends logs from S2| logLen:                                       
                                       273[AppendEntry]                                                           
                                                                             S2|T10 replica entries to S1|        
                                                                             entrylen:1| matchidx:272| nextidx:273
                                                                             S2|T10 update commitIndex as 272     
                                                                             S2|T10 starts to apply entries       
                                                                             [272:272][ApplyEntry]                
                                                                             S2|T10 finishes applying entries     
                                                                             [272:272][ApplyEntry]                
                                       S1|T10 is not leader                                                       
S0|T10 is not leader                                                                                              
                                       S1|T10 save persist| votedFor: 2|                                          
                                       logsLen: 273                                                               
                                       S1|T10 appends logs from S2| logLen:                                       
                                       273[AppendEntry]                                                           
                                       S1|T10 starts to apply entries                                             
                                       [272:272][ApplyEntry]                                                      
                                       S1|T10 finishes applying entries                                           
                                       [272:272][ApplyEntry]                                                      
                                                                             S2|T10 replica entries to S1|        
                                                                             entrylen:0| matchidx:272| nextidx:273
                                                                             S2|T10 save persist| votedFor: 2|    
                                                                             logsLen: 274                         
                                                                             S2|T10 receive commands | logLen:    
                                                                             274[Start]                           
                                                                             S2|T10 save persist| votedFor: 2|    
                                                                             logsLen: 275                         
                                                                             S2|T10 receive commands | logLen:    
                                                                             275[Start]                           
                                                                             S2|T10 save persist| votedFor: 2|    
                                                                             logsLen: 276                         
                                                                             S2|T10 receive commands | logLen:    
                                                                             276[Start]                           
                                                                             S2|T10 save persist| votedFor: 2|    
                                                                             logsLen: 277                         
                                                                             S2|T10 receive commands | logLen:    
                                                                             277[Start]                           
                                                                             S2|T10 save persist| votedFor: 2|    
                                                                             logsLen: 278                         
                                                                             S2|T10 receive commands | logLen:    
                                                                             278[Start]                           
                                                                             S2|T10 save persist| votedFor: 2|    
                                                                             logsLen: 279                         
                                                                             S2|T10 receive commands | logLen:    
                                                                             279[Start]                           
                                                                             S2|T10 save persist| votedFor: 2|    
                                                                             logsLen: 280                         
                                                                             S2|T10 receive commands | logLen:    
                                                                             280[Start]                           
                                                                             S2|T10 save persist| votedFor: 2|    
                                                                             logsLen: 281                         
                                                                             S2|T10 receive commands | logLen:    
                                                                             281[Start]                           
                                                                             S2|T10 save persist| votedFor: 2|    
                                                                             logsLen: 282                         
                                                                             S2|T10 receive commands | logLen:    
                                                                             282[Start]                           
                                                                             S2|T10 save persist| votedFor: 2|    
                                                                             logsLen: 283                         
                                                                             S2|T10 receive commands | logLen:    
                                                                             283[Start]                           
                                                                             S2|T10 save persist| votedFor: 2|    
                                                                             logsLen: 284                         
                                                                             S2|T10 receive commands | logLen:    
                                                                             284[Start]                           
                                                                             S2|T10 save persist| votedFor: 2|    
                                                                             logsLen: 285                         
                                                                             S2|T10 receive commands | logLen:    
                                                                             285[Start]                           
                                       S1|T10 is not leader                                                       
S0|T10 is not leader                                                                                              
                                       S1|T10 save persist| votedFor: 2|                                          
                                       logsLen: 285                                                               
                                       S1|T10 appends logs from S2| logLen:                                       
                                       285[AppendEntry]                                                           
                                                                             S2|T10 replica entries to S1|        
                                                                             entrylen:12| matchidx:284|           
                                                                             nextidx:285                          
                                                                             S2|T10 update commitIndex as 284     
                                                                             S2|T10 starts to apply entries       
                                                                             [273:284][ApplyEntry]                
                                                                             S2|T10 Snapshot until index 279|     
                                                                             logLen: 285                          
                                                                             S2|T10 finishes applying entries     
                                                                             [273:284][ApplyEntry]                
                                       S1|T10 is not leader                                                       
S0|T10 is not leader                                                                                              
                                                                             S2|T10 send rpc to S0|base: 279|     
                                                                             next: 272                            
                                       S1|T10 save persist| votedFor: 2|                                          
                                       logsLen: 285                                                               
                                       S1|T10 appends logs from S2| logLen:                                       
                                       285[AppendEntry]                                                           
                                       S1|T10 starts to apply entries                                             
                                       [273:284][ApplyEntry]                                                      
                                                                             S2|T10 replica entries to S1|        
                                                                             entrylen:0| matchidx:284| nextidx:285
                                       S1|T10 Snapshot until index 279|                                           
                                       logLen: 285                                                                
                                       S1|T10 finishes applying entries                                           
                                       [273:284][ApplyEntry]                                                      
S0 is connected again                                                                                             
                                                                             S2|T10 save persist| votedFor: 2|    
                                                                             logsLen: 286                         
                                                                             S2|T10 receive commands | logLen:    
                                                                             286[Start]                           
S0|T10 is not leader                                                                                              
                                       S1|T10 is not leader                                                       
                                                                             S2|T10 send rpc to S0|base: 279|     
                                                                             next: 272                            
S0|T10 receive rpc from S2                                                                                        
S0|T10 update rfstate| Base:279|                                                                                  
LogLen:280                                                                                                        
S0|T10 applys snapshot from S2                                                                                    
                                       S1|T10 save persist| votedFor: 2|                                          
                                       logsLen: 286                                                               
                                       S1|T10 appends logs from S2| logLen:                                       
                                       286[AppendEntry]                                                           
                                                                             S2|T10 installs snapshot to S0|      
                                                                             nextId:280| matchId:279              
                                                                             S2|T10 replica entries to S1|        
                                                                             entrylen:1| matchidx:285| nextidx:286
                                                                             S2|T10 update commitIndex as 285     
                                                                             S2|T10 starts to apply entries       
                                                                             [285:285][ApplyEntry]                
                                                                             S2|T10 finishes applying entries     
                                                                             [285:285][ApplyEntry]                
                                                                             S2|T10 fails to install snapshot to  
                                                                             S0                                   
                                       S1|T10 is not leader                                                       
S0|T10 is not leader                                                                                              
                                       S1|T10 save persist| votedFor: 2|                                          
                                       logsLen: 286                                                               
                                       S1|T10 appends logs from S2| logLen:                                       
                                       286[AppendEntry]                                                           
S0|T10 save persist| votedFor: 0|                                                                                 
logsLen: 286                                                                                                      
S0|T10 appends logs from S2| logLen:                                                                              
286[AppendEntry]                                                                                                  
                                       S1|T10 starts to apply entries                                             
                                       [285:285][ApplyEntry]                                                      
S0|T10 starts to apply entries                                                                                    
[280:285][ApplyEntry]                                                                                             
                                       S1|T10 finishes applying entries                                           
                                       [285:285][ApplyEntry]                                                      
S0|T10 finishes applying entries                                                                                  
[280:285][ApplyEntry]                                                                                             
                                                                             S2|T10 replica entries to S1|        
                                                                             entrylen:0| matchidx:285| nextidx:286
                                                                             S2|T10 replica entries to S0|        
                                                                             entrylen:6| matchidx:285| nextidx:286
S0|T10 is not leader                                                                                              
                                       S1|T10 is not leader                                                       
                                       S1|T10 save persist| votedFor: 2|                                          
                                       logsLen: 286                                                               
                                       S1|T10 appends logs from S2| logLen:                                       
                                       286[AppendEntry]                                                           
S0|T10 save persist| votedFor: 0|                                                                                 
logsLen: 286                                                                                                      
S0|T10 appends logs from S2| logLen:                                                                              
286[AppendEntry]                                                                                                  
                                                                             S2|T10 replica entries to S1|        
                                                                             entrylen:0| matchidx:285| nextidx:286
                                                                             S2|T10 replica entries to S0|        
                                                                             entrylen:0| matchidx:285| nextidx:286
                                       S1|T10 is not leader                                                       
S0|T10 is not leader                                                                                              
S0|T10 save persist| votedFor: 0|                                                                                 
logsLen: 286                                                                                                      
S0|T10 appends logs from S2| logLen:                                                                              
286[AppendEntry]                                                                                                  
                                       S1|T10 save persist| votedFor: 2|                                          
                                       logsLen: 286                                                               
                                       S1|T10 appends logs from S2| logLen:                                       
                                       286[AppendEntry]                                                           
                                                                             S2|T10 replica entries to S0|        
                                                                             entrylen:0| matchidx:285| nextidx:286
                                                                             S2|T10 replica entries to S1|        
                                                                             entrylen:0| matchidx:285| nextidx:286
                                       S1|T10 is not leader                                                       
S0|T10 is not leader                                                                                              
S0|T10 save persist| votedFor: 0|                                                                                 
logsLen: 286                                                                                                      
                                       S1|T10 save persist| votedFor: 2|                                          
                                       logsLen: 286                                                               
                                       S1|T10 appends logs from S2| logLen:                                       
                                       286[AppendEntry]                                                           
S0|T10 appends logs from S2| logLen:                                                                              
286[AppendEntry]                                                                                                  
                                                                             S2|T10 replica entries to S1|        
                                                                             entrylen:0| matchidx:285| nextidx:286
                                                                             S2|T10 replica entries to S0|        
                                                                             entrylen:0| matchidx:285| nextidx:286
                                       S1|T10 is not leader                                                       
S0|T10 is not leader                                                                                              
S0|T10 save persist| votedFor: 0|                                                                                 
logsLen: 286                                                                                                      
S0|T10 appends logs from S2| logLen:                                                                              
286[AppendEntry]                                                                                                  
                                       S1|T10 save persist| votedFor: 2|                                          
                                       logsLen: 286                                                               
                                       S1|T10 appends logs from S2| logLen:                                       
                                       286[AppendEntry]                                                           
                                                                             S2|T10 replica entries to S0|        
                                                                             entrylen:0| matchidx:285| nextidx:286
                                                                             S2|T10 replica entries to S1|        
                                                                             entrylen:0| matchidx:285| nextidx:286
S0 is disconnected                                                                                                
                                                                             S2|T10 save persist| votedFor: 2|    
                                                                             logsLen: 287                         
                                                                             S2|T10 receive commands | logLen:    
                                                                             287[Start]                           
                                       S1|T10 is not leader                                                       
S0|T10 is not leader                                                                                              
                                       S1|T10 save persist| votedFor: 2|                                          
                                       logsLen: 287                                                               
                                       S1|T10 appends logs from S2| logLen:                                       
                                       287[AppendEntry]                                                           
                                                                             S2|T10 replica entries to S1|        
                                                                             entrylen:1| matchidx:286| nextidx:287
                                                                             S2|T10 update commitIndex as 286     
                                                                             S2|T10 starts to apply entries       
                                                                             [286:286][ApplyEntry]                
                                                                             S2|T10 finishes applying entries     
                                                                             [286:286][ApplyEntry]                
                                       S1|T10 is not leader                                                       
S0|T10 is not leader                                                                                              
                                       S1|T10 save persist| votedFor: 2|                                          
                                       logsLen: 287                                                               
                                       S1|T10 appends logs from S2| logLen:                                       
                                       287[AppendEntry]                                                           
                                       S1|T10 starts to apply entries                                             
                                       [286:286][ApplyEntry]                                                      
                                       S1|T10 finishes applying entries                                           
                                       [286:286][ApplyEntry]                                                      
                                                                             S2|T10 replica entries to S1|        
                                                                             entrylen:0| matchidx:286| nextidx:287
                                                                             S2|T10 save persist| votedFor: 2|    
                                                                             logsLen: 288                         
                                                                             S2|T10 receive commands | logLen:    
                                                                             288[Start]                           
                                                                             S2|T10 save persist| votedFor: 2|    
                                                                             logsLen: 289                         
                                                                             S2|T10 receive commands | logLen:    
                                                                             289[Start]                           
                                                                             S2|T10 save persist| votedFor: 2|    
                                                                             logsLen: 290                         
                                                                             S2|T10 receive commands | logLen:    
                                                                             290[Start]                           
                                                                             S2|T10 save persist| votedFor: 2|    
                                                                             logsLen: 291                         
                                                                             S2|T10 receive commands | logLen:    
                                                                             291[Start]                           
                                                                             S2|T10 save persist| votedFor: 2|    
                                                                             logsLen: 292                         
                                                                             S2|T10 receive commands | logLen:    
                                                                             292[Start]                           
                                                                             S2|T10 save persist| votedFor: 2|    
                                                                             logsLen: 293                         
                                                                             S2|T10 receive commands | logLen:    
                                                                             293[Start]                           
                                                                             S2|T10 save persist| votedFor: 2|    
                                                                             logsLen: 294                         
                                                                             S2|T10 receive commands | logLen:    
                                                                             294[Start]                           
                                                                             S2|T10 save persist| votedFor: 2|    
                                                                             logsLen: 295                         
                                                                             S2|T10 receive commands | logLen:    
                                                                             295[Start]                           
S0|T10 is not leader                                                                                              
                                       S1|T10 is not leader                                                       
                                       S1|T10 save persist| votedFor: 2|                                          
                                       logsLen: 295                                                               
                                       S1|T10 appends logs from S2| logLen:                                       
                                       295[AppendEntry]                                                           
                                                                             S2|T10 replica entries to S1|        
                                                                             entrylen:8| matchidx:294| nextidx:295
                                                                             S2|T10 update commitIndex as 294     
                                                                             S2|T10 starts to apply entries       
                                                                             [287:294][ApplyEntry]                
                                                                             S2|T10 Snapshot until index 289|     
                                                                             logLen: 295                          
                                                                             S2|T10 finishes applying entries     
                                                                             [287:294][ApplyEntry]                
                                       S1|T10 is not leader                                                       
S0|T10 is not leader                                                                                              
                                                                             S2|T10 send rpc to S0|base: 289|     
                                                                             next: 286                            
                                       S1|T10 save persist| votedFor: 2|                                          
                                       logsLen: 295                                                               
                                       S1|T10 appends logs from S2| logLen:                                       
                                       295[AppendEntry]                                                           
                                       S1|T10 starts to apply entries                                             
                                       [287:294][ApplyEntry]                                                      
                                                                             S2|T10 replica entries to S1|        
                                                                             entrylen:0| matchidx:294| nextidx:295
                                       S1|T10 Snapshot until index 289|                                           
                                       logLen: 295                                                                
                                       S1|T10 finishes applying entries                                           
                                       [287:294][ApplyEntry]                                                      
S0 is connected again                                                                                             
                                                                             S2|T10 save persist| votedFor: 2|    
                                                                             logsLen: 296                         
                                                                             S2|T10 receive commands | logLen:    
                                                                             296[Start]                           
                                       S1|T10 is not leader                                                       
S0|T10 is not leader                                                                                              
                                                                             S2|T10 send rpc to S0|base: 289|     
                                                                             next: 286                            
S0|T10 receive rpc from S2                                                                                        
S0|T10 update rfstate| Base:289|                                                                                  
LogLen:290                                                                                                        
                                       S1|T10 save persist| votedFor: 2|                                          
                                       logsLen: 296                                                               
                                       S1|T10 appends logs from S2| logLen:                                       
                                       296[AppendEntry]                                                           
S0|T10 applys snapshot from S2                                                                                    
                                                                             S2|T10 installs snapshot to S0|      
                                                                             nextId:290| matchId:289              
                                                                             S2|T10 replica entries to S1|        
                                                                             entrylen:1| matchidx:295| nextidx:296
                                                                             S2|T10 update commitIndex as 295     
                                                                             S2|T10 starts to apply entries       
                                                                             [295:295][ApplyEntry]                
                                                                             S2|T10 finishes applying entries     
                                                                             [295:295][ApplyEntry]                
                                                                             S2|T10 fails to install snapshot to  
                                                                             S0                                   
                                       S1|T10 is not leader                                                       
S0|T10 is not leader                                                                                              
                                       S1|T10 save persist| votedFor: 2|                                          
                                       logsLen: 296                                                               
                                       S1|T10 appends logs from S2| logLen:                                       
                                       296[AppendEntry]                                                           
S0|T10 save persist| votedFor: 0|                                                                                 
logsLen: 296                                                                                                      
                                       S1|T10 starts to apply entries                                             
                                       [295:295][ApplyEntry]                                                      
S0|T10 appends logs from S2| logLen:                                                                              
296[AppendEntry]                                                                                                  
                                       S1|T10 finishes applying entries                                           
                                       [295:295][ApplyEntry]                                                      
S0|T10 starts to apply entries                                                                                    
[290:295][ApplyEntry]                                                                                             
                                                                             S2|T10 replica entries to S1|        
                                                                             entrylen:0| matchidx:295| nextidx:296
S0|T10 finishes applying entries                                                                                  
[290:295][ApplyEntry]                                                                                             
                                                                             S2|T10 replica entries to S0|        
                                                                             entrylen:6| matchidx:295| nextidx:296
                                       S1|T10 is not leader                                                       
S0|T10 is not leader                                                                                              
                                       S1|T10 save persist| votedFor: 2|                                          
                                       logsLen: 296                                                               
S0|T10 save persist| votedFor: 0|                                                                                 
logsLen: 296                                                                                                      
                                       S1|T10 appends logs from S2| logLen:                                       
                                       296[AppendEntry]                                                           
S0|T10 appends logs from S2| logLen:                                                                              
296[AppendEntry]                                                                                                  
                                                                             S2|T10 replica entries to S1|        
                                                                             entrylen:0| matchidx:295| nextidx:296
                                                                             S2|T10 replica entries to S0|        
                                                                             entrylen:0| matchidx:295| nextidx:296
S0|T10 is not leader                                                                                              
                                       S1|T10 is not leader                                                       
S0|T10 save persist| votedFor: 0|                                                                                 
logsLen: 296                                                                                                      
                                       S1|T10 save persist| votedFor: 2|                                          
                                       logsLen: 296                                                               
S0|T10 appends logs from S2| logLen:                                                                              
296[AppendEntry]                                                                                                  
                                       S1|T10 appends logs from S2| logLen:                                       
                                       296[AppendEntry]                                                           
                                                                             S2|T10 replica entries to S0|        
                                                                             entrylen:0| matchidx:295| nextidx:296
                                                                             S2|T10 replica entries to S1|        
                                                                             entrylen:0| matchidx:295| nextidx:296
S0|T10 is not leader                                                                                              
                                       S1|T10 is not leader                                                       
S0|T10 save persist| votedFor: 0|                                                                                 
logsLen: 296                                                                                                      
S0|T10 appends logs from S2| logLen:                                                                              
296[AppendEntry]                                                                                                  
                                       S1|T10 save persist| votedFor: 2|                                          
                                       logsLen: 296                                                               
                                       S1|T10 appends logs from S2| logLen:                                       
                                       296[AppendEntry]                                                           
                                                                             S2|T10 replica entries to S0|        
                                                                             entrylen:0| matchidx:295| nextidx:296
                                                                             S2|T10 replica entries to S1|        
                                                                             entrylen:0| matchidx:295| nextidx:296
                                       S1|T10 is not leader                                                       
S0|T10 is not leader                                                                                              
S0|T10 save persist| votedFor: 0|                                                                                 
logsLen: 296                                                                                                      
                                       S1|T10 save persist| votedFor: 2|                                          
                                       logsLen: 296                                                               
S0|T10 appends logs from S2| logLen:                                                                              
296[AppendEntry]                                                                                                  
                                       S1|T10 appends logs from S2| logLen:                                       
                                       296[AppendEntry]                                                           
                                                                             S2|T10 replica entries to S0|        
                                                                             entrylen:0| matchidx:295| nextidx:296
                                                                             S2|T10 replica entries to S1|        
                                                                             entrylen:0| matchidx:295| nextidx:296
                                       S1|T10 is not leader                                                       
S0|T10 is not leader                                                                                              
S0|T10 save persist| votedFor: 0|                                                                                 
logsLen: 296                                                                                                      
S0|T10 appends logs from S2| logLen:                                                                              
296[AppendEntry]                                                                                                  
                                       S1|T10 save persist| votedFor: 2|                                          
                                       logsLen: 296                                                               
                                       S1|T10 appends logs from S2| logLen:                                       
                                       296[AppendEntry]                                                           
                                                                             S2|T10 replica entries to S0|        
                                                                             entrylen:0| matchidx:295| nextidx:296
                                                                             S2|T10 replica entries to S1|        
                                                                             entrylen:0| matchidx:295| nextidx:296
                                                                             S2 is disconnected                   
S0|T10 is not leader                                                                                              
                                       S1|T10 is not leader                                                       
                                       S1|T10 is not leader                                                       
S0|T10 is not leader                                                                                              
S0|T10 is not leader                                                                                              
                                       S1|T10 is not leader                                                       
S0|T10 is not leader                                                                                              
                                       S1|T10 is not leader                                                       
S0|T10 is not leader                                                                                              
                                       S1|T10 is not leader                                                       
S0|T10 is not leader                                                                                              
                                       S1|T10 is not leader                                                       
S0|T11 starts to join election                                                                                    
S0|T11 save persist| votedFor: 0|                                                                                 
logsLen: 296                                                                                                      
                                       S1|T11 save persist| votedFor: -1|                                         
                                       logsLen: 296                                                               
                                       S1|T11 save persist| votedFor: 0|                                          
                                       logsLen: 296                                                               
                                       S1|T11 votes for S0[RequestVote]                                           
S0|T11 becomes the leader, and starts                                                                             
heatbeats                                                                                                         
                                       S1|T11 save persist| votedFor: 0|                                          
                                       logsLen: 296                                                               
                                       S1|T11 appends logs from S0| logLen:                                       
                                       296[AppendEntry]                                                           
S0|T11 replica entries to S1|                                                                                     
entrylen:0| matchidx:295| nextidx:296                                                                             
S0|T11 save persist| votedFor: 0|                                                                                 
logsLen: 297                                                                                                      
S0|T11 receive commands | logLen:                                                                                 
297[Start]                                                                                                        
                                       S1|T11 is not leader                                                       
                                       S1|T11 save persist| votedFor: 0|                                          
                                       logsLen: 297                                                               
                                       S1|T11 appends logs from S0| logLen:                                       
                                       297[AppendEntry]                                                           
S0|T11 replica entries to S1|                                                                                     
entrylen:1| matchidx:296| nextidx:297                                                                             
S0|T11 update commitIndex as 296                                                                                  
S0|T11 starts to apply entries                                                                                    
[296:296][ApplyEntry]                                                                                             
S0|T11 finishes applying entries                                                                                  
[296:296][ApplyEntry]                                                                                             
                                       S1|T11 is not leader                                                       
                                       S1|T11 save persist| votedFor: 0|                                          
                                       logsLen: 297                                                               
                                       S1|T11 appends logs from S0| logLen:                                       
                                       297[AppendEntry]                                                           
                                       S1|T11 starts to apply entries                                             
                                       [296:296][ApplyEntry]                                                      
                                       S1|T11 finishes applying entries                                           
                                       [296:296][ApplyEntry]                                                      
S0|T11 replica entries to S1|                                                                                     
entrylen:0| matchidx:296| nextidx:297                                                                             
S0|T11 save persist| votedFor: 0|                                                                                 
logsLen: 298                                                                                                      
S0|T11 receive commands | logLen:                                                                                 
298[Start]                                                                                                        
S0|T11 save persist| votedFor: 0|                                                                                 
logsLen: 299                                                                                                      
S0|T11 receive commands | logLen:                                                                                 
299[Start]                                                                                                        
S0|T11 save persist| votedFor: 0|                                                                                 
logsLen: 300                                                                                                      
S0|T11 receive commands | logLen:                                                                                 
300[Start]                                                                                                        
S0|T11 save persist| votedFor: 0|                                                                                 
logsLen: 301                                                                                                      
S0|T11 receive commands | logLen:                                                                                 
301[Start]                                                                                                        
S0|T11 save persist| votedFor: 0|                                                                                 
logsLen: 302                                                                                                      
S0|T11 receive commands | logLen:                                                                                 
302[Start]                                                                                                        
S0|T11 save persist| votedFor: 0|                                                                                 
logsLen: 303                                                                                                      
S0|T11 receive commands | logLen:                                                                                 
303[Start]                                                                                                        
S0|T11 save persist| votedFor: 0|                                                                                 
logsLen: 304                                                                                                      
S0|T11 receive commands | logLen:                                                                                 
304[Start]                                                                                                        
S0|T11 save persist| votedFor: 0|                                                                                 
logsLen: 305                                                                                                      
S0|T11 receive commands | logLen:                                                                                 
305[Start]                                                                                                        
S0|T11 save persist| votedFor: 0|                                                                                 
logsLen: 306                                                                                                      
S0|T11 receive commands | logLen:                                                                                 
306[Start]                                                                                                        
S0|T11 save persist| votedFor: 0|                                                                                 
logsLen: 307                                                                                                      
S0|T11 receive commands | logLen:                                                                                 
307[Start]                                                                                                        
                                       S1|T11 is not leader                                                       
                                       S1|T11 save persist| votedFor: 0|                                          
                                       logsLen: 307                                                               
                                       S1|T11 appends logs from S0| logLen:                                       
                                       307[AppendEntry]                                                           
S0|T11 replica entries to S1|                                                                                     
entrylen:10| matchidx:306| nextidx:307                                                                            
S0|T11 update commitIndex as 306                                                                                  
S0|T11 starts to apply entries                                                                                    
[297:306][ApplyEntry]                                                                                             
S0|T11 Snapshot until index 299|                                                                                  
logLen: 307                                                                                                       
S0|T11 finishes applying entries                                                                                  
[297:306][ApplyEntry]                                                                                             
S0|T11 send rpc to S2|base: 299| next:                                                                            
296                                                                                                               
                                       S1|T11 is not leader                                                       
                                       S1|T11 save persist| votedFor: 0|                                          
                                       logsLen: 307                                                               
                                       S1|T11 appends logs from S0| logLen:                                       
                                       307[AppendEntry]                                                           
                                       S1|T11 starts to apply entries                                             
                                       [297:306][ApplyEntry]                                                      
S0|T11 replica entries to S1|                                                                                     
entrylen:0| matchidx:306| nextidx:307                                                                             
                                       S1|T11 Snapshot until index 299|                                           
                                       logLen: 307                                                                
                                       S1|T11 finishes applying entries                                           
                                       [297:306][ApplyEntry]                                                      
                                                                             S2 is connected again                
                                                                             S2|T10 save persist| votedFor: 2|    
                                                                             logsLen: 297                         
                                                                             S2|T10 receive commands | logLen:    
                                                                             297[Start]                           
                                       S1|T11 is not leader                                                       
S0|T11 send rpc to S2|base: 299| next:                                                                            
296                                                                                                               
S0|T11 rejects to append entries from                                                                             
S2 | out of date term[AppendEntry]                                                                                
                                       S1|T11 rejects to append entries from                                      
                                       S2 | out of date term[AppendEntry]                                         
                                                                             S2|T10 receive rpc from S0           
                                       S1|T11 save persist| votedFor: 0|                                          
                                       logsLen: 307                                                               
                                                                             S2|T11 save persist| votedFor: 2|    
                                                                             logsLen: 297                         
                                       S1|T11 appends logs from S0| logLen:                                       
                                       307[AppendEntry]                                                           
                                                                             S2|T11 update rfstate| Base:299|     
                                                                             LogLen:300                           
                                                                             S2|T11 lost leadership, state: 0     
                                                                             S2|T11 lost leadership, state: 0     
S0|T11 replica entries to S1|                                                                                     
entrylen:0| matchidx:306| nextidx:307                                                                             
                                                                             S2|T11 applys snapshot from S0       
S0|T11 installs snapshot to S2|                                                                                   
nextId:300| matchId:299                                                                                           
                                       S1|T11 is not leader                                                       
                                                                             S2|T11 is not leader                 
                                       S1|T11 save persist| votedFor: 0|                                          
                                       logsLen: 307                                                               
                                       S1|T11 appends logs from S0| logLen:                                       
                                       307[AppendEntry]                                                           
                                                                             S2|T11 save persist| votedFor: 2|    
                                                                             logsLen: 307                         
                                                                             S2|T11 appends logs from S0| logLen: 
                                                                             307[AppendEntry]                     
                                                                             S2|T11 starts to apply entries       
                                                                             [300:306][ApplyEntry]                
S0|T11 replica entries to S1|                                                                                     
entrylen:0| matchidx:306| nextidx:307                                                                             
                                                                             S2|T11 finishes applying entries     
                                                                             [300:306][ApplyEntry]                
S0|T11 replica entries to S2|                                                                                     
entrylen:7| matchidx:306| nextidx:307                                                                             
                                       S1|T11 is not leader                                                       
                                                                             S2|T11 is not leader                 
                                       S1|T11 save persist| votedFor: 0|                                          
                                       logsLen: 307                                                               
                                                                             S2|T11 save persist| votedFor: 2|    
                                                                             logsLen: 307                         
                                                                             S2|T11 appends logs from S0| logLen: 
                                                                             307[AppendEntry]                     
                                       S1|T11 appends logs from S0| logLen:                                       
                                       307[AppendEntry]                                                           
S0|T11 replica entries to S2|                                                                                     
entrylen:0| matchidx:306| nextidx:307                                                                             
S0|T11 replica entries to S1|                                                                                     
entrylen:0| matchidx:306| nextidx:307                                                                             
                                       S1|T11 is not leader                                                       
                                                                             S2|T11 is not leader                 
                                                                             S2|T11 save persist| votedFor: 2|    
                                                                             logsLen: 307                         
                                       S1|T11 save persist| votedFor: 0|                                          
                                       logsLen: 307                                                               
                                                                             S2|T11 appends logs from S0| logLen: 
                                                                             307[AppendEntry]                     
                                       S1|T11 appends logs from S0| logLen:                                       
                                       307[AppendEntry]                                                           
S0|T11 replica entries to S2|                                                                                     
entrylen:0| matchidx:306| nextidx:307                                                                             
S0|T11 replica entries to S1|                                                                                     
entrylen:0| matchidx:306| nextidx:307                                                                             
                                       S1|T11 is not leader                                                       
                                                                             S2|T11 is not leader                 
                                       S1|T11 save persist| votedFor: 0|                                          
                                       logsLen: 307                                                               
                                       S1|T11 appends logs from S0| logLen:                                       
                                       307[AppendEntry]                                                           
                                                                             S2|T11 save persist| votedFor: 2|    
                                                                             logsLen: 307                         
                                                                             S2|T11 appends logs from S0| logLen: 
                                                                             307[AppendEntry]                     
S0|T11 replica entries to S1|                                                                                     
entrylen:0| matchidx:306| nextidx:307                                                                             
S0|T11 replica entries to S2|                                                                                     
entrylen:0| matchidx:306| nextidx:307                                                                             
                                                                             S2|T11 is not leader                 
                                       S1|T11 is not leader                                                       
                                       S1|T11 save persist| votedFor: 0|                                          
                                       logsLen: 307                                                               
                                                                             S2|T11 save persist| votedFor: 2|    
                                                                             logsLen: 307                         
                                                                             S2|T11 appends logs from S0| logLen: 
                                                                             307[AppendEntry]                     
                                       S1|T11 appends logs from S0| logLen:                                       
                                       307[AppendEntry]                                                           
S0|T11 replica entries to S2|                                                                                     
entrylen:0| matchidx:306| nextidx:307                                                                             
S0|T11 replica entries to S1|                                                                                     
entrylen:0| matchidx:306| nextidx:307                                                                             
                                       S1|T11 is not leader                                                       
                                                                             S2|T11 is not leader                 
                                       S1|T11 save persist| votedFor: 0|                                          
                                       logsLen: 307                                                               
                                                                             S2|T11 save persist| votedFor: 2|    
                                                                             logsLen: 307                         
                                                                             S2|T11 appends logs from S0| logLen: 
                                                                             307[AppendEntry]                     
                                       S1|T11 appends logs from S0| logLen:                                       
                                       307[AppendEntry]                                                           
S0|T11 replica entries to S2|                                                                                     
entrylen:0| matchidx:306| nextidx:307                                                                             
S0|T11 replica entries to S1|                                                                                     
entrylen:0| matchidx:306| nextidx:307                                                                             
                                                                             S2|T11 is not leader                 
                                       S1|T11 is not leader                                                       
                                       S1|T11 save persist| votedFor: 0|                                          
                                       logsLen: 307                                                               
                                       S1|T11 appends logs from S0| logLen:                                       
                                       307[AppendEntry]                                                           
                                                                             S2|T11 save persist| votedFor: 2|    
                                                                             logsLen: 307                         
                                                                             S2|T11 appends logs from S0| logLen: 
                                                                             307[AppendEntry]                     
S0|T11 replica entries to S1|                                                                                     
entrylen:0| matchidx:306| nextidx:307                                                                             
S0|T11 replica entries to S2|                                                                                     
entrylen:0| matchidx:306| nextidx:307                                                                             
                                                                             S2|T11 is not leader                 
                                       S1|T11 is not leader                                                       
                                                                             S2|T11 save persist| votedFor: 2|    
                                                                             logsLen: 307                         
                                                                             S2|T11 appends logs from S0| logLen: 
                                                                             307[AppendEntry]                     
                                       S1|T11 save persist| votedFor: 0|                                          
                                       logsLen: 307                                                               
                                       S1|T11 appends logs from S0| logLen:                                       
                                       307[AppendEntry]                                                           
S0|T11 replica entries to S2|                                                                                     
entrylen:0| matchidx:306| nextidx:307                                                                             
S0|T11 replica entries to S1|                                                                                     
entrylen:0| matchidx:306| nextidx:307                                                                             
                                                                             S2|T11 fails to install snapshot to  
                                                                             S0                                   
                                                                             S2|T11 is not leader                 
                                       S1|T11 is not leader                                                       
                                                                             S2|T11 save persist| votedFor: 2|    
                                                                             logsLen: 307                         
                                                                             S2|T11 appends logs from S0| logLen: 
                                                                             307[AppendEntry]                     
                                       S1|T11 save persist| votedFor: 0|                                          
                                       logsLen: 307                                                               
                                       S1|T11 appends logs from S0| logLen:                                       
                                       307[AppendEntry]                                                           
S0|T11 replica entries to S2|                                                                                     
entrylen:0| matchidx:306| nextidx:307                                                                             
S0|T11 replica entries to S1|                                                                                     
entrylen:0| matchidx:306| nextidx:307                                                                             
                                                                             S2|T11 is not leader                 
                                       S1|T11 is not leader                                                       
                                       S1|T11 save persist| votedFor: 0|                                          
                                       logsLen: 307                                                               
                                       S1|T11 appends logs from S0| logLen:                                       
                                       307[AppendEntry]                                                           
                                                                             S2|T11 save persist| votedFor: 2|    
                                                                             logsLen: 307                         
                                                                             S2|T11 appends logs from S0| logLen: 
                                                                             307[AppendEntry]                     
S0|T11 replica entries to S1|                                                                                     
entrylen:0| matchidx:306| nextidx:307                                                                             
S0|T11 replica entries to S2|                                                                                     
entrylen:0| matchidx:306| nextidx:307                                                                             
                                       S1|T11 is not leader                                                       
                                                                             S2|T11 is not leader                 
                                       S1|T11 save persist| votedFor: 0|                                          
                                       logsLen: 307                                                               
                                       S1|T11 appends logs from S0| logLen:                                       
                                       307[AppendEntry]                                                           
                                                                             S2|T11 save persist| votedFor: 2|    
                                                                             logsLen: 307                         
                                                                             S2|T11 appends logs from S0| logLen: 
                                                                             307[AppendEntry]                     
S0|T11 replica entries to S1|                                                                                     
entrylen:0| matchidx:306| nextidx:307                                                                             
S0|T11 replica entries to S2|                                                                                     
entrylen:0| matchidx:306| nextidx:307                                                                             
                                       S1|T11 is not leader                                                       
                                                                             S2|T11 is not leader                 
                                                                             S2|T11 save persist| votedFor: 2|    
                                                                             logsLen: 307                         
                                       S1|T11 save persist| votedFor: 0|                                          
                                       logsLen: 307                                                               
                                                                             S2|T11 appends logs from S0| logLen: 
                                                                             307[AppendEntry]                     
                                       S1|T11 appends logs from S0| logLen:                                       
                                       307[AppendEntry]                                                           
S0|T11 replica entries to S2|                                                                                     
entrylen:0| matchidx:306| nextidx:307                                                                             
S0|T11 replica entries to S1|                                                                                     
entrylen:0| matchidx:306| nextidx:307                                                                             
                                                                             S2|T11 is not leader                 
                                       S1|T11 is not leader                                                       
                                       S1|T11 save persist| votedFor: 0|                                          
                                       logsLen: 307                                                               
                                       S1|T11 appends logs from S0| logLen:                                       
                                       307[AppendEntry]                                                           
                                                                             S2|T11 save persist| votedFor: 2|    
                                                                             logsLen: 307                         
                                                                             S2|T11 appends logs from S0| logLen: 
                                                                             307[AppendEntry]                     
S0|T11 replica entries to S1|                                                                                     
entrylen:0| matchidx:306| nextidx:307                                                                             
S0|T11 replica entries to S2|                                                                                     
entrylen:0| matchidx:306| nextidx:307                                                                             
                                                                             S2|T11 is not leader                 
                                       S1|T11 is not leader                                                       
                                       S1|T11 save persist| votedFor: 0|                                          
                                       logsLen: 307                                                               
                                                                             S2|T11 save persist| votedFor: 2|    
                                                                             logsLen: 307                         
                                       S1|T11 appends logs from S0| logLen:                                       
                                       307[AppendEntry]                                                           
                                                                             S2|T11 appends logs from S0| logLen: 
                                                                             307[AppendEntry]                     
S0|T11 replica entries to S1|                                                                                     
entrylen:0| matchidx:306| nextidx:307                                                                             
S0|T11 replica entries to S2|                                                                                     
entrylen:0| matchidx:306| nextidx:307                                                                             
S0|T11 fails to install snapshot to S2                                                                            
                                                                             S2|T11 is not leader                 
                                       S1|T11 is not leader                                                       
                                       S1|T11 save persist| votedFor: 0|                                          
                                       logsLen: 307                                                               
                                       S1|T11 appends logs from S0| logLen:                                       
                                       307[AppendEntry]                                                           
                                                                             S2|T11 save persist| votedFor: 2|    
                                                                             logsLen: 307                         
                                                                             S2|T11 appends logs from S0| logLen: 
                                                                             307[AppendEntry]                     
S0|T11 replica entries to S1|                                                                                     
entrylen:0| matchidx:306| nextidx:307                                                                             
S0|T11 replica entries to S2|                                                                                     
entrylen:0| matchidx:306| nextidx:307                                                                             
                                       S1|T11 is not leader                                                       
                                                                             S2|T11 is not leader                 
                                                                             S2|T11 save persist| votedFor: 2|    
                                                                             logsLen: 307                         
                                       S1|T11 save persist| votedFor: 0|                                          
                                       logsLen: 307                                                               
                                                                             S2|T11 appends logs from S0| logLen: 
                                                                             307[AppendEntry]                     
                                       S1|T11 appends logs from S0| logLen:                                       
                                       307[AppendEntry]                                                           
S0|T11 replica entries to S2|                                                                                     
entrylen:0| matchidx:306| nextidx:307                                                                             
S0|T11 replica entries to S1|                                                                                     
entrylen:0| matchidx:306| nextidx:307                                                                             
                                                                             S2|T11 is not leader                 
                                       S1|T11 is not leader                                                       
                                                                             S2|T11 save persist| votedFor: 2|    
                                                                             logsLen: 307                         
                                       S1|T11 save persist| votedFor: 0|                                          
                                       logsLen: 307                                                               
                                       S1|T11 appends logs from S0| logLen:                                       
                                       307[AppendEntry]                                                           
                                                                             S2|T11 appends logs from S0| logLen: 
                                                                             307[AppendEntry]                     
S0|T11 replica entries to S1|                                                                                     
entrylen:0| matchidx:306| nextidx:307                                                                             
S0|T11 replica entries to S2|                                                                                     
entrylen:0| matchidx:306| nextidx:307                                                                             
                                       S1|T11 is not leader                                                       
                                                                             S2|T11 is not leader                 
                                                                             S2|T11 save persist| votedFor: 2|    
                                                                             logsLen: 307                         
                                                                             S2|T11 appends logs from S0| logLen: 
                                                                             307[AppendEntry]                     
                                       S1|T11 save persist| votedFor: 0|                                          
                                       logsLen: 307                                                               
                                       S1|T11 appends logs from S0| logLen:                                       
                                       307[AppendEntry]                                                           
S0|T11 replica entries to S2|                                                                                     
entrylen:0| matchidx:306| nextidx:307                                                                             
S0|T11 replica entries to S1|                                                                                     
entrylen:0| matchidx:306| nextidx:307                                                                             
                                                                             S2|T11 is not leader                 
                                       S1|T11 is not leader                                                       
                                                                             S2|T11 save persist| votedFor: 2|    
                                                                             logsLen: 307                         
                                       S1|T11 save persist| votedFor: 0|                                          
                                       logsLen: 307                                                               
                                       S1|T11 appends logs from S0| logLen:                                       
                                       307[AppendEntry]                                                           
                                                                             S2|T11 appends logs from S0| logLen: 
                                                                             307[AppendEntry]                     
S0|T11 replica entries to S1|                                                                                     
entrylen:0| matchidx:306| nextidx:307                                                                             
S0|T11 replica entries to S2|                                                                                     
entrylen:0| matchidx:306| nextidx:307                                                                             
S0|T11 save persist| votedFor: 0|                                                                                 
logsLen: 308                                                                                                      
S0|T11 receive commands | logLen:                                                                                 
308[Start]                                                                                                        
                                                                             S2|T11 is not leader                 
                                       S1|T11 is not leader                                                       
                                       S1|T11 save persist| votedFor: 0|                                          
                                       logsLen: 308                                                               
                                       S1|T11 appends logs from S0| logLen:                                       
                                       308[AppendEntry]                                                           
                                                                             S2|T11 save persist| votedFor: 2|    
                                                                             logsLen: 308                         
                                                                             S2|T11 appends logs from S0| logLen: 
                                                                             308[AppendEntry]                     
S0|T11 replica entries to S1|                                                                                     
entrylen:1| matchidx:307| nextidx:308                                                                             
S0|T11 update commitIndex as 307                                                                                  
S0|T11 replica entries to S2|                                                                                     
entrylen:1| matchidx:307| nextidx:308                                                                             
S0|T11 starts to apply entries                                                                                    
[307:307][ApplyEntry]                                                                                             
S0|T11 finishes applying entries                                                                                  
[307:307][ApplyEntry]                                                                                             
                                                                             S2|T11 is not leader                 
                                       S1|T11 is not leader                                                       
                                       S1|T11 save persist| votedFor: 0|                                          
                                       logsLen: 308                                                               
                                                                             S2|T11 save persist| votedFor: 2|    
                                                                             logsLen: 308                         
                                       S1|T11 appends logs from S0| logLen:                                       
                                       308[AppendEntry]                                                           
                                                                             S2|T11 appends logs from S0| logLen: 
                                                                             308[AppendEntry]                     
                                       S1|T11 starts to apply entries                                             
                                       [307:307][ApplyEntry]                                                      
                                                                             S2|T11 starts to apply entries       
                                                                             [307:307][ApplyEntry]                
                                                                             S2|T11 finishes applying entries     
                                                                             [307:307][ApplyEntry]                
                                       S1|T11 finishes applying entries                                           
                                       [307:307][ApplyEntry]                                                      
S0|T11 replica entries to S1|                                                                                     
entrylen:0| matchidx:307| nextidx:308                                                                             
S0|T11 replica entries to S2|                                                                                     
entrylen:0| matchidx:307| nextidx:308                                                                             
                                                                             S2|T11 is not leader                 
                                       S1|T11 is not leader                                                       
                                       S1|T11 save persist| votedFor: 0|                                          
                                       logsLen: 308                                                               
                                       S1|T11 appends logs from S0| logLen:                                       
                                       308[AppendEntry]                                                           
                                                                             S2|T11 save persist| votedFor: 2|    
                                                                             logsLen: 308                         
                                                                             S2|T11 appends logs from S0| logLen: 
                                                                             308[AppendEntry]                     
S0|T11 replica entries to S1|                                                                                     
entrylen:0| matchidx:307| nextidx:308                                                                             
S0|T11 replica entries to S2|                                                                                     
entrylen:0| matchidx:307| nextidx:308                                                                             
                                                                             S2|T11 is not leader                 
                                       S1|T11 is not leader                                                       
                                       S1|T11 save persist| votedFor: 0|                                          
                                       logsLen: 308                                                               
                                                                             S2|T11 save persist| votedFor: 2|    
                                                                             logsLen: 308                         
                                       S1|T11 appends logs from S0| logLen:                                       
                                       308[AppendEntry]                                                           
                                                                             S2|T11 appends logs from S0| logLen: 
                                                                             308[AppendEntry]                     
S0|T11 replica entries to S1|                                                                                     
entrylen:0| matchidx:307| nextidx:308                                                                             
S0|T11 replica entries to S2|                                                                                     
entrylen:0| matchidx:307| nextidx:308                                                                             
                                                                             S2|T11 is not leader                 
                                       S1|T11 is not leader                                                       
                                                                             S2|T11 save persist| votedFor: 2|    
                                                                             logsLen: 308                         
                                       S1|T11 save persist| votedFor: 0|                                          
                                       logsLen: 308                                                               
                                       S1|T11 appends logs from S0| logLen:                                       
                                       308[AppendEntry]                                                           
                                                                             S2|T11 appends logs from S0| logLen: 
                                                                             308[AppendEntry]                     
S0|T11 replica entries to S1|                                                                                     
entrylen:0| matchidx:307| nextidx:308                                                                             
S0|T11 replica entries to S2|                                                                                     
entrylen:0| matchidx:307| nextidx:308                                                                             
                                       S1|T11 is not leader                                                       
                                                                             S2|T11 is not leader                 
                                                                             S2|T11 save persist| votedFor: 2|    
                                                                             logsLen: 308                         
                                       S1|T11 save persist| votedFor: 0|                                          
                                       logsLen: 308                                                               
                                                                             S2|T11 appends logs from S0| logLen: 
                                                                             308[AppendEntry]                     
                                       S1|T11 appends logs from S0| logLen:                                       
                                       308[AppendEntry]                                                           
S0|T11 replica entries to S2|                                                                                     
entrylen:0| matchidx:307| nextidx:308                                                                             
S0|T11 replica entries to S1|                                                                                     
entrylen:0| matchidx:307| nextidx:308                                                                             
                                       S1 is disconnected                                                         
S0|T11 save persist| votedFor: 0|                                                                                 
logsLen: 309                                                                                                      
S0|T11 receive commands | logLen:                                                                                 
309[Start]                                                                                                        
                                                                             S2|T11 is not leader                 
                                       S1|T11 is not leader                                                       
                                                                             S2|T11 save persist| votedFor: 2|    
                                                                             logsLen: 309                         
                                                                             S2|T11 appends logs from S0| logLen: 
                                                                             309[AppendEntry]                     
S0|T11 replica entries to S2|                                                                                     
entrylen:1| matchidx:308| nextidx:309                                                                             
S0|T11 update commitIndex as 308                                                                                  
S0|T11 starts to apply entries                                                                                    
[308:308][ApplyEntry]                                                                                             
S0|T11 finishes applying entries                                                                                  
[308:308][ApplyEntry]                                                                                             
                                                                             S2|T11 fails to install snapshot to  
                                                                             S0                                   
                                                                             S2|T11 is not leader                 
                                       S1|T11 is not leader                                                       
                                                                             S2|T11 save persist| votedFor: 2|    
                                                                             logsLen: 309                         
                                                                             S2|T11 appends logs from S0| logLen: 
                                                                             309[AppendEntry]                     
                                                                             S2|T11 starts to apply entries       
                                                                             [308:308][ApplyEntry]                
                                                                             S2|T11 finishes applying entries     
                                                                             [308:308][ApplyEntry]                
S0|T11 replica entries to S2|                                                                                     
entrylen:0| matchidx:308| nextidx:309                                                                             
S0|T11 save persist| votedFor: 0|                                                                                 
logsLen: 310                                                                                                      
S0|T11 receive commands | logLen:                                                                                 
310[Start]                                                                                                        
S0|T11 save persist| votedFor: 0|                                                                                 
logsLen: 311                                                                                                      
S0|T11 receive commands | logLen:                                                                                 
311[Start]                                                                                                        
S0|T11 save persist| votedFor: 0|                                                                                 
logsLen: 312                                                                                                      
S0|T11 receive commands | logLen:                                                                                 
312[Start]                                                                                                        
S0|T11 save persist| votedFor: 0|                                                                                 
logsLen: 313                                                                                                      
S0|T11 receive commands | logLen:                                                                                 
313[Start]                                                                                                        
S0|T11 save persist| votedFor: 0|                                                                                 
logsLen: 314                                                                                                      
S0|T11 receive commands | logLen:                                                                                 
314[Start]                                                                                                        
S0|T11 save persist| votedFor: 0|                                                                                 
logsLen: 315                                                                                                      
S0|T11 receive commands | logLen:                                                                                 
315[Start]                                                                                                        
S0|T11 save persist| votedFor: 0|                                                                                 
logsLen: 316                                                                                                      
S0|T11 receive commands | logLen:                                                                                 
316[Start]                                                                                                        
S0|T11 save persist| votedFor: 0|                                                                                 
logsLen: 317                                                                                                      
S0|T11 receive commands | logLen:                                                                                 
317[Start]                                                                                                        
S0|T11 save persist| votedFor: 0|                                                                                 
logsLen: 318                                                                                                      
S0|T11 receive commands | logLen:                                                                                 
318[Start]                                                                                                        
S0|T11 save persist| votedFor: 0|                                                                                 
logsLen: 319                                                                                                      
S0|T11 receive commands | logLen:                                                                                 
319[Start]                                                                                                        
S0|T11 save persist| votedFor: 0|                                                                                 
logsLen: 320                                                                                                      
S0|T11 receive commands | logLen:                                                                                 
320[Start]                                                                                                        
S0|T11 save persist| votedFor: 0|                                                                                 
logsLen: 321                                                                                                      
S0|T11 receive commands | logLen:                                                                                 
321[Start]                                                                                                        
                                       S1|T11 is not leader                                                       
                                                                             S2|T11 is not leader                 
                                                                             S2|T11 save persist| votedFor: 2|    
                                                                             logsLen: 321                         
                                                                             S2|T11 appends logs from S0| logLen: 
                                                                             321[AppendEntry]                     
S0|T11 replica entries to S2|                                                                                     
entrylen:12| matchidx:320| nextidx:321                                                                            
S0|T11 update commitIndex as 320                                                                                  
S0|T11 starts to apply entries                                                                                    
[309:320][ApplyEntry]                                                                                             
S0|T11 Snapshot until index 309|                                                                                  
logLen: 321                                                                                                       
S0|T11 Snapshot until index 319|                                                                                  
logLen: 321                                                                                                       
S0|T11 finishes applying entries                                                                                  
[309:320][ApplyEntry]                                                                                             
                                                                             S2|T11 is not leader                 
S0|T11 send rpc to S1|base: 319| next:                                                                            
308                                                                                                               
                                       S1|T11 is not leader                                                       
                                                                             S2|T11 save persist| votedFor: 2|    
                                                                             logsLen: 321                         
                                                                             S2|T11 appends logs from S0| logLen: 
                                                                             321[AppendEntry]                     
                                                                             S2|T11 starts to apply entries       
                                                                             [309:320][ApplyEntry]                
S0|T11 replica entries to S2|                                                                                     
entrylen:0| matchidx:320| nextidx:321                                                                             
                                                                             S2|T11 Snapshot until index 309|     
                                                                             logLen: 321                          
                                                                             S2|T11 Snapshot until index 319|     
                                                                             logLen: 321                          
                                                                             S2|T11 finishes applying entries     
                                                                             [309:320][ApplyEntry]                
                                       S1 is connected again                                                      
S0|T11 save persist| votedFor: 0|                                                                                 
logsLen: 322                                                                                                      
S0|T11 receive commands | logLen:                                                                                 
322[Start]                                                                                                        
                                       S1|T11 is not leader                                                       
                                                                             S2|T11 is not leader                 
S0|T11 send rpc to S1|base: 319| next:                                                                            
308                                                                                                               
                                       S1|T11 receive rpc from S0                                                 
                                       S1|T11 update rfstate| Base:319|                                           
                                       LogLen:320                                                                 
                                                                             S2|T11 save persist| votedFor: 2|    
                                                                             logsLen: 322                         
                                       S1|T11 applys snapshot from S0                                             
                                                                             S2|T11 appends logs from S0| logLen: 
                                                                             322[AppendEntry]                     
S0|T11 installs snapshot to S1|                                                                                   
nextId:320| matchId:319                                                                                           
S0|T11 replica entries to S2|                                                                                     
entrylen:1| matchidx:321| nextidx:322                                                                             
S0|T11 update commitIndex as 321                                                                                  
S0|T11 starts to apply entries                                                                                    
[321:321][ApplyEntry]                                                                                             
S0|T11 finishes applying entries                                                                                  
[321:321][ApplyEntry]                                                                                             
                                                                             S2|T11 is not leader                 
                                       S1|T11 is not leader                                                       
                                                                             S2|T11 save persist| votedFor: 2|    
                                                                             logsLen: 322                         
                                       S1|T11 save persist| votedFor: 0|                                          
                                       logsLen: 322                                                               
                                       S1|T11 appends logs from S0| logLen:                                       
                                       322[AppendEntry]                                                           
                                                                             S2|T11 appends logs from S0| logLen: 
                                                                             322[AppendEntry]                     
                                       S1|T11 starts to apply entries                                             
                                       [320:321][ApplyEntry]                                                      
                                                                             S2|T11 starts to apply entries       
                                                                             [321:321][ApplyEntry]                
                                       S1|T11 finishes applying entries                                           
                                       [320:321][ApplyEntry]                                                      
                                                                             S2|T11 finishes applying entries     
                                                                             [321:321][ApplyEntry]                
S0|T11 replica entries to S2|                                                                                     
entrylen:0| matchidx:321| nextidx:322                                                                             
S0|T11 replica entries to S1|                                                                                     
entrylen:2| matchidx:321| nextidx:322                                                                             
                                                                             S2|T11 is not leader                 
                                       S1|T11 is not leader                                                       
                                       S1|T11 save persist| votedFor: 0|                                          
                                       logsLen: 322                                                               
                                                                             S2|T11 save persist| votedFor: 2|    
                                                                             logsLen: 322                         
                                       S1|T11 appends logs from S0| logLen:                                       
                                       322[AppendEntry]                                                           
                                                                             S2|T11 appends logs from S0| logLen: 
                                                                             322[AppendEntry]                     
S0|T11 replica entries to S1|                                                                                     
entrylen:0| matchidx:321| nextidx:322                                                                             
S0|T11 replica entries to S2|                                                                                     
entrylen:0| matchidx:321| nextidx:322                                                                             
                                       S1|T11 is not leader                                                       
                                                                             S2|T11 is not leader                 
                                                                             S2|T11 save persist| votedFor: 2|    
                                                                             logsLen: 322                         
                                       S1|T11 save persist| votedFor: 0|                                          
                                       logsLen: 322                                                               
                                                                             S2|T11 appends logs from S0| logLen: 
                                                                             322[AppendEntry]                     
                                       S1|T11 appends logs from S0| logLen:                                       
                                       322[AppendEntry]                                                           
S0|T11 replica entries to S2|                                                                                     
entrylen:0| matchidx:321| nextidx:322                                                                             
S0|T11 replica entries to S1|                                                                                     
entrylen:0| matchidx:321| nextidx:322                                                                             
                                       S1|T11 is not leader                                                       
                                                                             S2|T11 is not leader                 
                                       S1|T11 save persist| votedFor: 0|                                          
                                       logsLen: 322                                                               
                                                                             S2|T11 save persist| votedFor: 2|    
                                                                             logsLen: 322                         
                                       S1|T11 appends logs from S0| logLen:                                       
                                       322[AppendEntry]                                                           
                                                                             S2|T11 appends logs from S0| logLen: 
                                                                             322[AppendEntry]                     
S0|T11 replica entries to S1|                                                                                     
entrylen:0| matchidx:321| nextidx:322                                                                             
S0|T11 replica entries to S2|                                                                                     
entrylen:0| matchidx:321| nextidx:322                                                                             
                                       S1|T11 is not leader                                                       
                                                                             S2|T11 is not leader                 
                                       S1|T11 save persist| votedFor: 0|                                          
                                       logsLen: 322                                                               
                                                                             S2|T11 save persist| votedFor: 2|    
                                                                             logsLen: 322                         
                                                                             S2|T11 appends logs from S0| logLen: 
                                                                             322[AppendEntry]                     
                                       S1|T11 appends logs from S0| logLen:                                       
                                       322[AppendEntry]                                                           
S0|T11 replica entries to S1|                                                                                     
entrylen:0| matchidx:321| nextidx:322                                                                             
S0|T11 replica entries to S2|                                                                                     
entrylen:0| matchidx:321| nextidx:322                                                                             
                                       S1|T11 is not leader                                                       
                                                                             S2|T11 is not leader                 
                                       S1|T11 save persist| votedFor: 0|                                          
                                       logsLen: 322                                                               
                                       S1|T11 appends logs from S0| logLen:                                       
                                       322[AppendEntry]                                                           
                                                                             S2|T11 save persist| votedFor: 2|    
                                                                             logsLen: 322                         
                                                                             S2|T11 appends logs from S0| logLen: 
                                                                             322[AppendEntry]                     
S0|T11 replica entries to S1|                                                                                     
entrylen:0| matchidx:321| nextidx:322                                                                             
S0|T11 replica entries to S2|                                                                                     
entrylen:0| matchidx:321| nextidx:322                                                                             
S0|T0 is made                                                                                                     
                                       S1|T0 is made                                                              
                                                                             S2|T0 is made                        
                                                                             S2|T11 is not leader                 
                                       S1|T11 is not leader                                                       
S0|T0 is not leader                                                                                               
                                       S1|T0 is not leader                                                        
                                                                             S2|T0 is not leader                  
                                       S1|T0 is not leader                                                        
                                                                             S2|T0 is not leader                  
S0|T0 is not leader                                                                                               
                                                                             S2|T0 is not leader                  
S0|T0 is not leader                                                                                               
                                       S1|T0 is not leader                                                        
                                                                             S2|T0 is not leader                  
S0|T0 is not leader                                                                                               
                                       S1|T0 is not leader                                                        
                                                                             S2|T0 is not leader                  
S0|T0 is not leader                                                                                               
                                       S1|T0 is not leader                                                        
S0|T1 starts to join election                                                                                     
S0|T1 save persist| votedFor: 0|                                                                                  
logsLen: 1                                                                                                        
                                       S1|T1 save persist| votedFor: -1|                                          
                                       logsLen: 1                                                                 
                                       S1|T1 save persist| votedFor: 0|                                           
                                       logsLen: 1                                                                 
                                       S1|T1 votes for S0[RequestVote]                                            
S0|T1 becomes the leader, and starts                                                                              
heatbeats                                                                                                         
                                       S1|T1 is not leader                                                        
                                                                             S2|T0 is not leader                  
                                                                             S2|T1 starts to join election        
                                                                             S2|T1 save persist| votedFor: 2|     
                                                                             logsLen: 1                           
S0|T1 save persist| votedFor: 0|                                                                                  
logsLen: 2                                                                                                        
S0|T1 receive commands | logLen:                                                                                  
2[Start]                                                                                                          
                                       S1|T1 save persist| votedFor: 0|                                           
                                       logsLen: 1                                                                 
                                       S1|T1 appends logs from S0| logLen:                                        
                                       1[AppendEntry]                                                             
                                                                             S2 rejects to vote for S0 because it 
                                                                             has voted or it is more              
                                                                             up-dated[RequestVote]                
S0|T1 replica entries to S1|                                                                                      
entrylen:0| matchidx:0| nextidx:1                                                                                 
                                                                             S2|T1 save persist| votedFor: 2|     
                                                                             logsLen: 1                           
                                                                             S2|T1 appends logs from S0| logLen:  
                                                                             1[AppendEntry]                       
S0|T1 replica entries to S2|                                                                                      
entrylen:0| matchidx:0| nextidx:1                                                                                 
                                                                             S2|T1 save persist| votedFor: 2|     
                                                                             logsLen: 1                           
                                                                             S2|T1 appends logs from S0| logLen:  
                                                                             1[AppendEntry]                       
                                       S1|T1 save persist| votedFor: 0|                                           
                                       logsLen: 1                                                                 
                                       S1|T1 appends logs from S0| logLen:                                        
                                       1[AppendEntry]                                                             
S0|T1 replica entries to S2|                                                                                      
entrylen:0| matchidx:0| nextidx:1                                                                                 
S0|T1 replica entries to S1|                                                                                      
entrylen:0| matchidx:0| nextidx:1                                                                                 
                                       S1 rejects to vote for S2 because it                                       
                                       has voted or it is more                                                    
                                       up-dated[RequestVote]                                                      
S0 rejects to vote for S2 because it                                                                              
has voted or it is more                                                                                           
up-dated[RequestVote]                                                                                             
                                                                             S2|T1 ends this round                
                                                                             S2|T1 is not leader                  
                                       S1|T1 is not leader                                                        
                                       S1|T1 save persist| votedFor: 0|                                           
                                       logsLen: 2                                                                 
                                       S1|T1 appends logs from S0| logLen:                                        
                                       2[AppendEntry]                                                             
S0|T1 replica entries to S1|                                                                                      
entrylen:1| matchidx:1| nextidx:2                                                                                 
S0|T1 update commitIndex as 1                                                                                     
S0|T1 starts to apply entries                                                                                     
[1:1][ApplyEntry]                                                                                                 
S0|T1 finishes applying entries                                                                                   
[1:1][ApplyEntry]                                                                                                 
                                                                             S2|T1 is not leader                  
                                       S1|T1 is not leader                                                        
                                                                             S2|T1 save persist| votedFor: 2|     
                                                                             logsLen: 2                           
                                                                             S2|T1 appends logs from S0| logLen:  
                                                                             2[AppendEntry]                       
                                                                             S2|T1 starts to apply entries        
                                                                             [1:1][ApplyEntry]                    
                                                                             S2|T1 finishes applying entries      
                                                                             [1:1][ApplyEntry]                    
S0|T1 replica entries to S2|                                                                                      
entrylen:1| matchidx:1| nextidx:2                                                                                 
                                       S1|T1 save persist| votedFor: 0|                                           
                                       logsLen: 2                                                                 
                                       S1|T1 appends logs from S0| logLen:                                        
                                       2[AppendEntry]                                                             
                                       S1|T1 starts to apply entries                                              
                                       [1:1][ApplyEntry]                                                          
                                       S1|T1 finishes applying entries                                            
                                       [1:1][ApplyEntry]                                                          
S0|T1 replica entries to S1|                                                                                      
entrylen:0| matchidx:1| nextidx:2                                                                                 
                                                                             S2|T1 is not leader                  
                                       S1|T1 is not leader                                                        
                                       S1|T1 save persist| votedFor: 0|                                           
                                       logsLen: 2                                                                 
                                       S1|T1 appends logs from S0| logLen:                                        
                                       2[AppendEntry]                                                             
                                       S1|T1 is not leader                                                        
                                                                             S2|T1 is not leader                  
                                                                             S2|T1 save persist| votedFor: 2|     
                                                                             logsLen: 2                           
                                                                             S2|T1 appends logs from S0| logLen:  
                                                                             2[AppendEntry]                       
S0|T1 replica entries to S2|                                                                                      
entrylen:0| matchidx:1| nextidx:2                                                                                 
                                                                             S2|T1 is not leader                  
                                       S1|T1 is not leader                                                        
                                                                             S2|T1 save persist| votedFor: 2|     
                                                                             logsLen: 2                           
                                                                             S2|T1 appends logs from S0| logLen:  
                                                                             2[AppendEntry]                       
S0|T1 replica entries to S2|                                                                                      
entrylen:0| matchidx:1| nextidx:2                                                                                 
                                       S1|T1 save persist| votedFor: 0|                                           
                                       logsLen: 2                                                                 
                                       S1|T1 appends logs from S0| logLen:                                        
                                       2[AppendEntry]                                                             
S0|T1 replica entries to S1|                                                                                      
entrylen:0| matchidx:1| nextidx:2                                                                                 
                                                                             S2|T1 is not leader                  
                                       S1|T1 is not leader                                                        
                                       S1|T1 save persist| votedFor: 0|                                           
                                       logsLen: 2                                                                 
                                       S1|T1 appends logs from S0| logLen:                                        
                                       2[AppendEntry]                                                             
S0|T1 replica entries to S1|                                                                                      
entrylen:0| matchidx:1| nextidx:2                                                                                 
                                                                             S2|T1 save persist| votedFor: 2|     
                                                                             logsLen: 2                           
                                                                             S2|T1 appends logs from S0| logLen:  
                                                                             2[AppendEntry]                       
S0|T1 replica entries to S2|                                                                                      
entrylen:0| matchidx:1| nextidx:2                                                                                 
                                                                             S2|T1 is not leader                  
                                       S1|T1 is not leader                                                        
                                       S1|T1 save persist| votedFor: 0|                                           
                                       logsLen: 2                                                                 
                                       S1|T1 appends logs from S0| logLen:                                        
                                       2[AppendEntry]                                                             
                                                                             S2|T1 save persist| votedFor: 2|     
                                                                             logsLen: 2                           
                                                                             S2|T1 appends logs from S0| logLen:  
                                                                             2[AppendEntry]                       
                                       S1 is disconnected                                                         
S0|T1 save persist| votedFor: 0|                                                                                  
logsLen: 3                                                                                                        
S0|T1 receive commands | logLen:                                                                                  
3[Start]                                                                                                          
                                                                             S2|T1 is not leader                  
                                       S1|T1 is not leader                                                        
                                                                             S2|T1 save persist| votedFor: 2|     
                                                                             logsLen: 3                           
                                                                             S2|T1 appends logs from S0| logLen:  
                                                                             3[AppendEntry]                       
S0|T1 replica entries to S2|                                                                                      
entrylen:1| matchidx:2| nextidx:3                                                                                 
S0|T1 update commitIndex as 2                                                                                     
S0|T1 starts to apply entries                                                                                     
[2:2][ApplyEntry]                                                                                                 
S0|T1 finishes applying entries                                                                                   
[2:2][ApplyEntry]                                                                                                 
                                                                             S2|T1 is not leader                  
                                       S1|T1 is not leader                                                        
                                                                             S2|T1 save persist| votedFor: 2|     
                                                                             logsLen: 3                           
                                                                             S2|T1 appends logs from S0| logLen:  
                                                                             3[AppendEntry]                       
                                                                             S2|T1 starts to apply entries        
                                                                             [2:2][ApplyEntry]                    
                                                                             S2|T1 finishes applying entries      
                                                                             [2:2][ApplyEntry]                    
S0|T1 replica entries to S2|                                                                                      
entrylen:0| matchidx:2| nextidx:3                                                                                 
S0|T1 save persist| votedFor: 0|                                                                                  
logsLen: 4                                                                                                        
S0|T1 receive commands | logLen:                                                                                  
4[Start]                                                                                                          
S0|T1 save persist| votedFor: 0|                                                                                  
logsLen: 5                                                                                                        
S0|T1 receive commands | logLen:                                                                                  
5[Start]                                                                                                          
S0|T1 save persist| votedFor: 0|                                                                                  
logsLen: 6                                                                                                        
S0|T1 receive commands | logLen:                                                                                  
6[Start]                                                                                                          
S0|T1 save persist| votedFor: 0|                                                                                  
logsLen: 7                                                                                                        
S0|T1 receive commands | logLen:                                                                                  
7[Start]                                                                                                          
S0|T1 save persist| votedFor: 0|                                                                                  
logsLen: 8                                                                                                        
S0|T1 receive commands | logLen:                                                                                  
8[Start]                                                                                                          
S0|T1 save persist| votedFor: 0|                                                                                  
logsLen: 9                                                                                                        
S0|T1 receive commands | logLen:                                                                                  
9[Start]                                                                                                          
                                                                             S2|T1 is not leader                  
                                       S1|T1 is not leader                                                        
                                                                             S2|T1 save persist| votedFor: 2|     
                                                                             logsLen: 9                           
                                                                             S2|T1 appends logs from S0| logLen:  
                                                                             9[AppendEntry]                       
S0|T1 replica entries to S2|                                                                                      
entrylen:6| matchidx:8| nextidx:9                                                                                 
S0|T1 update commitIndex as 8                                                                                     
S0|T1 starts to apply entries                                                                                     
[3:8][ApplyEntry]                                                                                                 
S0|T1 finishes applying entries                                                                                   
[3:8][ApplyEntry]                                                                                                 
                                       S1|T1 is not leader                                                        
                                                                             S2|T1 is not leader                  
                                                                             S2|T1 save persist| votedFor: 2|     
                                                                             logsLen: 9                           
                                                                             S2|T1 appends logs from S0| logLen:  
                                                                             9[AppendEntry]                       
                                                                             S2|T1 starts to apply entries        
                                                                             [3:8][ApplyEntry]                    
                                                                             S2|T1 finishes applying entries      
                                                                             [3:8][ApplyEntry]                    
                                       S1 is connected again                                                      
S0|T1 save persist| votedFor: 0|                                                                                  
logsLen: 10                                                                                                       
S0|T1 receive commands | logLen:                                                                                  
10[Start]                                                                                                         
                                       S1|T1 is not leader                                                        
                                                                             S2|T1 is not leader                  
                                       S1|T1 save persist| votedFor: 0|                                           
                                       logsLen: 10                                                                
                                       S1|T1 appends logs from S0| logLen:                                        
                                       10[AppendEntry]                                                            
                                       S1|T1 starts to apply entries                                              
                                       [2:8][ApplyEntry]                                                          
                                       S1|T1 finishes applying entries                                            
                                       [2:8][ApplyEntry]                                                          
S0|T1 replica entries to S1|                                                                                      
entrylen:8| matchidx:9| nextidx:10                                                                                
S0|T1 update commitIndex as 9                                                                                     
S0|T1 starts to apply entries                                                                                     
[9:9][ApplyEntry]                                                                                                 
S0|T1 finishes applying entries                                                                                   
[9:9][ApplyEntry]                                                                                                 
S0|T1 Snapshot until index 9| logLen:                                                                             
10                                                                                                                
                                                                             S2|T1 save persist| votedFor: 2|     
                                                                             logsLen: 10                          
                                                                             S2|T1 appends logs from S0| logLen:  
                                                                             10[AppendEntry]                      
S0|T1 replica entries to S2|                                                                                      
entrylen:1| matchidx:9| nextidx:10                                                                                
                                       S1|T1 is not leader                                                        
                                                                             S2|T1 is not leader                  
                                       S1|T1 save persist| votedFor: 0|                                           
                                       logsLen: 10                                                                
                                       S1|T1 appends logs from S0| logLen:                                        
                                       10[AppendEntry]                                                            
                                       S1|T1 starts to apply entries                                              
                                       [9:9][ApplyEntry]                                                          
                                       S1|T1 finishes applying entries                                            
                                       [9:9][ApplyEntry]                                                          
S0|T1 replica entries to S1|                                                                                      
entrylen:0| matchidx:9| nextidx:10                                                                                
                                       S1|T1 Snapshot until index 9| logLen:                                      
                                       10                                                                         
                                                                             S2|T1 save persist| votedFor: 2|     
                                                                             logsLen: 10                          
                                                                             S2|T1 appends logs from S0| logLen:  
                                                                             10[AppendEntry]                      
                                                                             S2|T1 starts to apply entries        
                                                                             [9:9][ApplyEntry]                    
                                                                             S2|T1 finishes applying entries      
                                                                             [9:9][ApplyEntry]                    
S0|T1 replica entries to S2|                                                                                      
entrylen:0| matchidx:9| nextidx:10                                                                                
                                                                             S2|T1 Snapshot until index 9| logLen:
                                                                             10                                   
                                       S1|T1 is not leader                                                        
                                                                             S2|T1 is not leader                  
                                                                             S2|T1 save persist| votedFor: 2|     
                                                                             logsLen: 10                          
                                                                             S2|T1 appends logs from S0| logLen:  
                                                                             10[AppendEntry]                      
S0|T1 replica entries to S2|                                                                                      
entrylen:0| matchidx:9| nextidx:10                                                                                
                                       S1|T1 save persist| votedFor: 0|                                           
                                       logsLen: 10                                                                
                                       S1|T1 appends logs from S0| logLen:                                        
                                       10[AppendEntry]                                                            
S0|T1 replica entries to S1|                                                                                      
entrylen:0| matchidx:9| nextidx:10                                                                                
                                                                             S2|T1 is not leader                  
                                       S1|T1 is not leader                                                        
                                       S1|T1 save persist| votedFor: 0|                                           
                                       logsLen: 10                                                                
                                       S1|T1 appends logs from S0| logLen:                                        
                                       10[AppendEntry]                                                            
S0|T1 replica entries to S1|                                                                                      
entrylen:0| matchidx:9| nextidx:10                                                                                
                                                                             S2|T1 save persist| votedFor: 2|     
                                                                             logsLen: 10                          
                                                                             S2|T1 appends logs from S0| logLen:  
                                                                             10[AppendEntry]                      
S0|T1 replica entries to S2|                                                                                      
entrylen:0| matchidx:9| nextidx:10                                                                                
                                                                             S2|T1 is not leader                  
                                       S1|T1 is not leader                                                        
                                       S1|T1 save persist| votedFor: 0|                                           
                                       logsLen: 10                                                                
                                       S1|T1 appends logs from S0| logLen:                                        
                                       10[AppendEntry]                                                            
S0|T1 replica entries to S1|                                                                                      
entrylen:0| matchidx:9| nextidx:10                                                                                
                                                                             S2|T1 save persist| votedFor: 2|     
                                                                             logsLen: 10                          
                                                                             S2|T1 appends logs from S0| logLen:  
                                                                             10[AppendEntry]                      
S0|T1 replica entries to S2|                                                                                      
entrylen:0| matchidx:9| nextidx:10                                                                                
                                       S1|T1 is not leader                                                        
                                                                             S2|T1 is not leader                  
                                       S1|T1 save persist| votedFor: 0|                                           
                                       logsLen: 10                                                                
                                       S1|T1 appends logs from S0| logLen:                                        
                                       10[AppendEntry]                                                            
S0|T1 replica entries to S1|                                                                                      
entrylen:0| matchidx:9| nextidx:10                                                                                
                                                                             S2|T1 save persist| votedFor: 2|     
                                                                             logsLen: 10                          
                                                                             S2|T1 appends logs from S0| logLen:  
                                                                             10[AppendEntry]                      
S0|T1 replica entries to S2|                                                                                      
entrylen:0| matchidx:9| nextidx:10                                                                                
                                                                             S2|T1 is not leader                  
                                       S1|T1 is not leader                                                        
                                                                             S2|T1 save persist| votedFor: 2|     
                                                                             logsLen: 10                          
                                                                             S2|T1 appends logs from S0| logLen:  
                                                                             10[AppendEntry]                      
                                       S1|T1 save persist| votedFor: 0|                                           
                                       logsLen: 10                                                                
                                       S1|T1 appends logs from S0| logLen:                                        
                                       10[AppendEntry]                                                            
S0|T1 replica entries to S2|                                                                                      
entrylen:0| matchidx:9| nextidx:10                                                                                
S0|T1 replica entries to S1|                                                                                      
entrylen:0| matchidx:9| nextidx:10                                                                                
S0 is disconnected                                                                                                
                                                                             S2|T1 is not leader                  
                                       S1|T1 is not leader                                                        
                                       S1|T1 is not leader                                                        
                                                                             S2|T1 is not leader                  
S0|T11 fails to install snapshot to S1                                                                            
                                                                             S2|T1 is not leader                  
                                       S1|T1 is not leader                                                        
                                                                             S2|T1 is not leader                  
                                       S1|T1 is not leader                                                        
                                       S1|T1 is not leader                                                        
                                                                             S2|T1 is not leader                  
                                       S1|T1 is not leader                                                        
                                                                             S2|T1 is not leader                  
                                                                             S2|T1 is not leader                  
                                       S1|T1 is not leader                                                        
                                       S1|T1 is not leader                                                        
                                                                             S2|T1 is not leader                  
                                       S1|T1 is not leader                                                        
                                                                             S2|T1 is not leader                  
                                                                             S2|T1 is not leader                  
                                       S1|T1 is not leader                                                        
                                                                             S2|T2 starts to join election        
                                                                             S2|T2 save persist| votedFor: 2|     
                                                                             logsLen: 10                          
                                       S1|T2 save persist| votedFor: -1|                                          
                                       logsLen: 10                                                                
                                       S1|T2 save persist| votedFor: 2|                                           
                                       logsLen: 10                                                                
                                       S1|T2 votes for S2[RequestVote]                                            
                                                                             S2|T2 becomes the leader, and starts 
                                                                             heatbeats                            
                                       S1|T2 save persist| votedFor: 2|                                           
                                       logsLen: 10                                                                
                                       S1|T2 appends logs from S2| logLen:                                        
                                       10[AppendEntry]                                                            
                                                                             S2|T2 replica entries to S1|         
                                                                             entrylen:0| matchidx:9| nextidx:10   
                                                                             S2|T2 save persist| votedFor: 2|     
                                                                             logsLen: 11                          
                                                                             S2|T2 receive commands | logLen:     
                                                                             11[Start]                            
                                       S1|T2 is not leader                                                        
                                       S1|T2 is not leader                                                        
                                       S1|T2 save persist| votedFor: 2|                                           
                                       logsLen: 11                                                                
                                       S1|T2 appends logs from S2| logLen:                                        
                                       11[AppendEntry]                                                            
                                                                             S2|T2 replica entries to S1|         
                                                                             entrylen:1| matchidx:10| nextidx:11  
                                                                             S2|T2 update commitIndex as 10       
                                                                             S2|T2 starts to apply entries        
                                                                             [10:10][ApplyEntry]                  
                                                                             S2|T2 finishes applying entries      
                                                                             [10:10][ApplyEntry]                  
                                       S1|T2 is not leader                                                        
                                       S1|T2 save persist| votedFor: 2|                                           
                                       logsLen: 11                                                                
                                       S1|T2 appends logs from S2| logLen:                                        
                                       11[AppendEntry]                                                            
                                       S1|T2 starts to apply entries                                              
                                       [10:10][ApplyEntry]                                                        
                                       S1|T2 finishes applying entries                                            
                                       [10:10][ApplyEntry]                                                        
                                                                             S2|T2 replica entries to S1|         
                                                                             entrylen:0| matchidx:10| nextidx:11  
                                                                             S2|T2 save persist| votedFor: 2|     
                                                                             logsLen: 12                          
                                                                             S2|T2 receive commands | logLen:     
                                                                             12[Start]                            
                                       S1|T2 is not leader                                                        
                                       S1|T2 save persist| votedFor: 2|                                           
                                       logsLen: 12                                                                
                                       S1|T2 appends logs from S2| logLen:                                        
                                       12[AppendEntry]                                                            
                                                                             S2|T2 replica entries to S1|         
                                                                             entrylen:1| matchidx:11| nextidx:12  
                                                                             S2|T2 update commitIndex as 11       
                                                                             S2|T2 starts to apply entries        
                                                                             [11:11][ApplyEntry]                  
                                                                             S2|T2 finishes applying entries      
                                                                             [11:11][ApplyEntry]                  
                                       S1|T2 is not leader                                                        
                                       S1|T2 save persist| votedFor: 2|                                           
                                       logsLen: 12                                                                
                                       S1|T2 appends logs from S2| logLen:                                        
                                       12[AppendEntry]                                                            
                                       S1|T2 starts to apply entries                                              
                                       [11:11][ApplyEntry]                                                        
                                       S1|T2 finishes applying entries                                            
                                       [11:11][ApplyEntry]                                                        
                                                                             S2|T2 replica entries to S1|         
                                                                             entrylen:0| matchidx:11| nextidx:12  
S0 is connected again                                                                                             
                                                                             S2|T2 save persist| votedFor: 2|     
                                                                             logsLen: 13                          
                                                                             S2|T2 receive commands | logLen:     
                                                                             13[Start]                            
                                       S1|T2 is not leader                                                        
                                                                             S2|T2 rejects to append entries from 
                                                                             S0 | out of date term[AppendEntry]   
S0|T2 save persist| votedFor: -1|                                                                                 
logsLen: 10                                                                                                       
                                       S1|T2 save persist| votedFor: 2|                                           
                                       logsLen: 13                                                                
                                       S1|T2 appends logs from S2| logLen:                                        
                                       13[AppendEntry]                                                            
                                                                             S2|T2 replica entries to S1|         
                                                                             entrylen:1| matchidx:12| nextidx:13  
                                                                             S2|T2 update commitIndex as 12       
                                                                             S2|T2 starts to apply entries        
                                                                             [12:12][ApplyEntry]                  
                                                                             S2|T2 finishes applying entries      
                                                                             [12:12][ApplyEntry]                  
                                       S1|T2 rejects to append entries from                                       
                                       S0 | out of date term[AppendEntry]                                         
S0|T2 lost leadership, state: 0                                                                                   
S0|T2 save persist| votedFor: -1|                                                                                 
logsLen: 13                                                                                                       
S0|T2 appends logs from S2| logLen:                                                                               
13[AppendEntry]                                                                                                   
S0|T2 starts to apply entries                                                                                     
[10:11][ApplyEntry]                                                                                               
S0|T2 finishes applying entries                                                                                   
[10:11][ApplyEntry]                                                                                               
                                       S1|T2 is not leader                                                        
S0|T2 is not leader                                                                                               
S0|T2 save persist| votedFor: -1|                                                                                 
logsLen: 13                                                                                                       
S0|T2 appends logs from S2| logLen:                                                                               
13[AppendEntry]                                                                                                   
S0|T2 starts to apply entries                                                                                     
[12:12][ApplyEntry]                                                                                               
S0|T2 finishes applying entries                                                                                   
[12:12][ApplyEntry]                                                                                               
                                                                             S2|T2 replica entries to S0|         
                                                                             entrylen:3| matchidx:12| nextidx:13  
                                       S1|T2 save persist| votedFor: 2|                                           
                                       logsLen: 13                                                                
                                       S1|T2 appends logs from S2| logLen:                                        
                                       13[AppendEntry]                                                            
                                       S1|T2 starts to apply entries                                              
                                       [12:12][ApplyEntry]                                                        
                                       S1|T2 finishes applying entries                                            
                                       [12:12][ApplyEntry]                                                        
                                                                             S2|T2 replica entries to S1|         
                                                                             entrylen:0| matchidx:12| nextidx:13  
S0|T2 is not leader                                                                                               
                                       S1|T2 is not leader                                                        
                                       S1|T2 save persist| votedFor: 2|                                           
                                       logsLen: 13                                                                
                                       S1|T2 appends logs from S2| logLen:                                        
                                       13[AppendEntry]                                                            
                                                                             S2|T2 replica entries to S1|         
                                                                             entrylen:0| matchidx:12| nextidx:13  
S0|T2 save persist| votedFor: -1|                                                                                 
logsLen: 13                                                                                                       
S0|T2 appends logs from S2| logLen:                                                                               
13[AppendEntry]                                                                                                   
                                                                             S2|T2 replica entries to S0|         
                                                                             entrylen:0| matchidx:12| nextidx:13  
                                       S1|T2 is not leader                                                        
S0|T2 is not leader                                                                                               
S0|T2 save persist| votedFor: -1|                                                                                 
logsLen: 13                                                                                                       
S0|T2 appends logs from S2| logLen:                                                                               
13[AppendEntry]                                                                                                   
                                                                             S2|T2 replica entries to S0|         
                                                                             entrylen:0| matchidx:12| nextidx:13  
                                       S1|T2 save persist| votedFor: 2|                                           
                                       logsLen: 13                                                                
                                       S1|T2 appends logs from S2| logLen:                                        
                                       13[AppendEntry]                                                            
                                                                             S2|T2 replica entries to S1|         
                                                                             entrylen:0| matchidx:12| nextidx:13  
                                       S1|T2 is not leader                                                        
S0|T2 is not leader                                                                                               
                                       S1|T2 save persist| votedFor: 2|                                           
                                       logsLen: 13                                                                
                                       S1|T2 appends logs from S2| logLen:                                        
                                       13[AppendEntry]                                                            
                                                                             S2|T2 replica entries to S1|         
                                                                             entrylen:0| matchidx:12| nextidx:13  
                                       S1|T2 is not leader                                                        
S0|T2 is not leader                                                                                               
S0|T2 save persist| votedFor: -1|                                                                                 
logsLen: 13                                                                                                       
S0|T2 appends logs from S2| logLen:                                                                               
13[AppendEntry]                                                                                                   
                                                                             S2|T2 replica entries to S0|         
                                                                             entrylen:0| matchidx:12| nextidx:13  
                                       S1|T2 is not leader                                                        
S0|T2 is not leader                                                                                               
                                       S1|T2 save persist| votedFor: 2|                                           
                                       logsLen: 13                                                                
                                       S1|T2 appends logs from S2| logLen:                                        
                                       13[AppendEntry]                                                            
                                                                             S2|T2 replica entries to S1|         
                                                                             entrylen:0| matchidx:12| nextidx:13  
S0|T2 save persist| votedFor: -1|                                                                                 
logsLen: 13                                                                                                       
S0|T2 appends logs from S2| logLen:                                                                               
13[AppendEntry]                                                                                                   
                                                                             S2|T2 replica entries to S0|         
                                                                             entrylen:0| matchidx:12| nextidx:13  
S0 is disconnected                                                                                                
                                                                             S2|T2 save persist| votedFor: 2|     
                                                                             logsLen: 14                          
                                                                             S2|T2 receive commands | logLen:     
                                                                             14[Start]                            
                                       S1|T2 is not leader                                                        
S0|T2 is not leader                                                                                               
                                       S1|T2 save persist| votedFor: 2|                                           
                                       logsLen: 14                                                                
                                       S1|T2 appends logs from S2| logLen:                                        
                                       14[AppendEntry]                                                            
                                                                             S2|T2 replica entries to S1|         
                                                                             entrylen:1| matchidx:13| nextidx:14  
                                                                             S2|T2 update commitIndex as 13       
                                                                             S2|T2 starts to apply entries        
                                                                             [13:13][ApplyEntry]                  
                                                                             S2|T2 finishes applying entries      
                                                                             [13:13][ApplyEntry]                  
S0|T2 is not leader                                                                                               
                                       S1|T2 is not leader                                                        
                                       S1|T2 save persist| votedFor: 2|                                           
                                       logsLen: 14                                                                
                                       S1|T2 appends logs from S2| logLen:                                        
                                       14[AppendEntry]                                                            
                                       S1|T2 starts to apply entries                                              
                                       [13:13][ApplyEntry]                                                        
                                       S1|T2 finishes applying entries                                            
                                       [13:13][ApplyEntry]                                                        
                                                                             S2|T2 replica entries to S1|         
                                                                             entrylen:0| matchidx:13| nextidx:14  
                                                                             S2|T2 save persist| votedFor: 2|     
                                                                             logsLen: 15                          
                                                                             S2|T2 receive commands | logLen:     
                                                                             15[Start]                            
                                                                             S2|T2 save persist| votedFor: 2|     
                                                                             logsLen: 16                          
                                                                             S2|T2 receive commands | logLen:     
                                                                             16[Start]                            
                                                                             S2|T2 save persist| votedFor: 2|     
                                                                             logsLen: 17                          
                                                                             S2|T2 receive commands | logLen:     
                                                                             17[Start]                            
                                                                             S2|T2 save persist| votedFor: 2|     
                                                                             logsLen: 18                          
                                                                             S2|T2 receive commands | logLen:     
                                                                             18[Start]                            
                                                                             S2|T2 save persist| votedFor: 2|     
                                                                             logsLen: 19                          
                                                                             S2|T2 receive commands | logLen:     
                                                                             19[Start]                            
                                                                             S2|T2 save persist| votedFor: 2|     
                                                                             logsLen: 20                          
                                                                             S2|T2 receive commands | logLen:     
                                                                             20[Start]                            
                                                                             S2|T2 save persist| votedFor: 2|     
                                                                             logsLen: 21                          
                                                                             S2|T2 receive commands | logLen:     
                                                                             21[Start]                            
                                                                             S2|T2 save persist| votedFor: 2|     
                                                                             logsLen: 22                          
                                                                             S2|T2 receive commands | logLen:     
                                                                             22[Start]                            
                                                                             S2|T2 save persist| votedFor: 2|     
                                                                             logsLen: 23                          
                                                                             S2|T2 receive commands | logLen:     
                                                                             23[Start]                            
                                                                             S2|T2 save persist| votedFor: 2|     
                                                                             logsLen: 24                          
                                                                             S2|T2 receive commands | logLen:     
                                                                             24[Start]                            
S0|T2 is not leader                                                                                               
                                       S1|T2 is not leader                                                        
                                       S1|T2 save persist| votedFor: 2|                                           
                                       logsLen: 24                                                                
                                       S1|T2 appends logs from S2| logLen:                                        
                                       24[AppendEntry]                                                            
                                                                             S2|T2 replica entries to S1|         
                                                                             entrylen:10| matchidx:23| nextidx:24 
                                                                             S2|T2 update commitIndex as 23       
                                                                             S2|T2 starts to apply entries        
                                                                             [14:23][ApplyEntry]                  
                                                                             S2|T2 Snapshot until index 19|       
                                                                             logLen: 24                           
                                                                             S2|T2 finishes applying entries      
                                                                             [14:23][ApplyEntry]                  
                                       S1|T2 is not leader                                                        
S0|T2 is not leader                                                                                               
                                                                             S2|T2 send rpc to S0|base: 19| next: 
                                                                             13                                   
                                       S1|T2 save persist| votedFor: 2|                                           
                                       logsLen: 24                                                                
                                       S1|T2 appends logs from S2| logLen:                                        
                                       24[AppendEntry]                                                            
                                       S1|T2 starts to apply entries                                              
                                       [14:23][ApplyEntry]                                                        
                                                                             S2|T2 replica entries to S1|         
                                                                             entrylen:0| matchidx:23| nextidx:24  
                                       S1|T2 Snapshot until index 19|                                             
                                       logLen: 24                                                                 
                                       S1|T2 finishes applying entries                                            
                                       [14:23][ApplyEntry]                                                        
S0 is connected again                                                                                             
                                                                             S2|T2 save persist| votedFor: 2|     
                                                                             logsLen: 25                          
                                                                             S2|T2 receive commands | logLen:     
                                                                             25[Start]                            
S0|T2 is not leader                                                                                               
                                       S1|T2 is not leader                                                        
                                                                             S2|T2 send rpc to S0|base: 19| next: 
                                                                             13                                   
                                       S1|T2 save persist| votedFor: 2|                                           
                                       logsLen: 25                                                                
                                       S1|T2 appends logs from S2| logLen:                                        
                                       25[AppendEntry]                                                            
                                                                             S2|T2 replica entries to S1|         
                                                                             entrylen:1| matchidx:24| nextidx:25  
                                                                             S2|T2 update commitIndex as 24       
                                                                             S2|T2 starts to apply entries        
                                                                             [24:24][ApplyEntry]                  
                                                                             S2|T2 finishes applying entries      
                                                                             [24:24][ApplyEntry]                  
S0|T2 receive rpc from S2                                                                                         
S0|T2 update rfstate| Base:19|                                                                                    
LogLen:20                                                                                                         
S0|T2 applys snapshot from S2                                                                                     
                                                                             S2|T2 installs snapshot to S0|       
                                                                             nextId:20| matchId:19                
S0|T2 is not leader                                                                                               
                                       S1|T2 is not leader                                                        
S0|T2 save persist| votedFor: -1|                                                                                 
logsLen: 25                                                                                                       
S0|T2 appends logs from S2| logLen:                                                                               
25[AppendEntry]                                                                                                   
                                       S1|T2 save persist| votedFor: 2|                                           
                                       logsLen: 25                                                                
                                       S1|T2 appends logs from S2| logLen:                                        
                                       25[AppendEntry]                                                            
S0|T2 starts to apply entries                                                                                     
[20:24][ApplyEntry]                                                                                               
S0|T2 finishes applying entries                                                                                   
[20:24][ApplyEntry]                                                                                               
                                       S1|T2 starts to apply entries                                              
                                       [24:24][ApplyEntry]                                                        
                                       S1|T2 finishes applying entries                                            
                                       [24:24][ApplyEntry]                                                        
                                                                             S2|T2 replica entries to S0|         
                                                                             entrylen:5| matchidx:24| nextidx:25  
                                                                             S2|T2 replica entries to S1|         
                                                                             entrylen:0| matchidx:24| nextidx:25  
                                       S1|T2 is not leader                                                        
S0|T2 is not leader                                                                                               
S0|T2 save persist| votedFor: -1|                                                                                 
logsLen: 25                                                                                                       
S0|T2 appends logs from S2| logLen:                                                                               
25[AppendEntry]                                                                                                   
                                                                             S2|T2 replica entries to S0|         
                                                                             entrylen:0| matchidx:24| nextidx:25  
                                       S1|T2 save persist| votedFor: 2|                                           
                                       logsLen: 25                                                                
                                       S1|T2 appends logs from S2| logLen:                                        
                                       25[AppendEntry]                                                            
                                                                             S2|T2 replica entries to S1|         
                                                                             entrylen:0| matchidx:24| nextidx:25  
                                       S1|T2 is not leader                                                        
S0|T2 is not leader                                                                                               
S0|T2 is not leader                                                                                               
                                       S1|T2 is not leader                                                        
                                       S1|T2 is not leader                                                        
S0|T2 is not leader                                                                                               
S0|T2 save persist| votedFor: -1|                                                                                 
logsLen: 25                                                                                                       
S0|T2 appends logs from S2| logLen:                                                                               
25[AppendEntry]                                                                                                   
                                                                             S2|T2 replica entries to S0|         
                                                                             entrylen:0| matchidx:24| nextidx:25  
S0 is disconnected                                                                                                
                                                                             S2|T2 save persist| votedFor: 2|     
                                                                             logsLen: 26                          
                                                                             S2|T2 receive commands | logLen:     
                                                                             26[Start]                            
S0|T2 is not leader                                                                                               
                                       S1|T2 is not leader                                                        
                                       S1|T2 save persist| votedFor: 2|                                           
                                       logsLen: 26                                                                
                                       S1|T2 appends logs from S2| logLen:                                        
                                       26[AppendEntry]                                                            
                                                                             S2|T2 replica entries to S1|         
                                                                             entrylen:1| matchidx:25| nextidx:26  
                                                                             S2|T2 update commitIndex as 25       
                                                                             S2|T2 starts to apply entries        
                                                                             [25:25][ApplyEntry]                  
                                                                             S2|T2 finishes applying entries      
                                                                             [25:25][ApplyEntry]                  
                                       S1|T2 is not leader                                                        
S0|T2 is not leader                                                                                               
                                       S1|T2 save persist| votedFor: 2|                                           
                                       logsLen: 26                                                                
                                       S1|T2 appends logs from S2| logLen:                                        
                                       26[AppendEntry]                                                            
                                       S1|T2 starts to apply entries                                              
                                       [25:25][ApplyEntry]                                                        
                                       S1|T2 finishes applying entries                                            
                                       [25:25][ApplyEntry]                                                        
                                                                             S2|T2 replica entries to S1|         
                                                                             entrylen:0| matchidx:25| nextidx:26  
                                                                             S2|T2 save persist| votedFor: 2|     
                                                                             logsLen: 27                          
                                                                             S2|T2 receive commands | logLen:     
                                                                             27[Start]                            
                                                                             S2|T2 save persist| votedFor: 2|     
                                                                             logsLen: 28                          
                                                                             S2|T2 receive commands | logLen:     
                                                                             28[Start]                            
                                                                             S2|T2 save persist| votedFor: 2|     
                                                                             logsLen: 29                          
                                                                             S2|T2 receive commands | logLen:     
                                                                             29[Start]                            
                                                                             S2|T2 save persist| votedFor: 2|     
                                                                             logsLen: 30                          
                                                                             S2|T2 receive commands | logLen:     
                                                                             30[Start]                            
                                                                             S2|T2 save persist| votedFor: 2|     
                                                                             logsLen: 31                          
                                                                             S2|T2 receive commands | logLen:     
                                                                             31[Start]                            
                                                                             S2|T2 save persist| votedFor: 2|     
                                                                             logsLen: 32                          
                                                                             S2|T2 receive commands | logLen:     
                                                                             32[Start]                            
                                                                             S2|T2 save persist| votedFor: 2|     
                                                                             logsLen: 33                          
                                                                             S2|T2 receive commands | logLen:     
                                                                             33[Start]                            
                                                                             S2|T2 save persist| votedFor: 2|     
                                                                             logsLen: 34                          
                                                                             S2|T2 receive commands | logLen:     
                                                                             34[Start]                            
                                                                             S2|T2 save persist| votedFor: 2|     
                                                                             logsLen: 35                          
                                                                             S2|T2 receive commands | logLen:     
                                                                             35[Start]                            
                                                                             S2|T2 save persist| votedFor: 2|     
                                                                             logsLen: 36                          
                                                                             S2|T2 receive commands | logLen:     
                                                                             36[Start]                            
                                                                             S2|T2 save persist| votedFor: 2|     
                                                                             logsLen: 37                          
                                                                             S2|T2 receive commands | logLen:     
                                                                             37[Start]                            
                                                                             S2|T2 save persist| votedFor: 2|     
                                                                             logsLen: 38                          
                                                                             S2|T2 receive commands | logLen:     
                                                                             38[Start]                            
                                                                             S2|T2 save persist| votedFor: 2|     
                                                                             logsLen: 39                          
                                                                             S2|T2 receive commands | logLen:     
                                                                             39[Start]                            
                                                                             S2|T2 save persist| votedFor: 2|     
                                                                             logsLen: 40                          
                                                                             S2|T2 receive commands | logLen:     
                                                                             40[Start]                            
                                       S1|T2 is not leader                                                        
S0|T2 is not leader                                                                                               
                                       S1|T2 save persist| votedFor: 2|                                           
                                       logsLen: 40                                                                
                                       S1|T2 appends logs from S2| logLen:                                        
                                       40[AppendEntry]                                                            
                                                                             S2|T2 replica entries to S1|         
                                                                             entrylen:14| matchidx:39| nextidx:40 
                                                                             S2|T2 update commitIndex as 39       
                                                                             S2|T2 starts to apply entries        
                                                                             [26:39][ApplyEntry]                  
                                                                             S2|T2 Snapshot until index 29|       
                                                                             logLen: 40                           
                                                                             S2|T2 finishes applying entries      
                                                                             [26:39][ApplyEntry]                  
                                                                             S2|T2 Snapshot until index 39|       
                                                                             logLen: 40                           
S0|T2 is not leader                                                                                               
                                       S1|T2 is not leader                                                        
                                                                             S2|T2 send rpc to S0|base: 39| next: 
                                                                             25                                   
                                       S1|T2 save persist| votedFor: 2|                                           
                                       logsLen: 40                                                                
                                       S1|T2 appends logs from S2| logLen:                                        
                                       40[AppendEntry]                                                            
                                       S1|T2 starts to apply entries                                              
                                       [26:39][ApplyEntry]                                                        
                                                                             S2|T2 replica entries to S1|         
                                                                             entrylen:0| matchidx:39| nextidx:40  
                                       S1|T2 Snapshot until index 29|                                             
                                       logLen: 40                                                                 
                                       S1|T2 finishes applying entries                                            
                                       [26:39][ApplyEntry]                                                        
                                       S1|T2 Snapshot until index 39|                                             
                                       logLen: 40                                                                 
S0 is connected again                                                                                             
                                                                             S2|T2 save persist| votedFor: 2|     
                                                                             logsLen: 41                          
                                                                             S2|T2 receive commands | logLen:     
                                                                             41[Start]                            
S0|T2 is not leader                                                                                               
                                       S1|T2 is not leader                                                        
                                                                             S2|T2 send rpc to S0|base: 39| next: 
                                                                             25                                   
S0|T2 receive rpc from S2                                                                                         
S0|T2 update rfstate| Base:39|                                                                                    
LogLen:40                                                                                                         
S0|T2 applys snapshot from S2                                                                                     
                                                                             S2|T2 installs snapshot to S0|       
                                                                             nextId:40| matchId:39                
                                       S1|T2 save persist| votedFor: 2|                                           
                                       logsLen: 41                                                                
                                       S1|T2 appends logs from S2| logLen:                                        
                                       41[AppendEntry]                                                            
S0|T2 is not leader                                                                                               
                                       S1|T2 is not leader                                                        
S0|T2 save persist| votedFor: -1|                                                                                 
logsLen: 41                                                                                                       
S0|T2 appends logs from S2| logLen:                                                                               
41[AppendEntry]                                                                                                   
                                                                             S2|T2 replica entries to S0|         
                                                                             entrylen:1| matchidx:40| nextidx:41  
                                                                             S2|T2 update commitIndex as 40       
                                                                             S2|T2 starts to apply entries        
                                                                             [40:40][ApplyEntry]                  
                                                                             S2|T2 finishes applying entries      
                                                                             [40:40][ApplyEntry]                  
                                       S1|T2 save persist| votedFor: 2|                                           
                                       logsLen: 41                                                                
                                       S1|T2 appends logs from S2| logLen:                                        
                                       41[AppendEntry]                                                            
S0|T2 is not leader                                                                                               
                                       S1|T2 is not leader                                                        
S0|T2 save persist| votedFor: -1|                                                                                 
logsLen: 41                                                                                                       
S0|T2 appends logs from S2| logLen:                                                                               
41[AppendEntry]                                                                                                   
S0|T2 starts to apply entries                                                                                     
[40:40][ApplyEntry]                                                                                               
S0|T2 finishes applying entries                                                                                   
[40:40][ApplyEntry]                                                                                               
                                       S1|T2 save persist| votedFor: 2|                                           
                                       logsLen: 41                                                                
                                       S1|T2 appends logs from S2| logLen:                                        
                                       41[AppendEntry]                                                            
                                       S1|T2 starts to apply entries                                              
                                       [40:40][ApplyEntry]                                                        
                                       S1|T2 finishes applying entries                                            
                                       [40:40][ApplyEntry]                                                        
                                                                             S2|T2 replica entries to S1|         
                                                                             entrylen:1| matchidx:40| nextidx:41  
                                       S1|T2 is not leader                                                        
S0|T2 is not leader                                                                                               
                                       S1|T2 save persist| votedFor: 2|                                           
                                       logsLen: 41                                                                
                                       S1|T2 appends logs from S2| logLen:                                        
                                       41[AppendEntry]                                                            
                                                                             S2|T2 replica entries to S1|         
                                                                             entrylen:0| matchidx:40| nextidx:41  
S0|T2 save persist| votedFor: -1|                                                                                 
logsLen: 41                                                                                                       
S0|T2 appends logs from S2| logLen:                                                                               
41[AppendEntry]                                                                                                   
                                       S1|T2 is not leader                                                        
S0|T2 is not leader                                                                                               
                                       S1|T2 save persist| votedFor: 2|                                           
                                       logsLen: 41                                                                
                                       S1|T2 appends logs from S2| logLen:                                        
                                       41[AppendEntry]                                                            
S0|T2 save persist| votedFor: -1|                                                                                 
logsLen: 41                                                                                                       
S0|T2 appends logs from S2| logLen:                                                                               
41[AppendEntry]                                                                                                   
                                                                             S2|T2 replica entries to S0|         
                                                                             entrylen:0| matchidx:40| nextidx:41  
                                       S1|T2 is not leader                                                        
S0|T2 is not leader                                                                                               
                                       S1|T2 save persist| votedFor: 2|                                           
                                       logsLen: 41                                                                
                                       S1|T2 appends logs from S2| logLen:                                        
                                       41[AppendEntry]                                                            
                                                                             S2|T2 replica entries to S1|         
                                                                             entrylen:0| matchidx:40| nextidx:41  
                                       S1|T2 is not leader                                                        
S0|T2 is not leader                                                                                               
                                       S1|T2 save persist| votedFor: 2|                                           
                                       logsLen: 41                                                                
                                       S1|T2 appends logs from S2| logLen:                                        
                                       41[AppendEntry]                                                            
                                                                             S2|T2 replica entries to S1|         
                                                                             entrylen:0| matchidx:40| nextidx:41  
S0|T2 is not leader                                                                                               
                                       S1|T2 is not leader                                                        
S0|T2 save persist| votedFor: -1|                                                                                 
logsLen: 41                                                                                                       
S0|T2 appends logs from S2| logLen:                                                                               
41[AppendEntry]                                                                                                   
                                                                             S2|T2 replica entries to S0|         
                                                                             entrylen:0| matchidx:40| nextidx:41  
                                       S1|T2 save persist| votedFor: 2|                                           
                                       logsLen: 41                                                                
                                       S1|T2 appends logs from S2| logLen:                                        
                                       41[AppendEntry]                                                            
                                                                             S2|T2 replica entries to S1|         
                                                                             entrylen:0| matchidx:40| nextidx:41  
                                                                             S2 is disconnected                   
                                       S1|T2 is not leader                                                        
S0|T2 is not leader                                                                                               
S0|T2 is not leader                                                                                               
                                       S1|T2 is not leader                                                        
                                       S1|T2 is not leader                                                        
S0|T2 is not leader                                                                                               
S0|T2 is not leader                                                                                               
                                       S1|T2 is not leader                                                        
S0|T2 is not leader                                                                                               
                                       S1|T2 is not leader                                                        
S0|T3 starts to join election                                                                                     
S0|T3 save persist| votedFor: 0|                                                                                  
logsLen: 41                                                                                                       
                                       S1|T3 save persist| votedFor: -1|                                          
                                       logsLen: 41                                                                
                                       S1|T3 save persist| votedFor: 0|                                           
                                       logsLen: 41                                                                
                                       S1|T3 votes for S0[RequestVote]                                            
S0|T3 becomes the leader, and starts                                                                              
heatbeats                                                                                                         
                                       S1|T3 save persist| votedFor: 0|                                           
                                       logsLen: 41                                                                
                                       S1|T3 appends logs from S0| logLen:                                        
                                       41[AppendEntry]                                                            
                                       S1|T3 is not leader                                                        
S0|T3 save persist| votedFor: 0|                                                                                  
logsLen: 42                                                                                                       
S0|T3 receive commands | logLen:                                                                                  
42[Start]                                                                                                         
                                       S1|T3 save persist| votedFor: 0|                                           
                                       logsLen: 41                                                                
                                       S1|T3 appends logs from S0| logLen:                                        
                                       41[AppendEntry]                                                            
S0|T3 replica entries to S1|                                                                                      
entrylen:0| matchidx:40| nextidx:41                                                                               
                                       S1|T3 is not leader                                                        
                                       S1|T3 save persist| votedFor: 0|                                           
                                       logsLen: 42                                                                
                                       S1|T3 appends logs from S0| logLen:                                        
                                       42[AppendEntry]                                                            
S0|T3 replica entries to S1|                                                                                      
entrylen:1| matchidx:41| nextidx:42                                                                               
S0|T3 update commitIndex as 41                                                                                    
S0|T3 starts to apply entries                                                                                     
[41:41][ApplyEntry]                                                                                               
S0|T3 finishes applying entries                                                                                   
[41:41][ApplyEntry]                                                                                               
                                       S1|T3 is not leader                                                        
                                       S1|T3 save persist| votedFor: 0|                                           
                                       logsLen: 42                                                                
                                       S1|T3 appends logs from S0| logLen:                                        
                                       42[AppendEntry]                                                            
                                       S1|T3 starts to apply entries                                              
                                       [41:41][ApplyEntry]                                                        
                                       S1|T3 finishes applying entries                                            
                                       [41:41][ApplyEntry]                                                        
S0|T3 replica entries to S1|                                                                                      
entrylen:0| matchidx:41| nextidx:42                                                                               
S0|T3 save persist| votedFor: 0|                                                                                  
logsLen: 43                                                                                                       
S0|T3 receive commands | logLen:                                                                                  
43[Start]                                                                                                         
S0|T3 save persist| votedFor: 0|                                                                                  
logsLen: 44                                                                                                       
S0|T3 receive commands | logLen:                                                                                  
44[Start]                                                                                                         
S0|T3 save persist| votedFor: 0|                                                                                  
logsLen: 45                                                                                                       
S0|T3 receive commands | logLen:                                                                                  
45[Start]                                                                                                         
S0|T3 save persist| votedFor: 0|                                                                                  
logsLen: 46                                                                                                       
S0|T3 receive commands | logLen:                                                                                  
46[Start]                                                                                                         
S0|T3 save persist| votedFor: 0|                                                                                  
logsLen: 47                                                                                                       
S0|T3 receive commands | logLen:                                                                                  
47[Start]                                                                                                         
S0|T3 save persist| votedFor: 0|                                                                                  
logsLen: 48                                                                                                       
S0|T3 receive commands | logLen:                                                                                  
48[Start]                                                                                                         
S0|T3 save persist| votedFor: 0|                                                                                  
logsLen: 49                                                                                                       
S0|T3 receive commands | logLen:                                                                                  
49[Start]                                                                                                         
S0|T3 save persist| votedFor: 0|                                                                                  
logsLen: 50                                                                                                       
S0|T3 receive commands | logLen:                                                                                  
50[Start]                                                                                                         
S0|T3 save persist| votedFor: 0|                                                                                  
logsLen: 51                                                                                                       
S0|T3 receive commands | logLen:                                                                                  
51[Start]                                                                                                         
S0|T3 save persist| votedFor: 0|                                                                                  
logsLen: 52                                                                                                       
S0|T3 receive commands | logLen:                                                                                  
52[Start]                                                                                                         
S0|T3 save persist| votedFor: 0|                                                                                  
logsLen: 53                                                                                                       
S0|T3 receive commands | logLen:                                                                                  
53[Start]                                                                                                         
                                       S1|T3 is not leader                                                        
                                       S1|T3 save persist| votedFor: 0|                                           
                                       logsLen: 53                                                                
                                       S1|T3 appends logs from S0| logLen:                                        
                                       53[AppendEntry]                                                            
                                       S1|T3 is not leader                                                        
                                       S1|T3 save persist| votedFor: 0|                                           
                                       logsLen: 53                                                                
                                       S1|T3 appends logs from S0| logLen:                                        
                                       53[AppendEntry]                                                            
S0|T3 replica entries to S1|                                                                                      
entrylen:11| matchidx:52| nextidx:53                                                                              
S0|T3 update commitIndex as 52                                                                                    
S0|T3 starts to apply entries                                                                                     
[42:52][ApplyEntry]                                                                                               
S0|T3 Snapshot until index 49| logLen:                                                                            
53                                                                                                                
S0|T3 finishes applying entries                                                                                   
[42:52][ApplyEntry]                                                                                               
S0|T3 send rpc to S2|base: 49| next:                                                                              
41                                                                                                                
                                       S1|T3 is not leader                                                        
                                       S1|T3 save persist| votedFor: 0|                                           
                                       logsLen: 53                                                                
                                       S1|T3 appends logs from S0| logLen:                                        
                                       53[AppendEntry]                                                            
                                       S1|T3 starts to apply entries                                              
                                       [42:52][ApplyEntry]                                                        
S0|T3 replica entries to S1|                                                                                      
entrylen:0| matchidx:52| nextidx:53                                                                               
                                       S1|T3 Snapshot until index 49|                                             
                                       logLen: 53                                                                 
                                       S1|T3 finishes applying entries                                            
                                       [42:52][ApplyEntry]                                                        
                                                                             S2 is connected again                
                                                                             S2|T2 save persist| votedFor: 2|     
                                                                             logsLen: 42                          
                                                                             S2|T2 receive commands | logLen:     
                                                                             42[Start]                            
S0|T3 fails to install snapshot to S2                                                                             
                                       S1|T3 is not leader                                                        
S0|T3 send rpc to S2|base: 49| next:                                                                              
41                                                                                                                
                                       S1|T3 save persist| votedFor: 0|                                           
                                       logsLen: 53                                                                
                                       S1|T3 appends logs from S0| logLen:                                        
                                       53[AppendEntry]                                                            
S0|T3 replica entries to S1|                                                                                      
entrylen:0| matchidx:52| nextidx:53                                                                               
                                       S1|T3 rejects to append entries from                                       
                                       S2 | out of date term[AppendEntry]                                         
                                                                             S2|T3 save persist| votedFor: -1|    
                                                                             logsLen: 42                          
S0|T3 rejects to append entries from                                                                              
S2 | out of date term[AppendEntry]                                                                                
                                                                             S2|T3 lost leadership, state: 0      
                                                                             S2|T3 receive rpc from S0            
                                                                             S2|T3 update rfstate| Base:49|       
                                                                             LogLen:50                            
                                                                             S2|T3 applys snapshot from S0        
S0|T3 installs snapshot to S2|                                                                                    
nextId:50| matchId:49                                                                                             
                                                                             S2|T3 is not leader                  
                                       S1|T3 is not leader                                                        
                                       S1|T3 save persist| votedFor: 0|                                           
                                       logsLen: 53                                                                
                                       S1|T3 appends logs from S0| logLen:                                        
                                       53[AppendEntry]                                                            
S0|T3 replica entries to S1|                                                                                      
entrylen:0| matchidx:52| nextidx:53                                                                               
                                                                             S2|T3 save persist| votedFor: -1|    
                                                                             logsLen: 53                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             53[AppendEntry]                      
                                                                             S2|T3 starts to apply entries        
                                                                             [50:52][ApplyEntry]                  
                                                                             S2|T3 finishes applying entries      
                                                                             [50:52][ApplyEntry]                  
S0|T3 replica entries to S2|                                                                                      
entrylen:3| matchidx:52| nextidx:53                                                                               
                                                                             S2|T3 is not leader                  
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 save persist| votedFor: -1|    
                                                                             logsLen: 53                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             53[AppendEntry]                      
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:52| nextidx:53                                                                               
                                       S1|T3 save persist| votedFor: 0|                                           
                                       logsLen: 53                                                                
                                       S1|T3 appends logs from S0| logLen:                                        
                                       53[AppendEntry]                                                            
S0|T3 replica entries to S1|                                                                                      
entrylen:0| matchidx:52| nextidx:53                                                                               
                                                                             S2|T3 is not leader                  
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 save persist| votedFor: -1|    
                                                                             logsLen: 53                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             53[AppendEntry]                      
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:52| nextidx:53                                                                               
                                       S1|T3 save persist| votedFor: 0|                                           
                                       logsLen: 53                                                                
                                       S1|T3 appends logs from S0| logLen:                                        
                                       53[AppendEntry]                                                            
S0|T3 replica entries to S1|                                                                                      
entrylen:0| matchidx:52| nextidx:53                                                                               
                                                                             S2|T3 is not leader                  
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 save persist| votedFor: -1|    
                                                                             logsLen: 53                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             53[AppendEntry]                      
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:52| nextidx:53                                                                               
                                                                             S2|T3 is not leader                  
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 save persist| votedFor: -1|    
                                                                             logsLen: 53                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             53[AppendEntry]                      
                                       S1|T3 save persist| votedFor: 0|                                           
                                       logsLen: 53                                                                
                                       S1|T3 appends logs from S0| logLen:                                        
                                       53[AppendEntry]                                                            
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:52| nextidx:53                                                                               
S0|T3 replica entries to S1|                                                                                      
entrylen:0| matchidx:52| nextidx:53                                                                               
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 is not leader                  
                                       S1|T3 save persist| votedFor: 0|                                           
                                       logsLen: 53                                                                
                                       S1|T3 appends logs from S0| logLen:                                        
                                       53[AppendEntry]                                                            
S0|T3 replica entries to S1|                                                                                      
entrylen:0| matchidx:52| nextidx:53                                                                               
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 is not leader                  
                                       S1|T3 save persist| votedFor: 0|                                           
                                       logsLen: 53                                                                
                                       S1|T3 appends logs from S0| logLen:                                        
                                       53[AppendEntry]                                                            
S0|T3 replica entries to S1|                                                                                      
entrylen:0| matchidx:52| nextidx:53                                                                               
                                                                             S2|T3 save persist| votedFor: -1|    
                                                                             logsLen: 53                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             53[AppendEntry]                      
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:52| nextidx:53                                                                               
                                                                             S2|T3 is not leader                  
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 save persist| votedFor: -1|    
                                                                             logsLen: 53                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             53[AppendEntry]                      
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:52| nextidx:53                                                                               
                                       S1|T3 save persist| votedFor: 0|                                           
                                       logsLen: 53                                                                
                                       S1|T3 appends logs from S0| logLen:                                        
                                       53[AppendEntry]                                                            
S0|T3 replica entries to S1|                                                                                      
entrylen:0| matchidx:52| nextidx:53                                                                               
                                                                             S2|T3 is not leader                  
                                       S1|T3 is not leader                                                        
                                       S1|T3 save persist| votedFor: 0|                                           
                                       logsLen: 53                                                                
                                       S1|T3 appends logs from S0| logLen:                                        
                                       53[AppendEntry]                                                            
S0|T3 replica entries to S1|                                                                                      
entrylen:0| matchidx:52| nextidx:53                                                                               
                                                                             S2|T3 save persist| votedFor: -1|    
                                                                             logsLen: 53                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             53[AppendEntry]                      
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 is not leader                  
                                                                             S2|T3 save persist| votedFor: -1|    
                                                                             logsLen: 53                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             53[AppendEntry]                      
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:52| nextidx:53                                                                               
                                       S1|T3 save persist| votedFor: 0|                                           
                                       logsLen: 53                                                                
                                       S1|T3 appends logs from S0| logLen:                                        
                                       53[AppendEntry]                                                            
S0|T3 replica entries to S1|                                                                                      
entrylen:0| matchidx:52| nextidx:53                                                                               
                                                                             S2|T3 is not leader                  
                                       S1|T3 is not leader                                                        
                                       S1|T3 save persist| votedFor: 0|                                           
                                       logsLen: 53                                                                
                                       S1|T3 appends logs from S0| logLen:                                        
                                       53[AppendEntry]                                                            
S0|T3 replica entries to S1|                                                                                      
entrylen:0| matchidx:52| nextidx:53                                                                               
                                                                             S2|T3 is not leader                  
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 save persist| votedFor: -1|    
                                                                             logsLen: 53                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             53[AppendEntry]                      
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:52| nextidx:53                                                                               
                                       S1|T3 save persist| votedFor: 0|                                           
                                       logsLen: 53                                                                
                                       S1|T3 appends logs from S0| logLen:                                        
                                       53[AppendEntry]                                                            
S0|T3 replica entries to S1|                                                                                      
entrylen:0| matchidx:52| nextidx:53                                                                               
                                                                             S2|T3 is not leader                  
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 save persist| votedFor: -1|    
                                                                             logsLen: 53                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             53[AppendEntry]                      
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:52| nextidx:53                                                                               
                                       S1|T3 save persist| votedFor: 0|                                           
                                       logsLen: 53                                                                
                                       S1|T3 appends logs from S0| logLen:                                        
                                       53[AppendEntry]                                                            
S0|T3 replica entries to S1|                                                                                      
entrylen:0| matchidx:52| nextidx:53                                                                               
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 is not leader                  
                                       S1|T3 save persist| votedFor: 0|                                           
                                       logsLen: 53                                                                
                                       S1|T3 appends logs from S0| logLen:                                        
                                       53[AppendEntry]                                                            
                                                                             S2|T3 save persist| votedFor: -1|    
                                                                             logsLen: 53                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             53[AppendEntry]                      
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:52| nextidx:53                                                                               
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 is not leader                  
                                       S1|T3 save persist| votedFor: 0|                                           
                                       logsLen: 53                                                                
                                       S1|T3 appends logs from S0| logLen:                                        
                                       53[AppendEntry]                                                            
S0|T3 replica entries to S1|                                                                                      
entrylen:0| matchidx:52| nextidx:53                                                                               
                                                                             S2|T3 is not leader                  
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 save persist| votedFor: -1|    
                                                                             logsLen: 53                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             53[AppendEntry]                      
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:52| nextidx:53                                                                               
                                       S1|T3 save persist| votedFor: 0|                                           
                                       logsLen: 53                                                                
                                       S1|T3 appends logs from S0| logLen:                                        
                                       53[AppendEntry]                                                            
S0|T3 replica entries to S1|                                                                                      
entrylen:0| matchidx:52| nextidx:53                                                                               
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 is not leader                  
                                                                             S2|T3 save persist| votedFor: -1|    
                                                                             logsLen: 53                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             53[AppendEntry]                      
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:52| nextidx:53                                                                               
                                       S1|T3 save persist| votedFor: 0|                                           
                                       logsLen: 53                                                                
                                       S1|T3 appends logs from S0| logLen:                                        
                                       53[AppendEntry]                                                            
S0|T3 replica entries to S1|                                                                                      
entrylen:0| matchidx:52| nextidx:53                                                                               
                                                                             S2|T3 is not leader                  
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 save persist| votedFor: -1|    
                                                                             logsLen: 53                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             53[AppendEntry]                      
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:52| nextidx:53                                                                               
                                       S1|T3 save persist| votedFor: 0|                                           
                                       logsLen: 53                                                                
                                       S1|T3 appends logs from S0| logLen:                                        
                                       53[AppendEntry]                                                            
S0|T3 replica entries to S1|                                                                                      
entrylen:0| matchidx:52| nextidx:53                                                                               
                                                                             S2|T3 is not leader                  
                                       S1|T3 is not leader                                                        
                                       S1|T3 save persist| votedFor: 0|                                           
                                       logsLen: 53                                                                
                                       S1|T3 appends logs from S0| logLen:                                        
                                       53[AppendEntry]                                                            
S0|T3 replica entries to S1|                                                                                      
entrylen:0| matchidx:52| nextidx:53                                                                               
S0|T3 save persist| votedFor: 0|                                                                                  
logsLen: 54                                                                                                       
S0|T3 receive commands | logLen:                                                                                  
54[Start]                                                                                                         
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 is not leader                  
                                       S1|T3 save persist| votedFor: 0|                                           
                                       logsLen: 54                                                                
                                       S1|T3 appends logs from S0| logLen:                                        
                                       54[AppendEntry]                                                            
S0|T3 replica entries to S1|                                                                                      
entrylen:1| matchidx:53| nextidx:54                                                                               
S0|T3 update commitIndex as 53                                                                                    
S0|T3 starts to apply entries                                                                                     
[53:53][ApplyEntry]                                                                                               
S0|T3 finishes applying entries                                                                                   
[53:53][ApplyEntry]                                                                                               
                                                                             S2|T3 save persist| votedFor: -1|    
                                                                             logsLen: 54                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             54[AppendEntry]                      
S0|T3 replica entries to S2|                                                                                      
entrylen:1| matchidx:53| nextidx:54                                                                               
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 is not leader                  
                                                                             S2|T3 save persist| votedFor: -1|    
                                                                             logsLen: 54                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             54[AppendEntry]                      
                                                                             S2|T3 starts to apply entries        
                                                                             [53:53][ApplyEntry]                  
                                                                             S2|T3 finishes applying entries      
                                                                             [53:53][ApplyEntry]                  
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:53| nextidx:54                                                                               
                                       S1|T3 save persist| votedFor: 0|                                           
                                       logsLen: 54                                                                
                                       S1|T3 appends logs from S0| logLen:                                        
                                       54[AppendEntry]                                                            
                                       S1|T3 starts to apply entries                                              
                                       [53:53][ApplyEntry]                                                        
                                       S1|T3 finishes applying entries                                            
                                       [53:53][ApplyEntry]                                                        
S0|T3 replica entries to S1|                                                                                      
entrylen:0| matchidx:53| nextidx:54                                                                               
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 is not leader                  
                                                                             S2|T3 save persist| votedFor: -1|    
                                                                             logsLen: 54                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             54[AppendEntry]                      
                                       S1|T3 save persist| votedFor: 0|                                           
                                       logsLen: 54                                                                
                                       S1|T3 appends logs from S0| logLen:                                        
                                       54[AppendEntry]                                                            
S0|T3 replica entries to S1|                                                                                      
entrylen:0| matchidx:53| nextidx:54                                                                               
                                                                             S2|T3 fails to install snapshot to S0
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 is not leader                  
                                                                             S2|T3 save persist| votedFor: -1|    
                                                                             logsLen: 54                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             54[AppendEntry]                      
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:53| nextidx:54                                                                               
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 is not leader                  
                                       S1|T3 save persist| votedFor: 0|                                           
                                       logsLen: 54                                                                
                                       S1|T3 appends logs from S0| logLen:                                        
                                       54[AppendEntry]                                                            
S0|T3 replica entries to S1|                                                                                      
entrylen:0| matchidx:53| nextidx:54                                                                               
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 is not leader                  
                                                                             S2|T3 save persist| votedFor: -1|    
                                                                             logsLen: 54                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             54[AppendEntry]                      
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:53| nextidx:54                                                                               
                                       S1|T3 save persist| votedFor: 0|                                           
                                       logsLen: 54                                                                
                                       S1|T3 appends logs from S0| logLen:                                        
                                       54[AppendEntry]                                                            
S0|T3 replica entries to S1|                                                                                      
entrylen:0| matchidx:53| nextidx:54                                                                               
                                                                             S2|T3 is not leader                  
                                       S1|T3 is not leader                                                        
                                       S1|T3 save persist| votedFor: 0|                                           
                                       logsLen: 54                                                                
                                       S1|T3 appends logs from S0| logLen:                                        
                                       54[AppendEntry]                                                            
                                                                             S2|T3 save persist| votedFor: -1|    
                                                                             logsLen: 54                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             54[AppendEntry]                      
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:53| nextidx:54                                                                               
                                       S1 is disconnected                                                         
S0|T3 save persist| votedFor: 0|                                                                                  
logsLen: 55                                                                                                       
S0|T3 receive commands | logLen:                                                                                  
55[Start]                                                                                                         
                                                                             S2|T3 is not leader                  
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 save persist| votedFor: -1|    
                                                                             logsLen: 55                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             55[AppendEntry]                      
S0|T3 replica entries to S2|                                                                                      
entrylen:1| matchidx:54| nextidx:55                                                                               
S0|T3 update commitIndex as 54                                                                                    
S0|T3 starts to apply entries                                                                                     
[54:54][ApplyEntry]                                                                                               
S0|T3 finishes applying entries                                                                                   
[54:54][ApplyEntry]                                                                                               
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 is not leader                  
                                                                             S2|T3 save persist| votedFor: -1|    
                                                                             logsLen: 55                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             55[AppendEntry]                      
                                                                             S2|T3 starts to apply entries        
                                                                             [54:54][ApplyEntry]                  
                                                                             S2|T3 finishes applying entries      
                                                                             [54:54][ApplyEntry]                  
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:54| nextidx:55                                                                               
S0|T3 save persist| votedFor: 0|                                                                                  
logsLen: 56                                                                                                       
S0|T3 receive commands | logLen:                                                                                  
56[Start]                                                                                                         
S0|T3 save persist| votedFor: 0|                                                                                  
logsLen: 57                                                                                                       
S0|T3 receive commands | logLen:                                                                                  
57[Start]                                                                                                         
S0|T3 save persist| votedFor: 0|                                                                                  
logsLen: 58                                                                                                       
S0|T3 receive commands | logLen:                                                                                  
58[Start]                                                                                                         
S0|T3 save persist| votedFor: 0|                                                                                  
logsLen: 59                                                                                                       
S0|T3 receive commands | logLen:                                                                                  
59[Start]                                                                                                         
S0|T3 save persist| votedFor: 0|                                                                                  
logsLen: 60                                                                                                       
S0|T3 receive commands | logLen:                                                                                  
60[Start]                                                                                                         
S0|T3 save persist| votedFor: 0|                                                                                  
logsLen: 61                                                                                                       
S0|T3 receive commands | logLen:                                                                                  
61[Start]                                                                                                         
S0|T3 save persist| votedFor: 0|                                                                                  
logsLen: 62                                                                                                       
S0|T3 receive commands | logLen:                                                                                  
62[Start]                                                                                                         
S0|T3 save persist| votedFor: 0|                                                                                  
logsLen: 63                                                                                                       
S0|T3 receive commands | logLen:                                                                                  
63[Start]                                                                                                         
S0|T3 save persist| votedFor: 0|                                                                                  
logsLen: 64                                                                                                       
S0|T3 receive commands | logLen:                                                                                  
64[Start]                                                                                                         
S0|T3 save persist| votedFor: 0|                                                                                  
logsLen: 65                                                                                                       
S0|T3 receive commands | logLen:                                                                                  
65[Start]                                                                                                         
S0|T3 save persist| votedFor: 0|                                                                                  
logsLen: 66                                                                                                       
S0|T3 receive commands | logLen:                                                                                  
66[Start]                                                                                                         
S0|T3 save persist| votedFor: 0|                                                                                  
logsLen: 67                                                                                                       
S0|T3 receive commands | logLen:                                                                                  
67[Start]                                                                                                         
S0|T3 save persist| votedFor: 0|                                                                                  
logsLen: 68                                                                                                       
S0|T3 receive commands | logLen:                                                                                  
68[Start]                                                                                                         
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 is not leader                  
                                                                             S2|T3 is not leader                  
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 save persist| votedFor: -1|    
                                                                             logsLen: 68                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             68[AppendEntry]                      
S0|T3 replica entries to S2|                                                                                      
entrylen:13| matchidx:67| nextidx:68                                                                              
S0|T3 update commitIndex as 67                                                                                    
S0|T3 starts to apply entries                                                                                     
[55:67][ApplyEntry]                                                                                               
S0|T3 Snapshot until index 59| logLen:                                                                            
68                                                                                                                
S0|T3 finishes applying entries                                                                                   
[55:67][ApplyEntry]                                                                                               
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 is not leader                  
S0|T3 send rpc to S1|base: 59| next:                                                                              
54                                                                                                                
                                                                             S2|T3 save persist| votedFor: -1|    
                                                                             logsLen: 68                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             68[AppendEntry]                      
                                                                             S2|T3 starts to apply entries        
                                                                             [55:67][ApplyEntry]                  
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:67| nextidx:68                                                                               
                                                                             S2|T3 Snapshot until index 59|       
                                                                             logLen: 68                           
                                                                             S2|T3 finishes applying entries      
                                                                             [55:67][ApplyEntry]                  
                                       S1 is connected again                                                      
S0|T3 save persist| votedFor: 0|                                                                                  
logsLen: 69                                                                                                       
S0|T3 receive commands | logLen:                                                                                  
69[Start]                                                                                                         
                                                                             S2|T3 is not leader                  
                                       S1|T3 is not leader                                                        
S0|T3 send rpc to S1|base: 59| next:                                                                              
54                                                                                                                
                                                                             S2|T3 save persist| votedFor: -1|    
                                                                             logsLen: 69                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             69[AppendEntry]                      
S0|T3 replica entries to S2|                                                                                      
entrylen:1| matchidx:68| nextidx:69                                                                               
S0|T3 update commitIndex as 68                                                                                    
S0|T3 starts to apply entries                                                                                     
[68:68][ApplyEntry]                                                                                               
S0|T3 finishes applying entries                                                                                   
[68:68][ApplyEntry]                                                                                               
                                       S1|T3 receive rpc from S0                                                  
                                       S1|T3 update rfstate| Base:59|                                             
                                       LogLen:60                                                                  
                                       S1|T3 applys snapshot from S0                                              
S0|T3 fails to install snapshot to S1                                                                             
                                                                             S2|T3 is not leader                  
                                       S1|T3 is not leader                                                        
S0|T3 send rpc to S1|base: 59| next:                                                                              
54                                                                                                                
                                       S1|T3 receive rpc from S0                                                  
                                       S1|T3 rejects to installsnap from S0                                       
                                       | out of date term                                                         
S0|T3 installs snapshot to S1|                                                                                    
nextId:60| matchId:59                                                                                             
                                                                             S2|T3 save persist| votedFor: -1|    
                                                                             logsLen: 69                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             69[AppendEntry]                      
                                                                             S2|T3 starts to apply entries        
                                                                             [68:68][ApplyEntry]                  
                                                                             S2|T3 finishes applying entries      
                                                                             [68:68][ApplyEntry]                  
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:68| nextidx:69                                                                               
                                                                             S2|T3 is not leader                  
                                       S1|T3 is not leader                                                        
                                       S1|T3 save persist| votedFor: 0|                                           
                                       logsLen: 69                                                                
                                       S1|T3 appends logs from S0| logLen:                                        
                                       69[AppendEntry]                                                            
                                       S1|T3 starts to apply entries                                              
                                       [60:68][ApplyEntry]                                                        
                                       S1|T3 finishes applying entries                                            
                                       [60:68][ApplyEntry]                                                        
S0|T3 replica entries to S1|                                                                                      
entrylen:9| matchidx:68| nextidx:69                                                                               
                                                                             S2|T3 save persist| votedFor: -1|    
                                                                             logsLen: 69                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             69[AppendEntry]                      
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:68| nextidx:69                                                                               
                                                                             S2|T3 is not leader                  
                                       S1|T3 is not leader                                                        
                                       S1|T3 save persist| votedFor: 0|                                           
                                       logsLen: 69                                                                
                                       S1|T3 appends logs from S0| logLen:                                        
                                       69[AppendEntry]                                                            
S0|T3 replica entries to S1|                                                                                      
entrylen:0| matchidx:68| nextidx:69                                                                               
                                                                             S2|T3 save persist| votedFor: -1|    
                                                                             logsLen: 69                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             69[AppendEntry]                      
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:68| nextidx:69                                                                               
                                                                             S2|T3 is not leader                  
                                       S1|T3 is not leader                                                        
                                       S1|T3 save persist| votedFor: 0|                                           
                                       logsLen: 69                                                                
                                       S1|T3 appends logs from S0| logLen:                                        
                                       69[AppendEntry]                                                            
S0|T3 replica entries to S1|                                                                                      
entrylen:0| matchidx:68| nextidx:69                                                                               
                                                                             S2|T3 save persist| votedFor: -1|    
                                                                             logsLen: 69                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             69[AppendEntry]                      
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:68| nextidx:69                                                                               
                                                                             S2|T3 is not leader                  
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 save persist| votedFor: -1|    
                                                                             logsLen: 69                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             69[AppendEntry]                      
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:68| nextidx:69                                                                               
                                       S1|T3 save persist| votedFor: 0|                                           
                                       logsLen: 69                                                                
                                       S1|T3 appends logs from S0| logLen:                                        
                                       69[AppendEntry]                                                            
S0|T3 replica entries to S1|                                                                                      
entrylen:0| matchidx:68| nextidx:69                                                                               
                                                                             S2|T3 fails to install snapshot to S0
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 is not leader                  
                                                                             S2|T3 save persist| votedFor: -1|    
                                                                             logsLen: 69                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             69[AppendEntry]                      
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:68| nextidx:69                                                                               
                                       S1|T3 save persist| votedFor: 0|                                           
                                       logsLen: 69                                                                
                                       S1|T3 appends logs from S0| logLen:                                        
                                       69[AppendEntry]                                                            
S0|T3 replica entries to S1|                                                                                      
entrylen:0| matchidx:68| nextidx:69                                                                               
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 is not leader                  
                                       S1|T3 save persist| votedFor: 0|                                           
                                       logsLen: 69                                                                
                                       S1|T3 appends logs from S0| logLen:                                        
                                       69[AppendEntry]                                                            
                                                                             S2|T3 save persist| votedFor: -1|    
                                                                             logsLen: 69                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             69[AppendEntry]                      
                                       S1 is disconnected                                                         
S0|T3 save persist| votedFor: 0|                                                                                  
logsLen: 70                                                                                                       
S0|T3 receive commands | logLen:                                                                                  
70[Start]                                                                                                         
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 is not leader                  
                                                                             S2|T3 save persist| votedFor: -1|    
                                                                             logsLen: 70                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             70[AppendEntry]                      
S0|T3 replica entries to S2|                                                                                      
entrylen:1| matchidx:69| nextidx:70                                                                               
S0|T3 update commitIndex as 69                                                                                    
S0|T3 starts to apply entries                                                                                     
[69:69][ApplyEntry]                                                                                               
S0|T3 finishes applying entries                                                                                   
[69:69][ApplyEntry]                                                                                               
S0|T3 Snapshot until index 69| logLen:                                                                            
70                                                                                                                
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 is not leader                  
S0|T3 send rpc to S1|base: 69| next:                                                                              
69                                                                                                                
                                                                             S2|T3 is not leader                  
S0|T3 send rpc to S1|base: 69| next:                                                                              
69                                                                                                                
                                       S1|T3 is not leader                                                        
                                                                             S2|T3 save persist| votedFor: -1|    
                                                                             logsLen: 70                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             70[AppendEntry]                      
                                                                             S2|T3 starts to apply entries        
                                                                             [69:69][ApplyEntry]                  
                                                                             S2|T3 finishes applying entries      
                                                                             [69:69][ApplyEntry]                  
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:69| nextidx:70                                                                               
                                                                             S2|T3 Snapshot until index 69|       
                                                                             logLen: 70                           
S0|T3 save persist| votedFor: 0|                                                                                  
logsLen: 71                                                                                                       
S0|T3 receive commands | logLen:                                                                                  
71[Start]                                                                                                         
S0|T3 save persist| votedFor: 0|                                                                                  
logsLen: 72                                                                                                       
S0|T3 receive commands | logLen:                                                                                  
72[Start]                                                                                                         
S0|T3 save persist| votedFor: 0|                                                                                  
logsLen: 73                                                                                                       
S0|T3 receive commands | logLen:                                                                                  
73[Start]                                                                                                         
S0|T3 save persist| votedFor: 0|                                                                                  
logsLen: 74                                                                                                       
S0|T3 receive commands | logLen:                                                                                  
74[Start]                                                                                                         
S0|T3 save persist| votedFor: 0|                                                                                  
logsLen: 75                                                                                                       
S0|T3 receive commands | logLen:                                                                                  
75[Start]                                                                                                         
S0|T3 save persist| votedFor: 0|                                                                                  
logsLen: 76                                                                                                       
S0|T3 receive commands | logLen:                                                                                  
76[Start]                                                                                                         
S0|T3 save persist| votedFor: 0|                                                                                  
logsLen: 77                                                                                                       
S0|T3 receive commands | logLen:                                                                                  
77[Start]                                                                                                         
S0|T3 save persist| votedFor: 0|                                                                                  
logsLen: 78                                                                                                       
S0|T3 receive commands | logLen:                                                                                  
78[Start]                                                                                                         
                                                                             S2|T3 is not leader                  
                                       S1|T3 is not leader                                                        
S0|T3 send rpc to S1|base: 69| next:                                                                              
69                                                                                                                
                                                                             S2|T3 save persist| votedFor: -1|    
                                                                             logsLen: 78                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             78[AppendEntry]                      
S0|T3 replica entries to S2|                                                                                      
entrylen:8| matchidx:77| nextidx:78                                                                               
S0|T3 update commitIndex as 77                                                                                    
S0|T3 starts to apply entries                                                                                     
[70:77][ApplyEntry]                                                                                               
S0|T3 finishes applying entries                                                                                   
[70:77][ApplyEntry]                                                                                               
                                                                             S2|T3 is not leader                  
                                       S1|T3 is not leader                                                        
S0|T3 send rpc to S1|base: 69| next:                                                                              
69                                                                                                                
                                                                             S2|T3 save persist| votedFor: -1|    
                                                                             logsLen: 78                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             78[AppendEntry]                      
                                                                             S2|T3 starts to apply entries        
                                                                             [70:77][ApplyEntry]                  
                                                                             S2|T3 finishes applying entries      
                                                                             [70:77][ApplyEntry]                  
S0|T3 replica entries to S2|                                                                                      
entrylen:0| matchidx:77| nextidx:78                                                                               
                                       S1 is connected again                                                      
S0|T3 save persist| votedFor: 0|                                                                                  
logsLen: 79                                                                                                       
S0|T3 receive commands | logLen:                                                                                  
79[Start]                                                                                                         
                                                                             S2|T3 is not leader                  
S0|T3 send rpc to S1|base: 69| next:                                                                              
69                                                                                                                
                                       S1|T3 is not leader                                                        
                                       S1|T4 starts to join election                                              
                                       S1|T4 save persist| votedFor: 1|                                           
                                       logsLen: 69                                                                
S0|T4 save persist| votedFor: -1|                                                                                 
logsLen: 79                                                                                                       
S0 rejects to vote for S1 because it                                                                              
has voted or it is more                                                                                           
up-dated[RequestVote]                                                                                             
                                                                             S2|T3 save persist| votedFor: -1|    
                                                                             logsLen: 79                          
                                                                             S2|T3 appends logs from S0| logLen:  
                                                                             79[AppendEntry]                      
S0|T4 lost leadership, state: 0                                                                                   
S0|T4 fails to install snapshot to S1                                                                             
                                                                             S2|T4 save persist| votedFor: -1|    
                                                                             logsLen: 79                          
                                                                             S2 rejects to vote for S1 because it 
                                                                             has voted or it is more              
                                                                             up-dated[RequestVote]                
                                       S1|T4 is not leader                                                        
                                                                             S2|T4 is not leader                  
S0|T4 is not leader                                                                                               
S0|T4 is not leader                                                                                               
                                       S1|T4 is not leader                                                        
                                                                             S2|T4 is not leader                  
                                                                             S2|T4 is not leader                  
                                       S1|T4 is not leader                                                        
S0|T4 is not leader                                                                                               
S0|T5 starts to join election                                                                                     
S0|T5 save persist| votedFor: 0|                                                                                  
logsLen: 79                                                                                                       
                                       S1|T5 save persist| votedFor: -1|                                          
                                       logsLen: 69                                                                
                                       S1|T5 save persist| votedFor: 0|                                           
                                       logsLen: 69                                                                
                                       S1|T5 votes for S0[RequestVote]                                            
S0|T5 becomes the leader, and starts                                                                              
heatbeats                                                                                                         
                                                                             S2|T5 save persist| votedFor: -1|    
                                                                             logsLen: 79                          
                                                                             S2|T5 save persist| votedFor: -1|    
                                                                             logsLen: 79                          
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             79[AppendEntry]                      
S0|T5 replica entries to S2|                                                                                      
entrylen:0| matchidx:78| nextidx:79                                                                               
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 is not leader                  
                                       S1|T5 rejects to append entries from                                       
                                       S0| short log| args.prev:78|                                               
                                       logLen:69                                                                  
S0|T5 send rpc to S1|base: 69| next:                                                                              
69                                                                                                                
                                                                             S2|T5 save persist| votedFor: -1|    
                                                                             logsLen: 79                          
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             79[AppendEntry]                      
S0|T5 replica entries to S2|                                                                                      
entrylen:0| matchidx:78| nextidx:79                                                                               
                                       S1|T5 rejects to append entries from                                       
                                       S0| short log| args.prev:78|                                               
                                       logLen:69                                                                  
S0|T5 send rpc to S1|base: 69| next:                                                                              
69                                                                                                                
                                       S1|T5 receive rpc from S0                                                  
                                       S1|T5 update rfstate| Base:69|                                             
                                       LogLen:70                                                                  
                                       S1|T5 applys snapshot from S0                                              
S0|T5 fails to install snapshot to S1                                                                             
                                       S1|T5 receive rpc from S0                                                  
                                       S1|T5 rejects to installsnap from S0                                       
                                       | out of date term                                                         
S0|T5 installs snapshot to S1|                                                                                    
nextId:70| matchId:69                                                                                             
                                                                             S2|T5 is not leader                  
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 save persist| votedFor: -1|    
                                                                             logsLen: 79                          
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             79[AppendEntry]                      
                                       S1|T5 save persist| votedFor: 0|                                           
                                       logsLen: 79                                                                
                                       S1|T5 appends logs from S0| logLen:                                        
                                       79[AppendEntry]                                                            
                                       S1|T5 starts to apply entries                                              
                                       [70:77][ApplyEntry]                                                        
                                       S1|T5 finishes applying entries                                            
                                       [70:77][ApplyEntry]                                                        
S0|T5 replica entries to S2|                                                                                      
entrylen:0| matchidx:78| nextidx:79                                                                               
S0|T5 replica entries to S1|                                                                                      
entrylen:9| matchidx:78| nextidx:79                                                                               
                                                                             S2|T5 is not leader                  
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 save persist| votedFor: -1|    
                                                                             logsLen: 79                          
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             79[AppendEntry]                      
S0|T5 replica entries to S2|                                                                                      
entrylen:0| matchidx:78| nextidx:79                                                                               
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 is not leader                  
                                       S1|T5 save persist| votedFor: 0|                                           
                                       logsLen: 79                                                                
                                       S1|T5 appends logs from S0| logLen:                                        
                                       79[AppendEntry]                                                            
S0|T5 replica entries to S1|                                                                                      
entrylen:0| matchidx:78| nextidx:79                                                                               
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 is not leader                  
                                       S1|T5 save persist| votedFor: 0|                                           
                                       logsLen: 79                                                                
                                       S1|T5 appends logs from S0| logLen:                                        
                                       79[AppendEntry]                                                            
S0|T5 replica entries to S1|                                                                                      
entrylen:0| matchidx:78| nextidx:79                                                                               
                                                                             S2|T5 save persist| votedFor: -1|    
                                                                             logsLen: 79                          
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             79[AppendEntry]                      
S0|T5 replica entries to S2|                                                                                      
entrylen:0| matchidx:78| nextidx:79                                                                               
                                                                             S2|T5 is not leader                  
                                       S1|T5 is not leader                                                        
                                       S1|T5 save persist| votedFor: 0|                                           
                                       logsLen: 79                                                                
                                       S1|T5 appends logs from S0| logLen:                                        
                                       79[AppendEntry]                                                            
S0|T5 replica entries to S1|                                                                                      
entrylen:0| matchidx:78| nextidx:79                                                                               
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 is not leader                  
                                       S1|T5 save persist| votedFor: 0|                                           
                                       logsLen: 79                                                                
                                       S1|T5 appends logs from S0| logLen:                                        
                                       79[AppendEntry]                                                            
S0|T5 replica entries to S1|                                                                                      
entrylen:0| matchidx:78| nextidx:79                                                                               
                                                                             S2|T5 save persist| votedFor: -1|    
                                                                             logsLen: 79                          
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             79[AppendEntry]                      
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 is not leader                  
                                                                             S2|T5 save persist| votedFor: -1|    
                                                                             logsLen: 79                          
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             79[AppendEntry]                      
S0|T5 replica entries to S2|                                                                                      
entrylen:0| matchidx:78| nextidx:79                                                                               
                                       S1|T5 save persist| votedFor: 0|                                           
                                       logsLen: 79                                                                
                                       S1|T5 appends logs from S0| logLen:                                        
                                       79[AppendEntry]                                                            
S0|T5 replica entries to S1|                                                                                      
entrylen:0| matchidx:78| nextidx:79                                                                               
S0|T5 fails to install snapshot to S1                                                                             
S0|T5 fails to install snapshot to S1                                                                             
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 is not leader                  
                                       S1|T5 save persist| votedFor: 0|                                           
                                       logsLen: 79                                                                
                                       S1|T5 appends logs from S0| logLen:                                        
                                       79[AppendEntry]                                                            
S0|T5 replica entries to S1|                                                                                      
entrylen:0| matchidx:78| nextidx:79                                                                               
                                                                             S2|T5 save persist| votedFor: -1|    
                                                                             logsLen: 79                          
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             79[AppendEntry]                      
S0|T5 replica entries to S2|                                                                                      
entrylen:0| matchidx:78| nextidx:79                                                                               
                                                                             S2|T5 is not leader                  
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 save persist| votedFor: -1|    
                                                                             logsLen: 79                          
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             79[AppendEntry]                      
S0|T5 replica entries to S2|                                                                                      
entrylen:0| matchidx:78| nextidx:79                                                                               
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 is not leader                  
                                                                             S2|T5 save persist| votedFor: -1|    
                                                                             logsLen: 79                          
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             79[AppendEntry]                      
S0|T5 replica entries to S2|                                                                                      
entrylen:0| matchidx:78| nextidx:79                                                                               
                                       S1|T5 save persist| votedFor: 0|                                           
                                       logsLen: 79                                                                
                                       S1|T5 appends logs from S0| logLen:                                        
                                       79[AppendEntry]                                                            
S0|T5 replica entries to S1|                                                                                      
entrylen:0| matchidx:78| nextidx:79                                                                               
                                                                             S2|T5 is not leader                  
                                       S1|T5 is not leader                                                        
                                       S1|T5 save persist| votedFor: 0|                                           
                                       logsLen: 79                                                                
                                       S1|T5 appends logs from S0| logLen:                                        
                                       79[AppendEntry]                                                            
S0|T5 replica entries to S1|                                                                                      
entrylen:0| matchidx:78| nextidx:79                                                                               
                                                                             S2|T5 save persist| votedFor: -1|    
                                                                             logsLen: 79                          
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             79[AppendEntry]                      
S0|T5 replica entries to S2|                                                                                      
entrylen:0| matchidx:78| nextidx:79                                                                               
                                                                             S2|T5 is not leader                  
                                       S1|T5 is not leader                                                        
                                       S1|T5 save persist| votedFor: 0|                                           
                                       logsLen: 79                                                                
                                       S1|T5 appends logs from S0| logLen:                                        
                                       79[AppendEntry]                                                            
S0|T5 replica entries to S1|                                                                                      
entrylen:0| matchidx:78| nextidx:79                                                                               
                                                                             S2|T5 save persist| votedFor: -1|    
                                                                             logsLen: 79                          
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             79[AppendEntry]                      
S0|T5 replica entries to S2|                                                                                      
entrylen:0| matchidx:78| nextidx:79                                                                               
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 is not leader                  
                                                                             S2|T5 save persist| votedFor: -1|    
                                                                             logsLen: 79                          
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             79[AppendEntry]                      
S0|T5 replica entries to S2|                                                                                      
entrylen:0| matchidx:78| nextidx:79                                                                               
                                       S1|T5 save persist| votedFor: 0|                                           
                                       logsLen: 79                                                                
                                       S1|T5 appends logs from S0| logLen:                                        
                                       79[AppendEntry]                                                            
S0|T5 replica entries to S1|                                                                                      
entrylen:0| matchidx:78| nextidx:79                                                                               
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 is not leader                  
                                       S1|T5 save persist| votedFor: 0|                                           
                                       logsLen: 79                                                                
                                       S1|T5 appends logs from S0| logLen:                                        
                                       79[AppendEntry]                                                            
S0|T5 replica entries to S1|                                                                                      
entrylen:0| matchidx:78| nextidx:79                                                                               
                                                                             S2|T5 save persist| votedFor: -1|    
                                                                             logsLen: 79                          
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             79[AppendEntry]                      
S0|T5 replica entries to S2|                                                                                      
entrylen:0| matchidx:78| nextidx:79                                                                               
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 is not leader                  
                                       S1|T5 save persist| votedFor: 0|                                           
                                       logsLen: 79                                                                
                                       S1|T5 appends logs from S0| logLen:                                        
                                       79[AppendEntry]                                                            
S0|T5 replica entries to S1|                                                                                      
entrylen:0| matchidx:78| nextidx:79                                                                               
S0|T5 save persist| votedFor: 0|                                                                                  
logsLen: 80                                                                                                       
S0|T5 receive commands | logLen:                                                                                  
80[Start]                                                                                                         
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 is not leader                  
                                                                             S2|T5 save persist| votedFor: -1|    
                                                                             logsLen: 80                          
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             80[AppendEntry]                      
                                       S1|T5 save persist| votedFor: 0|                                           
                                       logsLen: 80                                                                
                                       S1|T5 appends logs from S0| logLen:                                        
                                       80[AppendEntry]                                                            
S0|T5 replica entries to S1|                                                                                      
entrylen:1| matchidx:79| nextidx:80                                                                               
S0|T5 update commitIndex as 79                                                                                    
S0|T5 starts to apply entries                                                                                     
[78:79][ApplyEntry]                                                                                               
S0|T5 finishes applying entries                                                                                   
[78:79][ApplyEntry]                                                                                               
S0|T5 Snapshot until index 79| logLen:                                                                            
80                                                                                                                
                                       S1|T5 is not leader                                                        
S0|T5 send rpc to S2|base: 79| next:                                                                              
79                                                                                                                
                                                                             S2|T5 is not leader                  
                                                                             S2|T5 receive rpc from S0            
                                                                             S2|T5 update rfstate| Base:79|       
                                                                             LogLen:80                            
                                                                             S2|T5 applys snapshot from S0        
S0|T5 installs snapshot to S2|                                                                                    
nextId:80| matchId:79                                                                                             
                                       S1|T5 save persist| votedFor: 0|                                           
                                       logsLen: 80                                                                
                                       S1|T5 appends logs from S0| logLen:                                        
                                       80[AppendEntry]                                                            
                                       S1|T5 starts to apply entries                                              
                                       [78:79][ApplyEntry]                                                        
                                       S1|T5 finishes applying entries                                            
                                       [78:79][ApplyEntry]                                                        
S0|T5 replica entries to S1|                                                                                      
entrylen:0| matchidx:79| nextidx:80                                                                               
                                       S1|T5 Snapshot until index 79|                                             
                                       logLen: 80                                                                 
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 is not leader                  
                                       S1|T5 save persist| votedFor: 0|                                           
                                       logsLen: 80                                                                
                                       S1|T5 appends logs from S0| logLen:                                        
                                       80[AppendEntry]                                                            
                                                                             S2|T5 save persist| votedFor: -1|    
                                                                             logsLen: 80                          
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             80[AppendEntry]                      
S0|T5 replica entries to S1|                                                                                      
entrylen:0| matchidx:79| nextidx:80                                                                               
S0|T5 replica entries to S2|                                                                                      
entrylen:0| matchidx:79| nextidx:80                                                                               
                                                                             S2|T5 is not leader                  
                                       S1|T5 is not leader                                                        
                                       S1|T5 save persist| votedFor: 0|                                           
                                       logsLen: 80                                                                
                                       S1|T5 appends logs from S0| logLen:                                        
                                       80[AppendEntry]                                                            
                                                                             S2|T5 save persist| votedFor: -1|    
                                                                             logsLen: 80                          
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             80[AppendEntry]                      
S0|T5 replica entries to S2|                                                                                      
entrylen:0| matchidx:79| nextidx:80                                                                               
S0|T5 fails to install snapshot to S1                                                                             
                                                                             S2|T5 is not leader                  
                                       S1|T5 is not leader                                                        
                                       S1|T5 save persist| votedFor: 0|                                           
                                       logsLen: 80                                                                
                                       S1|T5 appends logs from S0| logLen:                                        
                                       80[AppendEntry]                                                            
S0|T5 replica entries to S1|                                                                                      
entrylen:0| matchidx:79| nextidx:80                                                                               
                                                                             S2|T5 is not leader                  
                                       S1|T5 is not leader                                                        
                                       S1|T5 save persist| votedFor: 0|                                           
                                       logsLen: 80                                                                
                                       S1|T5 appends logs from S0| logLen:                                        
                                       80[AppendEntry]                                                            
S0|T5 replica entries to S1|                                                                                      
entrylen:0| matchidx:79| nextidx:80                                                                               
                                                                             S2|T5 save persist| votedFor: -1|    
                                                                             logsLen: 80                          
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             80[AppendEntry]                      
S0|T5 replica entries to S2|                                                                                      
entrylen:0| matchidx:79| nextidx:80                                                                               
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 is not leader                  
                                       S1|T5 save persist| votedFor: 0|                                           
                                       logsLen: 80                                                                
                                       S1|T5 appends logs from S0| logLen:                                        
                                       80[AppendEntry]                                                            
                                                                             S2|T5 save persist| votedFor: -1|    
                                                                             logsLen: 80                          
                                                                             S2|T5 appends logs from S0| logLen:  
                                                                             80[AppendEntry]                      
S0|T5 replica entries to S2|                                                                                      
entrylen:0| matchidx:79| nextidx:80                                                                               
S0 is disconnected                                                                                                
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 is not leader                  
                                                                             S2|T5 is not leader                  
                                       S1|T5 is not leader                                                        
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 is not leader                  
                                                                             S2|T5 is not leader                  
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 is not leader                  
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 is not leader                  
                                       S1|T5 is not leader                                                        
                                                                             S2|T5 is not leader                  
                                       S1|T5 is not leader                                                        
                                       S1|T6 starts to join election                                              
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 80                                                                
                                                                             S2|T5 is not leader                  
                                       S1|T6 is not leader                                                        
                                                                             S2|T6 save persist| votedFor: -1|    
                                                                             logsLen: 80                          
                                                                             S2|T6 save persist| votedFor: 1|     
                                                                             logsLen: 80                          
                                                                             S2|T6 votes for S1[RequestVote]      
                                       S1|T6 becomes the leader, and starts                                       
                                       heatbeats                                                                  
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 81                                                                
                                       S1|T6 receive commands | logLen:                                           
                                       81[Start]                                                                  
                                                                             S2|T6 is not leader                  
                                                                             S2|T6 save persist| votedFor: 1|     
                                                                             logsLen: 81                          
                                                                             S2|T6 appends logs from S1| logLen:  
                                                                             81[AppendEntry]                      
                                       S1|T6 replica entries to S2|                                               
                                       entrylen:1| matchidx:80| nextidx:81                                        
                                       S1|T6 update commitIndex as 80                                             
                                       S1|T6 starts to apply entries                                              
                                       [80:80][ApplyEntry]                                                        
                                       S1|T6 finishes applying entries                                            
                                       [80:80][ApplyEntry]                                                        
                                                                             S2|T6 is not leader                  
                                                                             S2|T6 save persist| votedFor: 1|     
                                                                             logsLen: 81                          
                                                                             S2|T6 appends logs from S1| logLen:  
                                                                             81[AppendEntry]                      
                                                                             S2|T6 starts to apply entries        
                                                                             [80:80][ApplyEntry]                  
                                                                             S2|T6 finishes applying entries      
                                                                             [80:80][ApplyEntry]                  
                                       S1|T6 replica entries to S2|                                               
                                       entrylen:0| matchidx:80| nextidx:81                                        
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 82                                                                
                                       S1|T6 receive commands | logLen:                                           
                                       82[Start]                                                                  
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 83                                                                
                                       S1|T6 receive commands | logLen:                                           
                                       83[Start]                                                                  
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 84                                                                
                                       S1|T6 receive commands | logLen:                                           
                                       84[Start]                                                                  
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 85                                                                
                                       S1|T6 receive commands | logLen:                                           
                                       85[Start]                                                                  
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 86                                                                
                                       S1|T6 receive commands | logLen:                                           
                                       86[Start]                                                                  
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 87                                                                
                                       S1|T6 receive commands | logLen:                                           
                                       87[Start]                                                                  
S0|T5 fails to install snapshot to S1                                                                             
                                                                             S2|T6 is not leader                  
                                                                             S2|T6 is not leader                  
                                                                             S2|T6 save persist| votedFor: 1|     
                                                                             logsLen: 87                          
                                                                             S2|T6 appends logs from S1| logLen:  
                                                                             87[AppendEntry]                      
                                                                             S2|T6 is not leader                  
                                                                             S2|T6 save persist| votedFor: 1|     
                                                                             logsLen: 87                          
                                                                             S2|T6 appends logs from S1| logLen:  
                                                                             87[AppendEntry]                      
                                       S1|T6 replica entries to S2|                                               
                                       entrylen:6| matchidx:86| nextidx:87                                        
                                       S1|T6 update commitIndex as 86                                             
                                       S1|T6 starts to apply entries                                              
                                       [81:86][ApplyEntry]                                                        
                                       S1|T6 finishes applying entries                                            
                                       [81:86][ApplyEntry]                                                        
                                                                             S2|T6 is not leader                  
                                                                             S2|T6 save persist| votedFor: 1|     
                                                                             logsLen: 87                          
                                                                             S2|T6 appends logs from S1| logLen:  
                                                                             87[AppendEntry]                      
                                                                             S2|T6 starts to apply entries        
                                                                             [81:86][ApplyEntry]                  
                                                                             S2|T6 finishes applying entries      
                                                                             [81:86][ApplyEntry]                  
                                       S1|T6 replica entries to S2|                                               
                                       entrylen:0| matchidx:86| nextidx:87                                        
S0 is connected again                                                                                             
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 88                                                                
                                       S1|T6 receive commands | logLen:                                           
                                       88[Start]                                                                  
                                                                             S2|T6 is not leader                  
                                                                             S2|T6 rejects to append entries from 
                                                                             S0 | out of date term[AppendEntry]   
                                       S1|T6 rejects to append entries from                                       
                                       S0 | out of date term[AppendEntry]                                         
S0|T6 save persist| votedFor: -1|                                                                                 
logsLen: 80                                                                                                       
S0|T6 lost leadership, state: 0                                                                                   
S0|T6 save persist| votedFor: -1|                                                                                 
logsLen: 88                                                                                                       
S0|T6 appends logs from S1| logLen:                                                                               
88[AppendEntry]                                                                                                   
S0|T6 starts to apply entries                                                                                     
[80:86][ApplyEntry]                                                                                               
S0|T6 finishes applying entries                                                                                   
[80:86][ApplyEntry]                                                                                               
                                       S1|T6 replica entries to S0|                                               
                                       entrylen:8| matchidx:87| nextidx:88                                        
                                       S1|T6 update commitIndex as 87                                             
                                       S1|T6 starts to apply entries                                              
                                       [87:87][ApplyEntry]                                                        
                                       S1|T6 finishes applying entries                                            
                                       [87:87][ApplyEntry]                                                        
S0|T6 is not leader                                                                                               
                                                                             S2|T6 is not leader                  
                                                                             S2|T6 save persist| votedFor: 1|     
                                                                             logsLen: 88                          
                                                                             S2|T6 appends logs from S1| logLen:  
                                                                             88[AppendEntry]                      
                                                                             S2|T6 starts to apply entries        
                                                                             [87:87][ApplyEntry]                  
                                                                             S2|T6 finishes applying entries      
                                                                             [87:87][ApplyEntry]                  
                                       S1|T6 replica entries to S2|                                               
                                       entrylen:1| matchidx:87| nextidx:88                                        
S0|T6 save persist| votedFor: -1|                                                                                 
logsLen: 88                                                                                                       
S0|T6 appends logs from S1| logLen:                                                                               
88[AppendEntry]                                                                                                   
S0|T6 starts to apply entries                                                                                     
[87:87][ApplyEntry]                                                                                               
S0|T6 finishes applying entries                                                                                   
[87:87][ApplyEntry]                                                                                               
                                       S1|T6 replica entries to S0|                                               
                                       entrylen:0| matchidx:87| nextidx:88                                        
                                                                             S2|T6 is not leader                  
S0|T6 is not leader                                                                                               
                                                                             S2|T6 save persist| votedFor: 1|     
                                                                             logsLen: 88                          
                                                                             S2|T6 appends logs from S1| logLen:  
                                                                             88[AppendEntry]                      
S0|T6 save persist| votedFor: -1|                                                                                 
logsLen: 88                                                                                                       
S0|T6 appends logs from S1| logLen:                                                                               
88[AppendEntry]                                                                                                   
                                       S1|T6 replica entries to S0|                                               
                                       entrylen:0| matchidx:87| nextidx:88                                        
                                                                             S2|T6 is not leader                  
S0|T6 is not leader                                                                                               
S0|T6 save persist| votedFor: -1|                                                                                 
logsLen: 88                                                                                                       
S0|T6 appends logs from S1| logLen:                                                                               
88[AppendEntry]                                                                                                   
                                       S1|T6 replica entries to S0|                                               
                                       entrylen:0| matchidx:87| nextidx:88                                        
                                                                             S2|T6 save persist| votedFor: 1|     
                                                                             logsLen: 88                          
                                                                             S2|T6 appends logs from S1| logLen:  
                                                                             88[AppendEntry]                      
                                       S1|T6 replica entries to S2|                                               
                                       entrylen:0| matchidx:87| nextidx:88                                        
                                                                             S2|T6 is not leader                  
S0|T6 is not leader                                                                                               
                                                                             S2|T6 save persist| votedFor: 1|     
                                                                             logsLen: 88                          
                                                                             S2|T6 appends logs from S1| logLen:  
                                                                             88[AppendEntry]                      
                                       S1|T6 replica entries to S2|                                               
                                       entrylen:0| matchidx:87| nextidx:88                                        
S0|T6 save persist| votedFor: -1|                                                                                 
logsLen: 88                                                                                                       
S0|T6 appends logs from S1| logLen:                                                                               
88[AppendEntry]                                                                                                   
                                       S1|T6 replica entries to S0|                                               
                                       entrylen:0| matchidx:87| nextidx:88                                        
                                                                             S2|T6 is not leader                  
S0|T6 is not leader                                                                                               
S0|T6 save persist| votedFor: -1|                                                                                 
logsLen: 88                                                                                                       
S0|T6 appends logs from S1| logLen:                                                                               
88[AppendEntry]                                                                                                   
                                       S1|T6 replica entries to S0|                                               
                                       entrylen:0| matchidx:87| nextidx:88                                        
                                                                             S2|T6 save persist| votedFor: 1|     
                                                                             logsLen: 88                          
                                                                             S2|T6 appends logs from S1| logLen:  
                                                                             88[AppendEntry]                      
                                                                             S2 is disconnected                   
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 89                                                                
                                       S1|T6 receive commands | logLen:                                           
                                       89[Start]                                                                  
                                                                             S2|T6 is not leader                  
S0|T6 is not leader                                                                                               
S0|T6 save persist| votedFor: -1|                                                                                 
logsLen: 89                                                                                                       
S0|T6 appends logs from S1| logLen:                                                                               
89[AppendEntry]                                                                                                   
                                       S1|T6 replica entries to S0|                                               
                                       entrylen:1| matchidx:88| nextidx:89                                        
                                       S1|T6 update commitIndex as 88                                             
                                       S1|T6 starts to apply entries                                              
                                       [88:88][ApplyEntry]                                                        
                                       S1|T6 finishes applying entries                                            
                                       [88:88][ApplyEntry]                                                        
                                                                             S2|T6 is not leader                  
S0|T6 is not leader                                                                                               
S0|T6 save persist| votedFor: -1|                                                                                 
logsLen: 89                                                                                                       
S0|T6 appends logs from S1| logLen:                                                                               
89[AppendEntry]                                                                                                   
S0|T6 starts to apply entries                                                                                     
[88:88][ApplyEntry]                                                                                               
S0|T6 finishes applying entries                                                                                   
[88:88][ApplyEntry]                                                                                               
                                       S1|T6 replica entries to S0|                                               
                                       entrylen:0| matchidx:88| nextidx:89                                        
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 90                                                                
                                       S1|T6 receive commands | logLen:                                           
                                       90[Start]                                                                  
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 91                                                                
                                       S1|T6 receive commands | logLen:                                           
                                       91[Start]                                                                  
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 92                                                                
                                       S1|T6 receive commands | logLen:                                           
                                       92[Start]                                                                  
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 93                                                                
                                       S1|T6 receive commands | logLen:                                           
                                       93[Start]                                                                  
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 94                                                                
                                       S1|T6 receive commands | logLen:                                           
                                       94[Start]                                                                  
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 95                                                                
                                       S1|T6 receive commands | logLen:                                           
                                       95[Start]                                                                  
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 96                                                                
                                       S1|T6 receive commands | logLen:                                           
                                       96[Start]                                                                  
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 97                                                                
                                       S1|T6 receive commands | logLen:                                           
                                       97[Start]                                                                  
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 98                                                                
                                       S1|T6 receive commands | logLen:                                           
                                       98[Start]                                                                  
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 99                                                                
                                       S1|T6 receive commands | logLen:                                           
                                       99[Start]                                                                  
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 100                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       100[Start]                                                                 
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 101                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       101[Start]                                                                 
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 102                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       102[Start]                                                                 
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 103                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       103[Start]                                                                 
S0|T6 is not leader                                                                                               
                                                                             S2|T6 is not leader                  
S0|T6 is not leader                                                                                               
                                                                             S2|T6 is not leader                  
S0|T6 save persist| votedFor: -1|                                                                                 
logsLen: 103                                                                                                      
S0|T6 appends logs from S1| logLen:                                                                               
103[AppendEntry]                                                                                                  
                                       S1|T6 replica entries to S0|                                               
                                       entrylen:14| matchidx:102|                                                 
                                       nextidx:103                                                                
                                       S1|T6 update commitIndex as 102                                            
                                       S1|T6 starts to apply entries                                              
                                       [89:102][ApplyEntry]                                                       
                                       S1|T6 Snapshot until index 89|                                             
                                       logLen: 103                                                                
                                       S1|T6 Snapshot until index 99|                                             
                                       logLen: 103                                                                
                                       S1|T6 finishes applying entries                                            
                                       [89:102][ApplyEntry]                                                       
S0|T6 is not leader                                                                                               
                                                                             S2|T6 is not leader                  
                                       S1|T6 send rpc to S2|base: 99| next:                                       
                                       88                                                                         
S0|T6 save persist| votedFor: -1|                                                                                 
logsLen: 103                                                                                                      
S0|T6 appends logs from S1| logLen:                                                                               
103[AppendEntry]                                                                                                  
S0|T6 starts to apply entries                                                                                     
[89:102][ApplyEntry]                                                                                              
                                       S1|T6 replica entries to S0|                                               
                                       entrylen:0| matchidx:102| nextidx:103                                      
S0|T6 Snapshot until index 89| logLen:                                                                            
103                                                                                                               
S0|T6 Snapshot until index 99| logLen:                                                                            
103                                                                                                               
S0|T6 finishes applying entries                                                                                   
[89:102][ApplyEntry]                                                                                              
                                                                             S2 is connected again                
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 104                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       104[Start]                                                                 
S0|T6 is not leader                                                                                               
                                                                             S2|T6 is not leader                  
                                       S1|T6 send rpc to S2|base: 99| next:                                       
                                       88                                                                         
                                                                             S2|T6 receive rpc from S1            
                                                                             S2|T6 update rfstate| Base:99|       
                                                                             LogLen:100                           
                                                                             S2|T6 applys snapshot from S1        
                                       S1|T6 installs snapshot to S2|                                             
                                       nextId:100| matchId:99                                                     
S0|T6 is not leader                                                                                               
                                                                             S2|T6 is not leader                  
                                                                             S2|T6 save persist| votedFor: 1|     
                                                                             logsLen: 104                         
                                                                             S2|T6 appends logs from S1| logLen:  
                                                                             104[AppendEntry]                     
                                                                             S2|T6 starts to apply entries        
                                                                             [100:102][ApplyEntry]                
                                                                             S2|T6 finishes applying entries      
                                                                             [100:102][ApplyEntry]                
                                       S1|T6 replica entries to S2|                                               
                                       entrylen:4| matchidx:103| nextidx:104                                      
                                       S1|T6 update commitIndex as 103                                            
                                       S1|T6 starts to apply entries                                              
                                       [103:103][ApplyEntry]                                                      
                                       S1|T6 finishes applying entries                                            
                                       [103:103][ApplyEntry]                                                      
S0|T6 save persist| votedFor: -1|                                                                                 
logsLen: 104                                                                                                      
S0|T6 appends logs from S1| logLen:                                                                               
104[AppendEntry]                                                                                                  
                                       S1|T6 replica entries to S0|                                               
                                       entrylen:1| matchidx:103| nextidx:104                                      
S0|T6 is not leader                                                                                               
                                                                             S2|T6 is not leader                  
                                                                             S2|T6 save persist| votedFor: 1|     
                                                                             logsLen: 104                         
                                                                             S2|T6 appends logs from S1| logLen:  
                                                                             104[AppendEntry]                     
                                                                             S2|T6 starts to apply entries        
                                                                             [103:103][ApplyEntry]                
                                                                             S2|T6 finishes applying entries      
                                                                             [103:103][ApplyEntry]                
                                       S1|T6 replica entries to S2|                                               
                                       entrylen:0| matchidx:103| nextidx:104                                      
S0|T6 save persist| votedFor: -1|                                                                                 
logsLen: 104                                                                                                      
S0|T6 appends logs from S1| logLen:                                                                               
104[AppendEntry]                                                                                                  
S0|T6 starts to apply entries                                                                                     
[103:103][ApplyEntry]                                                                                             
S0|T6 finishes applying entries                                                                                   
[103:103][ApplyEntry]                                                                                             
                                       S1|T6 replica entries to S0|                                               
                                       entrylen:0| matchidx:103| nextidx:104                                      
                                                                             S2|T6 is not leader                  
S0|T6 is not leader                                                                                               
                                                                             S2|T6 save persist| votedFor: 1|     
                                                                             logsLen: 104                         
                                                                             S2|T6 appends logs from S1| logLen:  
                                                                             104[AppendEntry]                     
                                       S1|T6 replica entries to S2|                                               
                                       entrylen:0| matchidx:103| nextidx:104                                      
S0|T6 save persist| votedFor: -1|                                                                                 
logsLen: 104                                                                                                      
S0|T6 appends logs from S1| logLen:                                                                               
104[AppendEntry]                                                                                                  
                                       S1|T6 replica entries to S0|                                               
                                       entrylen:0| matchidx:103| nextidx:104                                      
                                                                             S2|T6 is not leader                  
S0|T6 is not leader                                                                                               
                                                                             S2|T6 save persist| votedFor: 1|     
                                                                             logsLen: 104                         
                                                                             S2|T6 appends logs from S1| logLen:  
                                                                             104[AppendEntry]                     
                                       S1|T6 replica entries to S2|                                               
                                       entrylen:0| matchidx:103| nextidx:104                                      
S0|T6 save persist| votedFor: -1|                                                                                 
logsLen: 104                                                                                                      
S0|T6 appends logs from S1| logLen:                                                                               
104[AppendEntry]                                                                                                  
                                       S1|T6 replica entries to S0|                                               
                                       entrylen:0| matchidx:103| nextidx:104                                      
S0|T6 is not leader                                                                                               
                                                                             S2|T6 is not leader                  
                                                                             S2|T6 save persist| votedFor: 1|     
                                                                             logsLen: 104                         
                                                                             S2|T6 appends logs from S1| logLen:  
                                                                             104[AppendEntry]                     
                                       S1|T6 replica entries to S2|                                               
                                       entrylen:0| matchidx:103| nextidx:104                                      
S0|T6 save persist| votedFor: -1|                                                                                 
logsLen: 104                                                                                                      
S0|T6 appends logs from S1| logLen:                                                                               
104[AppendEntry]                                                                                                  
                                       S1|T6 replica entries to S0|                                               
                                       entrylen:0| matchidx:103| nextidx:104                                      
S0|T6 fails to install snapshot to S1                                                                             
                                                                             S2|T6 is not leader                  
S0|T6 is not leader                                                                                               
                                                                             S2|T6 save persist| votedFor: 1|     
                                                                             logsLen: 104                         
                                                                             S2|T6 appends logs from S1| logLen:  
                                                                             104[AppendEntry]                     
S0|T6 save persist| votedFor: -1|                                                                                 
logsLen: 104                                                                                                      
S0|T6 appends logs from S1| logLen:                                                                               
104[AppendEntry]                                                                                                  
                                       S1|T6 replica entries to S0|                                               
                                       entrylen:0| matchidx:103| nextidx:104                                      
S0|T6 is not leader                                                                                               
                                                                             S2|T6 is not leader                  
S0|T6 save persist| votedFor: -1|                                                                                 
logsLen: 104                                                                                                      
S0|T6 appends logs from S1| logLen:                                                                               
104[AppendEntry]                                                                                                  
                                                                             S2|T6 save persist| votedFor: 1|     
                                                                             logsLen: 104                         
                                                                             S2|T6 appends logs from S1| logLen:  
                                                                             104[AppendEntry]                     
                                       S1|T6 replica entries to S0|                                               
                                       entrylen:0| matchidx:103| nextidx:104                                      
                                       S1|T6 replica entries to S2|                                               
                                       entrylen:0| matchidx:103| nextidx:104                                      
                                                                             S2 is disconnected                   
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 105                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       105[Start]                                                                 
                                                                             S2|T6 is not leader                  
S0|T6 is not leader                                                                                               
S0|T6 save persist| votedFor: -1|                                                                                 
logsLen: 105                                                                                                      
S0|T6 appends logs from S1| logLen:                                                                               
105[AppendEntry]                                                                                                  
                                       S1|T6 replica entries to S0|                                               
                                       entrylen:1| matchidx:104| nextidx:105                                      
                                       S1|T6 update commitIndex as 104                                            
                                       S1|T6 starts to apply entries                                              
                                       [104:104][ApplyEntry]                                                      
                                       S1|T6 finishes applying entries                                            
                                       [104:104][ApplyEntry]                                                      
                                                                             S2|T6 is not leader                  
S0|T6 is not leader                                                                                               
S0|T6 save persist| votedFor: -1|                                                                                 
logsLen: 105                                                                                                      
S0|T6 appends logs from S1| logLen:                                                                               
105[AppendEntry]                                                                                                  
S0|T6 starts to apply entries                                                                                     
[104:104][ApplyEntry]                                                                                             
S0|T6 finishes applying entries                                                                                   
[104:104][ApplyEntry]                                                                                             
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 106                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       106[Start]                                                                 
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 107                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       107[Start]                                                                 
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 108                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       108[Start]                                                                 
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 109                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       109[Start]                                                                 
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 110                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       110[Start]                                                                 
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 111                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       111[Start]                                                                 
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 112                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       112[Start]                                                                 
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 113                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       113[Start]                                                                 
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 114                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       114[Start]                                                                 
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 115                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       115[Start]                                                                 
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 116                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       116[Start]                                                                 
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 117                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       117[Start]                                                                 
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 118                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       118[Start]                                                                 
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 119                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       119[Start]                                                                 
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 120                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       120[Start]                                                                 
S0|T6 is not leader                                                                                               
                                                                             S2|T6 is not leader                  
                                                                             S2|T6 is not leader                  
S0|T6 is not leader                                                                                               
S0|T6 save persist| votedFor: -1|                                                                                 
logsLen: 120                                                                                                      
S0|T6 appends logs from S1| logLen:                                                                               
120[AppendEntry]                                                                                                  
                                       S1|T6 replica entries to S0|                                               
                                       entrylen:15| matchidx:119|                                                 
                                       nextidx:120                                                                
                                       S1|T6 update commitIndex as 119                                            
                                       S1|T6 starts to apply entries                                              
                                       [105:119][ApplyEntry]                                                      
                                       S1|T6 Snapshot until index 109|                                            
                                       logLen: 120                                                                
                                       S1|T6 finishes applying entries                                            
                                       [105:119][ApplyEntry]                                                      
                                       S1|T6 Snapshot until index 119|                                            
                                       logLen: 120                                                                
S0|T6 is not leader                                                                                               
                                                                             S2|T6 is not leader                  
                                       S1|T6 send rpc to S2|base: 119| next:                                      
                                       104                                                                        
S0|T6 save persist| votedFor: -1|                                                                                 
logsLen: 120                                                                                                      
S0|T6 appends logs from S1| logLen:                                                                               
120[AppendEntry]                                                                                                  
S0|T6 starts to apply entries                                                                                     
[105:119][ApplyEntry]                                                                                             
                                       S1|T6 replica entries to S0|                                               
                                       entrylen:0| matchidx:119| nextidx:120                                      
S0|T6 Snapshot until index 109|                                                                                   
logLen: 120                                                                                                       
S0|T6 finishes applying entries                                                                                   
[105:119][ApplyEntry]                                                                                             
S0|T6 Snapshot until index 119|                                                                                   
logLen: 120                                                                                                       
                                                                             S2 is connected again                
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 121                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       121[Start]                                                                 
S0|T6 is not leader                                                                                               
                                                                             S2|T6 is not leader                  
                                       S1|T6 send rpc to S2|base: 119| next:                                      
                                       104                                                                        
                                                                             S2|T6 receive rpc from S1            
                                                                             S2|T6 update rfstate| Base:119|      
                                                                             LogLen:120                           
                                                                             S2|T6 applys snapshot from S1        
                                       S1|T6 installs snapshot to S2|                                             
                                       nextId:120| matchId:119                                                    
S0|T6 save persist| votedFor: -1|                                                                                 
logsLen: 121                                                                                                      
S0|T6 appends logs from S1| logLen:                                                                               
121[AppendEntry]                                                                                                  
                                       S1|T6 replica entries to S0|                                               
                                       entrylen:1| matchidx:120| nextidx:121                                      
                                       S1|T6 update commitIndex as 120                                            
                                       S1|T6 starts to apply entries                                              
                                       [120:120][ApplyEntry]                                                      
                                       S1|T6 finishes applying entries                                            
                                       [120:120][ApplyEntry]                                                      
S0|T6 is not leader                                                                                               
                                                                             S2|T6 is not leader                  
                                                                             S2|T6 save persist| votedFor: 1|     
                                                                             logsLen: 121                         
                                                                             S2|T6 appends logs from S1| logLen:  
                                                                             121[AppendEntry]                     
                                                                             S2|T6 starts to apply entries        
                                                                             [120:120][ApplyEntry]                
                                                                             S2|T6 finishes applying entries      
                                                                             [120:120][ApplyEntry]                
                                       S1|T6 replica entries to S2|                                               
                                       entrylen:1| matchidx:120| nextidx:121                                      
S0|T6 save persist| votedFor: -1|                                                                                 
logsLen: 121                                                                                                      
S0|T6 appends logs from S1| logLen:                                                                               
121[AppendEntry]                                                                                                  
S0|T6 starts to apply entries                                                                                     
[120:120][ApplyEntry]                                                                                             
S0|T6 finishes applying entries                                                                                   
[120:120][ApplyEntry]                                                                                             
                                       S1|T6 replica entries to S0|                                               
                                       entrylen:0| matchidx:120| nextidx:121                                      
S0|T6 is not leader                                                                                               
                                                                             S2|T6 is not leader                  
                                                                             S2|T6 save persist| votedFor: 1|     
                                                                             logsLen: 121                         
                                                                             S2|T6 appends logs from S1| logLen:  
                                                                             121[AppendEntry]                     
                                       S1|T6 replica entries to S2|                                               
                                       entrylen:0| matchidx:120| nextidx:121                                      
S0|T6 save persist| votedFor: -1|                                                                                 
logsLen: 121                                                                                                      
S0|T6 appends logs from S1| logLen:                                                                               
121[AppendEntry]                                                                                                  
S0|T6 is not leader                                                                                               
                                                                             S2|T6 is not leader                  
                                                                             S2|T6 save persist| votedFor: 1|     
                                                                             logsLen: 121                         
                                                                             S2|T6 appends logs from S1| logLen:  
                                                                             121[AppendEntry]                     
                                       S1|T6 replica entries to S2|                                               
                                       entrylen:0| matchidx:120| nextidx:121                                      
S0|T6 save persist| votedFor: -1|                                                                                 
logsLen: 121                                                                                                      
S0|T6 appends logs from S1| logLen:                                                                               
121[AppendEntry]                                                                                                  
                                       S1|T6 replica entries to S0|                                               
                                       entrylen:0| matchidx:120| nextidx:121                                      
S0|T6 is not leader                                                                                               
                                                                             S2|T6 is not leader                  
S0|T6 save persist| votedFor: -1|                                                                                 
logsLen: 121                                                                                                      
S0|T6 appends logs from S1| logLen:                                                                               
121[AppendEntry]                                                                                                  
                                       S1|T6 replica entries to S0|                                               
                                       entrylen:0| matchidx:120| nextidx:121                                      
                                                                             S2|T6 save persist| votedFor: 1|     
                                                                             logsLen: 121                         
                                                                             S2|T6 appends logs from S1| logLen:  
                                                                             121[AppendEntry]                     
                                       S1|T6 replica entries to S2|                                               
                                       entrylen:0| matchidx:120| nextidx:121                                      
                                                                             S2|T6 is not leader                  
S0|T6 is not leader                                                                                               
                                                                             S2|T6 save persist| votedFor: 1|     
                                                                             logsLen: 121                         
                                                                             S2|T6 appends logs from S1| logLen:  
                                                                             121[AppendEntry]                     
                                       S1|T6 replica entries to S2|                                               
                                       entrylen:0| matchidx:120| nextidx:121                                      
S0|T6 save persist| votedFor: -1|                                                                                 
logsLen: 121                                                                                                      
S0|T6 appends logs from S1| logLen:                                                                               
121[AppendEntry]                                                                                                  
                                       S1|T6 replica entries to S0|                                               
                                       entrylen:0| matchidx:120| nextidx:121                                      
S0|T6 is not leader                                                                                               
                                                                             S2|T6 is not leader                  
                                                                             S2|T6 save persist| votedFor: 1|     
                                                                             logsLen: 121                         
S0|T6 save persist| votedFor: -1|                                                                                 
logsLen: 121                                                                                                      
S0|T6 appends logs from S1| logLen:                                                                               
121[AppendEntry]                                                                                                  
                                                                             S2|T6 appends logs from S1| logLen:  
                                                                             121[AppendEntry]                     
                                       S1|T6 replica entries to S0|                                               
                                       entrylen:0| matchidx:120| nextidx:121                                      
                                       S1|T6 replica entries to S2|                                               
                                       entrylen:0| matchidx:120| nextidx:121                                      
                                       S1 is disconnected                                                         
                                       S1|T6 fails to install snapshot to S2                                      
S0|T6 is not leader                                                                                               
                                                                             S2|T6 is not leader                  
                                                                             S2|T6 is not leader                  
S0|T6 is not leader                                                                                               
S0|T6 is not leader                                                                                               
                                                                             S2|T6 is not leader                  
S0|T6 is not leader                                                                                               
                                                                             S2|T6 is not leader                  
                                                                             S2|T6 is not leader                  
S0|T6 is not leader                                                                                               
S0|T6 is not leader                                                                                               
                                                                             S2|T6 is not leader                  
S0|T6 is not leader                                                                                               
                                                                             S2|T6 is not leader                  
S0|T6 is not leader                                                                                               
                                                                             S2|T6 is not leader                  
S0|T6 is not leader                                                                                               
                                                                             S2|T6 is not leader                  
S0|T7 starts to join election                                                                                     
S0|T7 save persist| votedFor: 0|                                                                                  
logsLen: 121                                                                                                      
                                                                             S2|T7 save persist| votedFor: -1|    
                                                                             logsLen: 121                         
                                                                             S2|T7 save persist| votedFor: 0|     
                                                                             logsLen: 121                         
                                                                             S2|T7 votes for S0[RequestVote]      
S0|T7 becomes the leader, and starts                                                                              
heatbeats                                                                                                         
                                                                             S2|T7 save persist| votedFor: 0|     
                                                                             logsLen: 121                         
                                                                             S2|T7 appends logs from S0| logLen:  
                                                                             121[AppendEntry]                     
S0|T7 replica entries to S2|                                                                                      
entrylen:0| matchidx:120| nextidx:121                                                                             
S0|T7 save persist| votedFor: 0|                                                                                  
logsLen: 122                                                                                                      
S0|T7 receive commands | logLen:                                                                                  
122[Start]                                                                                                        
                                                                             S2|T7 is not leader                  
                                                                             S2|T7 save persist| votedFor: 0|     
                                                                             logsLen: 122                         
                                                                             S2|T7 appends logs from S0| logLen:  
                                                                             122[AppendEntry]                     
S0|T7 replica entries to S2|                                                                                      
entrylen:1| matchidx:121| nextidx:122                                                                             
S0|T7 update commitIndex as 121                                                                                   
S0|T7 starts to apply entries                                                                                     
[121:121][ApplyEntry]                                                                                             
S0|T7 finishes applying entries                                                                                   
[121:121][ApplyEntry]                                                                                             
                                                                             S2|T7 is not leader                  
                                                                             S2|T7 save persist| votedFor: 0|     
                                                                             logsLen: 122                         
                                                                             S2|T7 appends logs from S0| logLen:  
                                                                             122[AppendEntry]                     
                                                                             S2|T7 starts to apply entries        
                                                                             [121:121][ApplyEntry]                
                                                                             S2|T7 finishes applying entries      
                                                                             [121:121][ApplyEntry]                
S0|T7 replica entries to S2|                                                                                      
entrylen:0| matchidx:121| nextidx:122                                                                             
S0|T7 save persist| votedFor: 0|                                                                                  
logsLen: 123                                                                                                      
S0|T7 receive commands | logLen:                                                                                  
123[Start]                                                                                                        
                                                                             S2|T7 is not leader                  
                                                                             S2|T7 save persist| votedFor: 0|     
                                                                             logsLen: 123                         
                                                                             S2|T7 appends logs from S0| logLen:  
                                                                             123[AppendEntry]                     
S0|T7 replica entries to S2|                                                                                      
entrylen:1| matchidx:122| nextidx:123                                                                             
S0|T7 update commitIndex as 122                                                                                   
S0|T7 starts to apply entries                                                                                     
[122:122][ApplyEntry]                                                                                             
S0|T7 finishes applying entries                                                                                   
[122:122][ApplyEntry]                                                                                             
                                                                             S2|T7 is not leader                  
                                                                             S2|T7 is not leader                  
                                                                             S2|T7 save persist| votedFor: 0|     
                                                                             logsLen: 123                         
                                                                             S2|T7 appends logs from S0| logLen:  
                                                                             123[AppendEntry]                     
                                                                             S2|T7 starts to apply entries        
                                                                             [122:122][ApplyEntry]                
                                                                             S2|T7 finishes applying entries      
                                                                             [122:122][ApplyEntry]                
S0|T7 replica entries to S2|                                                                                      
entrylen:0| matchidx:122| nextidx:123                                                                             
                                       S1 is connected again                                                      
                                       S1|T6 save persist| votedFor: 1|                                           
                                       logsLen: 122                                                               
                                       S1|T6 receive commands | logLen:                                           
                                       122[Start]                                                                 
                                                                             S2|T7 is not leader                  
                                                                             S2|T7 rejects to append entries from 
                                                                             S1 | out of date term[AppendEntry]   
                                       S1|T7 save persist| votedFor: -1|                                          
                                       logsLen: 122                                                               
                                                                             S2|T7 save persist| votedFor: 0|     
                                                                             logsLen: 123                         
                                                                             S2|T7 appends logs from S0| logLen:  
                                                                             123[AppendEntry]                     
S0|T7 replica entries to S2|                                                                                      
entrylen:0| matchidx:122| nextidx:123                                                                             
S0|T7 rejects to append entries from                                                                              
S1 | out of date term[AppendEntry]                                                                                
                                       S1|T7 save persist| votedFor: -1|                                          
                                       logsLen: 123                                                               
                                       S1|T7 appends logs from S0| logLen:                                        
                                       123[AppendEntry]                                                           
                                       S1|T7 starts to apply entries                                              
                                       [121:122][ApplyEntry]                                                      
                                       S1|T7 finishes applying entries                                            
                                       [121:122][ApplyEntry]                                                      
S0|T7 replica entries to S1|                                                                                      
entrylen:2| matchidx:122| nextidx:123                                                                             
                                                                             S2|T7 is not leader                  
                                       S1|T7 is not leader                                                        
                                       S1|T7 save persist| votedFor: -1|                                          
                                       logsLen: 123                                                               
                                       S1|T7 appends logs from S0| logLen:                                        
                                       123[AppendEntry]                                                           
S0|T7 replica entries to S1|                                                                                      
entrylen:0| matchidx:122| nextidx:123                                                                             
                                                                             S2|T7 is not leader                  
                                       S1|T7 is not leader                                                        
                                       S1|T7 save persist| votedFor: -1|                                          
                                       logsLen: 123                                                               
                                       S1|T7 appends logs from S0| logLen:                                        
                                       123[AppendEntry]                                                           
S0|T7 replica entries to S1|                                                                                      
entrylen:0| matchidx:122| nextidx:123                                                                             
                                                                             S2|T7 save persist| votedFor: 0|     
                                                                             logsLen: 123                         
                                                                             S2|T7 appends logs from S0| logLen:  
                                                                             123[AppendEntry]                     
S0|T7 replica entries to S2|                                                                                      
entrylen:0| matchidx:122| nextidx:123                                                                             
                                       S1|T7 is not leader                                                        
                                                                             S2|T7 is not leader                  
                                                                             S2|T7 save persist| votedFor: 0|     
                                                                             logsLen: 123                         
                                                                             S2|T7 appends logs from S0| logLen:  
                                                                             123[AppendEntry]                     
                                       S1|T7 save persist| votedFor: -1|                                          
                                       logsLen: 123                                                               
                                       S1|T7 appends logs from S0| logLen:                                        
                                       123[AppendEntry]                                                           
                                       S1|T7 is not leader                                                        
                                                                             S2|T7 is not leader                  
                                                                             S2|T7 save persist| votedFor: 0|     
                                                                             logsLen: 123                         
                                                                             S2|T7 appends logs from S0| logLen:  
                                                                             123[AppendEntry]                     
S0|T7 replica entries to S2|                                                                                      
entrylen:0| matchidx:122| nextidx:123                                                                             
                                       S1|T7 is not leader                                                        
                                                                             S2|T7 is not leader                  
                                                                             S2|T7 save persist| votedFor: 0|     
                                                                             logsLen: 123                         
                                                                             S2|T7 appends logs from S0| logLen:  
                                                                             123[AppendEntry]                     
S0|T7 replica entries to S2|                                                                                      
entrylen:0| matchidx:122| nextidx:123                                                                             
                                       S1|T7 save persist| votedFor: -1|                                          
                                       logsLen: 123                                                               
                                       S1|T7 appends logs from S0| logLen:                                        
                                       123[AppendEntry]                                                           
S0|T7 replica entries to S1|                                                                                      
entrylen:0| matchidx:122| nextidx:123                                                                             
                                       S1|T7 is not leader                                                        
                                                                             S2|T7 is not leader                  
                                                                             S2|T7 save persist| votedFor: 0|     
                                                                             logsLen: 123                         
                                                                             S2|T7 appends logs from S0| logLen:  
                                                                             123[AppendEntry]                     
S0|T7 replica entries to S2|                                                                                      
entrylen:0| matchidx:122| nextidx:123                                                                             
                                       S1|T7 save persist| votedFor: -1|                                          
                                       logsLen: 123                                                               
                                       S1|T7 appends logs from S0| logLen:                                        
                                       123[AppendEntry]                                                           
S0|T7 replica entries to S1|                                                                                      
entrylen:0| matchidx:122| nextidx:123                                                                             
                                       S1|T7 is not leader                                                        
                                                                             S2|T7 is not leader                  
                                                                             S2|T7 save persist| votedFor: 0|     
                                                                             logsLen: 123                         
                                                                             S2|T7 appends logs from S0| logLen:  
                                                                             123[AppendEntry]                     
S0|T7 replica entries to S2|                                                                                      
entrylen:0| matchidx:122| nextidx:123                                                                             
                                                                             S2|T7 is not leader                  
                                       S1|T7 is not leader                                                        
                                                                             S2|T7 save persist| votedFor: 0|     
                                                                             logsLen: 123                         
                                                                             S2|T7 appends logs from S0| logLen:  
                                                                             123[AppendEntry]                     
                                       S1|T7 save persist| votedFor: -1|                                          
                                       logsLen: 123                                                               
                                       S1|T7 appends logs from S0| logLen:                                        
                                       123[AppendEntry]                                                           
S0|T7 replica entries to S2|                                                                                      
entrylen:0| matchidx:122| nextidx:123                                                                             
                                                                             S2|T7 is not leader                  
                                       S1|T7 is not leader                                                        
                                                                             S2|T7 save persist| votedFor: 0|     
                                                                             logsLen: 123                         
                                                                             S2|T7 appends logs from S0| logLen:  
                                                                             123[AppendEntry]                     
S0|T7 replica entries to S2|                                                                                      
entrylen:0| matchidx:122| nextidx:123                                                                             
                                       S1|T7 save persist| votedFor: -1|                                          
                                       logsLen: 123                                                               
                                       S1|T7 appends logs from S0| logLen:                                        
                                       123[AppendEntry]                                                           
                                                                             S2|T7 is not leader                  
                                       S1|T7 is not leader                                                        
                                       S1|T7 save persist| votedFor: -1|                                          
                                       logsLen: 123                                                               
                                       S1|T7 appends logs from S0| logLen:                                        
                                       123[AppendEntry]                                                           
                                                                             S2|T7 save persist| votedFor: 0|     
                                                                             logsLen: 123                         
                                                                             S2|T7 appends logs from S0| logLen:  
                                                                             123[AppendEntry]                     
S0|T7 replica entries to S2|                                                                                      
entrylen:0| matchidx:122| nextidx:123                                                                             
S0|T7 replica entries to S1|                                                                                      
entrylen:0| matchidx:122| nextidx:123                                                                             
                                       S1|T7 is not leader                                                        
                                                                             S2|T7 is not leader                  
                                                                             S2|T7 save persist| votedFor: 0|     
                                                                             logsLen: 123                         
                                                                             S2|T7 appends logs from S0| logLen:  
                                                                             123[AppendEntry]                     
S0|T7 replica entries to S2|                                                                                      
entrylen:0| matchidx:122| nextidx:123                                                                             
                                       S1|T7 save persist| votedFor: -1|                                          
                                       logsLen: 123                                                               
                                       S1|T7 appends logs from S0| logLen:                                        
                                       123[AppendEntry]                                                           
                                                                             S2|T7 is not leader                  
                                       S1|T7 is not leader                                                        
                                       S1|T7 save persist| votedFor: -1|                                          
                                       logsLen: 123                                                               
                                                                             S2|T7 save persist| votedFor: 0|     
                                                                             logsLen: 123                         
                                                                             S2|T7 appends logs from S0| logLen:  
                                                                             123[AppendEntry]                     
                                       S1|T7 appends logs from S0| logLen:                                        
                                       123[AppendEntry]                                                           
S0|T7 replica entries to S2|                                                                                      
entrylen:0| matchidx:122| nextidx:123                                                                             
                                       S1|T7 is not leader                                                        
                                                                             S2|T7 is not leader                  
                                       S1|T7 save persist| votedFor: -1|                                          
                                       logsLen: 123                                                               
                                       S1|T7 appends logs from S0| logLen:                                        
                                       123[AppendEntry]                                                           
S0|T7 replica entries to S1|                                                                                      
entrylen:0| matchidx:122| nextidx:123                                                                             
                                                                             S2|T7 is not leader                  
                                       S1|T7 is not leader                                                        
                                       S1|T7 save persist| votedFor: -1|                                          
                                       logsLen: 123                                                               
                                       S1|T7 appends logs from S0| logLen:                                        
                                       123[AppendEntry]                                                           
S0|T7 replica entries to S1|                                                                                      
entrylen:0| matchidx:122| nextidx:123                                                                             
                                                                             S2|T7 save persist| votedFor: 0|     
                                                                             logsLen: 123                         
                                                                             S2|T7 appends logs from S0| logLen:  
                                                                             123[AppendEntry]                     
S0|T7 replica entries to S2|                                                                                      
entrylen:0| matchidx:122| nextidx:123                                                                             
                                       S1|T7 is not leader                                                        
                                                                             S2|T7 is not leader                  
                                       S1|T7 save persist| votedFor: -1|                                          
                                       logsLen: 123                                                               
                                       S1|T7 appends logs from S0| logLen:                                        
                                       123[AppendEntry]                                                           
S0|T7 replica entries to S1|                                                                                      
entrylen:0| matchidx:122| nextidx:123                                                                             
                                                                             S2|T7 save persist| votedFor: 0|     
                                                                             logsLen: 123                         
                                                                             S2|T7 appends logs from S0| logLen:  
                                                                             123[AppendEntry]                     
S0|T7 replica entries to S2|                                                                                      
entrylen:0| matchidx:122| nextidx:123                                                                             
                                                                             S2|T7 is not leader                  
                                       S1|T7 is not leader                                                        
                                       S1|T7 save persist| votedFor: -1|                                          
                                       logsLen: 123                                                               
                                       S1|T7 appends logs from S0| logLen:                                        
                                       123[AppendEntry]                                                           
S0|T7 replica entries to S1|                                                                                      
entrylen:0| matchidx:122| nextidx:123                                                                             
                                                                             S2|T7 save persist| votedFor: 0|     
                                                                             logsLen: 123                         
                                                                             S2|T7 appends logs from S0| logLen:  
                                                                             123[AppendEntry]                     
S0|T7 replica entries to S2|                                                                                      
entrylen:0| matchidx:122| nextidx:123                                                                             
                                       S1|T7 is not leader                                                        
                                                                             S2|T7 is not leader                  
                                                                             S2|T7 save persist| votedFor: 0|     
                                                                             logsLen: 123                         
                                                                             S2|T7 appends logs from S0| logLen:  
                                                                             123[AppendEntry]                     
S0|T7 replica entries to S2|                                                                                      
entrylen:0| matchidx:122| nextidx:123                                                                             
                                       S1|T7 save persist| votedFor: -1|                                          
                                       logsLen: 123                                                               
                                       S1|T7 appends logs from S0| logLen:                                        
                                       123[AppendEntry]                                                           
S0|T7 replica entries to S1|                                                                                      
entrylen:0| matchidx:122| nextidx:123                                                                             
                                       S1|T7 fails to install snapshot to S2                                      
                                       S1|T7 is not leader                                                        
                                                                             S2|T7 is not leader                  
                                       S1|T7 save persist| votedFor: -1|                                          
                                       logsLen: 123                                                               
                                       S1|T7 appends logs from S0| logLen:                                        
                                       123[AppendEntry]                                                           
S0|T7 replica entries to S1|                                                                                      
entrylen:0| matchidx:122| nextidx:123                                                                             
                                                                             S2|T7 save persist| votedFor: 0|     
                                                                             logsLen: 123                         
                                                                             S2|T7 appends logs from S0| logLen:  
                                                                             123[AppendEntry]                     
S0|T7 replica entries to S2|                                                                                      
entrylen:0| matchidx:122| nextidx:123                                                                             
                                                                             S2|T7 is not leader                  
                                       S1|T7 is not leader                                                        
                                                                             S2|T7 save persist| votedFor: 0|     
                                                                             logsLen: 123                         
                                                                             S2|T7 appends logs from S0| logLen:  
                                                                             123[AppendEntry]                     
S0|T7 replica entries to S2|                                                                                      
entrylen:0| matchidx:122| nextidx:123                                                                             
                                       S1|T7 save persist| votedFor: -1|                                          
                                       logsLen: 123                                                               
                                       S1|T7 appends logs from S0| logLen:                                        
                                       123[AppendEntry]                                                           
S0|T7 replica entries to S1|                                                                                      
entrylen:0| matchidx:122| nextidx:123                                                                             
S0|T7 save persist| votedFor: 0|                                                                                  
logsLen: 124                                                                                                      
S0|T7 receive commands | logLen:                                                                                  
124[Start]                                                                                                        
                                                                             S2|T7 is not leader                  
                                       S1|T7 is not leader                                                        
                                                                             S2|T7 save persist| votedFor: 0|     
                                                                             logsLen: 124                         
                                                                             S2|T7 appends logs from S0| logLen:  
                                                                             124[AppendEntry]                     
                                       S1|T7 save persist| votedFor: -1|                                          
                                       logsLen: 124                                                               
                                       S1|T7 appends logs from S0| logLen:                                        
                                       124[AppendEntry]                                                           
S0|T7 replica entries to S1|                                                                                      
entrylen:1| matchidx:123| nextidx:124                                                                             
S0|T7 update commitIndex as 123                                                                                   
S0|T7 starts to apply entries                                                                                     
[123:123][ApplyEntry]                                                                                             
S0|T7 finishes applying entries                                                                                   
[123:123][ApplyEntry]                                                                                             
                                                                             S2|T7 is not leader                  
                                       S1|T7 is not leader                                                        
                                       S1|T7 save persist| votedFor: -1|                                          
                                       logsLen: 124                                                               
                                       S1|T7 appends logs from S0| logLen:                                        
                                       124[AppendEntry]                                                           
                                       S1|T7 starts to apply entries                                              
                                       [123:123][ApplyEntry]                                                      
                                       S1|T7 finishes applying entries                                            
                                       [123:123][ApplyEntry]                                                      
                                                                             S2|T7 save persist| votedFor: 0|     
                                                                             logsLen: 124                         
S0|T7 replica entries to S1|                                                                                      
entrylen:0| matchidx:123| nextidx:124                                                                             
                                                                             S2|T7 appends logs from S0| logLen:  
                                                                             124[AppendEntry]                     
                                                                             S2|T7 starts to apply entries        
                                                                             [123:123][ApplyEntry]                
                                                                             S2|T7 finishes applying entries      
                                                                             [123:123][ApplyEntry]                
S0|T7 replica entries to S2|                                                                                      
entrylen:1| matchidx:123| nextidx:124                                                                             
                                       S1|T7 is not leader                                                        
                                                                             S2|T7 is not leader                  
                                                                             S2|T7 save persist| votedFor: 0|     
                                                                             logsLen: 124                         
                                                                             S2|T7 appends logs from S0| logLen:  
                                                                             124[AppendEntry]                     
                                       S1|T7 save persist| votedFor: -1|                                          
                                       logsLen: 124                                                               
                                       S1|T7 appends logs from S0| logLen:                                        
                                       124[AppendEntry]                                                           
S0|T7 replica entries to S2|                                                                                      
entrylen:0| matchidx:123| nextidx:124                                                                             
S0|T7 replica entries to S1|                                                                                      
entrylen:0| matchidx:123| nextidx:124                                                                             
                                                                             S2|T7 is not leader                  
                                       S1|T7 is not leader                                                        
                                       S1|T7 save persist| votedFor: -1|                                          
                                       logsLen: 124                                                               
                                       S1|T7 appends logs from S0| logLen:                                        
                                       124[AppendEntry]                                                           
                                                                             S2|T7 save persist| votedFor: 0|     
                                                                             logsLen: 124                         
                                                                             S2|T7 appends logs from S0| logLen:  
                                                                             124[AppendEntry]                     
S0|T7 replica entries to S2|                                                                                      
entrylen:0| matchidx:123| nextidx:124                                                                             
                                                                             S2|T7 is not leader                  
                                       S1|T7 is not leader                                                        
                                                                             S2|T7 save persist| votedFor: 0|     
                                                                             logsLen: 124                         
                                                                             S2|T7 appends logs from S0| logLen:  
                                                                             124[AppendEntry]                     
S0|T7 replica entries to S2|                                                                                      
entrylen:0| matchidx:123| nextidx:124                                                                             
                                       S1|T7 save persist| votedFor: -1|                                          
                                       logsLen: 124                                                               
                                       S1|T7 appends logs from S0| logLen:                                        
                                       124[AppendEntry]                                                           
S0|T7 replica entries to S1|                                                                                      
entrylen:0| matchidx:123| nextidx:124                                                                             
                                       S1|T7 is not leader                                                        
                                                                             S2|T7 is not leader                  
                                                                             S2|T7 save persist| votedFor: 0|     
                                                                             logsLen: 124                         
                                       S1|T7 save persist| votedFor: -1|                                          
                                       logsLen: 124                                                               
                                                                             S2|T7 appends logs from S0| logLen:  
                                                                             124[AppendEntry]                     
                                       S1|T7 appends logs from S0| logLen:                                        
                                       124[AppendEntry]                                                           
S0|T7 replica entries to S2|                                                                                      
entrylen:0| matchidx:123| nextidx:124                                                                             
S0|T7 replica entries to S1|                                                                                      
entrylen:0| matchidx:123| nextidx:124                                                                             
                                       S1|T7 is not leader                                                        
                                                                             S2|T7 is not leader                  
                                       S1|T7 save persist| votedFor: -1|                                          
                                       logsLen: 124                                                               
                                       S1|T7 appends logs from S0| logLen:                                        
                                       124[AppendEntry]                                                           
S0|T7 replica entries to S1|                                                                                      
entrylen:0| matchidx:123| nextidx:124                                                                             
                                       S1 is disconnected                                                         
S0|T7 save persist| votedFor: 0|                                                                                  
logsLen: 125                                                                                                      
S0|T7 receive commands | logLen:                                                                                  
125[Start]                                                                                                        
                                                                             S2|T7 is not leader                  
                                       S1|T7 is not leader                                                        
                                                                             S2|T7 save persist| votedFor: 0|     
                                                                             logsLen: 125                         
                                                                             S2|T7 appends logs from S0| logLen:  
                                                                             125[AppendEntry]                     
S0|T7 replica entries to S2|                                                                                      
entrylen:1| matchidx:124| nextidx:125                                                                             
S0|T7 update commitIndex as 124                                                                                   
S0|T7 starts to apply entries                                                                                     
[124:124][ApplyEntry]                                                                                             
S0|T7 finishes applying entries                                                                                   
[124:124][ApplyEntry]                                                                                             
                                       S1|T7 is not leader                                                        
                                                                             S2|T7 is not leader                  
                                                                             S2|T7 save persist| votedFor: 0|     
                                                                             logsLen: 125                         
                                                                             S2|T7 appends logs from S0| logLen:  
                                                                             125[AppendEntry]                     
                                                                             S2|T7 starts to apply entries        
                                                                             [124:124][ApplyEntry]                
                                                                             S2|T7 finishes applying entries      
                                                                             [124:124][ApplyEntry]                
S0|T7 replica entries to S2|                                                                                      
entrylen:0| matchidx:124| nextidx:125                                                                             
S0|T7 save persist| votedFor: 0|                                                                                  
logsLen: 126                                                                                                      
S0|T7 receive commands | logLen:                                                                                  
126[Start]                                                                                                        
S0|T7 save persist| votedFor: 0|                                                                                  
logsLen: 127                                                                                                      
S0|T7 receive commands | logLen:                                                                                  
127[Start]                                                                                                        
S0|T7 save persist| votedFor: 0|                                                                                  
logsLen: 128                                                                                                      
S0|T7 receive commands | logLen:                                                                                  
128[Start]                                                                                                        
S0|T7 save persist| votedFor: 0|                                                                                  
logsLen: 129                                                                                                      
S0|T7 receive commands | logLen:                                                                                  
129[Start]                                                                                                        
S0|T7 save persist| votedFor: 0|                                                                                  
logsLen: 130                                                                                                      
S0|T7 receive commands | logLen:                                                                                  
130[Start]                                                                                                        
S0|T7 save persist| votedFor: 0|                                                                                  
logsLen: 131                                                                                                      
S0|T7 receive commands | logLen:                                                                                  
131[Start]                                                                                                        
S0|T7 save persist| votedFor: 0|                                                                                  
logsLen: 132                                                                                                      
S0|T7 receive commands | logLen:                                                                                  
132[Start]                                                                                                        
                                       S1|T7 is not leader                                                        
                                                                             S2|T7 is not leader                  
                                                                             S2|T7 is not leader                  
                                       S1|T7 is not leader                                                        
                                                                             S2|T7 is not leader                  
                                       S1|T7 is not leader                                                        
                                                                             S2|T7 save persist| votedFor: 0|     
                                                                             logsLen: 132                         
                                                                             S2|T7 appends logs from S0| logLen:  
                                                                             132[AppendEntry]                     
S0|T7 replica entries to S2|                                                                                      
entrylen:7| matchidx:131| nextidx:132                                                                             
S0|T7 update commitIndex as 131                                                                                   
S0|T7 starts to apply entries                                                                                     
[125:131][ApplyEntry]                                                                                             
S0|T7 Snapshot until index 129|                                                                                   
logLen: 132                                                                                                       
S0|T7 finishes applying entries                                                                                   
[125:131][ApplyEntry]                                                                                             
                                                                             S2|T7 is not leader                  
                                       S1|T7 is not leader                                                        
S0|T7 send rpc to S1|base: 129| next:                                                                             
124                                                                                                               
                                                                             S2|T7 save persist| votedFor: 0|     
                                                                             logsLen: 132                         
                                                                             S2|T7 appends logs from S0| logLen:  
                                                                             132[AppendEntry]                     
                                                                             S2|T7 starts to apply entries        
                                                                             [125:131][ApplyEntry]                
S0|T7 replica entries to S2|                                                                                      
entrylen:0| matchidx:131| nextidx:132                                                                             
                                                                             S2|T7 Snapshot until index 129|      
                                                                             logLen: 132                          
                                                                             S2|T7 finishes applying entries      
                                                                             [125:131][ApplyEntry]                
                                       S1 is connected again                                                      
S0|T7 save persist| votedFor: 0|                                                                                  
logsLen: 133                                                                                                      
S0|T7 receive commands | logLen:                                                                                  
133[Start]                                                                                                        
                                                                             S2|T7 is not leader                  
                                       S1|T7 is not leader                                                        
S0|T7 send rpc to S1|base: 129| next:                                                                             
124                                                                                                               
                                       S1|T7 receive rpc from S0                                                  
                                       S1|T7 update rfstate| Base:129|                                            
                                       LogLen:130                                                                 
                                                                             S2|T7 save persist| votedFor: 0|     
                                                                             logsLen: 133                         
                                                                             S2|T7 appends logs from S0| logLen:  
                                                                             133[AppendEntry]                     
                                       S1|T7 applys snapshot from S0                                              
S0|T7 installs snapshot to S1|                                                                                    
nextId:130| matchId:129                                                                                           
S0|T7 replica entries to S2|                                                                                      
entrylen:1| matchidx:132| nextidx:133                                                                             
S0|T7 update commitIndex as 132                                                                                   
S0|T7 starts to apply entries                                                                                     
[132:132][ApplyEntry]                                                                                             
S0|T7 finishes applying entries                                                                                   
[132:132][ApplyEntry]                                                                                             
                                                                             S2|T7 is not leader                  
                                       S1|T7 is not leader                                                        
                                       S1|T7 save persist| votedFor: -1|                                          
                                       logsLen: 133                                                               
                                       S1|T7 appends logs from S0| logLen:                                        
                                       133[AppendEntry]                                                           
                                       S1|T7 starts to apply entries                                              
                                       [130:132][ApplyEntry]                                                      
                                       S1|T7 finishes applying entries                                            
                                       [130:132][ApplyEntry]                                                      
                                                                             S2|T7 save persist| votedFor: 0|     
                                                                             logsLen: 133                         
                                                                             S2|T7 appends logs from S0| logLen:  
                                                                             133[AppendEntry]                     
                                                                             S2|T7 starts to apply entries        
                                                                             [132:132][ApplyEntry]                
                                                                             S2|T7 finishes applying entries      
                                                                             [132:132][ApplyEntry]                
S0|T7 replica entries to S2|                                                                                      
entrylen:0| matchidx:132| nextidx:133                                                                             
                                       S1|T7 is not leader                                                        
                                                                             S2|T7 is not leader                  
                                                                             S2|T7 save persist| votedFor: 0|     
                                                                             logsLen: 133                         
                                                                             S2|T7 appends logs from S0| logLen:  
                                                                             133[AppendEntry]                     
S0|T7 replica entries to S2|                                                                                      
entrylen:0| matchidx:132| nextidx:133                                                                             
                                       S1|T7 is not leader                                                        
                                                                             S2|T7 is not leader                  
                                                                             S2|T7 save persist| votedFor: 0|     
                                                                             logsLen: 133                         
                                                                             S2|T7 appends logs from S0| logLen:  
                                                                             133[AppendEntry]                     
S0|T7 replica entries to S2|                                                                                      
entrylen:0| matchidx:132| nextidx:133                                                                             
                                       S1|T7 save persist| votedFor: -1|                                          
                                       logsLen: 133                                                               
                                       S1|T7 appends logs from S0| logLen:                                        
                                       133[AppendEntry]                                                           
                                       S1|T7 is not leader                                                        
                                                                             S2|T7 is not leader                  
                                                                             S2|T7 save persist| votedFor: 0|     
                                                                             logsLen: 133                         
                                                                             S2|T7 appends logs from S0| logLen:  
                                                                             133[AppendEntry]                     
S0|T7 replica entries to S2|                                                                                      
entrylen:0| matchidx:132| nextidx:133                                                                             
                                       S1|T7 is not leader                                                        
                                                                             S2|T7 is not leader                  
                                       S1|T7 save persist| votedFor: -1|                                          
                                       logsLen: 133                                                               
                                       S1|T7 appends logs from S0| logLen:                                        
                                       133[AppendEntry]                                                           
S0|T7 replica entries to S1|                                                                                      
entrylen:3| matchidx:132| nextidx:133                                                                             
                                                                             S2|T7 save persist| votedFor: 0|     
                                                                             logsLen: 133                         
                                                                             S2|T7 appends logs from S0| logLen:  
                                                                             133[AppendEntry]                     
S0|T7 replica entries to S2|                                                                                      
entrylen:0| matchidx:132| nextidx:133                                                                             
                                                                             S2|T7 is not leader                  
                                       S1|T7 is not leader                                                        
                                                                             S2|T7 save persist| votedFor: 0|     
                                                                             logsLen: 133                         
                                                                             S2|T7 appends logs from S0| logLen:  
                                                                             133[AppendEntry]                     
S0|T7 replica entries to S2|                                                                                      
entrylen:0| matchidx:132| nextidx:133                                                                             
                                       S1|T7 save persist| votedFor: -1|                                          
                                       logsLen: 133                                                               
                                       S1|T7 appends logs from S0| logLen:                                        
                                       133[AppendEntry]                                                           
                                       S1 is disconnected                                                         
S0|T7 save persist| votedFor: 0|                                                                                  
logsLen: 134                                                                                                      
S0|T7 receive commands | logLen:                                                                                  
134[Start]                                                                                                        
                                                                             S2|T7 is not leader                  
                                       S1|T7 is not leader                                                        
                                                                             S2|T7 save persist| votedFor: 0|     
                                                                             logsLen: 134                         
                                                                             S2|T7 appends logs from S0| logLen:  
                                                                             134[AppendEntry]                     
S0|T7 replica entries to S2|                                                                                      
entrylen:1| matchidx:133| nextidx:134                                                                             
S0|T7 update commitIndex as 133                                                                                   
S0|T7 starts to apply entries                                                                                     
[133:133][ApplyEntry]                                                                                             
S0|T7 finishes applying entries                                                                                   
[133:133][ApplyEntry]                                                                                             
                                                                             S2|T7 is not leader                  
                                       S1|T7 is not leader                                                        
                                                                             S2|T7 save persist| votedFor: 0|     
                                                                             logsLen: 134                         
                                                                             S2|T7 appends logs from S0| logLen:  
                                                                             134[AppendEntry]                     
                                                                             S2|T7 starts to apply entries        
                                                                             [133:133][ApplyEntry]                
                                                                             S2|T7 finishes applying entries      
                                                                             [133:133][ApplyEntry]                
S0|T7 save persist| votedFor: 0|                                                                                  
logsLen: 135                                                                                                      
S0|T7 receive commands | logLen:                                                                                  
135[Start]                                                                                                        
S0|T7 save persist| votedFor: 0|                                                                                  
logsLen: 136                                                                                                      
S0|T7 receive commands | logLen:                                                                                  
136[Start]                                                                                                        
S0|T7 save persist| votedFor: 0|                                                                                  
logsLen: 137                                                                                                      
S0|T7 receive commands | logLen:                                                                                  
137[Start]                                                                                                        
S0|T7 save persist| votedFor: 0|                                                                                  
logsLen: 138                                                                                                      
S0|T7 receive commands | logLen:                                                                                  
138[Start]                                                                                                        
S0|T7 save persist| votedFor: 0|                                                                                  
logsLen: 139                                                                                                      
S0|T7 receive commands | logLen:                                                                                  
139[Start]                                                                                                        
S0|T7 save persist| votedFor: 0|                                                                                  
logsLen: 140                                                                                                      
S0|T7 receive commands | logLen:                                                                                  
140[Start]                                                                                                        
S0|T7 save persist| votedFor: 0|                                                                                  
logsLen: 141                                                                                                      
S0|T7 receive commands | logLen:                                                                                  
141[Start]                                                                                                        
S0|T7 save persist| votedFor: 0|                                                                                  
logsLen: 142                                                                                                      
S0|T7 receive commands | logLen:                                                                                  
142[Start]                                                                                                        
S0|T7 save persist| votedFor: 0|                                                                                  
logsLen: 143                                                                                                      
S0|T7 receive commands | logLen:                                                                                  
143[Start]                                                                                                        
S0|T7 save persist| votedFor: 0|                                                                                  
logsLen: 144                                                                                                      
S0|T7 receive commands | logLen:                                                                                  
144[Start]                                                                                                        
S0|T7 save persist| votedFor: 0|                                                                                  
logsLen: 145                                                                                                      
S0|T7 receive commands | logLen:                                                                                  
145[Start]                                                                                                        
S0|T7 save persist| votedFor: 0|                                                                                  
logsLen: 146                                                                                                      
S0|T7 receive commands | logLen:                                                                                  
146[Start]                                                                                                        
S0|T7 save persist| votedFor: 0|                                                                                  
logsLen: 147                                                                                                      
S0|T7 receive commands | logLen:                                                                                  
147[Start]                                                                                                        
S0|T7 save persist| votedFor: 0|                                                                                  
logsLen: 148                                                                                                      
S0|T7 receive commands | logLen:                                                                                  
148[Start]                                                                                                        
                                       S1|T7 is not leader                                                        
                                                                             S2|T7 is not leader                  
                                                                             S2|T7 save persist| votedFor: 0|     
                                                                             logsLen: 148                         
                                                                             S2|T7 appends logs from S0| logLen:  
                                                                             148[AppendEntry]                     
S0|T7 replica entries to S2|                                                                                      
entrylen:14| matchidx:147| nextidx:148                                                                            
S0|T7 update commitIndex as 147                                                                                   
S0|T7 starts to apply entries                                                                                     
[134:147][ApplyEntry]                                                                                             
S0|T7 Snapshot until index 139|                                                                                   
logLen: 148                                                                                                       
S0|T7 finishes applying entries                                                                                   
[134:147][ApplyEntry]                                                                                             
                                                                             S2|T7 is not leader                  
                                       S1|T7 is not leader                                                        
S0|T7 send rpc to S1|base: 139| next:                                                                             
133                                                                                                               
                                                                             S2|T7 save persist| votedFor: 0|     
                                                                             logsLen: 148                         
                                                                             S2|T7 appends logs from S0| logLen:  
                                                                             148[AppendEntry]                     
                                                                             S2|T7 starts to apply entries        
                                                                             [134:147][ApplyEntry]                
                                                                             S2|T7 Snapshot until index 139|      
                                                                             logLen: 148                          
                                                                             S2|T7 finishes applying entries      
                                                                             [134:147][ApplyEntry]                
                                       S1 is connected again                                                      
S0|T7 save persist| votedFor: 0|                                                                                  
logsLen: 149                                                                                                      
S0|T7 receive commands | logLen:                                                                                  
149[Start]                                                                                                        
                                                                             S2|T7 is not leader                  
S0|T7 send rpc to S1|base: 139| next:                                                                             
133                                                                                                               
                                       S1|T7 is not leader                                                        
                                                                             S2|T7 save persist| votedFor: 0|     
                                                                             logsLen: 149                         
                                                                             S2|T7 appends logs from S0| logLen:  
                                                                             149[AppendEntry]                     
S0|T7 replica entries to S2|                                                                                      
entrylen:1| matchidx:148| nextidx:149                                                                             
S0|T7 update commitIndex as 148                                                                                   
S0|T7 starts to apply entries                                                                                     
[148:148][ApplyEntry]                                                                                             
S0|T7 finishes applying entries                                                                                   
[148:148][ApplyEntry]                                                                                             
                                       S1|T7 receive rpc from S0                                                  
                                       S1|T7 update rfstate| Base:139|                                            
                                       LogLen:140                                                                 
                                       S1|T7 applys snapshot from S0                                              
S0|T7 installs snapshot to S1|                                                                                    
nextId:140| matchId:139                                                                                           
                                                                             S2|T7 is not leader                  
                                       S1|T7 is not leader                                                        
                                       S1|T7 save persist| votedFor: -1|                                          
                                       logsLen: 149                                                               
                                       S1|T7 appends logs from S0| logLen:                                        
                                       149[AppendEntry]                                                           
                                       S1|T7 starts to apply entries                                              
                                       [140:148][ApplyEntry]                                                      
                                       S1|T7 finishes applying entries                                            
                                       [140:148][ApplyEntry]                                                      
S0|T7 replica entries to S1|                                                                                      
entrylen:9| matchidx:148| nextidx:149                                                                             
                                                                             S2|T7 save persist| votedFor: 0|     
                                                                             logsLen: 149                         
                                                                             S2|T7 appends logs from S0| logLen:  
                                                                             149[AppendEntry]                     
                                                                             S2|T7 starts to apply entries        
                                                                             [148:148][ApplyEntry]                
                                                                             S2|T7 finishes applying entries      
                                                                             [148:148][ApplyEntry]                
S0|T7 replica entries to S2|                                                                                      
entrylen:0| matchidx:148| nextidx:149                                                                             
                                       S1|T7 is not leader                                                        
                                                                             S2|T7 is not leader                  
                                                                             S2|T7 save persist| votedFor: 0|     
                                                                             logsLen: 149                         
                                                                             S2|T7 appends logs from S0| logLen:  
                                                                             149[AppendEntry]                     
S0|T7 replica entries to S2|                                                                                      
entrylen:0| matchidx:148| nextidx:149                                                                             
                                       S1|T7 save persist| votedFor: -1|                                          
                                       logsLen: 149                                                               
                                       S1|T7 appends logs from S0| logLen:                                        
                                       149[AppendEntry]                                                           
S0|T7 replica entries to S1|                                                                                      
entrylen:0| matchidx:148| nextidx:149                                                                             
                                       S1|T7 is not leader                                                        
                                                                             S2|T7 is not leader                  
                                                                             S2|T7 save persist| votedFor: 0|     
                                                                             logsLen: 149                         
                                                                             S2|T7 appends logs from S0| logLen:  
                                                                             149[AppendEntry]                     
S0|T7 replica entries to S2|                                                                                      
entrylen:0| matchidx:148| nextidx:149                                                                             
                                                                             S2|T7 is not leader                  
                                       S1|T7 is not leader                                                        
                                                                             S2|T7 save persist| votedFor: 0|     
                                                                             logsLen: 149                         
                                                                             S2|T7 appends logs from S0| logLen:  
                                                                             149[AppendEntry]                     
S0|T7 replica entries to S2|                                                                                      
entrylen:0| matchidx:148| nextidx:149                                                                             
                                                                             S2|T7 is not leader                  
                                       S1|T7 is not leader                                                        
                                       S1|T7 save persist| votedFor: -1|                                          
                                       logsLen: 149                                                               
                                       S1|T7 appends logs from S0| logLen:                                        
                                       149[AppendEntry]                                                           
S0|T7 replica entries to S1|                                                                                      
entrylen:0| matchidx:148| nextidx:149                                                                             
                                                                             S2|T7 save persist| votedFor: 0|     
                                                                             logsLen: 149                         
                                                                             S2|T7 appends logs from S0| logLen:  
                                                                             149[AppendEntry]                     
S0|T7 replica entries to S2|                                                                                      
entrylen:0| matchidx:148| nextidx:149                                                                             
S0 is disconnected                                                                                                
                                       S1|T7 is not leader                                                        
                                                                             S2|T7 is not leader                  
                                                                             S2|T7 is not leader                  
                                       S1|T7 is not leader                                                        
                                       S1|T7 is not leader                                                        
                                                                             S2|T7 is not leader                  
                                       S1|T7 is not leader                                                        
                                                                             S2|T7 is not leader                  
                                       S1|T7 is not leader                                                        
                                                                             S2|T7 is not leader                  
                                       S1|T7 is not leader                                                        
                                                                             S2|T7 is not leader                  
                                       S1|T7 is not leader                                                        
                                                                             S2|T7 is not leader                  
                                                                             S2|T7 is not leader                  
                                       S1|T7 is not leader                                                        
                                       S1|T8 starts to join election                                              
                                                                             S2|T7 is not leader                  
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 149                                                               
                                       S1|T8 is not leader                                                        
                                                                             S2|T8 save persist| votedFor: -1|    
                                                                             logsLen: 149                         
                                                                             S2|T8 save persist| votedFor: 1|     
                                                                             logsLen: 149                         
                                                                             S2|T8 votes for S1[RequestVote]      
                                       S1|T8 becomes the leader, and starts                                       
                                       heatbeats                                                                  
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 150                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       150[Start]                                                                 
                                                                             S2|T8 is not leader                  
                                                                             S2|T8 save persist| votedFor: 1|     
                                                                             logsLen: 150                         
                                                                             S2|T8 appends logs from S1| logLen:  
                                                                             150[AppendEntry]                     
                                       S1|T8 replica entries to S2|                                               
                                       entrylen:1| matchidx:149| nextidx:150                                      
                                       S1|T8 update commitIndex as 149                                            
                                       S1|T8 starts to apply entries                                              
                                       [149:149][ApplyEntry]                                                      
                                       S1|T8 finishes applying entries                                            
                                       [149:149][ApplyEntry]                                                      
                                       S1|T8 Snapshot until index 149|                                            
                                       logLen: 150                                                                
                                                                             S2|T8 is not leader                  
                                       S1|T8 send rpc to S0|base: 149| next:                                      
                                       149                                                                        
                                                                             S2|T8 save persist| votedFor: 1|     
                                                                             logsLen: 150                         
                                                                             S2|T8 appends logs from S1| logLen:  
                                                                             150[AppendEntry]                     
                                                                             S2|T8 starts to apply entries        
                                                                             [149:149][ApplyEntry]                
                                                                             S2|T8 finishes applying entries      
                                                                             [149:149][ApplyEntry]                
                                       S1|T8 replica entries to S2|                                               
                                       entrylen:0| matchidx:149| nextidx:150                                      
                                                                             S2|T8 Snapshot until index 149|      
                                                                             logLen: 150                          
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 151                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       151[Start]                                                                 
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 152                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       152[Start]                                                                 
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 153                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       153[Start]                                                                 
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 154                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       154[Start]                                                                 
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 155                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       155[Start]                                                                 
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 156                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       156[Start]                                                                 
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 157                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       157[Start]                                                                 
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 158                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       158[Start]                                                                 
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 159                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       159[Start]                                                                 
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 160                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       160[Start]                                                                 
                                                                             S2|T8 is not leader                  
                                       S1|T8 send rpc to S0|base: 149| next:                                      
                                       149                                                                        
                                                                             S2|T8 save persist| votedFor: 1|     
                                                                             logsLen: 160                         
                                                                             S2|T8 appends logs from S1| logLen:  
                                                                             160[AppendEntry]                     
                                       S1|T8 replica entries to S2|                                               
                                       entrylen:10| matchidx:159|                                                 
                                       nextidx:160                                                                
                                       S1|T8 update commitIndex as 159                                            
                                       S1|T8 starts to apply entries                                              
                                       [150:159][ApplyEntry]                                                      
                                       S1|T8 finishes applying entries                                            
                                       [150:159][ApplyEntry]                                                      
                                       S1|T8 Snapshot until index 159|                                            
                                       logLen: 160                                                                
                                                                             S2|T8 is not leader                  
                                       S1|T8 send rpc to S0|base: 159| next:                                      
                                       149                                                                        
                                                                             S2|T8 save persist| votedFor: 1|     
                                                                             logsLen: 160                         
                                                                             S2|T8 appends logs from S1| logLen:  
                                                                             160[AppendEntry]                     
                                                                             S2|T8 starts to apply entries        
                                                                             [150:159][ApplyEntry]                
                                                                             S2|T8 finishes applying entries      
                                                                             [150:159][ApplyEntry]                
                                       S1|T8 replica entries to S2|                                               
                                       entrylen:0| matchidx:159| nextidx:160                                      
                                                                             S2|T8 Snapshot until index 159|      
                                                                             logLen: 160                          
S0 is connected again                                                                                             
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 161                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       161[Start]                                                                 
                                                                             S2|T8 is not leader                  
                                       S1|T8 send rpc to S0|base: 159| next:                                      
                                       149                                                                        
                                       S1|T8 rejects to append entries from                                       
                                       S0 | out of date term[AppendEntry]                                         
S0|T8 save persist| votedFor: -1|                                                                                 
logsLen: 149                                                                                                      
S0|T8 receive rpc from S1                                                                                         
S0|T8 update rfstate| Base:159|                                                                                   
LogLen:160                                                                                                        
S0|T8 applys snapshot from S1                                                                                     
                                       S1|T8 installs snapshot to S0|                                             
                                       nextId:160| matchId:159                                                    
                                                                             S2|T8 rejects to append entries from 
                                                                             S0 | out of date term[AppendEntry]   
S0|T8 lost leadership, state: 0                                                                                   
                                                                             S2|T8 save persist| votedFor: 1|     
                                                                             logsLen: 161                         
                                                                             S2|T8 appends logs from S1| logLen:  
                                                                             161[AppendEntry]                     
                                       S1|T8 replica entries to S2|                                               
                                       entrylen:1| matchidx:160| nextidx:161                                      
                                       S1|T8 update commitIndex as 160                                            
                                       S1|T8 starts to apply entries                                              
                                       [160:160][ApplyEntry]                                                      
                                       S1|T8 finishes applying entries                                            
                                       [160:160][ApplyEntry]                                                      
S0|T8 is not leader                                                                                               
                                                                             S2|T8 is not leader                  
S0|T8 save persist| votedFor: -1|                                                                                 
logsLen: 161                                                                                                      
S0|T8 appends logs from S1| logLen:                                                                               
161[AppendEntry]                                                                                                  
S0|T8 starts to apply entries                                                                                     
[160:160][ApplyEntry]                                                                                             
S0|T8 finishes applying entries                                                                                   
[160:160][ApplyEntry]                                                                                             
                                       S1|T8 replica entries to S0|                                               
                                       entrylen:1| matchidx:160| nextidx:161                                      
                                                                             S2|T8 save persist| votedFor: 1|     
                                                                             logsLen: 161                         
                                                                             S2|T8 appends logs from S1| logLen:  
                                                                             161[AppendEntry]                     
                                                                             S2|T8 starts to apply entries        
                                                                             [160:160][ApplyEntry]                
                                                                             S2|T8 finishes applying entries      
                                                                             [160:160][ApplyEntry]                
                                       S1|T8 replica entries to S2|                                               
                                       entrylen:0| matchidx:160| nextidx:161                                      
                                                                             S2|T8 is not leader                  
S0|T8 is not leader                                                                                               
S0|T8 save persist| votedFor: -1|                                                                                 
logsLen: 161                                                                                                      
S0|T8 appends logs from S1| logLen:                                                                               
161[AppendEntry]                                                                                                  
                                       S1|T8 replica entries to S0|                                               
                                       entrylen:0| matchidx:160| nextidx:161                                      
                                                                             S2|T8 save persist| votedFor: 1|     
                                                                             logsLen: 161                         
                                                                             S2|T8 appends logs from S1| logLen:  
                                                                             161[AppendEntry]                     
                                       S1|T8 replica entries to S2|                                               
                                       entrylen:0| matchidx:160| nextidx:161                                      
S0|T8 is not leader                                                                                               
                                                                             S2|T8 is not leader                  
                                                                             S2|T8 save persist| votedFor: 1|     
                                                                             logsLen: 161                         
                                                                             S2|T8 appends logs from S1| logLen:  
                                                                             161[AppendEntry]                     
                                       S1|T8 replica entries to S2|                                               
                                       entrylen:0| matchidx:160| nextidx:161                                      
S0|T8 save persist| votedFor: -1|                                                                                 
logsLen: 161                                                                                                      
S0|T8 appends logs from S1| logLen:                                                                               
161[AppendEntry]                                                                                                  
                                       S1|T8 replica entries to S0|                                               
                                       entrylen:0| matchidx:160| nextidx:161                                      
                                                                             S2|T8 is not leader                  
S0|T8 is not leader                                                                                               
S0|T8 save persist| votedFor: -1|                                                                                 
logsLen: 161                                                                                                      
S0|T8 appends logs from S1| logLen:                                                                               
161[AppendEntry]                                                                                                  
                                       S1|T8 replica entries to S0|                                               
                                       entrylen:0| matchidx:160| nextidx:161                                      
                                                                             S2|T8 save persist| votedFor: 1|     
                                                                             logsLen: 161                         
                                                                             S2|T8 appends logs from S1| logLen:  
                                                                             161[AppendEntry]                     
                                       S1|T8 replica entries to S2|                                               
                                       entrylen:0| matchidx:160| nextidx:161                                      
S0|T8 is not leader                                                                                               
                                                                             S2|T8 is not leader                  
                                                                             S2|T8 save persist| votedFor: 1|     
                                                                             logsLen: 161                         
                                                                             S2|T8 appends logs from S1| logLen:  
                                                                             161[AppendEntry]                     
                                       S1|T8 replica entries to S2|                                               
                                       entrylen:0| matchidx:160| nextidx:161                                      
S0|T8 save persist| votedFor: -1|                                                                                 
logsLen: 161                                                                                                      
S0|T8 appends logs from S1| logLen:                                                                               
161[AppendEntry]                                                                                                  
                                       S1|T8 replica entries to S0|                                               
                                       entrylen:0| matchidx:160| nextidx:161                                      
S0|T8 is not leader                                                                                               
                                                                             S2|T8 is not leader                  
                                                                             S2|T8 save persist| votedFor: 1|     
                                                                             logsLen: 161                         
                                                                             S2|T8 appends logs from S1| logLen:  
                                                                             161[AppendEntry]                     
                                       S1|T8 replica entries to S2|                                               
                                       entrylen:0| matchidx:160| nextidx:161                                      
S0|T8 save persist| votedFor: -1|                                                                                 
logsLen: 161                                                                                                      
S0|T8 appends logs from S1| logLen:                                                                               
161[AppendEntry]                                                                                                  
                                       S1|T8 replica entries to S0|                                               
                                       entrylen:0| matchidx:160| nextidx:161                                      
                                                                             S2 is disconnected                   
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 162                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       162[Start]                                                                 
                                                                             S2|T8 is not leader                  
S0|T8 is not leader                                                                                               
S0|T8 save persist| votedFor: -1|                                                                                 
logsLen: 162                                                                                                      
S0|T8 appends logs from S1| logLen:                                                                               
162[AppendEntry]                                                                                                  
                                       S1|T8 replica entries to S0|                                               
                                       entrylen:1| matchidx:161| nextidx:162                                      
                                       S1|T8 update commitIndex as 161                                            
                                       S1|T8 starts to apply entries                                              
                                       [161:161][ApplyEntry]                                                      
                                       S1|T8 finishes applying entries                                            
                                       [161:161][ApplyEntry]                                                      
                                                                             S2|T8 is not leader                  
S0|T8 is not leader                                                                                               
S0|T8 save persist| votedFor: -1|                                                                                 
logsLen: 162                                                                                                      
S0|T8 appends logs from S1| logLen:                                                                               
162[AppendEntry]                                                                                                  
S0|T8 starts to apply entries                                                                                     
[161:161][ApplyEntry]                                                                                             
S0|T8 finishes applying entries                                                                                   
[161:161][ApplyEntry]                                                                                             
                                       S1|T8 replica entries to S0|                                               
                                       entrylen:0| matchidx:161| nextidx:162                                      
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 163                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       163[Start]                                                                 
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 164                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       164[Start]                                                                 
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 165                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       165[Start]                                                                 
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 166                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       166[Start]                                                                 
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 167                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       167[Start]                                                                 
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 168                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       168[Start]                                                                 
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 169                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       169[Start]                                                                 
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 170                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       170[Start]                                                                 
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 171                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       171[Start]                                                                 
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 172                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       172[Start]                                                                 
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 173                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       173[Start]                                                                 
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 174                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       174[Start]                                                                 
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 175                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       175[Start]                                                                 
                                                                             S2|T8 is not leader                  
S0|T8 is not leader                                                                                               
S0|T8 save persist| votedFor: -1|                                                                                 
logsLen: 175                                                                                                      
S0|T8 appends logs from S1| logLen:                                                                               
175[AppendEntry]                                                                                                  
                                       S1|T8 replica entries to S0|                                               
                                       entrylen:13| matchidx:174|                                                 
                                       nextidx:175                                                                
                                       S1|T8 update commitIndex as 174                                            
                                       S1|T8 starts to apply entries                                              
                                       [162:174][ApplyEntry]                                                      
                                       S1|T8 Snapshot until index 169|                                            
                                       logLen: 175                                                                
                                       S1|T8 finishes applying entries                                            
                                       [162:174][ApplyEntry]                                                      
                                                                             S2|T8 is not leader                  
S0|T8 is not leader                                                                                               
                                       S1|T8 send rpc to S2|base: 169| next:                                      
                                       161                                                                        
S0|T8 save persist| votedFor: -1|                                                                                 
logsLen: 175                                                                                                      
S0|T8 appends logs from S1| logLen:                                                                               
175[AppendEntry]                                                                                                  
S0|T8 starts to apply entries                                                                                     
[162:174][ApplyEntry]                                                                                             
                                       S1|T8 replica entries to S0|                                               
                                       entrylen:0| matchidx:174| nextidx:175                                      
S0|T8 Snapshot until index 169|                                                                                   
logLen: 175                                                                                                       
S0|T8 finishes applying entries                                                                                   
[162:174][ApplyEntry]                                                                                             
                                                                             S2 is connected again                
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 176                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       176[Start]                                                                 
                                                                             S2|T8 is not leader                  
S0|T8 is not leader                                                                                               
                                       S1|T8 send rpc to S2|base: 169| next:                                      
                                       161                                                                        
S0|T8 save persist| votedFor: -1|                                                                                 
logsLen: 176                                                                                                      
S0|T8 appends logs from S1| logLen:                                                                               
176[AppendEntry]                                                                                                  
                                       S1|T8 replica entries to S0|                                               
                                       entrylen:1| matchidx:175| nextidx:176                                      
                                       S1|T8 update commitIndex as 175                                            
                                       S1|T8 starts to apply entries                                              
                                       [175:175][ApplyEntry]                                                      
                                       S1|T8 finishes applying entries                                            
                                       [175:175][ApplyEntry]                                                      
                                                                             S2|T8 receive rpc from S1            
                                                                             S2|T8 update rfstate| Base:169|      
                                                                             LogLen:170                           
                                                                             S2|T8 applys snapshot from S1        
                                       S1|T8 installs snapshot to S2|                                             
                                       nextId:170| matchId:169                                                    
S0|T8 is not leader                                                                                               
                                                                             S2|T8 is not leader                  
                                                                             S2|T8 save persist| votedFor: 1|     
                                                                             logsLen: 176                         
                                                                             S2|T8 appends logs from S1| logLen:  
                                                                             176[AppendEntry]                     
                                                                             S2|T8 starts to apply entries        
                                                                             [170:175][ApplyEntry]                
                                                                             S2|T8 finishes applying entries      
                                                                             [170:175][ApplyEntry]                
                                       S1|T8 replica entries to S2|                                               
                                       entrylen:6| matchidx:175| nextidx:176                                      
                                                                             S2|T8 is not leader                  
S0|T8 is not leader                                                                                               
S0|T8 save persist| votedFor: -1|                                                                                 
logsLen: 176                                                                                                      
S0|T8 appends logs from S1| logLen:                                                                               
176[AppendEntry]                                                                                                  
S0|T8 starts to apply entries                                                                                     
[175:175][ApplyEntry]                                                                                             
S0|T8 finishes applying entries                                                                                   
[175:175][ApplyEntry]                                                                                             
                                       S1|T8 replica entries to S0|                                               
                                       entrylen:0| matchidx:175| nextidx:176                                      
                                                                             S2|T8 is not leader                  
S0|T8 is not leader                                                                                               
S0|T8 save persist| votedFor: -1|                                                                                 
logsLen: 176                                                                                                      
S0|T8 appends logs from S1| logLen:                                                                               
176[AppendEntry]                                                                                                  
                                       S1|T8 replica entries to S0|                                               
                                       entrylen:0| matchidx:175| nextidx:176                                      
                                                                             S2|T8 save persist| votedFor: 1|     
                                                                             logsLen: 176                         
                                                                             S2|T8 appends logs from S1| logLen:  
                                                                             176[AppendEntry]                     
                                       S1|T8 replica entries to S2|                                               
                                       entrylen:0| matchidx:175| nextidx:176                                      
                                                                             S2|T8 is not leader                  
S0|T8 is not leader                                                                                               
                                       S1|T8 fails to install snapshot to S0                                      
                                                                             S2|T8 save persist| votedFor: 1|     
                                                                             logsLen: 176                         
                                                                             S2|T8 appends logs from S1| logLen:  
                                                                             176[AppendEntry]                     
                                       S1|T8 replica entries to S2|                                               
                                       entrylen:0| matchidx:175| nextidx:176                                      
S0|T8 save persist| votedFor: -1|                                                                                 
logsLen: 176                                                                                                      
S0|T8 appends logs from S1| logLen:                                                                               
176[AppendEntry]                                                                                                  
                                       S1|T8 replica entries to S0|                                               
                                       entrylen:0| matchidx:175| nextidx:176                                      
S0|T8 is not leader                                                                                               
                                                                             S2|T8 is not leader                  
                                                                             S2|T8 save persist| votedFor: 1|     
                                                                             logsLen: 176                         
                                                                             S2|T8 appends logs from S1| logLen:  
                                                                             176[AppendEntry]                     
                                       S1|T8 replica entries to S2|                                               
                                       entrylen:0| matchidx:175| nextidx:176                                      
S0|T8 is not leader                                                                                               
                                                                             S2|T8 is not leader                  
                                                                             S2|T8 save persist| votedFor: 1|     
                                                                             logsLen: 176                         
                                                                             S2|T8 appends logs from S1| logLen:  
                                                                             176[AppendEntry]                     
                                       S1|T8 replica entries to S2|                                               
                                       entrylen:0| matchidx:175| nextidx:176                                      
S0|T8 save persist| votedFor: -1|                                                                                 
logsLen: 176                                                                                                      
S0|T8 appends logs from S1| logLen:                                                                               
176[AppendEntry]                                                                                                  
                                       S1|T8 replica entries to S0|                                               
                                       entrylen:0| matchidx:175| nextidx:176                                      
S0|T8 fails to install snapshot to S1                                                                             
S0|T8 is not leader                                                                                               
                                                                             S2|T8 is not leader                  
S0|T8 save persist| votedFor: -1|                                                                                 
logsLen: 176                                                                                                      
S0|T8 appends logs from S1| logLen:                                                                               
176[AppendEntry]                                                                                                  
                                       S1|T8 replica entries to S0|                                               
                                       entrylen:0| matchidx:175| nextidx:176                                      
                                                                             S2|T8 save persist| votedFor: 1|     
                                                                             logsLen: 176                         
                                                                             S2|T8 appends logs from S1| logLen:  
                                                                             176[AppendEntry]                     
                                       S1|T8 replica entries to S2|                                               
                                       entrylen:0| matchidx:175| nextidx:176                                      
                                                                             S2 is disconnected                   
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 177                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       177[Start]                                                                 
S0|T8 is not leader                                                                                               
                                                                             S2|T8 is not leader                  
S0|T8 save persist| votedFor: -1|                                                                                 
logsLen: 177                                                                                                      
S0|T8 appends logs from S1| logLen:                                                                               
177[AppendEntry]                                                                                                  
                                       S1|T8 replica entries to S0|                                               
                                       entrylen:1| matchidx:176| nextidx:177                                      
                                       S1|T8 update commitIndex as 176                                            
                                       S1|T8 starts to apply entries                                              
                                       [176:176][ApplyEntry]                                                      
                                       S1|T8 finishes applying entries                                            
                                       [176:176][ApplyEntry]                                                      
S0|T8 is not leader                                                                                               
                                                                             S2|T8 is not leader                  
S0|T8 save persist| votedFor: -1|                                                                                 
logsLen: 177                                                                                                      
S0|T8 appends logs from S1| logLen:                                                                               
177[AppendEntry]                                                                                                  
S0|T8 starts to apply entries                                                                                     
[176:176][ApplyEntry]                                                                                             
S0|T8 finishes applying entries                                                                                   
[176:176][ApplyEntry]                                                                                             
                                       S1|T8 replica entries to S0|                                               
                                       entrylen:0| matchidx:176| nextidx:177                                      
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 178                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       178[Start]                                                                 
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 179                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       179[Start]                                                                 
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 180                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       180[Start]                                                                 
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 181                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       181[Start]                                                                 
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 182                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       182[Start]                                                                 
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 183                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       183[Start]                                                                 
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 184                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       184[Start]                                                                 
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 185                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       185[Start]                                                                 
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 186                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       186[Start]                                                                 
S0|T8 is not leader                                                                                               
                                                                             S2|T8 is not leader                  
S0|T8 save persist| votedFor: -1|                                                                                 
logsLen: 186                                                                                                      
S0|T8 appends logs from S1| logLen:                                                                               
186[AppendEntry]                                                                                                  
                                       S1|T8 replica entries to S0|                                               
                                       entrylen:9| matchidx:185| nextidx:186                                      
                                       S1|T8 update commitIndex as 185                                            
                                       S1|T8 starts to apply entries                                              
                                       [177:185][ApplyEntry]                                                      
                                       S1|T8 Snapshot until index 179|                                            
                                       logLen: 186                                                                
                                       S1|T8 finishes applying entries                                            
                                       [177:185][ApplyEntry]                                                      
                                                                             S2|T8 is not leader                  
S0|T8 is not leader                                                                                               
                                       S1|T8 send rpc to S2|base: 179| next:                                      
                                       176                                                                        
S0|T8 save persist| votedFor: -1|                                                                                 
logsLen: 186                                                                                                      
S0|T8 appends logs from S1| logLen:                                                                               
186[AppendEntry]                                                                                                  
S0|T8 starts to apply entries                                                                                     
[177:185][ApplyEntry]                                                                                             
                                       S1|T8 replica entries to S0|                                               
                                       entrylen:0| matchidx:185| nextidx:186                                      
S0|T8 Snapshot until index 179|                                                                                   
logLen: 186                                                                                                       
S0|T8 finishes applying entries                                                                                   
[177:185][ApplyEntry]                                                                                             
                                                                             S2 is connected again                
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 187                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       187[Start]                                                                 
S0|T8 fails to install snapshot to S1                                                                             
S0|T8 is not leader                                                                                               
                                                                             S2|T8 is not leader                  
                                       S1|T8 send rpc to S2|base: 179| next:                                      
                                       176                                                                        
                                                                             S2|T8 receive rpc from S1            
                                                                             S2|T8 update rfstate| Base:179|      
                                                                             LogLen:180                           
                                                                             S2|T8 applys snapshot from S1        
                                       S1|T8 fails to install snapshot to S2                                      
S0|T8 is not leader                                                                                               
                                                                             S2|T8 is not leader                  
                                       S1|T8 send rpc to S2|base: 179| next:                                      
                                       176                                                                        
S0|T8 save persist| votedFor: -1|                                                                                 
logsLen: 187                                                                                                      
S0|T8 appends logs from S1| logLen:                                                                               
187[AppendEntry]                                                                                                  
                                       S1|T8 replica entries to S0|                                               
                                       entrylen:1| matchidx:186| nextidx:187                                      
                                       S1|T8 update commitIndex as 186                                            
                                       S1|T8 starts to apply entries                                              
                                       [186:186][ApplyEntry]                                                      
                                       S1|T8 finishes applying entries                                            
                                       [186:186][ApplyEntry]                                                      
                                                                             S2|T8 receive rpc from S1            
                                                                             S2|T8 rejects to installsnap from S1 
                                                                             | out of date term                   
                                       S1|T8 installs snapshot to S2|                                             
                                       nextId:180| matchId:179                                                    
S0|T8 is not leader                                                                                               
                                                                             S2|T8 is not leader                  
S0|T8 save persist| votedFor: -1|                                                                                 
logsLen: 187                                                                                                      
S0|T8 appends logs from S1| logLen:                                                                               
187[AppendEntry]                                                                                                  
S0|T8 starts to apply entries                                                                                     
[186:186][ApplyEntry]                                                                                             
S0|T8 finishes applying entries                                                                                   
[186:186][ApplyEntry]                                                                                             
                                       S1|T8 replica entries to S0|                                               
                                       entrylen:0| matchidx:186| nextidx:187                                      
                                                                             S2|T8 is not leader                  
S0|T8 is not leader                                                                                               
                                       S1|T8 fails to install snapshot to S2                                      
S0|T8 save persist| votedFor: -1|                                                                                 
logsLen: 187                                                                                                      
S0|T8 appends logs from S1| logLen:                                                                               
187[AppendEntry]                                                                                                  
                                       S1|T8 replica entries to S0|                                               
                                       entrylen:0| matchidx:186| nextidx:187                                      
                                                                             S2|T8 save persist| votedFor: 1|     
                                                                             logsLen: 187                         
                                                                             S2|T8 appends logs from S1| logLen:  
                                                                             187[AppendEntry]                     
                                                                             S2|T8 starts to apply entries        
                                                                             [180:186][ApplyEntry]                
                                                                             S2|T8 finishes applying entries      
                                                                             [180:186][ApplyEntry]                
                                       S1|T8 replica entries to S2|                                               
                                       entrylen:7| matchidx:186| nextidx:187                                      
                                                                             S2|T8 is not leader                  
S0|T8 is not leader                                                                                               
S0|T8 save persist| votedFor: -1|                                                                                 
logsLen: 187                                                                                                      
S0|T8 appends logs from S1| logLen:                                                                               
187[AppendEntry]                                                                                                  
                                       S1|T8 replica entries to S0|                                               
                                       entrylen:0| matchidx:186| nextidx:187                                      
                                                                             S2|T8 save persist| votedFor: 1|     
                                                                             logsLen: 187                         
                                                                             S2|T8 appends logs from S1| logLen:  
                                                                             187[AppendEntry]                     
                                       S1|T8 replica entries to S2|                                               
                                       entrylen:0| matchidx:186| nextidx:187                                      
                                                                             S2|T8 is not leader                  
S0|T8 is not leader                                                                                               
                                                                             S2|T8 save persist| votedFor: 1|     
                                                                             logsLen: 187                         
                                                                             S2|T8 appends logs from S1| logLen:  
                                                                             187[AppendEntry]                     
S0|T8 save persist| votedFor: -1|                                                                                 
logsLen: 187                                                                                                      
S0|T8 appends logs from S1| logLen:                                                                               
187[AppendEntry]                                                                                                  
                                       S1|T8 replica entries to S2|                                               
                                       entrylen:0| matchidx:186| nextidx:187                                      
                                       S1|T8 replica entries to S0|                                               
                                       entrylen:0| matchidx:186| nextidx:187                                      
                                                                             S2|T8 is not leader                  
S0|T8 is not leader                                                                                               
                                                                             S2|T8 save persist| votedFor: 1|     
                                                                             logsLen: 187                         
                                                                             S2|T8 appends logs from S1| logLen:  
                                                                             187[AppendEntry]                     
                                       S1|T8 replica entries to S2|                                               
                                       entrylen:0| matchidx:186| nextidx:187                                      
S0|T8 save persist| votedFor: -1|                                                                                 
logsLen: 187                                                                                                      
S0|T8 appends logs from S1| logLen:                                                                               
187[AppendEntry]                                                                                                  
                                       S1|T8 replica entries to S0|                                               
                                       entrylen:0| matchidx:186| nextidx:187                                      
                                                                             S2|T8 is not leader                  
S0|T8 is not leader                                                                                               
S0|T8 save persist| votedFor: -1|                                                                                 
logsLen: 187                                                                                                      
S0|T8 appends logs from S1| logLen:                                                                               
187[AppendEntry]                                                                                                  
                                       S1|T8 replica entries to S0|                                               
                                       entrylen:0| matchidx:186| nextidx:187                                      
S0|T8 is not leader                                                                                               
                                                                             S2|T8 is not leader                  
S0|T8 save persist| votedFor: -1|                                                                                 
logsLen: 187                                                                                                      
S0|T8 appends logs from S1| logLen:                                                                               
187[AppendEntry]                                                                                                  
                                       S1|T8 replica entries to S0|                                               
                                       entrylen:0| matchidx:186| nextidx:187                                      
                                       S1 is disconnected                                                         
S0|T8 is not leader                                                                                               
                                                                             S2|T8 is not leader                  
S0|T8 is not leader                                                                                               
                                                                             S2|T8 is not leader                  
                                                                             S2|T8 is not leader                  
S0|T8 is not leader                                                                                               
                                                                             S2|T8 is not leader                  
S0|T8 is not leader                                                                                               
S0|T8 is not leader                                                                                               
                                                                             S2|T8 is not leader                  
S0|T8 is not leader                                                                                               
                                                                             S2|T8 is not leader                  
                                                                             S2|T9 starts to join election        
                                                                             S2|T9 save persist| votedFor: 2|     
                                                                             logsLen: 187                         
                                                                             S2|T9 is not leader                  
S0|T8 is not leader                                                                                               
S0|T9 save persist| votedFor: -1|                                                                                 
logsLen: 187                                                                                                      
S0|T9 save persist| votedFor: 2|                                                                                  
logsLen: 187                                                                                                      
S0|T9 votes for S2[RequestVote]                                                                                   
                                                                             S2|T9 is not leader                  
S0|T9 is not leader                                                                                               
                                                                             S2|T9 is not leader                  
S0|T9 is not leader                                                                                               
                                                                             S2|T9 is not leader                  
S0|T9 is not leader                                                                                               
S0|T9 is not leader                                                                                               
                                                                             S2|T9 is not leader                  
                                                                             S2|T9 is not leader                  
S0|T9 is not leader                                                                                               
S0|T10 starts to join election                                                                                    
S0|T10 save persist| votedFor: 0|                                                                                 
logsLen: 187                                                                                                      
                                                                             S2|T10 save persist| votedFor: -1|   
                                                                             logsLen: 187                         
                                                                             S2|T10 save persist| votedFor: 0|    
                                                                             logsLen: 187                         
                                                                             S2|T10 votes for S0[RequestVote]     
S0|T10 becomes the leader, and starts                                                                             
heatbeats                                                                                                         
                                                                             S2|T10 is not leader                 
                                                                             S2|T10 save persist| votedFor: 0|    
                                                                             logsLen: 187                         
                                                                             S2|T10 appends logs from S0| logLen: 
                                                                             187[AppendEntry]                     
S0|T10 replica entries to S2|                                                                                     
entrylen:0| matchidx:186| nextidx:187                                                                             
S0|T10 save persist| votedFor: 0|                                                                                 
logsLen: 188                                                                                                      
S0|T10 receive commands | logLen:                                                                                 
188[Start]                                                                                                        
                                                                             S2|T10 save persist| votedFor: 0|    
                                                                             logsLen: 187                         
                                                                             S2|T10 appends logs from S0| logLen: 
                                                                             187[AppendEntry]                     
S0|T10 replica entries to S2|                                                                                     
entrylen:0| matchidx:186| nextidx:187                                                                             
                                                                             S2|T10 is not leader                 
                                                                             S2|T10 save persist| votedFor: 0|    
                                                                             logsLen: 188                         
                                                                             S2|T10 appends logs from S0| logLen: 
                                                                             188[AppendEntry]                     
S0|T10 replica entries to S2|                                                                                     
entrylen:1| matchidx:187| nextidx:188                                                                             
S0|T10 update commitIndex as 187                                                                                  
S0|T10 starts to apply entries                                                                                    
[187:187][ApplyEntry]                                                                                             
S0|T10 finishes applying entries                                                                                  
[187:187][ApplyEntry]                                                                                             
                                                                             S2|T10 is not leader                 
                                                                             S2|T10 save persist| votedFor: 0|    
                                                                             logsLen: 188                         
                                                                             S2|T10 appends logs from S0| logLen: 
                                                                             188[AppendEntry]                     
                                                                             S2|T10 starts to apply entries       
                                                                             [187:187][ApplyEntry]                
                                                                             S2|T10 finishes applying entries     
                                                                             [187:187][ApplyEntry]                
S0|T10 replica entries to S2|                                                                                     
entrylen:0| matchidx:187| nextidx:188                                                                             
S0|T10 save persist| votedFor: 0|                                                                                 
logsLen: 189                                                                                                      
S0|T10 receive commands | logLen:                                                                                 
189[Start]                                                                                                        
                                                                             S2|T10 is not leader                 
                                                                             S2|T10 save persist| votedFor: 0|    
                                                                             logsLen: 189                         
                                                                             S2|T10 appends logs from S0| logLen: 
                                                                             189[AppendEntry]                     
S0|T10 replica entries to S2|                                                                                     
entrylen:1| matchidx:188| nextidx:189                                                                             
S0|T10 update commitIndex as 188                                                                                  
S0|T10 starts to apply entries                                                                                    
[188:188][ApplyEntry]                                                                                             
S0|T10 finishes applying entries                                                                                  
[188:188][ApplyEntry]                                                                                             
                                                                             S2|T10 is not leader                 
                                                                             S2|T10 save persist| votedFor: 0|    
                                                                             logsLen: 189                         
                                                                             S2|T10 appends logs from S0| logLen: 
                                                                             189[AppendEntry]                     
                                                                             S2|T10 starts to apply entries       
                                                                             [188:188][ApplyEntry]                
                                                                             S2|T10 finishes applying entries     
                                                                             [188:188][ApplyEntry]                
S0|T10 replica entries to S2|                                                                                     
entrylen:0| matchidx:188| nextidx:189                                                                             
                                       S1 is connected again                                                      
                                       S1|T8 save persist| votedFor: 1|                                           
                                       logsLen: 188                                                               
                                       S1|T8 receive commands | logLen:                                           
                                       188[Start]                                                                 
                                                                             S2|T10 is not leader                 
                                                                             S2|T10 rejects to append entries from
                                                                             S1 | out of date term[AppendEntry]   
                                                                             S2|T10 save persist| votedFor: 0|    
                                                                             logsLen: 189                         
                                                                             S2|T10 appends logs from S0| logLen: 
                                                                             189[AppendEntry]                     
S0|T10 replica entries to S2|                                                                                     
entrylen:0| matchidx:188| nextidx:189                                                                             
S0|T10 rejects to append entries from                                                                             
S1 | out of date term[AppendEntry]                                                                                
                                       S1|T10 save persist| votedFor: -1|                                         
                                       logsLen: 188                                                               
                                                                             S2|T10 is not leader                 
                                       S1|T10 is not leader                                                       
                                       S1|T10 save persist| votedFor: -1|                                         
                                       logsLen: 189                                                               
                                       S1|T10 appends logs from S0| logLen:                                       
                                       189[AppendEntry]                                                           
                                       S1|T10 starts to apply entries                                             
                                       [187:188][ApplyEntry]                                                      
                                       S1|T10 finishes applying entries                                           
                                       [187:188][ApplyEntry]                                                      
S0|T10 replica entries to S1|                                                                                     
entrylen:2| matchidx:188| nextidx:189                                                                             
                                                                             S2|T10 save persist| votedFor: 0|    
                                                                             logsLen: 189                         
                                                                             S2|T10 appends logs from S0| logLen: 
                                                                             189[AppendEntry]                     
S0|T10 replica entries to S2|                                                                                     
entrylen:0| matchidx:188| nextidx:189                                                                             
                                       S1|T10 is not leader                                                       
                                                                             S2|T10 is not leader                 
                                       S1|T10 save persist| votedFor: -1|                                         
                                       logsLen: 189                                                               
                                       S1|T10 appends logs from S0| logLen:                                       
                                       189[AppendEntry]                                                           
S0|T10 replica entries to S1|                                                                                     
entrylen:0| matchidx:188| nextidx:189                                                                             
                                                                             S2|T10 save persist| votedFor: 0|    
                                                                             logsLen: 189                         
                                                                             S2|T10 appends logs from S0| logLen: 
                                                                             189[AppendEntry]                     
S0|T10 replica entries to S2|                                                                                     
entrylen:0| matchidx:188| nextidx:189                                                                             
                                       S1|T10 is not leader                                                       
                                                                             S2|T10 is not leader                 
                                                                             S2|T10 save persist| votedFor: 0|    
                                                                             logsLen: 189                         
                                                                             S2|T10 appends logs from S0| logLen: 
                                                                             189[AppendEntry]                     
                                       S1|T10 save persist| votedFor: -1|                                         
                                       logsLen: 189                                                               
                                       S1|T10 appends logs from S0| logLen:                                       
                                       189[AppendEntry]                                                           
S0|T10 replica entries to S2|                                                                                     
entrylen:0| matchidx:188| nextidx:189                                                                             
S0|T10 replica entries to S1|                                                                                     
entrylen:0| matchidx:188| nextidx:189                                                                             
                                       S1|T10 is not leader                                                       
                                                                             S2|T10 is not leader                 
                                                                             S2|T10 is not leader                 
                                       S1|T10 is not leader                                                       
                                       S1|T10 save persist| votedFor: -1|                                         
                                       logsLen: 189                                                               
                                       S1|T10 appends logs from S0| logLen:                                       
                                       189[AppendEntry]                                                           
S0|T10 replica entries to S1|                                                                                     
entrylen:0| matchidx:188| nextidx:189                                                                             
                                                                             S2|T10 save persist| votedFor: 0|    
                                                                             logsLen: 189                         
                                                                             S2|T10 appends logs from S0| logLen: 
                                                                             189[AppendEntry]                     
S0|T10 replica entries to S2|                                                                                     
entrylen:0| matchidx:188| nextidx:189                                                                             
                                       S1|T10 is not leader                                                       
                                                                             S2|T10 is not leader                 
                                                                             S2|T10 save persist| votedFor: 0|    
                                                                             logsLen: 189                         
                                                                             S2|T10 appends logs from S0| logLen: 
                                                                             189[AppendEntry]                     
S0|T10 replica entries to S2|                                                                                     
entrylen:0| matchidx:188| nextidx:189                                                                             
                                       S1|T10 save persist| votedFor: -1|                                         
                                       logsLen: 189                                                               
                                       S1|T10 appends logs from S0| logLen:                                       
                                       189[AppendEntry]                                                           
S0|T10 replica entries to S1|                                                                                     
entrylen:0| matchidx:188| nextidx:189                                                                             
                                       S1|T10 is not leader                                                       
                                                                             S2|T10 is not leader                 
                                                                             S2|T10 save persist| votedFor: 0|    
                                                                             logsLen: 189                         
                                                                             S2|T10 appends logs from S0| logLen: 
                                                                             189[AppendEntry]                     
S0|T10 replica entries to S2|                                                                                     
entrylen:0| matchidx:188| nextidx:189                                                                             
                                       S1|T10 fails to install snapshot to                                        
                                       S0                                                                         
                                       S1|T10 is not leader                                                       
                                                                             S2|T10 is not leader                 
                                       S1|T10 save persist| votedFor: -1|                                         
                                       logsLen: 189                                                               
                                       S1|T10 appends logs from S0| logLen:                                       
                                       189[AppendEntry]                                                           
S0|T10 replica entries to S1|                                                                                     
entrylen:0| matchidx:188| nextidx:189                                                                             
                                                                             S2|T10 save persist| votedFor: 0|    
                                                                             logsLen: 189                         
                                                                             S2|T10 appends logs from S0| logLen: 
                                                                             189[AppendEntry]                     
S0|T10 replica entries to S2|                                                                                     
entrylen:0| matchidx:188| nextidx:189                                                                             
                                       S1|T10 fails to install snapshot to                                        
                                       S0                                                                         
                                                                             S2|T10 is not leader                 
                                       S1|T10 is not leader                                                       
                                       S1|T10 save persist| votedFor: -1|                                         
                                       logsLen: 189                                                               
                                       S1|T10 appends logs from S0| logLen:                                       
                                       189[AppendEntry]                                                           
S0|T10 replica entries to S1|                                                                                     
entrylen:0| matchidx:188| nextidx:189                                                                             
                                                                             S2|T10 save persist| votedFor: 0|    
                                                                             logsLen: 189                         
                                                                             S2|T10 appends logs from S0| logLen: 
                                                                             189[AppendEntry]                     
S0|T10 replica entries to S2|                                                                                     
entrylen:0| matchidx:188| nextidx:189                                                                             
                                       S1|T10 is not leader                                                       
                                                                             S2|T10 is not leader                 
                                                                             S2|T10 save persist| votedFor: 0|    
                                                                             logsLen: 189                         
                                                                             S2|T10 appends logs from S0| logLen: 
                                                                             189[AppendEntry]                     
S0|T10 replica entries to S2|                                                                                     
entrylen:0| matchidx:188| nextidx:189                                                                             
                                       S1|T10 save persist| votedFor: -1|                                         
                                       logsLen: 189                                                               
                                       S1|T10 appends logs from S0| logLen:                                       
                                       189[AppendEntry]                                                           
S0|T10 replica entries to S1|                                                                                     
entrylen:0| matchidx:188| nextidx:189                                                                             
                                       S1|T10 is not leader                                                       
                                                                             S2|T10 is not leader                 
                                                                             S2|T10 save persist| votedFor: 0|    
                                                                             logsLen: 189                         
                                                                             S2|T10 appends logs from S0| logLen: 
                                                                             189[AppendEntry]                     
S0|T10 replica entries to S2|                                                                                     
entrylen:0| matchidx:188| nextidx:189                                                                             
                                       S1|T10 save persist| votedFor: -1|                                         
                                       logsLen: 189                                                               
                                       S1|T10 appends logs from S0| logLen:                                       
                                       189[AppendEntry]                                                           
S0|T10 replica entries to S1|                                                                                     
entrylen:0| matchidx:188| nextidx:189                                                                             
                                                                             S2|T10 is not leader                 
                                       S1|T10 is not leader                                                       
                                                                             S2|T10 save persist| votedFor: 0|    
                                                                             logsLen: 189                         
                                                                             S2|T10 appends logs from S0| logLen: 
                                                                             189[AppendEntry]                     
S0|T10 replica entries to S2|                                                                                     
entrylen:0| matchidx:188| nextidx:189                                                                             
                                       S1|T10 save persist| votedFor: -1|                                         
                                       logsLen: 189                                                               
                                       S1|T10 appends logs from S0| logLen:                                       
                                       189[AppendEntry]                                                           
S0|T10 replica entries to S1|                                                                                     
entrylen:0| matchidx:188| nextidx:189                                                                             
                                                                             S2|T10 is not leader                 
                                       S1|T10 is not leader                                                       
                                       S1|T10 save persist| votedFor: -1|                                         
                                       logsLen: 189                                                               
                                       S1|T10 appends logs from S0| logLen:                                       
                                       189[AppendEntry]                                                           
S0|T10 replica entries to S1|                                                                                     
entrylen:0| matchidx:188| nextidx:189                                                                             
                                                                             S2|T10 save persist| votedFor: 0|    
                                                                             logsLen: 189                         
                                                                             S2|T10 appends logs from S0| logLen: 
                                                                             189[AppendEntry]                     
                                                                             S2|T10 is not leader                 
                                       S1|T10 is not leader                                                       
                                                                             S2|T10 save persist| votedFor: 0|    
                                                                             logsLen: 189                         
                                                                             S2|T10 appends logs from S0| logLen: 
                                                                             189[AppendEntry]                     
                                       S1|T10 save persist| votedFor: -1|                                         
                                       logsLen: 189                                                               
                                       S1|T10 appends logs from S0| logLen:                                       
                                       189[AppendEntry]                                                           
S0|T10 replica entries to S2|                                                                                     
entrylen:0| matchidx:188| nextidx:189                                                                             
S0|T10 replica entries to S1|                                                                                     
entrylen:0| matchidx:188| nextidx:189                                                                             
                                                                             S2|T10 is not leader                 
                                       S1|T10 is not leader                                                       
                                                                             S2|T10 save persist| votedFor: 0|    
                                                                             logsLen: 189                         
                                                                             S2|T10 appends logs from S0| logLen: 
                                                                             189[AppendEntry]                     
S0|T10 replica entries to S2|                                                                                     
entrylen:0| matchidx:188| nextidx:189                                                                             
                                       S1|T10 save persist| votedFor: -1|                                         
                                       logsLen: 189                                                               
                                       S1|T10 appends logs from S0| logLen:                                       
                                       189[AppendEntry]                                                           
S0|T10 replica entries to S1|                                                                                     
entrylen:0| matchidx:188| nextidx:189                                                                             
                                       S1|T10 is not leader                                                       
                                                                             S2|T10 is not leader                 
                                       S1|T10 save persist| votedFor: -1|                                         
                                       logsLen: 189                                                               
                                       S1|T10 appends logs from S0| logLen:                                       
                                       189[AppendEntry]                                                           
S0|T10 replica entries to S1|                                                                                     
entrylen:0| matchidx:188| nextidx:189                                                                             
                                                                             S2|T10 save persist| votedFor: 0|    
                                                                             logsLen: 189                         
                                                                             S2|T10 appends logs from S0| logLen: 
                                                                             189[AppendEntry]                     
S0|T10 replica entries to S2|                                                                                     
entrylen:0| matchidx:188| nextidx:189                                                                             
                                                                             S2|T10 is not leader                 
                                       S1|T10 is not leader                                                       
                                                                             S2|T10 save persist| votedFor: 0|    
                                                                             logsLen: 189                         
                                                                             S2|T10 appends logs from S0| logLen: 
                                                                             189[AppendEntry]                     
S0|T10 replica entries to S2|                                                                                     
entrylen:0| matchidx:188| nextidx:189                                                                             
                                       S1|T10 fails to install snapshot to                                        
                                       S2                                                                         
                                       S1|T10 is not leader                                                       
                                                                             S2|T10 is not leader                 
                                       S1|T10 save persist| votedFor: -1|                                         
                                       logsLen: 189                                                               
                                       S1|T10 appends logs from S0| logLen:                                       
                                       189[AppendEntry]                                                           
                                       S1|T10 is not leader                                                       
                                                                             S2|T10 is not leader                 
                                       S1|T10 save persist| votedFor: -1|                                         
                                       logsLen: 189                                                               
                                       S1|T10 appends logs from S0| logLen:                                       
                                       189[AppendEntry]                                                           
S0|T10 replica entries to S1|                                                                                     
entrylen:0| matchidx:188| nextidx:189                                                                             
                                                                             S2|T10 save persist| votedFor: 0|    
                                                                             logsLen: 189                         
                                                                             S2|T10 appends logs from S0| logLen: 
                                                                             189[AppendEntry]                     
S0|T10 replica entries to S2|                                                                                     
entrylen:0| matchidx:188| nextidx:189                                                                             
S0|T10 save persist| votedFor: 0|                                                                                 
logsLen: 190                                                                                                      
S0|T10 receive commands | logLen:                                                                                 
190[Start]                                                                                                        
                                       S1|T10 is not leader                                                       
                                                                             S2|T10 is not leader                 
                                       S1|T10 save persist| votedFor: -1|                                         
                                       logsLen: 190                                                               
                                       S1|T10 appends logs from S0| logLen:                                       
                                       190[AppendEntry]                                                           
S0|T10 replica entries to S1|                                                                                     
entrylen:1| matchidx:189| nextidx:190                                                                             
S0|T10 update commitIndex as 189                                                                                  
S0|T10 starts to apply entries                                                                                    
[189:189][ApplyEntry]                                                                                             
S0|T10 finishes applying entries                                                                                  
[189:189][ApplyEntry]                                                                                             
S0|T10 Snapshot until index 189|                                                                                  
logLen: 190                                                                                                       
                                                                             S2|T10 save persist| votedFor: 0|    
                                                                             logsLen: 190                         
                                                                             S2|T10 appends logs from S0| logLen: 
                                                                             190[AppendEntry]                     
S0|T10 replica entries to S2|                                                                                     
entrylen:1| matchidx:189| nextidx:190                                                                             
                                       S1|T10 is not leader                                                       
                                                                             S2|T10 is not leader                 
                                                                             S2|T10 save persist| votedFor: 0|    
                                                                             logsLen: 190                         
                                                                             S2|T10 appends logs from S0| logLen: 
                                                                             190[AppendEntry]                     
                                                                             S2|T10 starts to apply entries       
                                                                             [189:189][ApplyEntry]                
                                                                             S2|T10 finishes applying entries     
                                                                             [189:189][ApplyEntry]                
S0|T10 replica entries to S2|                                                                                     
entrylen:0| matchidx:189| nextidx:190                                                                             
                                                                             S2|T10 Snapshot until index 189|     
                                                                             logLen: 190                          
                                       S1|T10 save persist| votedFor: -1|                                         
                                       logsLen: 190                                                               
                                       S1|T10 appends logs from S0| logLen:                                       
                                       190[AppendEntry]                                                           
                                       S1|T10 starts to apply entries                                             
                                       [189:189][ApplyEntry]                                                      
                                       S1|T10 finishes applying entries                                           
                                       [189:189][ApplyEntry]                                                      
S0|T10 replica entries to S1|                                                                                     
entrylen:0| matchidx:189| nextidx:190                                                                             
                                       S1|T10 Snapshot until index 189|                                           
                                       logLen: 190                                                                
                                       S1|T10 is not leader                                                       
                                                                             S2|T10 is not leader                 
                                       S1|T10 save persist| votedFor: -1|                                         
                                       logsLen: 190                                                               
                                       S1|T10 appends logs from S0| logLen:                                       
                                       190[AppendEntry]                                                           
                                                                             S2|T10 save persist| votedFor: 0|    
                                                                             logsLen: 190                         
                                                                             S2|T10 appends logs from S0| logLen: 
                                                                             190[AppendEntry]                     
S0|T10 replica entries to S2|                                                                                     
entrylen:0| matchidx:189| nextidx:190                                                                             
                                       S1|T10 is not leader                                                       
                                                                             S2|T10 is not leader                 
                                                                             S2|T10 save persist| votedFor: 0|    
                                                                             logsLen: 190                         
                                                                             S2|T10 appends logs from S0| logLen: 
                                                                             190[AppendEntry]                     
S0|T10 replica entries to S2|                                                                                     
entrylen:0| matchidx:189| nextidx:190                                                                             
                                       S1|T10 save persist| votedFor: -1|                                         
                                       logsLen: 190                                                               
                                       S1|T10 appends logs from S0| logLen:                                       
                                       190[AppendEntry]                                                           
S0|T10 replica entries to S1|                                                                                     
entrylen:0| matchidx:189| nextidx:190                                                                             
                                                                             S2|T10 is not leader                 
                                       S1|T10 is not leader                                                       
                                       S1|T10 save persist| votedFor: -1|                                         
                                       logsLen: 190                                                               
                                       S1|T10 appends logs from S0| logLen:                                       
                                       190[AppendEntry]                                                           
S0|T10 replica entries to S1|                                                                                     
entrylen:0| matchidx:189| nextidx:190                                                                             
                                                                             S2|T10 save persist| votedFor: 0|    
                                                                             logsLen: 190                         
                                                                             S2|T10 appends logs from S0| logLen: 
                                                                             190[AppendEntry]                     
                                                                             S2|T10 is not leader                 
                                       S1|T10 is not leader                                                       
                                       S1|T10 save persist| votedFor: -1|                                         
                                       logsLen: 190                                                               
                                       S1|T10 appends logs from S0| logLen:                                       
                                       190[AppendEntry]                                                           
S0|T10 replica entries to S1|                                                                                     
entrylen:0| matchidx:189| nextidx:190                                                                             
                                                                             S2|T10 save persist| votedFor: 0|    
                                                                             logsLen: 190                         
                                                                             S2|T10 appends logs from S0| logLen: 
                                                                             190[AppendEntry]                     
S0|T10 replica entries to S2|                                                                                     
entrylen:0| matchidx:189| nextidx:190                                                                             
                                       S1|T10 is not leader                                                       
                                                                             S2|T10 is not leader                 
                                       S1|T10 save persist| votedFor: -1|                                         
                                       logsLen: 190                                                               
                                       S1|T10 appends logs from S0| logLen:                                       
                                       190[AppendEntry]                                                           
S0|T10 replica entries to S1|                                                                                     
entrylen:0| matchidx:189| nextidx:190                                                                             
                                                                             S2|T10 save persist| votedFor: 0|    
                                                                             logsLen: 190                         
                                                                             S2|T10 appends logs from S0| logLen: 
                                                                             190[AppendEntry]                     
                                       S1 is disconnected                                                         
S0|T10 save persist| votedFor: 0|                                                                                 
logsLen: 191                                                                                                      
S0|T10 receive commands | logLen:                                                                                 
191[Start]                                                                                                        
                                       S1|T10 is not leader                                                       
                                                                             S2|T10 is not leader                 
                                                                             S2|T10 save persist| votedFor: 0|    
                                                                             logsLen: 191                         
                                                                             S2|T10 appends logs from S0| logLen: 
                                                                             191[AppendEntry]                     
S0|T10 replica entries to S2|                                                                                     
entrylen:1| matchidx:190| nextidx:191                                                                             
S0|T10 update commitIndex as 190                                                                                  
S0|T10 starts to apply entries                                                                                    
[190:190][ApplyEntry]                                                                                             
S0|T10 finishes applying entries                                                                                  
[190:190][ApplyEntry]                                                                                             
                                       S1|T10 is not leader                                                       
                                                                             S2|T10 is not leader                 
                                                                             S2|T10 save persist| votedFor: 0|    
                                                                             logsLen: 191                         
                                                                             S2|T10 appends logs from S0| logLen: 
                                                                             191[AppendEntry]                     
                                                                             S2|T10 starts to apply entries       
                                                                             [190:190][ApplyEntry]                
                                                                             S2|T10 finishes applying entries     
                                                                             [190:190][ApplyEntry]                
S0|T10 replica entries to S2|                                                                                     
entrylen:0| matchidx:190| nextidx:191                                                                             
S0|T10 save persist| votedFor: 0|                                                                                 
logsLen: 192                                                                                                      
S0|T10 receive commands | logLen:                                                                                 
192[Start]                                                                                                        
S0|T10 save persist| votedFor: 0|                                                                                 
logsLen: 193                                                                                                      
S0|T10 receive commands | logLen:                                                                                 
193[Start]                                                                                                        
S0|T10 save persist| votedFor: 0|                                                                                 
logsLen: 194                                                                                                      
S0|T10 receive commands | logLen:                                                                                 
194[Start]                                                                                                        
S0|T10 save persist| votedFor: 0|                                                                                 
logsLen: 195                                                                                                      
S0|T10 receive commands | logLen:                                                                                 
195[Start]                                                                                                        
S0|T10 save persist| votedFor: 0|                                                                                 
logsLen: 196                                                                                                      
S0|T10 receive commands | logLen:                                                                                 
196[Start]                                                                                                        
S0|T10 save persist| votedFor: 0|                                                                                 
logsLen: 197                                                                                                      
S0|T10 receive commands | logLen:                                                                                 
197[Start]                                                                                                        
                                       S1|T10 is not leader                                                       
                                                                             S2|T10 is not leader                 
                                                                             S2|T10 save persist| votedFor: 0|    
                                                                             logsLen: 197                         
                                                                             S2|T10 appends logs from S0| logLen: 
                                                                             197[AppendEntry]                     
S0|T10 replica entries to S2|                                                                                     
entrylen:6| matchidx:196| nextidx:197                                                                             
S0|T10 update commitIndex as 196                                                                                  
S0|T10 starts to apply entries                                                                                    
[191:196][ApplyEntry]                                                                                             
S0|T10 finishes applying entries                                                                                  
[191:196][ApplyEntry]                                                                                             
                                       S1|T10 is not leader                                                       
                                                                             S2|T10 is not leader                 
                                                                             S2|T10 save persist| votedFor: 0|    
                                                                             logsLen: 197                         
                                                                             S2|T10 appends logs from S0| logLen: 
                                                                             197[AppendEntry]                     
                                                                             S2|T10 starts to apply entries       
                                                                             [191:196][ApplyEntry]                
                                                                             S2|T10 finishes applying entries     
                                                                             [191:196][ApplyEntry]                
S0|T10 replica entries to S2|                                                                                     
entrylen:0| matchidx:196| nextidx:197                                                                             
                                       S1 is connected again                                                      
S0|T10 save persist| votedFor: 0|                                                                                 
logsLen: 198                                                                                                      
S0|T10 receive commands | logLen:                                                                                 
198[Start]                                                                                                        
                                                                             S2|T10 is not leader                 
                                       S1|T10 is not leader                                                       
                                                                             S2|T10 save persist| votedFor: 0|    
                                                                             logsLen: 198                         
                                                                             S2|T10 appends logs from S0| logLen: 
                                                                             198[AppendEntry]                     
S0|T10 replica entries to S2|                                                                                     
entrylen:1| matchidx:197| nextidx:198                                                                             
S0|T10 update commitIndex as 197                                                                                  
S0|T10 starts to apply entries                                                                                    
[197:197][ApplyEntry]                                                                                             
S0|T10 finishes applying entries                                                                                  
[197:197][ApplyEntry]                                                                                             
                                       S1|T10 save persist| votedFor: -1|                                         
                                       logsLen: 198                                                               
                                       S1|T10 appends logs from S0| logLen:                                       
                                       198[AppendEntry]                                                           
                                       S1|T10 starts to apply entries                                             
                                       [190:196][ApplyEntry]                                                      
                                       S1|T10 finishes applying entries                                           
                                       [190:196][ApplyEntry]                                                      
S0|T10 replica entries to S1|                                                                                     
entrylen:8| matchidx:197| nextidx:198                                                                             
                                                                             S2|T10 is not leader                 
                                       S1|T10 is not leader                                                       
                                                                             S2|T10 save persist| votedFor: 0|    
                                                                             logsLen: 198                         
                                                                             S2|T10 appends logs from S0| logLen: 
                                                                             198[AppendEntry]                     
                                                                             S2|T10 starts to apply entries       
                                                                             [197:197][ApplyEntry]                
                                                                             S2|T10 finishes applying entries     
                                                                             [197:197][ApplyEntry]                
S0|T10 replica entries to S2|                                                                                     
entrylen:0| matchidx:197| nextidx:198                                                                             
                                       S1|T10 save persist| votedFor: -1|                                         
                                       logsLen: 198                                                               
                                       S1|T10 appends logs from S0| logLen:                                       
                                       198[AppendEntry]                                                           
                                       S1|T10 starts to apply entries                                             
                                       [197:197][ApplyEntry]                                                      
                                       S1|T10 finishes applying entries                                           
                                       [197:197][ApplyEntry]                                                      
S0|T10 replica entries to S1|                                                                                     
entrylen:0| matchidx:197| nextidx:198                                                                             
                                                                             S2|T10 is not leader                 
                                       S1|T10 is not leader                                                       
                                                                             S2|T10 save persist| votedFor: 0|    
                                                                             logsLen: 198                         
                                                                             S2|T10 appends logs from S0| logLen: 
                                                                             198[AppendEntry]                     
                                       S1|T10 save persist| votedFor: -1|                                         
                                       logsLen: 198                                                               
                                       S1|T10 appends logs from S0| logLen:                                       
                                       198[AppendEntry]                                                           
S0|T10 replica entries to S1|                                                                                     
entrylen:0| matchidx:197| nextidx:198                                                                             
                                                                             S2|T10 is not leader                 
                                       S1|T10 is not leader                                                       
                                                                             S2|T10 save persist| votedFor: 0|    
                                                                             logsLen: 198                         
                                                                             S2|T10 appends logs from S0| logLen: 
                                                                             198[AppendEntry]                     
S0|T10 replica entries to S2|                                                                                     
entrylen:0| matchidx:197| nextidx:198                                                                             
                                       S1|T10 save persist| votedFor: -1|                                         
                                       logsLen: 198                                                               
                                       S1|T10 appends logs from S0| logLen:                                       
                                       198[AppendEntry]                                                           
S0|T10 replica entries to S1|                                                                                     
entrylen:0| matchidx:197| nextidx:198                                                                             
                                                                             S2|T10 is not leader                 
                                       S1|T10 is not leader                                                       
                                                                             S2|T10 save persist| votedFor: 0|    
                                                                             logsLen: 198                         
                                                                             S2|T10 appends logs from S0| logLen: 
                                                                             198[AppendEntry]                     
                                       S1|T10 save persist| votedFor: -1|                                         
                                       logsLen: 198                                                               
                                       S1|T10 appends logs from S0| logLen:                                       
                                       198[AppendEntry]                                                           
S0|T10 replica entries to S2|                                                                                     
entrylen:0| matchidx:197| nextidx:198                                                                             
S0|T10 replica entries to S1|                                                                                     
entrylen:0| matchidx:197| nextidx:198                                                                             
                                                                             S2|T10 is not leader                 
                                       S1|T10 is not leader                                                       
                                                                             S2|T10 save persist| votedFor: 0|    
                                                                             logsLen: 198                         
                                                                             S2|T10 appends logs from S0| logLen: 
                                                                             198[AppendEntry]                     
S0|T10 replica entries to S2|                                                                                     
entrylen:0| matchidx:197| nextidx:198                                                                             
                                       S1|T10 save persist| votedFor: -1|                                         
                                       logsLen: 198                                                               
                                       S1|T10 appends logs from S0| logLen:                                       
                                       198[AppendEntry]                                                           
S0|T10 replica entries to S1|                                                                                     
entrylen:0| matchidx:197| nextidx:198                                                                             
                                                                             S2|T10 is not leader                 
                                       S1|T10 is not leader                                                       
                                                                             S2|T10 save persist| votedFor: 0|    
                                                                             logsLen: 198                         
                                                                             S2|T10 appends logs from S0| logLen: 
                                                                             198[AppendEntry]                     
S0|T10 replica entries to S2|                                                                                     
entrylen:0| matchidx:197| nextidx:198                                                                             
                                       S1|T10 save persist| votedFor: -1|                                         
                                       logsLen: 198                                                               
                                       S1|T10 appends logs from S0| logLen:                                       
                                       198[AppendEntry]                                                           
S0|T10 replica entries to S1|                                                                                     
entrylen:0| matchidx:197| nextidx:198                                                                             
                                       S1 is disconnected                                                         
S0|T10 save persist| votedFor: 0|                                                                                 
logsLen: 199                                                                                                      
S0|T10 receive commands | logLen:                                                                                 
199[Start]                                                                                                        
                                       S1|T10 is not leader                                                       
                                                                             S2|T10 is not leader                 
                                                                             S2|T10 save persist| votedFor: 0|    
                                                                             logsLen: 199                         
                                                                             S2|T10 appends logs from S0| logLen: 
                                                                             199[AppendEntry]                     
S0|T10 replica entries to S2|                                                                                     
entrylen:1| matchidx:198| nextidx:199                                                                             
S0|T10 update commitIndex as 198                                                                                  
S0|T10 starts to apply entries                                                                                    
[198:198][ApplyEntry]                                                                                             
S0|T10 finishes applying entries                                                                                  
[198:198][ApplyEntry]                                                                                             
                                       S1|T10 is not leader                                                       
                                                                             S2|T10 is not leader                 
                                                                             S2|T10 save persist| votedFor: 0|    
                                                                             logsLen: 199                         
                                                                             S2|T10 appends logs from S0| logLen: 
                                                                             199[AppendEntry]                     
                                                                             S2|T10 starts to apply entries       
                                                                             [198:198][ApplyEntry]                
                                                                             S2|T10 finishes applying entries     
                                                                             [198:198][ApplyEntry]                
S0|T10 replica entries to S2|                                                                                     
entrylen:0| matchidx:198| nextidx:199                                                                             
S0|T10 save persist| votedFor: 0|                                                                                 
logsLen: 200                                                                                                      
S0|T10 receive commands | logLen:                                                                                 
200[Start]                                                                                                        
S0|T10 save persist| votedFor: 0|                                                                                 
logsLen: 201                                                                                                      
S0|T10 receive commands | logLen:                                                                                 
201[Start]                                                                                                        
S0|T10 save persist| votedFor: 0|                                                                                 
logsLen: 202                                                                                                      
S0|T10 receive commands | logLen:                                                                                 
202[Start]                                                                                                        
S0|T10 save persist| votedFor: 0|                                                                                 
logsLen: 203                                                                                                      
S0|T10 receive commands | logLen:                                                                                 
203[Start]                                                                                                        
S0|T10 save persist| votedFor: 0|                                                                                 
logsLen: 204                                                                                                      
S0|T10 receive commands | logLen:                                                                                 
204[Start]                                                                                                        
S0|T10 save persist| votedFor: 0|                                                                                 
logsLen: 205                                                                                                      
S0|T10 receive commands | logLen:                                                                                 
205[Start]                                                                                                        
S0|T10 save persist| votedFor: 0|                                                                                 
logsLen: 206                                                                                                      
S0|T10 receive commands | logLen:                                                                                 
206[Start]                                                                                                        
S0|T10 save persist| votedFor: 0|                                                                                 
logsLen: 207                                                                                                      
S0|T10 receive commands | logLen:                                                                                 
207[Start]                                                                                                        
S0|T10 save persist| votedFor: 0|                                                                                 
logsLen: 208                                                                                                      
S0|T10 receive commands | logLen:                                                                                 
208[Start]                                                                                                        
S0|T10 save persist| votedFor: 0|                                                                                 
logsLen: 209                                                                                                      
S0|T10 receive commands | logLen:                                                                                 
209[Start]                                                                                                        
S0|T10 save persist| votedFor: 0|                                                                                 
logsLen: 210                                                                                                      
S0|T10 receive commands | logLen:                                                                                 
210[Start]                                                                                                        
                                       S1|T10 is not leader                                                       
                                                                             S2|T10 is not leader                 
                                                                             S2|T10 save persist| votedFor: 0|    
                                                                             logsLen: 210                         
                                                                             S2|T10 appends logs from S0| logLen: 
                                                                             210[AppendEntry]                     
S0|T10 replica entries to S2|                                                                                     
entrylen:11| matchidx:209| nextidx:210                                                                            
S0|T10 update commitIndex as 209                                                                                  
S0|T10 starts to apply entries                                                                                    
[199:209][ApplyEntry]                                                                                             
S0|T10 Snapshot until index 199|                                                                                  
logLen: 210                                                                                                       
S0|T10 finishes applying entries                                                                                  
[199:209][ApplyEntry]                                                                                             
S0|T10 Snapshot until index 209|                                                                                  
logLen: 210                                                                                                       
                                       S1|T10 is not leader                                                       
                                                                             S2|T10 is not leader                 
S0|T10 send rpc to S1|base: 209| next:                                                                            
198                                                                                                               
                                                                             S2|T10 save persist| votedFor: 0|    
                                                                             logsLen: 210                         
                                                                             S2|T10 appends logs from S0| logLen: 
                                                                             210[AppendEntry]                     
                                                                             S2|T10 starts to apply entries       
                                                                             [199:209][ApplyEntry]                
S0|T10 replica entries to S2|                                                                                     
entrylen:0| matchidx:209| nextidx:210                                                                             
                                                                             S2|T10 Snapshot until index 199|     
                                                                             logLen: 210                          
                                                                             S2|T10 finishes applying entries     
                                                                             [199:209][ApplyEntry]                
                                                                             S2|T10 Snapshot until index 209|     
                                                                             logLen: 210                          
                                       S1 is connected again                                                      
S0|T10 save persist| votedFor: 0|                                                                                 
logsLen: 211                                                                                                      
S0|T10 receive commands | logLen:                                                                                 
211[Start]                                                                                                        
                                       S1|T10 is not leader                                                       
                                                                             S2|T10 is not leader                 
S0|T10 send rpc to S1|base: 209| next:                                                                            
198                                                                                                               
                                       S1|T10 receive rpc from S0                                                 
                                       S1|T10 update rfstate| Base:209|                                           
                                       LogLen:210                                                                 
                                       S1|T10 applys snapshot from S0                                             
S0|T10 installs snapshot to S1|                                                                                   
nextId:210| matchId:209                                                                                           
                                                                             S2|T10 save persist| votedFor: 0|    
                                                                             logsLen: 211                         
                                                                             S2|T10 appends logs from S0| logLen: 
                                                                             211[AppendEntry]                     
S0|T10 replica entries to S2|                                                                                     
entrylen:1| matchidx:210| nextidx:211                                                                             
S0|T10 update commitIndex as 210                                                                                  
S0|T10 starts to apply entries                                                                                    
[210:210][ApplyEntry]                                                                                             
S0|T10 finishes applying entries                                                                                  
[210:210][ApplyEntry]                                                                                             
                                       S1|T10 is not leader                                                       
                                                                             S2|T10 is not leader                 
                                                                             S2|T10 save persist| votedFor: 0|    
                                                                             logsLen: 211                         
                                                                             S2|T10 appends logs from S0| logLen: 
                                                                             211[AppendEntry]                     
                                                                             S2|T10 starts to apply entries       
                                                                             [210:210][ApplyEntry]                
                                                                             S2|T10 finishes applying entries     
                                                                             [210:210][ApplyEntry]                
S0|T10 replica entries to S2|                                                                                     
entrylen:0| matchidx:210| nextidx:211                                                                             
                                       S1|T10 is not leader                                                       
                                                                             S2|T10 is not leader                 
                                       S1|T10 save persist| votedFor: -1|                                         
                                       logsLen: 211                                                               
                                       S1|T10 appends logs from S0| logLen:                                       
                                       211[AppendEntry]                                                           
                                       S1|T10 starts to apply entries                                             
                                       [210:210][ApplyEntry]                                                      
                                       S1|T10 finishes applying entries                                           
                                       [210:210][ApplyEntry]                                                      
S0|T10 replica entries to S1|                                                                                     
entrylen:1| matchidx:210| nextidx:211                                                                             
                                                                             S2|T10 save persist| votedFor: 0|    
                                                                             logsLen: 211                         
                                                                             S2|T10 appends logs from S0| logLen: 
                                                                             211[AppendEntry]                     
S0|T10 replica entries to S2|                                                                                     
entrylen:0| matchidx:210| nextidx:211                                                                             
                                       S1|T10 is not leader                                                       
                                                                             S2|T10 is not leader                 
                                       S1|T10 save persist| votedFor: -1|                                         
                                       logsLen: 211                                                               
                                       S1|T10 appends logs from S0| logLen:                                       
                                       211[AppendEntry]                                                           
                                                                             S2|T10 save persist| votedFor: 0|    
                                                                             logsLen: 211                         
                                                                             S2|T10 appends logs from S0| logLen: 
                                                                             211[AppendEntry]                     
S0|T10 replica entries to S2|                                                                                     
entrylen:0| matchidx:210| nextidx:211                                                                             
                                                                             S2|T10 is not leader                 
                                       S1|T10 is not leader                                                       
                                                                             S2|T10 save persist| votedFor: 0|    
                                                                             logsLen: 211                         
                                                                             S2|T10 appends logs from S0| logLen: 
                                                                             211[AppendEntry]                     
                                                                             S2|T10 is not leader                 
                                       S1|T10 is not leader                                                       
                                       S1|T10 save persist| votedFor: -1|                                         
                                       logsLen: 211                                                               
                                       S1|T10 appends logs from S0| logLen:                                       
                                       211[AppendEntry]                                                           
                                                                             S2|T10 save persist| votedFor: 0|    
                                                                             logsLen: 211                         
                                                                             S2|T10 appends logs from S0| logLen: 
                                                                             211[AppendEntry]                     
                                       S1|T10 is not leader                                                       
                                                                             S2|T10 is not leader                 
                                       S1|T10 save persist| votedFor: -1|                                         
                                       logsLen: 211                                                               
                                       S1|T10 appends logs from S0| logLen:                                       
                                       211[AppendEntry]                                                           
S0|T10 replica entries to S1|                                                                                     
entrylen:0| matchidx:210| nextidx:211                                                                             
                                                                             S2|T10 is not leader                 
                                       S1|T10 is not leader                                                       
                                       S1|T10 save persist| votedFor: -1|                                         
                                       logsLen: 211                                                               
                                       S1|T10 appends logs from S0| logLen:                                       
                                       211[AppendEntry]                                                           
S0|T10 replica entries to S1|                                                                                     
entrylen:0| matchidx:210| nextidx:211                                                                             
                                                                             S2|T10 save persist| votedFor: 0|    
                                                                             logsLen: 211                         
                                                                             S2|T10 appends logs from S0| logLen: 
                                                                             211[AppendEntry]                     
S0|T10 replica entries to S2|                                                                                     
entrylen:0| matchidx:210| nextidx:211                                                                             
S0 is disconnected                                                                                                
                                       S1|T10 is not leader                                                       
                                                                             S2|T10 is not leader                 
                                       S1|T10 is not leader                                                       
                                                                             S2|T10 is not leader                 
                                       S1|T10 is not leader                                                       
                                                                             S2|T10 is not leader                 
                                                                             S2|T10 is not leader                 
                                       S1|T10 is not leader                                                       
                                                                             S2|T10 is not leader                 
                                       S1|T10 is not leader                                                       
                                       S1|T11 starts to join election                                             
                                       S1|T11 save persist| votedFor: 1|                                          
                                       logsLen: 211                                                               
                                                                             S2|T10 is not leader                 
                                       S1|T11 is not leader                                                       
                                                                             S2|T11 save persist| votedFor: -1|   
                                                                             logsLen: 211                         
                                                                             S2|T11 save persist| votedFor: 1|    
                                                                             logsLen: 211                         
                                                                             S2|T11 votes for S1[RequestVote]     
                                       S1|T11 becomes the leader, and starts                                      
                                       heatbeats                                                                  
                                                                             S2|T11 save persist| votedFor: 1|    
                                                                             logsLen: 211                         
                                                                             S2|T11 appends logs from S1| logLen: 
                                                                             211[AppendEntry]                     
                                       S1|T11 replica entries to S2|                                              
                                       entrylen:0| matchidx:210| nextidx:211                                      
                                       S1|T11 save persist| votedFor: 1|                                          
                                       logsLen: 212                                                               
                                       S1|T11 receive commands | logLen:                                          
                                       212[Start]                                                                 
                                                                             S2|T11 is not leader                 
                                                                             S2|T11 is not leader                 
                                                                             S2|T11 is not leader                 
                                                                             S2|T11 save persist| votedFor: 1|    
                                                                             logsLen: 212                         
                                                                             S2|T11 appends logs from S1| logLen: 
                                                                             212[AppendEntry]                     
                                       S1|T11 replica entries to S2|                                              
                                       entrylen:1| matchidx:211| nextidx:212                                      
                                       S1|T11 update commitIndex as 211                                           
                                       S1|T11 starts to apply entries                                             
                                       [211:211][ApplyEntry]                                                      
                                       S1|T11 finishes applying entries                                           
                                       [211:211][ApplyEntry]                                                      
                                                                             S2|T11 is not leader                 
                                                                             S2|T11 save persist| votedFor: 1|    
                                                                             logsLen: 212                         
                                                                             S2|T11 appends logs from S1| logLen: 
                                                                             212[AppendEntry]                     
                                                                             S2|T11 starts to apply entries       
                                                                             [211:211][ApplyEntry]                
                                                                             S2|T11 finishes applying entries     
                                                                             [211:211][ApplyEntry]                
                                       S1|T11 replica entries to S2|                                              
                                       entrylen:0| matchidx:211| nextidx:212                                      
                                       S1|T11 save persist| votedFor: 1|                                          
                                       logsLen: 213                                                               
                                       S1|T11 receive commands | logLen:                                          
                                       213[Start]                                                                 
                                       S1|T11 save persist| votedFor: 1|                                          
                                       logsLen: 214                                                               
                                       S1|T11 receive commands | logLen:                                          
                                       214[Start]                                                                 
                                       S1|T11 save persist| votedFor: 1|                                          
                                       logsLen: 215                                                               
                                       S1|T11 receive commands | logLen:                                          
                                       215[Start]                                                                 
                                       S1|T11 save persist| votedFor: 1|                                          
                                       logsLen: 216                                                               
                                       S1|T11 receive commands | logLen:                                          
                                       216[Start]                                                                 
                                       S1|T11 save persist| votedFor: 1|                                          
                                       logsLen: 217                                                               
                                       S1|T11 receive commands | logLen:                                          
                                       217[Start]                                                                 
                                       S1|T11 save persist| votedFor: 1|                                          
                                       logsLen: 218                                                               
                                       S1|T11 receive commands | logLen:                                          
                                       218[Start]                                                                 
                                       S1|T11 save persist| votedFor: 1|                                          
                                       logsLen: 219                                                               
                                       S1|T11 receive commands | logLen:                                          
                                       219[Start]                                                                 
                                       S1|T11 save persist| votedFor: 1|                                          
                                       logsLen: 220                                                               
                                       S1|T11 receive commands | logLen:                                          
                                       220[Start]                                                                 
                                       S1|T11 save persist| votedFor: 1|                                          
                                       logsLen: 221                                                               
                                       S1|T11 receive commands | logLen:                                          
                                       221[Start]                                                                 
                                       S1|T11 save persist| votedFor: 1|                                          
                                       logsLen: 222                                                               
                                       S1|T11 receive commands | logLen:                                          
                                       222[Start]                                                                 
                                       S1|T11 save persist| votedFor: 1|                                          
                                       logsLen: 223                                                               
                                       S1|T11 receive commands | logLen:                                          
                                       223[Start]                                                                 
                                       S1|T11 save persist| votedFor: 1|                                          
                                       logsLen: 224                                                               
                                       S1|T11 receive commands | logLen:                                          
                                       224[Start]                                                                 
                                       S1|T11 save persist| votedFor: 1|                                          
                                       logsLen: 225                                                               
                                       S1|T11 receive commands | logLen:                                          
                                       225[Start]                                                                 
                                                                             S2|T11 is not leader                 
                                                                             S2|T11 save persist| votedFor: 1|    
                                                                             logsLen: 225                         
                                                                             S2|T11 appends logs from S1| logLen: 
                                                                             225[AppendEntry]                     
                                                                             S2|T11 is not leader                 
                                                                             S2|T11 save persist| votedFor: 1|    
                                                                             logsLen: 225                         
                                                                             S2|T11 appends logs from S1| logLen: 
                                                                             225[AppendEntry]                     
                                       S1|T11 replica entries to S2|                                              
                                       entrylen:13| matchidx:224|                                                 
                                       nextidx:225                                                                
                                       S1|T11 update commitIndex as 224                                           
                                       S1|T11 starts to apply entries                                             
                                       [212:224][ApplyEntry]                                                      
                                       S1|T11 Snapshot until index 219|                                           
                                       logLen: 225                                                                
                                       S1|T11 finishes applying entries                                           
                                       [212:224][ApplyEntry]                                                      
                                                                             S2|T11 is not leader                 
                                       S1|T11 send rpc to S0|base: 219|                                           
                                       next: 211                                                                  
                                                                             S2|T11 save persist| votedFor: 1|    
                                                                             logsLen: 225                         
                                                                             S2|T11 appends logs from S1| logLen: 
                                                                             225[AppendEntry]                     
                                                                             S2|T11 starts to apply entries       
                                                                             [212:224][ApplyEntry]                
                                       S1|T11 replica entries to S2|                                              
                                       entrylen:0| matchidx:224| nextidx:225                                      
                                                                             S2|T11 Snapshot until index 219|     
                                                                             logLen: 225                          
                                                                             S2|T11 finishes applying entries     
                                                                             [212:224][ApplyEntry]                
S0 is connected again                                                                                             
                                       S1|T11 save persist| votedFor: 1|                                          
                                       logsLen: 226                                                               
                                       S1|T11 receive commands | logLen:                                          
                                       226[Start]                                                                 
                                                                             S2|T11 is not leader                 
                                       S1|T11 send rpc to S0|base: 219|                                           
                                       next: 211                                                                  
S0|T10 receive rpc from S1                                                                                        
S0|T11 save persist| votedFor: 0|                                                                                 
logsLen: 211                                                                                                      
S0|T11 update rfstate| Base:219|                                                                                  
LogLen:220                                                                                                        
S0|T11 applys snapshot from S1                                                                                    
                                       S1|T11 installs snapshot to S0|                                            
                                       nextId:220| matchId:219                                                    
                                       S1|T11 rejects to append entries from                                      
                                       S0 | out of date term[AppendEntry]                                         
S0|T11 lost leadership, state: 0                                                                                  
                                                                             S2|T11 save persist| votedFor: 1|    
                                                                             logsLen: 226                         
                                                                             S2|T11 appends logs from S1| logLen: 
                                                                             226[AppendEntry]                     
                                       S1|T11 replica entries to S2|                                              
                                       entrylen:1| matchidx:225| nextidx:226                                      
                                                                             S2|T11 rejects to append entries from
                                                                             S0 | out of date term[AppendEntry]   
                                       S1|T11 update commitIndex as 225                                           
                                       S1|T11 starts to apply entries                                             
                                       [225:225][ApplyEntry]                                                      
                                       S1|T11 finishes applying entries                                           
                                       [225:225][ApplyEntry]                                                      
S0|T11 lost leadership, state: 0                                                                                  
                                                                             S2|T11 is not leader                 
S0|T11 is not leader                                                                                              
                                                                             S2|T11 save persist| votedFor: 1|    
                                                                             logsLen: 226                         
                                                                             S2|T11 appends logs from S1| logLen: 
                                                                             226[AppendEntry]                     
                                                                             S2|T11 starts to apply entries       
                                                                             [225:225][ApplyEntry]                
                                                                             S2|T11 finishes applying entries     
                                                                             [225:225][ApplyEntry]                
                                       S1|T11 replica entries to S2|                                              
                                       entrylen:0| matchidx:225| nextidx:226                                      
S0|T11 save persist| votedFor: 0|                                                                                 
logsLen: 226                                                                                                      
S0|T11 appends logs from S1| logLen:                                                                              
226[AppendEntry]                                                                                                  
S0|T11 starts to apply entries                                                                                    
[220:225][ApplyEntry]                                                                                             
S0|T11 finishes applying entries                                                                                  
[220:225][ApplyEntry]                                                                                             
                                       S1|T11 replica entries to S0|                                              
                                       entrylen:6| matchidx:225| nextidx:226                                      
                                                                             S2|T11 is not leader                 
S0|T11 is not leader                                                                                              
S0|T11 save persist| votedFor: 0|                                                                                 
logsLen: 226                                                                                                      
S0|T11 appends logs from S1| logLen:                                                                              
226[AppendEntry]                                                                                                  
                                       S1|T11 replica entries to S0|                                              
                                       entrylen:0| matchidx:225| nextidx:226                                      
                                                                             S2|T11 save persist| votedFor: 1|    
                                                                             logsLen: 226                         
                                                                             S2|T11 appends logs from S1| logLen: 
                                                                             226[AppendEntry]                     
                                       S1|T11 replica entries to S2|                                              
                                       entrylen:0| matchidx:225| nextidx:226                                      
S0|T11 is not leader                                                                                              
                                                                             S2|T11 is not leader                 
S0|T11 save persist| votedFor: 0|                                                                                 
logsLen: 226                                                                                                      
S0|T11 appends logs from S1| logLen:                                                                              
226[AppendEntry]                                                                                                  
                                       S1|T11 replica entries to S0|                                              
                                       entrylen:0| matchidx:225| nextidx:226                                      
                                                                             S2|T11 save persist| votedFor: 1|    
                                                                             logsLen: 226                         
                                                                             S2|T11 appends logs from S1| logLen: 
                                                                             226[AppendEntry]                     
                                       S1|T11 replica entries to S2|                                              
                                       entrylen:0| matchidx:225| nextidx:226                                      
                                                                             S2|T11 is not leader                 
S0|T11 is not leader                                                                                              
                                                                             S2|T11 save persist| votedFor: 1|    
                                                                             logsLen: 226                         
                                                                             S2|T11 appends logs from S1| logLen: 
                                                                             226[AppendEntry]                     
S0|T11 save persist| votedFor: 0|                                                                                 
logsLen: 226                                                                                                      
S0|T11 appends logs from S1| logLen:                                                                              
226[AppendEntry]                                                                                                  
                                       S1|T11 replica entries to S2|                                              
                                       entrylen:0| matchidx:225| nextidx:226                                      
                                       S1|T11 replica entries to S0|                                              
                                       entrylen:0| matchidx:225| nextidx:226                                      
                                                                             S2|T11 is not leader                 
S0|T11 is not leader                                                                                              
                                                                             S2|T11 save persist| votedFor: 1|    
                                                                             logsLen: 226                         
                                                                             S2|T11 appends logs from S1| logLen: 
                                                                             226[AppendEntry]                     
                                       S1|T11 replica entries to S2|                                              
                                       entrylen:0| matchidx:225| nextidx:226                                      
S0|T11 save persist| votedFor: 0|                                                                                 
logsLen: 226                                                                                                      
S0|T11 appends logs from S1| logLen:                                                                              
226[AppendEntry]                                                                                                  
                                                                             S2|T11 is not leader                 
S0|T11 is not leader                                                                                              
                                                                             S2|T11 save persist| votedFor: 1|    
                                                                             logsLen: 226                         
                                                                             S2|T11 appends logs from S1| logLen: 
                                                                             226[AppendEntry]                     
                                       S1|T11 replica entries to S2|                                              
                                       entrylen:0| matchidx:225| nextidx:226                                      
                                                                             S2 is disconnected                   
                                       S1|T11 save persist| votedFor: 1|                                          
                                       logsLen: 227                                                               
                                       S1|T11 receive commands | logLen:                                          
                                       227[Start]                                                                 
S0|T11 is not leader                                                                                              
                                                                             S2|T11 is not leader                 
S0|T11 save persist| votedFor: 0|                                                                                 
logsLen: 227                                                                                                      
S0|T11 appends logs from S1| logLen:                                                                              
227[AppendEntry]                                                                                                  
                                       S1|T11 replica entries to S0|                                              
                                       entrylen:1| matchidx:226| nextidx:227                                      
                                       S1|T11 update commitIndex as 226                                           
                                       S1|T11 starts to apply entries                                             
                                       [226:226][ApplyEntry]                                                      
                                       S1|T11 finishes applying entries                                           
                                       [226:226][ApplyEntry]                                                      
S0|T11 is not leader                                                                                              
                                                                             S2|T11 is not leader                 
S0|T11 save persist| votedFor: 0|                                                                                 
logsLen: 227                                                                                                      
S0|T11 appends logs from S1| logLen:                                                                              
227[AppendEntry]                                                                                                  
S0|T11 starts to apply entries                                                                                    
[226:226][ApplyEntry]                                                                                             
S0|T11 finishes applying entries                                                                                  
[226:226][ApplyEntry]                                                                                             
                                       S1|T11 replica entries to S0|                                              
                                       entrylen:0| matchidx:226| nextidx:227                                      
                                       S1|T11 save persist| votedFor: 1|                                          
                                       logsLen: 228                                                               
                                       S1|T11 receive commands | logLen:                                          
                                       228[Start]                                                                 
                                       S1|T11 save persist| votedFor: 1|                                          
                                       logsLen: 229                                                               
                                       S1|T11 receive commands | logLen:                                          
                                       229[Start]                                                                 
                                       S1|T11 save persist| votedFor: 1|                                          
                                       logsLen: 230                                                               
                                       S1|T11 receive commands | logLen:                                          
                                       230[Start]                                                                 
                                       S1|T11 save persist| votedFor: 1|                                          
                                       logsLen: 231                                                               
                                       S1|T11 receive commands | logLen:                                          
                                       231[Start]                                                                 
                                       S1|T11 save persist| votedFor: 1|                                          
                                       logsLen: 232                                                               
                                       S1|T11 receive commands | logLen:                                          
                                       232[Start]                                                                 
                                       S1|T11 save persist| votedFor: 1|                                          
                                       logsLen: 233                                                               
                                       S1|T11 receive commands | logLen:                                          
                                       233[Start]                                                                 
                                       S1|T11 save persist| votedFor: 1|                                          
                                       logsLen: 234                                                               
                                       S1|T11 receive commands | logLen:                                          
                                       234[Start]                                                                 
                                       S1|T11 save persist| votedFor: 1|                                          
                                       logsLen: 235                                                               
                                       S1|T11 receive commands | logLen:                                          
                                       235[Start]                                                                 
                                       S1|T11 save persist| votedFor: 1|                                          
                                       logsLen: 236                                                               
                                       S1|T11 receive commands | logLen:                                          
                                       236[Start]                                                                 
                                       S1|T11 save persist| votedFor: 1|                                          
                                       logsLen: 237                                                               
                                       S1|T11 receive commands | logLen:                                          
                                       237[Start]                                                                 
                                                                             S2|T11 is not leader                 
S0|T11 is not leader                                                                                              
S0|T11 save persist| votedFor: 0|                                                                                 
logsLen: 237                                                                                                      
S0|T11 appends logs from S1| logLen:                                                                              
237[AppendEntry]                                                                                                  
                                       S1|T11 replica entries to S0|                                              
                                       entrylen:10| matchidx:236|                                                 
                                       nextidx:237                                                                
                                       S1|T11 update commitIndex as 236                                           
                                       S1|T11 starts to apply entries                                             
                                       [227:236][ApplyEntry]                                                      
                                       S1|T11 Snapshot until index 229|                                           
                                       logLen: 237                                                                
                                       S1|T11 finishes applying entries                                           
                                       [227:236][ApplyEntry]                                                      
S0|T11 is not leader                                                                                              
                                                                             S2|T11 is not leader                 
                                       S1|T11 send rpc to S2|base: 229|                                           
                                       next: 226                                                                  
                                                                             S2|T11 is not leader                 
S0|T11 is not leader                                                                                              
                                       S1|T11 send rpc to S2|base: 229|                                           
                                       next: 226                                                                  
S0|T11 save persist| votedFor: 0|                                                                                 
logsLen: 237                                                                                                      
S0|T11 appends logs from S1| logLen:                                                                              
237[AppendEntry]                                                                                                  
S0|T11 starts to apply entries                                                                                    
[227:236][ApplyEntry]                                                                                             
                                       S1|T11 replica entries to S0|                                              
                                       entrylen:0| matchidx:236| nextidx:237                                      
S0|T11 Snapshot until index 229|                                                                                  
logLen: 237                                                                                                       
S0|T11 finishes applying entries                                                                                  
[227:236][ApplyEntry]                                                                                             
                                                                             S2 is connected again                
                                       S1|T11 save persist| votedFor: 1|                                          
                                       logsLen: 238                                                               
                                       S1|T11 receive commands | logLen:                                          
                                       238[Start]                                                                 
                                                                             S2|T11 is not leader                 
S0|T11 is not leader                                                                                              
                                       S1|T11 send rpc to S2|base: 229|                                           
                                       next: 226                                                                  
                                                                             S2|T11 receive rpc from S1           
                                                                             S2|T11 update rfstate| Base:229|     
                                                                             LogLen:230                           
                                                                             S2|T11 applys snapshot from S1       
S0|T11 save persist| votedFor: 0|                                                                                 
logsLen: 238                                                                                                      
S0|T11 appends logs from S1| logLen:                                                                              
238[AppendEntry]                                                                                                  
                                       S1|T11 installs snapshot to S2|                                            
                                       nextId:230| matchId:229                                                    
                                       S1|T11 replica entries to S0|                                              
                                       entrylen:1| matchidx:237| nextidx:238                                      
                                       S1|T11 update commitIndex as 237                                           
                                       S1|T11 starts to apply entries                                             
                                       [237:237][ApplyEntry]                                                      
                                       S1|T11 finishes applying entries                                           
                                       [237:237][ApplyEntry]                                                      
S0|T11 is not leader                                                                                              
                                                                             S2|T11 is not leader                 
                                                                             S2|T11 save persist| votedFor: 1|    
                                                                             logsLen: 238                         
                                                                             S2|T11 appends logs from S1| logLen: 
                                                                             238[AppendEntry]                     
                                                                             S2|T11 starts to apply entries       
                                                                             [230:237][ApplyEntry]                
                                                                             S2|T11 finishes applying entries     
                                                                             [230:237][ApplyEntry]                
                                       S1|T11 replica entries to S2|                                              
                                       entrylen:8| matchidx:237| nextidx:238                                      
S0|T11 save persist| votedFor: 0|                                                                                 
logsLen: 238                                                                                                      
S0|T11 appends logs from S1| logLen:                                                                              
238[AppendEntry]                                                                                                  
S0|T11 starts to apply entries                                                                                    
[237:237][ApplyEntry]                                                                                             
S0|T11 finishes applying entries                                                                                  
[237:237][ApplyEntry]                                                                                             
                                       S1|T11 replica entries to S0|                                              
                                       entrylen:0| matchidx:237| nextidx:238                                      
S0|T11 is not leader                                                                                              
                                                                             S2|T11 is not leader                 
S0|T11 save persist| votedFor: 0|                                                                                 
logsLen: 238                                                                                                      
S0|T11 appends logs from S1| logLen:                                                                              
238[AppendEntry]                                                                                                  
                                       S1|T11 replica entries to S0|                                              
                                       entrylen:0| matchidx:237| nextidx:238                                      
                                                                             S2|T11 save persist| votedFor: 1|    
                                                                             logsLen: 238                         
                                                                             S2|T11 appends logs from S1| logLen: 
                                                                             238[AppendEntry]                     
                                       S1|T11 replica entries to S2|                                              
                                       entrylen:0| matchidx:237| nextidx:238                                      
                                                                             S2|T11 is not leader                 
S0|T11 is not leader                                                                                              
S0|T11 save persist| votedFor: 0|                                                                                 
logsLen: 238                                                                                                      
S0|T11 appends logs from S1| logLen:                                                                              
238[AppendEntry]                                                                                                  
                                       S1|T11 replica entries to S0|                                              
                                       entrylen:0| matchidx:237| nextidx:238                                      
                                                                             S2|T11 save persist| votedFor: 1|    
                                                                             logsLen: 238                         
                                                                             S2|T11 appends logs from S1| logLen: 
                                                                             238[AppendEntry]                     
                                       S1|T11 replica entries to S2|                                              
                                       entrylen:0| matchidx:237| nextidx:238                                      
S0|T11 is not leader                                                                                              
                                                                             S2|T11 is not leader                 
S0|T11 save persist| votedFor: 0|                                                                                 
logsLen: 238                                                                                                      
S0|T11 appends logs from S1| logLen:                                                                              
238[AppendEntry]                                                                                                  
                                       S1|T11 replica entries to S0|                                              
                                       entrylen:0| matchidx:237| nextidx:238                                      
                                                                             S2|T11 is not leader                 
S0|T11 is not leader                                                                                              
                                                                             S2|T11 save persist| votedFor: 1|    
                                                                             logsLen: 238                         
                                                                             S2|T11 appends logs from S1| logLen: 
                                                                             238[AppendEntry]                     
                                       S1|T11 replica entries to S2|                                              
                                       entrylen:0| matchidx:237| nextidx:238                                      
S0|T11 is not leader                                                                                              
                                                                             S2|T11 is not leader                 
                                                                             S2|T11 save persist| votedFor: 1|    
                                                                             logsLen: 238                         
                                                                             S2|T11 appends logs from S1| logLen: 
                                                                             238[AppendEntry]                     
                                       S1|T11 replica entries to S2|                                              
                                       entrylen:0| matchidx:237| nextidx:238                                      
                                                                             S2 is disconnected                   
                                       S1|T11 save persist| votedFor: 1|                                          
                                       logsLen: 239                                                               
                                       S1|T11 receive commands | logLen:                                          
                                       239[Start]                                                                 
                                                                             S2|T11 is not leader                 
S0|T11 is not leader                                                                                              
S0|T11 is not leader                                                                                              
                                                                             S2|T11 is not leader                 
S0|T11 save persist| votedFor: 0|                                                                                 
logsLen: 239                                                                                                      
S0|T11 appends logs from S1| logLen:                                                                              
239[AppendEntry]                                                                                                  
                                       S1|T11 replica entries to S0|                                              
                                       entrylen:1| matchidx:238| nextidx:239                                      
                                       S1|T11 update commitIndex as 238                                           
                                       S1|T11 starts to apply entries                                             
                                       [238:238][ApplyEntry]                                                      
                                       S1|T11 finishes applying entries                                           
                                       [238:238][ApplyEntry]                                                      
                                                                             S2|T11 is not leader                 
S0|T11 is not leader                                                                                              
S0|T11 save persist| votedFor: 0|                                                                                 
logsLen: 239                                                                                                      
S0|T11 appends logs from S1| logLen:                                                                              
239[AppendEntry]                                                                                                  
S0|T11 starts to apply entries                                                                                    
[238:238][ApplyEntry]                                                                                             
S0|T11 finishes applying entries                                                                                  
[238:238][ApplyEntry]                                                                                             
                                       S1|T11 replica entries to S0|                                              
                                       entrylen:0| matchidx:238| nextidx:239                                      
                                       S1|T11 save persist| votedFor: 1|                                          
                                       logsLen: 240                                                               
                                       S1|T11 receive commands | logLen:                                          
                                       240[Start]                                                                 
                                       S1|T11 save persist| votedFor: 1|                                          
                                       logsLen: 241                                                               
                                       S1|T11 receive commands | logLen:                                          
                                       241[Start]                                                                 
                                       S1|T11 save persist| votedFor: 1|                                          
                                       logsLen: 242                                                               
                                       S1|T11 receive commands | logLen:                                          
                                       242[Start]                                                                 
                                       S1|T11 save persist| votedFor: 1|                                          
                                       logsLen: 243                                                               
                                       S1|T11 receive commands | logLen:                                          
                                       243[Start]                                                                 
                                       S1|T11 save persist| votedFor: 1|                                          
                                       logsLen: 244                                                               
                                       S1|T11 receive commands | logLen:                                          
                                       244[Start]                                                                 
                                       S1|T11 save persist| votedFor: 1|                                          
                                       logsLen: 245                                                               
                                       S1|T11 receive commands | logLen:                                          
                                       245[Start]                                                                 
                                       S1|T11 save persist| votedFor: 1|                                          
                                       logsLen: 246                                                               
                                       S1|T11 receive commands | logLen:                                          
                                       246[Start]                                                                 
                                       S1|T11 save persist| votedFor: 1|                                          
                                       logsLen: 247                                                               
                                       S1|T11 receive commands | logLen:                                          
                                       247[Start]                                                                 
                                                                             S2|T11 is not leader                 
S0|T11 is not leader                                                                                              
S0|T11 save persist| votedFor: 0|                                                                                 
logsLen: 247                                                                                                      
S0|T11 appends logs from S1| logLen:                                                                              
247[AppendEntry]                                                                                                  
                                       S1|T11 replica entries to S0|                                              
                                       entrylen:8| matchidx:246| nextidx:247                                      
                                       S1|T11 update commitIndex as 246                                           
                                       S1|T11 starts to apply entries                                             
                                       [239:246][ApplyEntry]                                                      
                                       S1|T11 Snapshot until index 239|                                           
                                       logLen: 247                                                                
                                       S1|T11 finishes applying entries                                           
                                       [239:246][ApplyEntry]                                                      
                                                                             S2|T11 is not leader                 
                                       S1|T11 send rpc to S2|base: 239|                                           
                                       next: 238                                                                  
S0|T11 is not leader                                                                                              
S0|T11 save persist| votedFor: 0|                                                                                 
logsLen: 247                                                                                                      
S0|T11 appends logs from S1| logLen:                                                                              
247[AppendEntry]                                                                                                  
S0|T11 starts to apply entries                                                                                    
[239:246][ApplyEntry]                                                                                             
                                       S1|T11 replica entries to S0|                                              
                                       entrylen:0| matchidx:246| nextidx:247                                      
S0|T11 Snapshot until index 239|                                                                                  
logLen: 247                                                                                                       
S0|T11 finishes applying entries                                                                                  
[239:246][ApplyEntry]                                                                                             
                                                                             S2 is connected again                
                                       S1|T11 save persist| votedFor: 1|                                          
                                       logsLen: 248                                                               
                                       S1|T11 receive commands | logLen:                                          
                                       248[Start]                                                                 
                                       S1|T11 fails to install snapshot to                                        
                                       S2                                                                         
                                       S1|T11 fails to install snapshot to                                        
                                       S2                                                                         
                                                                             S2|T11 is not leader                 
S0|T11 is not leader                                                                                              
                                       S1|T11 send rpc to S2|base: 239|                                           
                                       next: 238                                                                  
                                                                             S2|T11 receive rpc from S1           
                                                                             S2|T11 update rfstate| Base:239|     
                                                                             LogLen:240                           
                                                                             S2|T11 applys snapshot from S1       
                                       S1|T11 installs snapshot to S2|                                            
                                       nextId:240| matchId:239                                                    
S0|T11 save persist| votedFor: 0|                                                                                 
logsLen: 248                                                                                                      
S0|T11 appends logs from S1| logLen:                                                                              
248[AppendEntry]                                                                                                  
                                       S1|T11 replica entries to S0|                                              
                                       entrylen:1| matchidx:247| nextidx:248                                      
                                       S1|T11 update commitIndex as 247                                           
                                       S1|T11 starts to apply entries                                             
                                       [247:247][ApplyEntry]                                                      
                                       S1|T11 finishes applying entries                                           
                                       [247:247][ApplyEntry]                                                      
                                                                             S2|T11 is not leader                 
S0|T11 is not leader                                                                                              
S0|T11 save persist| votedFor: 0|                                                                                 
logsLen: 248                                                                                                      
S0|T11 appends logs from S1| logLen:                                                                              
248[AppendEntry]                                                                                                  
S0|T11 starts to apply entries                                                                                    
[247:247][ApplyEntry]                                                                                             
S0|T11 finishes applying entries                                                                                  
[247:247][ApplyEntry]                                                                                             
                                                                             S2|T11 save persist| votedFor: 1|    
                                                                             logsLen: 248                         
                                                                             S2|T11 appends logs from S1| logLen: 
                                                                             248[AppendEntry]                     
                                                                             S2|T11 starts to apply entries       
                                                                             [240:247][ApplyEntry]                
                                                                             S2|T11 finishes applying entries     
                                                                             [240:247][ApplyEntry]                
                                       S1|T11 replica entries to S2|                                              
                                       entrylen:8| matchidx:247| nextidx:248                                      
                                       S1|T11 fails to install snapshot to                                        
                                       S0                                                                         
                                                                             S2|T11 is not leader                 
S0|T11 is not leader                                                                                              
                                                                             S2|T11 save persist| votedFor: 1|    
                                                                             logsLen: 248                         
                                                                             S2|T11 appends logs from S1| logLen: 
                                                                             248[AppendEntry]                     
S0|T11 is not leader                                                                                              
                                                                             S2|T11 is not leader                 
S0|T11 save persist| votedFor: 0|                                                                                 
logsLen: 248                                                                                                      
S0|T11 appends logs from S1| logLen:                                                                              
248[AppendEntry]                                                                                                  
                                       S1|T11 replica entries to S0|                                              
                                       entrylen:0| matchidx:247| nextidx:248                                      
                                                                             S2|T11 save persist| votedFor: 1|    
                                                                             logsLen: 248                         
                                                                             S2|T11 appends logs from S1| logLen: 
                                                                             248[AppendEntry]                     
                                       S1|T11 replica entries to S2|                                              
                                       entrylen:0| matchidx:247| nextidx:248                                      
                                                                             S2|T11 is not leader                 
S0|T11 is not leader                                                                                              
                                                                             S2|T11 save persist| votedFor: 1|    
                                                                             logsLen: 248                         
                                                                             S2|T11 appends logs from S1| logLen: 
                                                                             248[AppendEntry]                     
                                       S1|T11 replica entries to S2|                                              
                                       entrylen:0| matchidx:247| nextidx:248                                      
S0|T11 is not leader                                                                                              
                                                                             S2|T11 is not leader                 
                                                                             S2|T11 save persist| votedFor: 1|    
                                                                             logsLen: 248                         
                                                                             S2|T11 appends logs from S1| logLen: 
                                                                             248[AppendEntry]                     
                                       S1|T11 replica entries to S2|                                              
                                       entrylen:0| matchidx:247| nextidx:248                                      
S0|T11 save persist| votedFor: 0|                                                                                 
logsLen: 248                                                                                                      
S0|T11 appends logs from S1| logLen:                                                                              
248[AppendEntry]                                                                                                  
                                       S1|T11 replica entries to S0|                                              
                                       entrylen:0| matchidx:247| nextidx:248                                      
S0|T11 is not leader                                                                                              
                                                                             S2|T11 is not leader                 
                                                                             S2|T11 save persist| votedFor: 1|    
                                                                             logsLen: 248                         
                                                                             S2|T11 appends logs from S1| logLen: 
                                                                             248[AppendEntry]                     
                                       S1|T11 replica entries to S2|                                              
                                       entrylen:0| matchidx:247| nextidx:248                                      
S0|T11 save persist| votedFor: 0|                                                                                 
logsLen: 248                                                                                                      
S0|T11 appends logs from S1| logLen:                                                                              
248[AppendEntry]                                                                                                  
                                       S1|T11 replica entries to S0|                                              
                                       entrylen:0| matchidx:247| nextidx:248                                      
                                       S1 is disconnected                                                         
                                                                             S2|T11 is not leader                 
S0|T11 is not leader                                                                                              
S0|T11 is not leader                                                                                              
                                                                             S2|T11 is not leader                 
                                                                             S2|T11 is not leader                 
S0|T11 is not leader                                                                                              
                                                                             S2|T11 is not leader                 
S0|T11 is not leader                                                                                              
S0|T11 is not leader                                                                                              
                                                                             S2|T11 is not leader                 
                                                                             S2|T11 is not leader                 
S0|T11 is not leader                                                                                              
S0|T11 is not leader                                                                                              
                                                                             S2|T11 is not leader                 
                                                                             S2|T11 is not leader                 
S0|T11 is not leader                                                                                              
S0|T11 is not leader                                                                                              
                                                                             S2|T11 is not leader                 
                                                                             S2|T12 starts to join election       
                                                                             S2|T12 save persist| votedFor: 2|    
                                                                             logsLen: 248                         
S0|T12 starts to join election                                                                                    
S0|T12 save persist| votedFor: 0|                                                                                 
logsLen: 248                                                                                                      
                                                                             S2 rejects to vote for S0 because it 
                                                                             has voted or it is more              
                                                                             up-dated[RequestVote]                
S0 rejects to vote for S2 because it                                                                              
has voted or it is more                                                                                           
up-dated[RequestVote]                                                                                             
S0|T12 is not leader                                                                                              
                                                                             S2|T12 is not leader                 
                                                                             S2|T12 is not leader                 
S0|T12 is not leader                                                                                              
                                                                             S2|T12 is not leader                 
S0|T12 is not leader                                                                                              
                                                                             S2|T12 is not leader                 
S0|T12 is not leader                                                                                              
                                                                             S2|T12 is not leader                 
S0|T12 is not leader                                                                                              
S0|T12 is not leader                                                                                              
                                                                             S2|T12 is not leader                 
S0|T12 fails to install snapshot to S1                                                                            
                                                                             S2|T12 is not leader                 
S0|T12 is not leader                                                                                              
                                                                             S2|T12 is not leader                 
S0|T12 is not leader                                                                                              
                                                                             S2|T12 is not leader                 
S0|T12 is not leader                                                                                              
                                       S1|T11 fails to install snapshot to                                        
                                       S2                                                                         
S0|T12 is not leader                                                                                              
                                                                             S2|T12 is not leader                 
                                                                             S2|T12 is not leader                 
S0|T12 is not leader                                                                                              
S0|T13 starts to join election                                                                                    
S0|T13 save persist| votedFor: 0|                                                                                 
logsLen: 248                                                                                                      
S0|T13 is not leader                                                                                              
                                                                             S2|T12 is not leader                 
                                                                             S2|T13 save persist| votedFor: -1|   
                                                                             logsLen: 248                         
                                                                             S2|T13 save persist| votedFor: 0|    
                                                                             logsLen: 248                         
                                                                             S2|T13 votes for S0[RequestVote]     
S0|T13 becomes the leader, and starts                                                                             
heatbeats                                                                                                         
                                                                             S2|T13 save persist| votedFor: 0|    
                                                                             logsLen: 248                         
                                                                             S2|T13 appends logs from S0| logLen: 
                                                                             248[AppendEntry]                     
S0|T13 replica entries to S2|                                                                                     
entrylen:0| matchidx:247| nextidx:248                                                                             
S0|T13 save persist| votedFor: 0|                                                                                 
logsLen: 249                                                                                                      
S0|T13 receive commands | logLen:                                                                                 
249[Start]                                                                                                        
                                                                             S2|T13 is not leader                 
                                                                             S2|T13 save persist| votedFor: 0|    
                                                                             logsLen: 249                         
                                                                             S2|T13 appends logs from S0| logLen: 
                                                                             249[AppendEntry]                     
S0|T13 replica entries to S2|                                                                                     
entrylen:1| matchidx:248| nextidx:249                                                                             
S0|T13 update commitIndex as 248                                                                                  
S0|T13 starts to apply entries                                                                                    
[248:248][ApplyEntry]                                                                                             
S0|T13 finishes applying entries                                                                                  
[248:248][ApplyEntry]                                                                                             
                                                                             S2|T13 is not leader                 
                                                                             S2|T13 save persist| votedFor: 0|    
                                                                             logsLen: 249                         
                                                                             S2|T13 appends logs from S0| logLen: 
                                                                             249[AppendEntry]                     
                                                                             S2|T13 starts to apply entries       
                                                                             [248:248][ApplyEntry]                
                                                                             S2|T13 finishes applying entries     
                                                                             [248:248][ApplyEntry]                
S0|T13 replica entries to S2|                                                                                     
entrylen:0| matchidx:248| nextidx:249                                                                             
S0|T13 save persist| votedFor: 0|                                                                                 
logsLen: 250                                                                                                      
S0|T13 receive commands | logLen:                                                                                 
250[Start]                                                                                                        
                                                                             S2|T13 is not leader                 
                                                                             S2|T13 save persist| votedFor: 0|    
                                                                             logsLen: 250                         
                                                                             S2|T13 appends logs from S0| logLen: 
                                                                             250[AppendEntry]                     
S0|T13 replica entries to S2|                                                                                     
entrylen:1| matchidx:249| nextidx:250                                                                             
S0|T13 update commitIndex as 249                                                                                  
S0|T13 starts to apply entries                                                                                    
[249:249][ApplyEntry]                                                                                             
S0|T13 finishes applying entries                                                                                  
[249:249][ApplyEntry]                                                                                             
S0|T13 Snapshot until index 249|                                                                                  
logLen: 250                                                                                                       
                                                                             S2|T13 is not leader                 
S0|T13 send rpc to S1|base: 249| next:                                                                            
248                                                                                                               
                                                                             S2|T13 is not leader                 
S0|T13 send rpc to S1|base: 249| next:                                                                            
248                                                                                                               
S0|T13 fails to install snapshot to S1                                                                            
                                                                             S2|T13 save persist| votedFor: 0|    
                                                                             logsLen: 250                         
                                                                             S2|T13 appends logs from S0| logLen: 
                                                                             250[AppendEntry]                     
                                                                             S2|T13 starts to apply entries       
                                                                             [249:249][ApplyEntry]                
                                                                             S2|T13 finishes applying entries     
                                                                             [249:249][ApplyEntry]                
S0|T13 replica entries to S2|                                                                                     
entrylen:0| matchidx:249| nextidx:250                                                                             
                                                                             S2|T13 Snapshot until index 249|     
                                                                             logLen: 250                          
                                       S1 is connected again                                                      
                                       S1|T11 save persist| votedFor: 1|                                          
                                       logsLen: 249                                                               
                                       S1|T11 receive commands | logLen:                                          
                                       249[Start]                                                                 
                                                                             S2|T13 is not leader                 
S0|T13 send rpc to S1|base: 249| next:                                                                            
248                                                                                                               
                                       S1|T11 receive rpc from S0                                                 
                                       S1|T13 save persist| votedFor: 1|                                          
                                       logsLen: 249                                                               
S0|T13 rejects to append entries from                                                                             
S1 | out of date term[AppendEntry]                                                                                
                                                                             S2|T13 save persist| votedFor: 0|    
                                                                             logsLen: 250                         
                                       S1|T13 update rfstate| Base:249|                                           
                                       LogLen:250                                                                 
                                                                             S2|T13 appends logs from S0| logLen: 
                                                                             250[AppendEntry]                     
                                                                             S2|T13 rejects to append entries from
                                                                             S1 | out of date term[AppendEntry]   
S0|T13 replica entries to S2|                                                                                     
entrylen:0| matchidx:249| nextidx:250                                                                             
                                       S1|T13 applys snapshot from S0                                             
S0|T13 fails to install snapshot to S1                                                                            
                                       S1|T13 lost leadership, state: 0                                           
                                       S1|T13 lost leadership, state: 0                                           
                                                                             S2|T13 is not leader                 
                                       S1|T13 is not leader                                                       
S0|T13 send rpc to S1|base: 249| next:                                                                            
248                                                                                                               
                                                                             S2|T13 save persist| votedFor: 0|    
                                                                             logsLen: 250                         
                                                                             S2|T13 appends logs from S0| logLen: 
                                                                             250[AppendEntry]                     
S0|T13 replica entries to S2|                                                                                     
entrylen:0| matchidx:249| nextidx:250                                                                             
                                       S1|T13 receive rpc from S0                                                 
                                       S1|T13 rejects to installsnap from S0                                      
                                       | out of date term                                                         
S0|T13 installs snapshot to S1|                                                                                   
nextId:250| matchId:249                                                                                           
                                       S1|T13 is not leader                                                       
                                                                             S2|T13 is not leader                 
                                       S1|T13 save persist| votedFor: 1|                                          
                                       logsLen: 250                                                               
                                       S1|T13 appends logs from S0| logLen:                                       
                                       250[AppendEntry]                                                           
                                                                             S2|T13 save persist| votedFor: 0|    
                                                                             logsLen: 250                         
                                                                             S2|T13 appends logs from S0| logLen: 
                                                                             250[AppendEntry]                     
S0|T13 replica entries to S2|                                                                                     
entrylen:0| matchidx:249| nextidx:250                                                                             
                                                                             S2|T13 is not leader                 
                                       S1|T13 is not leader                                                       
                                       S1|T13 save persist| votedFor: 1|                                          
                                       logsLen: 250                                                               
                                       S1|T13 appends logs from S0| logLen:                                       
                                       250[AppendEntry]                                                           
S0|T13 replica entries to S1|                                                                                     
entrylen:0| matchidx:249| nextidx:250                                                                             
                                                                             S2|T13 save persist| votedFor: 0|    
                                                                             logsLen: 250                         
                                                                             S2|T13 appends logs from S0| logLen: 
                                                                             250[AppendEntry]                     
S0|T13 replica entries to S2|                                                                                     
entrylen:0| matchidx:249| nextidx:250                                                                             
                                                                             S2|T13 is not leader                 
                                       S1|T13 is not leader                                                       
                                       S1|T13 save persist| votedFor: 1|                                          
                                       logsLen: 250                                                               
                                       S1|T13 appends logs from S0| logLen:                                       
                                       250[AppendEntry]                                                           
S0|T13 replica entries to S1|                                                                                     
entrylen:0| matchidx:249| nextidx:250                                                                             
                                                                             S2|T13 save persist| votedFor: 0|    
                                                                             logsLen: 250                         
                                                                             S2|T13 appends logs from S0| logLen: 
                                                                             250[AppendEntry]                     
S0|T13 replica entries to S2|                                                                                     
entrylen:0| matchidx:249| nextidx:250                                                                             
                                       S1|T13 is not leader                                                       
                                                                             S2|T13 is not leader                 
                                       S1|T13 save persist| votedFor: 1|                                          
                                       logsLen: 250                                                               
                                       S1|T13 appends logs from S0| logLen:                                       
                                       250[AppendEntry]                                                           
                                                                             S2|T13 save persist| votedFor: 0|    
                                                                             logsLen: 250                         
                                                                             S2|T13 appends logs from S0| logLen: 
                                                                             250[AppendEntry]                     
S0|T13 replica entries to S2|                                                                                     
entrylen:0| matchidx:249| nextidx:250                                                                             
                                                                             S2|T13 is not leader                 
                                       S1|T13 is not leader                                                       
                                       S1|T13 save persist| votedFor: 1|                                          
                                       logsLen: 250                                                               
                                       S1|T13 appends logs from S0| logLen:                                       
                                       250[AppendEntry]                                                           
S0|T13 replica entries to S1|                                                                                     
entrylen:0| matchidx:249| nextidx:250                                                                             
                                       S1|T13 is not leader                                                       
                                                                             S2|T13 is not leader                 
                                       S1|T13 save persist| votedFor: 1|                                          
                                       logsLen: 250                                                               
                                                                             S2|T13 save persist| votedFor: 0|    
                                                                             logsLen: 250                         
                                       S1|T13 appends logs from S0| logLen:                                       
                                       250[AppendEntry]                                                           
                                                                             S2|T13 appends logs from S0| logLen: 
                                                                             250[AppendEntry]                     
S0|T13 replica entries to S1|                                                                                     
entrylen:0| matchidx:249| nextidx:250                                                                             
S0|T13 replica entries to S2|                                                                                     
entrylen:0| matchidx:249| nextidx:250                                                                             
                                       S1|T13 is not leader                                                       
                                                                             S2|T13 is not leader                 
                                       S1|T13 save persist| votedFor: 1|                                          
                                       logsLen: 250                                                               
                                       S1|T13 appends logs from S0| logLen:                                       
                                       250[AppendEntry]                                                           
                                                                             S2|T13 is not leader                 
                                       S1|T13 is not leader                                                       
                                                                             S2|T13 save persist| votedFor: 0|    
                                                                             logsLen: 250                         
                                                                             S2|T13 appends logs from S0| logLen: 
                                                                             250[AppendEntry]                     
S0|T13 replica entries to S2|                                                                                     
entrylen:0| matchidx:249| nextidx:250                                                                             
                                       S1|T13 save persist| votedFor: 1|                                          
                                       logsLen: 250                                                               
                                       S1|T13 appends logs from S0| logLen:                                       
                                       250[AppendEntry]                                                           
S0|T13 replica entries to S1|                                                                                     
entrylen:0| matchidx:249| nextidx:250                                                                             
                                                                             S2|T13 is not leader                 
                                       S1|T13 is not leader                                                       
                                       S1|T13 save persist| votedFor: 1|                                          
                                       logsLen: 250                                                               
                                       S1|T13 appends logs from S0| logLen:                                       
                                       250[AppendEntry]                                                           
S0|T13 replica entries to S1|                                                                                     
entrylen:0| matchidx:249| nextidx:250                                                                             
                                                                             S2|T13 save persist| votedFor: 0|    
                                                                             logsLen: 250                         
                                                                             S2|T13 appends logs from S0| logLen: 
                                                                             250[AppendEntry]                     
                                                                             S2|T13 is not leader                 
                                       S1|T13 is not leader                                                       
                                       S1|T13 save persist| votedFor: 1|                                          
                                       logsLen: 250                                                               
                                       S1|T13 appends logs from S0| logLen:                                       
                                       250[AppendEntry]                                                           
S0|T13 replica entries to S1|                                                                                     
entrylen:0| matchidx:249| nextidx:250                                                                             
                                                                             S2|T13 save persist| votedFor: 0|    
                                                                             logsLen: 250                         
                                                                             S2|T13 appends logs from S0| logLen: 
                                                                             250[AppendEntry]                     
S0|T13 replica entries to S2|                                                                                     
entrylen:0| matchidx:249| nextidx:250                                                                             
                                       S1|T13 is not leader                                                       
                                                                             S2|T13 is not leader                 
                                                                             S2|T13 save persist| votedFor: 0|    
                                                                             logsLen: 250                         
                                                                             S2|T13 appends logs from S0| logLen: 
                                                                             250[AppendEntry]                     
S0|T13 replica entries to S2|                                                                                     
entrylen:0| matchidx:249| nextidx:250                                                                             
                                       S1|T13 save persist| votedFor: 1|                                          
                                       logsLen: 250                                                               
                                       S1|T13 appends logs from S0| logLen:                                       
                                       250[AppendEntry]                                                           
S0|T13 replica entries to S1|                                                                                     
entrylen:0| matchidx:249| nextidx:250                                                                             
                                       S1|T13 is not leader                                                       
                                                                             S2|T13 is not leader                 
                                                                             S2|T13 save persist| votedFor: 0|    
                                                                             logsLen: 250                         
                                                                             S2|T13 appends logs from S0| logLen: 
                                                                             250[AppendEntry]                     
                                       S1|T13 save persist| votedFor: 1|                                          
                                       logsLen: 250                                                               
                                       S1|T13 appends logs from S0| logLen:                                       
                                       250[AppendEntry]                                                           
S0|T13 replica entries to S1|                                                                                     
entrylen:0| matchidx:249| nextidx:250                                                                             
                                                                             S2|T13 is not leader                 
                                       S1|T13 is not leader                                                       
                                       S1|T13 save persist| votedFor: 1|                                          
                                       logsLen: 250                                                               
                                       S1|T13 appends logs from S0| logLen:                                       
                                       250[AppendEntry]                                                           
                                                                             S2|T13 save persist| votedFor: 0|    
                                                                             logsLen: 250                         
                                                                             S2|T13 appends logs from S0| logLen: 
                                                                             250[AppendEntry]                     
S0|T13 replica entries to S1|                                                                                     
entrylen:0| matchidx:249| nextidx:250                                                                             
S0|T13 replica entries to S2|                                                                                     
entrylen:0| matchidx:249| nextidx:250                                                                             
                                                                             S2|T13 is not leader                 
                                       S1|T13 is not leader                                                       
                                       S1|T13 save persist| votedFor: 1|                                          
                                       logsLen: 250                                                               
                                       S1|T13 appends logs from S0| logLen:                                       
                                       250[AppendEntry]                                                           
S0|T13 replica entries to S1|                                                                                     
entrylen:0| matchidx:249| nextidx:250                                                                             
                                                                             S2|T13 save persist| votedFor: 0|    
                                                                             logsLen: 250                         
                                                                             S2|T13 appends logs from S0| logLen: 
                                                                             250[AppendEntry]                     
S0|T13 replica entries to S2|                                                                                     
entrylen:0| matchidx:249| nextidx:250                                                                             
                                       S1|T13 is not leader                                                       
                                                                             S2|T13 is not leader                 
                                       S1|T13 save persist| votedFor: 1|                                          
                                       logsLen: 250                                                               
                                       S1|T13 appends logs from S0| logLen:                                       
                                       250[AppendEntry]                                                           
S0|T13 replica entries to S1|                                                                                     
entrylen:0| matchidx:249| nextidx:250                                                                             
                                                                             S2|T13 save persist| votedFor: 0|    
                                                                             logsLen: 250                         
                                                                             S2|T13 appends logs from S0| logLen: 
                                                                             250[AppendEntry]                     
S0|T13 replica entries to S2|                                                                                     
entrylen:0| matchidx:249| nextidx:250                                                                             
                                                                             S2|T13 is not leader                 
                                       S1|T13 is not leader                                                       
                                       S1|T13 save persist| votedFor: 1|                                          
                                       logsLen: 250                                                               
                                       S1|T13 appends logs from S0| logLen:                                       
                                       250[AppendEntry]                                                           
S0|T13 replica entries to S1|                                                                                     
entrylen:0| matchidx:249| nextidx:250                                                                             
                                                                             S2|T13 save persist| votedFor: 0|    
                                                                             logsLen: 250                         
                                                                             S2|T13 appends logs from S0| logLen: 
                                                                             250[AppendEntry]                     
S0|T13 replica entries to S2|                                                                                     
entrylen:0| matchidx:249| nextidx:250                                                                             
                                                                             S2|T13 is not leader                 
                                       S1|T13 is not leader                                                       
                                       S1|T13 save persist| votedFor: 1|                                          
                                       logsLen: 250                                                               
                                       S1|T13 appends logs from S0| logLen:                                       
                                       250[AppendEntry]                                                           
S0|T13 replica entries to S1|                                                                                     
entrylen:0| matchidx:249| nextidx:250                                                                             
                                                                             S2|T13 save persist| votedFor: 0|    
                                                                             logsLen: 250                         
                                                                             S2|T13 appends logs from S0| logLen: 
                                                                             250[AppendEntry]                     
S0|T13 replica entries to S2|                                                                                     
entrylen:0| matchidx:249| nextidx:250                                                                             
                                                                             S2|T13 is not leader                 
                                       S1|T13 is not leader                                                       
                                       S1|T13 save persist| votedFor: 1|                                          
                                       logsLen: 250                                                               
                                       S1|T13 appends logs from S0| logLen:                                       
                                       250[AppendEntry]                                                           
S0|T13 replica entries to S1|                                                                                     
entrylen:0| matchidx:249| nextidx:250                                                                             
                                                                             S2|T13 save persist| votedFor: 0|    
                                                                             logsLen: 250                         
                                                                             S2|T13 appends logs from S0| logLen: 
                                                                             250[AppendEntry]                     
S0|T13 replica entries to S2|                                                                                     
entrylen:0| matchidx:249| nextidx:250                                                                             
S0|T13 save persist| votedFor: 0|                                                                                 
logsLen: 251                                                                                                      
S0|T13 receive commands | logLen:                                                                                 
251[Start]                                                                                                        
                                       S1|T13 is not leader                                                       
                                                                             S2|T13 is not leader                 
                                                                             S2|T13 save persist| votedFor: 0|    
                                                                             logsLen: 251                         
                                                                             S2|T13 appends logs from S0| logLen: 
                                                                             251[AppendEntry]                     
S0|T13 replica entries to S2|                                                                                     
entrylen:1| matchidx:250| nextidx:251                                                                             
S0|T13 update commitIndex as 250                                                                                  
S0|T13 starts to apply entries                                                                                    
[250:250][ApplyEntry]                                                                                             
S0|T13 finishes applying entries                                                                                  
[250:250][ApplyEntry]                                                                                             
                                       S1|T13 is not leader                                                       
                                                                             S2|T13 is not leader                 
                                       S1|T13 save persist| votedFor: 1|                                          
                                       logsLen: 251                                                               
                                       S1|T13 appends logs from S0| logLen:                                       
                                       251[AppendEntry]                                                           
                                       S1|T13 starts to apply entries                                             
                                       [250:250][ApplyEntry]                                                      
                                       S1|T13 finishes applying entries                                           
                                       [250:250][ApplyEntry]                                                      
S0|T13 replica entries to S1|                                                                                     
entrylen:1| matchidx:250| nextidx:251                                                                             
                                                                             S2|T13 save persist| votedFor: 0|    
                                                                             logsLen: 251                         
                                                                             S2|T13 appends logs from S0| logLen: 
                                                                             251[AppendEntry]                     
                                                                             S2|T13 starts to apply entries       
                                                                             [250:250][ApplyEntry]                
                                                                             S2|T13 finishes applying entries     
                                                                             [250:250][ApplyEntry]                
S0|T13 replica entries to S2|                                                                                     
entrylen:0| matchidx:250| nextidx:251                                                                             
                                       S1|T13 is not leader                                                       
                                                                             S2|T13 is not leader                 
                                       S1|T13 save persist| votedFor: 1|                                          
                                       logsLen: 251                                                               
                                       S1|T13 appends logs from S0| logLen:                                       
                                       251[AppendEntry]                                                           
S0|T13 replica entries to S1|                                                                                     
entrylen:0| matchidx:250| nextidx:251                                                                             
                                                                             S2|T13 save persist| votedFor: 0|    
                                                                             logsLen: 251                         
                                                                             S2|T13 appends logs from S0| logLen: 
                                                                             251[AppendEntry]                     
S0|T13 replica entries to S2|                                                                                     
entrylen:0| matchidx:250| nextidx:251                                                                             
                                                                             S2|T13 is not leader                 
                                       S1|T13 is not leader                                                       
                                                                             S2|T13 save persist| votedFor: 0|    
                                                                             logsLen: 251                         
                                                                             S2|T13 appends logs from S0| logLen: 
                                                                             251[AppendEntry]                     
S0|T13 replica entries to S2|                                                                                     
entrylen:0| matchidx:250| nextidx:251                                                                             
                                       S1|T13 is not leader                                                       
                                                                             S2|T13 is not leader                 
                                                                             S2|T13 save persist| votedFor: 0|    
                                                                             logsLen: 251                         
                                                                             S2|T13 appends logs from S0| logLen: 
                                                                             251[AppendEntry]                     
S0|T13 replica entries to S2|                                                                                     
entrylen:0| matchidx:250| nextidx:251                                                                             
                                       S1|T13 save persist| votedFor: 1|                                          
                                       logsLen: 251                                                               
                                       S1|T13 appends logs from S0| logLen:                                       
                                       251[AppendEntry]                                                           
S0|T13 replica entries to S1|                                                                                     
entrylen:0| matchidx:250| nextidx:251                                                                             
                                                                             S2|T13 is not leader                 
                                       S1|T13 is not leader                                                       
                                                                             S2|T13 save persist| votedFor: 0|    
                                                                             logsLen: 251                         
                                                                             S2|T13 appends logs from S0| logLen: 
                                                                             251[AppendEntry]                     
S0|T13 replica entries to S2|                                                                                     
entrylen:0| matchidx:250| nextidx:251                                                                             
                                                                             S2|T13 is not leader                 
                                       S1|T13 is not leader                                                       
                                       S1|T13 save persist| votedFor: 1|                                          
                                       logsLen: 251                                                               
                                       S1|T13 appends logs from S0| logLen:                                       
                                       251[AppendEntry]                                                           
S0|T13 replica entries to S1|                                                                                     
entrylen:0| matchidx:250| nextidx:251                                                                             
                                       S1 is disconnected                                                         
S0|T13 save persist| votedFor: 0|                                                                                 
logsLen: 252                                                                                                      
S0|T13 receive commands | logLen:                                                                                 
252[Start]                                                                                                        
                                                                             S2|T13 is not leader                 
                                       S1|T13 is not leader                                                       
                                                                             S2|T13 save persist| votedFor: 0|    
                                                                             logsLen: 252                         
                                                                             S2|T13 appends logs from S0| logLen: 
                                                                             252[AppendEntry]                     
                                                                             S2|T13 is not leader                 
                                       S1|T13 is not leader                                                       
                                                                             S2|T13 save persist| votedFor: 0|    
                                                                             logsLen: 252                         
                                                                             S2|T13 appends logs from S0| logLen: 
                                                                             252[AppendEntry]                     
S0|T13 replica entries to S2|                                                                                     
entrylen:1| matchidx:251| nextidx:252                                                                             
S0|T13 update commitIndex as 251                                                                                  
S0|T13 starts to apply entries                                                                                    
[251:251][ApplyEntry]                                                                                             
S0|T13 finishes applying entries                                                                                  
[251:251][ApplyEntry]                                                                                             
                                                                             S2|T13 is not leader                 
                                       S1|T13 is not leader                                                       
                                                                             S2|T13 save persist| votedFor: 0|    
                                                                             logsLen: 252                         
                                                                             S2|T13 appends logs from S0| logLen: 
                                                                             252[AppendEntry]                     
                                                                             S2|T13 starts to apply entries       
                                                                             [251:251][ApplyEntry]                
                                                                             S2|T13 finishes applying entries     
                                                                             [251:251][ApplyEntry]                
S0|T13 replica entries to S2|                                                                                     
entrylen:0| matchidx:251| nextidx:252                                                                             
S0|T13 save persist| votedFor: 0|                                                                                 
logsLen: 253                                                                                                      
S0|T13 receive commands | logLen:                                                                                 
253[Start]                                                                                                        
S0|T13 save persist| votedFor: 0|                                                                                 
logsLen: 254                                                                                                      
S0|T13 receive commands | logLen:                                                                                 
254[Start]                                                                                                        
S0|T13 save persist| votedFor: 0|                                                                                 
logsLen: 255                                                                                                      
S0|T13 receive commands | logLen:                                                                                 
255[Start]                                                                                                        
S0|T13 save persist| votedFor: 0|                                                                                 
logsLen: 256                                                                                                      
S0|T13 receive commands | logLen:                                                                                 
256[Start]                                                                                                        
S0|T13 save persist| votedFor: 0|                                                                                 
logsLen: 257                                                                                                      
S0|T13 receive commands | logLen:                                                                                 
257[Start]                                                                                                        
S0|T13 save persist| votedFor: 0|                                                                                 
logsLen: 258                                                                                                      
S0|T13 receive commands | logLen:                                                                                 
258[Start]                                                                                                        
S0|T13 save persist| votedFor: 0|                                                                                 
logsLen: 259                                                                                                      
S0|T13 receive commands | logLen:                                                                                 
259[Start]                                                                                                        
S0|T13 save persist| votedFor: 0|                                                                                 
logsLen: 260                                                                                                      
S0|T13 receive commands | logLen:                                                                                 
260[Start]                                                                                                        
S0|T13 save persist| votedFor: 0|                                                                                 
logsLen: 261                                                                                                      
S0|T13 receive commands | logLen:                                                                                 
261[Start]                                                                                                        
S0|T13 save persist| votedFor: 0|                                                                                 
logsLen: 262                                                                                                      
S0|T13 receive commands | logLen:                                                                                 
262[Start]                                                                                                        
S0|T13 save persist| votedFor: 0|                                                                                 
logsLen: 263                                                                                                      
S0|T13 receive commands | logLen:                                                                                 
263[Start]                                                                                                        
S0|T13 save persist| votedFor: 0|                                                                                 
logsLen: 264                                                                                                      
S0|T13 receive commands | logLen:                                                                                 
264[Start]                                                                                                        
S0|T13 save persist| votedFor: 0|                                                                                 
logsLen: 265                                                                                                      
S0|T13 receive commands | logLen:                                                                                 
265[Start]                                                                                                        
S0|T13 save persist| votedFor: 0|                                                                                 
logsLen: 266                                                                                                      
S0|T13 receive commands | logLen:                                                                                 
266[Start]                                                                                                        
S0|T13 save persist| votedFor: 0|                                                                                 
logsLen: 267                                                                                                      
S0|T13 receive commands | logLen:                                                                                 
267[Start]                                                                                                        
                                       S1|T13 is not leader                                                       
                                                                             S2|T13 is not leader                 
                                                                             S2|T13 save persist| votedFor: 0|    
                                                                             logsLen: 267                         
                                                                             S2|T13 appends logs from S0| logLen: 
                                                                             267[AppendEntry]                     
S0|T13 replica entries to S2|                                                                                     
entrylen:15| matchidx:266| nextidx:267                                                                            
S0|T13 update commitIndex as 266                                                                                  
S0|T13 starts to apply entries                                                                                    
[252:266][ApplyEntry]                                                                                             
S0|T13 Snapshot until index 259|                                                                                  
logLen: 267                                                                                                       
S0|T13 finishes applying entries                                                                                  
[252:266][ApplyEntry]                                                                                             
                                                                             S2|T13 is not leader                 
                                       S1|T13 is not leader                                                       
S0|T13 send rpc to S1|base: 259| next:                                                                            
251                                                                                                               
                                                                             S2|T13 is not leader                 
                                       S1|T13 is not leader                                                       
S0|T13 send rpc to S1|base: 259| next:                                                                            
251                                                                                                               
                                       S1|T14 starts to join election                                             
                                       S1|T14 save persist| votedFor: 1|                                          
                                       logsLen: 251                                                               
                                       S1|T14 is not leader                                                       
S0|T13 send rpc to S1|base: 259| next:                                                                            
251                                                                                                               
                                                                             S2|T13 is not leader                 
                                                                             S2|T13 save persist| votedFor: 0|    
                                                                             logsLen: 267                         
                                                                             S2|T13 appends logs from S0| logLen: 
                                                                             267[AppendEntry]                     
                                                                             S2|T13 starts to apply entries       
                                                                             [252:266][ApplyEntry]                
S0|T13 replica entries to S2|                                                                                     
entrylen:0| matchidx:266| nextidx:267                                                                             
                                                                             S2|T13 Snapshot until index 259|     
                                                                             logLen: 267                          
                                                                             S2|T13 finishes applying entries     
                                                                             [252:266][ApplyEntry]                
                                       S1 is connected again                                                      
S0|T13 save persist| votedFor: 0|                                                                                 
logsLen: 268                                                                                                      
S0|T13 receive commands | logLen:                                                                                 
268[Start]                                                                                                        
                                                                             S2|T13 is not leader                 
                                       S1|T14 is not leader                                                       
S0|T13 send rpc to S1|base: 259| next:                                                                            
251                                                                                                               
                                                                             S2|T13 save persist| votedFor: 0|    
                                                                             logsLen: 268                         
                                                                             S2|T13 appends logs from S0| logLen: 
                                                                             268[AppendEntry]                     
S0|T13 replica entries to S2|                                                                                     
entrylen:1| matchidx:267| nextidx:268                                                                             
S0|T13 update commitIndex as 267                                                                                  
                                       S1|T14 receive rpc from S0                                                 
                                       S1|T14 rejects to installsnap from S0                                      
                                       | out of date term                                                         
S0|T13 starts to apply entries                                                                                    
[267:267][ApplyEntry]                                                                                             
S0|T13 finishes applying entries                                                                                  
[267:267][ApplyEntry]                                                                                             
S0|T14 save persist| votedFor: -1|                                                                                
logsLen: 268                                                                                                      
                                                                             S2|T13 is not leader                 
S0|T14 is not leader                                                                                              
                                       S1|T14 is not leader                                                       
                                                                             S2|T13 is not leader                 
S0|T14 is not leader                                                                                              
                                       S1|T14 is not leader                                                       
                                       S1|T14 is not leader                                                       
                                                                             S2|T13 is not leader                 
S0|T14 is not leader                                                                                              
                                       S1|T14 is not leader                                                       
                                                                             S2|T13 is not leader                 
S0|T14 is not leader                                                                                              
S0|T14 is not leader                                                                                              
                                                                             S2|T13 is not leader                 
                                       S1|T14 is not leader                                                       
S0|T15 starts to join election                                                                                    
S0|T15 save persist| votedFor: 0|                                                                                 
logsLen: 268                                                                                                      
                                       S1|T15 save persist| votedFor: -1|                                         
                                       logsLen: 251                                                               
                                       S1|T15 save persist| votedFor: 0|                                          
                                       logsLen: 251                                                               
                                       S1|T15 votes for S0[RequestVote]                                           
S0|T15 becomes the leader, and starts                                                                             
heatbeats                                                                                                         
                                                                             S2|T15 save persist| votedFor: 0|    
                                                                             logsLen: 268                         
                                       S1|T15 rejects to append entries from                                      
                                       S0| short log| args.prev:267|                                              
                                       logLen:251                                                                 
                                                                             S2|T15 save persist| votedFor: 0|    
                                                                             logsLen: 268                         
                                                                             S2|T15 appends logs from S0| logLen: 
                                                                             268[AppendEntry]                     
                                                                             S2|T15 starts to apply entries       
                                                                             [267:267][ApplyEntry]                
S0|T15 send rpc to S1|base: 259| next:                                                                            
251                                                                                                               
                                                                             S2|T15 finishes applying entries     
                                                                             [267:267][ApplyEntry]                
S0|T15 replica entries to S2|                                                                                     
entrylen:0| matchidx:267| nextidx:268                                                                             
                                       S1|T15 receive rpc from S0                                                 
                                                                             S2|T15 is not leader                 
                                       S1|T15 update rfstate| Base:259|                                           
                                       LogLen:260                                                                 
S0|T15 send rpc to S1|base: 259| next:                                                                            
251                                                                                                               
                                       S1|T15 is not leader                                                       
                                       S1|T15 applys snapshot from S0                                             
S0|T15 installs snapshot to S1|                                                                                   
nextId:260| matchId:259                                                                                           
                                       S1|T15 receive rpc from S0                                                 
                                       S1|T15 rejects to installsnap from S0                                      
                                       | out of date term                                                         
S0|T15 installs snapshot to S1|                                                                                   
nextId:260| matchId:259                                                                                           
                                                                             S2|T15 is not leader                 
                                       S1|T15 is not leader                                                       
                                                                             S2|T15 save persist| votedFor: 0|    
                                                                             logsLen: 268                         
                                                                             S2|T15 appends logs from S0| logLen: 
                                                                             268[AppendEntry]                     
S0|T15 replica entries to S2|                                                                                     
entrylen:0| matchidx:267| nextidx:268                                                                             
                                       S1|T15 save persist| votedFor: 0|                                          
                                       logsLen: 268                                                               
                                       S1|T15 appends logs from S0| logLen:                                       
                                       268[AppendEntry]                                                           
                                       S1|T15 starts to apply entries                                             
                                       [260:267][ApplyEntry]                                                      
                                       S1|T15 finishes applying entries                                           
                                       [260:267][ApplyEntry]                                                      
S0|T15 replica entries to S1|                                                                                     
entrylen:8| matchidx:267| nextidx:268                                                                             
                                                                             S2|T15 is not leader                 
                                       S1|T15 is not leader                                                       
                                                                             S2|T15 save persist| votedFor: 0|    
                                                                             logsLen: 268                         
                                                                             S2|T15 appends logs from S0| logLen: 
                                                                             268[AppendEntry]                     
S0|T15 replica entries to S2|                                                                                     
entrylen:0| matchidx:267| nextidx:268                                                                             
                                       S1|T15 save persist| votedFor: 0|                                          
                                       logsLen: 268                                                               
                                       S1|T15 appends logs from S0| logLen:                                       
                                       268[AppendEntry]                                                           
                                       S1|T15 is not leader                                                       
                                                                             S2|T15 is not leader                 
                                                                             S2|T15 save persist| votedFor: 0|    
                                                                             logsLen: 268                         
                                                                             S2|T15 appends logs from S0| logLen: 
                                                                             268[AppendEntry]                     
S0|T15 replica entries to S2|                                                                                     
entrylen:0| matchidx:267| nextidx:268                                                                             
                                       S1|T15 save persist| votedFor: 0|                                          
                                       logsLen: 268                                                               
                                       S1|T15 appends logs from S0| logLen:                                       
                                       268[AppendEntry]                                                           
S0|T15 replica entries to S1|                                                                                     
entrylen:0| matchidx:267| nextidx:268                                                                             
                                       S1|T15 is not leader                                                       
                                                                             S2|T15 is not leader                 
                                                                             S2|T15 save persist| votedFor: 0|    
                                                                             logsLen: 268                         
                                                                             S2|T15 appends logs from S0| logLen: 
                                                                             268[AppendEntry]                     
S0|T15 replica entries to S2|                                                                                     
entrylen:0| matchidx:267| nextidx:268                                                                             
                                       S1|T15 save persist| votedFor: 0|                                          
                                       logsLen: 268                                                               
                                       S1|T15 appends logs from S0| logLen:                                       
                                       268[AppendEntry]                                                           
                                       S1|T15 is not leader                                                       
                                                                             S2|T15 is not leader                 
                                                                             S2|T15 save persist| votedFor: 0|    
                                                                             logsLen: 268                         
                                                                             S2|T15 appends logs from S0| logLen: 
                                                                             268[AppendEntry]                     
S0|T15 replica entries to S2|                                                                                     
entrylen:0| matchidx:267| nextidx:268                                                                             
                                       S1|T15 save persist| votedFor: 0|                                          
                                       logsLen: 268                                                               
                                       S1|T15 appends logs from S0| logLen:                                       
                                       268[AppendEntry]                                                           
S0|T15 replica entries to S1|                                                                                     
entrylen:0| matchidx:267| nextidx:268                                                                             
                                       S1|T15 is not leader                                                       
                                                                             S2|T15 is not leader                 
                                       S1 is disconnected                                                         
S0|T15 save persist| votedFor: 0|                                                                                 
logsLen: 269                                                                                                      
S0|T15 receive commands | logLen:                                                                                 
269[Start]                                                                                                        
                                       S1|T15 save persist| votedFor: 0|                                          
                                       logsLen: 268                                                               
                                       S1|T15 appends logs from S0| logLen:                                       
                                       268[AppendEntry]                                                           
                                                                             S2|T15 save persist| votedFor: 0|    
                                                                             logsLen: 268                         
                                                                             S2|T15 appends logs from S0| logLen: 
                                                                             268[AppendEntry]                     
S0|T15 replica entries to S2|                                                                                     
entrylen:0| matchidx:267| nextidx:268                                                                             
                                                                             S2|T15 is not leader                 
                                       S1|T15 is not leader                                                       
                                                                             S2|T15 save persist| votedFor: 0|    
                                                                             logsLen: 269                         
                                                                             S2|T15 appends logs from S0| logLen: 
                                                                             269[AppendEntry]                     
S0|T15 replica entries to S2|                                                                                     
entrylen:1| matchidx:268| nextidx:269                                                                             
S0|T15 update commitIndex as 268                                                                                  
S0|T15 starts to apply entries                                                                                    
[268:268][ApplyEntry]                                                                                             
S0|T15 finishes applying entries                                                                                  
[268:268][ApplyEntry]                                                                                             
                                                                             S2|T15 is not leader                 
                                       S1|T15 is not leader                                                       
                                                                             S2|T15 save persist| votedFor: 0|    
                                                                             logsLen: 269                         
                                                                             S2|T15 appends logs from S0| logLen: 
                                                                             269[AppendEntry]                     
                                                                             S2|T15 starts to apply entries       
                                                                             [268:268][ApplyEntry]                
                                                                             S2|T15 finishes applying entries     
                                                                             [268:268][ApplyEntry]                
S0|T15 replica entries to S2|                                                                                     
entrylen:0| matchidx:268| nextidx:269                                                                             
S0|T15 save persist| votedFor: 0|                                                                                 
logsLen: 270                                                                                                      
S0|T15 receive commands | logLen:                                                                                 
270[Start]                                                                                                        
S0|T15 save persist| votedFor: 0|                                                                                 
logsLen: 271                                                                                                      
S0|T15 receive commands | logLen:                                                                                 
271[Start]                                                                                                        
S0|T15 save persist| votedFor: 0|                                                                                 
logsLen: 272                                                                                                      
S0|T15 receive commands | logLen:                                                                                 
272[Start]                                                                                                        
S0|T15 save persist| votedFor: 0|                                                                                 
logsLen: 273                                                                                                      
S0|T15 receive commands | logLen:                                                                                 
273[Start]                                                                                                        
S0|T15 save persist| votedFor: 0|                                                                                 
logsLen: 274                                                                                                      
S0|T15 receive commands | logLen:                                                                                 
274[Start]                                                                                                        
S0|T15 save persist| votedFor: 0|                                                                                 
logsLen: 275                                                                                                      
S0|T15 receive commands | logLen:                                                                                 
275[Start]                                                                                                        
S0|T15 fails to install snapshot to S1                                                                            
S0|T15 save persist| votedFor: 0|                                                                                 
logsLen: 276                                                                                                      
S0|T15 receive commands | logLen:                                                                                 
276[Start]                                                                                                        
S0|T15 save persist| votedFor: 0|                                                                                 
logsLen: 277                                                                                                      
S0|T15 receive commands | logLen:                                                                                 
277[Start]                                                                                                        
S0|T15 save persist| votedFor: 0|                                                                                 
logsLen: 278                                                                                                      
S0|T15 receive commands | logLen:                                                                                 
278[Start]                                                                                                        
S0|T15 save persist| votedFor: 0|                                                                                 
logsLen: 279                                                                                                      
S0|T15 receive commands | logLen:                                                                                 
279[Start]                                                                                                        
S0|T15 save persist| votedFor: 0|                                                                                 
logsLen: 280                                                                                                      
S0|T15 receive commands | logLen:                                                                                 
280[Start]                                                                                                        
S0|T15 save persist| votedFor: 0|                                                                                 
logsLen: 281                                                                                                      
S0|T15 receive commands | logLen:                                                                                 
281[Start]                                                                                                        
S0|T15 save persist| votedFor: 0|                                                                                 
logsLen: 282                                                                                                      
S0|T15 receive commands | logLen:                                                                                 
282[Start]                                                                                                        
S0|T15 save persist| votedFor: 0|                                                                                 
logsLen: 283                                                                                                      
S0|T15 receive commands | logLen:                                                                                 
283[Start]                                                                                                        
                                                                             S2|T15 is not leader                 
                                       S1|T15 is not leader                                                       
                                                                             S2|T15 save persist| votedFor: 0|    
                                                                             logsLen: 283                         
                                                                             S2|T15 appends logs from S0| logLen: 
                                                                             283[AppendEntry]                     
S0|T15 replica entries to S2|                                                                                     
entrylen:14| matchidx:282| nextidx:283                                                                            
S0|T15 update commitIndex as 282                                                                                  
S0|T15 starts to apply entries                                                                                    
[269:282][ApplyEntry]                                                                                             
S0|T15 Snapshot until index 269|                                                                                  
logLen: 283                                                                                                       
S0|T15 Snapshot until index 279|                                                                                  
logLen: 283                                                                                                       
S0|T15 finishes applying entries                                                                                  
[269:282][ApplyEntry]                                                                                             
                                                                             S2|T15 is not leader                 
                                       S1|T15 is not leader                                                       
S0|T15 send rpc to S1|base: 279| next:                                                                            
268                                                                                                               
                                                                             S2|T15 save persist| votedFor: 0|    
                                                                             logsLen: 283                         
                                                                             S2|T15 appends logs from S0| logLen: 
                                                                             283[AppendEntry]                     
                                                                             S2|T15 starts to apply entries       
                                                                             [269:282][ApplyEntry]                
S0|T15 replica entries to S2|                                                                                     
entrylen:0| matchidx:282| nextidx:283                                                                             
                                                                             S2|T15 Snapshot until index 269|     
                                                                             logLen: 283                          
                                                                             S2|T15 Snapshot until index 279|     
                                                                             logLen: 283                          
                                                                             S2|T15 finishes applying entries     
                                                                             [269:282][ApplyEntry]                
                                       S1 is connected again                                                      
S0|T15 save persist| votedFor: 0|                                                                                 
logsLen: 284                                                                                                      
S0|T15 receive commands | logLen:                                                                                 
284[Start]                                                                                                        
                                       S1|T15 is not leader                                                       
                                                                             S2|T15 is not leader                 
S0|T15 send rpc to S1|base: 279| next:                                                                            
268                                                                                                               
                                       S1|T15 receive rpc from S0                                                 
                                       S1|T15 update rfstate| Base:279|                                           
                                       LogLen:280                                                                 
                                       S1|T15 applys snapshot from S0                                             
S0|T15 installs snapshot to S1|                                                                                   
nextId:280| matchId:279                                                                                           
                                                                             S2|T15 save persist| votedFor: 0|    
                                                                             logsLen: 284                         
                                                                             S2|T15 appends logs from S0| logLen: 
                                                                             284[AppendEntry]                     
S0|T15 replica entries to S2|                                                                                     
entrylen:1| matchidx:283| nextidx:284                                                                             
S0|T15 update commitIndex as 283                                                                                  
S0|T15 starts to apply entries                                                                                    
[283:283][ApplyEntry]                                                                                             
S0|T15 finishes applying entries                                                                                  
[283:283][ApplyEntry]                                                                                             
                                       S1|T15 is not leader                                                       
                                                                             S2|T15 is not leader                 
                                       S1|T15 save persist| votedFor: 0|                                          
                                       logsLen: 284                                                               
                                       S1|T15 appends logs from S0| logLen:                                       
                                       284[AppendEntry]                                                           
                                       S1|T15 starts to apply entries                                             
                                       [280:283][ApplyEntry]                                                      
                                       S1|T15 finishes applying entries                                           
                                       [280:283][ApplyEntry]                                                      
S0|T15 replica entries to S1|                                                                                     
entrylen:4| matchidx:283| nextidx:284                                                                             
                                                                             S2|T15 save persist| votedFor: 0|    
                                                                             logsLen: 284                         
                                                                             S2|T15 appends logs from S0| logLen: 
                                                                             284[AppendEntry]                     
                                                                             S2|T15 starts to apply entries       
                                                                             [283:283][ApplyEntry]                
                                                                             S2|T15 finishes applying entries     
                                                                             [283:283][ApplyEntry]                
S0|T15 replica entries to S2|                                                                                     
entrylen:0| matchidx:283| nextidx:284                                                                             
                                                                             S2|T15 is not leader                 
                                       S1|T15 is not leader                                                       
                                                                             S2|T15 save persist| votedFor: 0|    
                                                                             logsLen: 284                         
                                                                             S2|T15 appends logs from S0| logLen: 
                                                                             284[AppendEntry]                     
S0|T15 replica entries to S2|                                                                                     
entrylen:0| matchidx:283| nextidx:284                                                                             
                                       S1|T15 save persist| votedFor: 0|                                          
                                       logsLen: 284                                                               
                                       S1|T15 appends logs from S0| logLen:                                       
                                       284[AppendEntry]                                                           
S0|T15 replica entries to S1|                                                                                     
entrylen:0| matchidx:283| nextidx:284                                                                             
                                                                             S2|T15 is not leader                 
                                       S1|T15 is not leader                                                       
                                       S1|T15 save persist| votedFor: 0|                                          
                                       logsLen: 284                                                               
                                       S1|T15 appends logs from S0| logLen:                                       
                                       284[AppendEntry]                                                           
                                                                             S2|T15 save persist| votedFor: 0|    
                                                                             logsLen: 284                         
                                                                             S2|T15 appends logs from S0| logLen: 
                                                                             284[AppendEntry]                     
S0|T15 replica entries to S2|                                                                                     
entrylen:0| matchidx:283| nextidx:284                                                                             
                                                                             S2|T15 is not leader                 
                                       S1|T15 is not leader                                                       
                                       S1|T15 save persist| votedFor: 0|                                          
                                       logsLen: 284                                                               
                                       S1|T15 appends logs from S0| logLen:                                       
                                       284[AppendEntry]                                                           
                                                                             S2|T15 is not leader                 
                                       S1|T15 is not leader                                                       
                                                                             S2|T15 save persist| votedFor: 0|    
                                                                             logsLen: 284                         
                                                                             S2|T15 appends logs from S0| logLen: 
                                                                             284[AppendEntry]                     
S0|T15 replica entries to S2|                                                                                     
entrylen:0| matchidx:283| nextidx:284                                                                             
                                       S1|T15 save persist| votedFor: 0|                                          
                                       logsLen: 284                                                               
                                       S1|T15 appends logs from S0| logLen:                                       
                                       284[AppendEntry]                                                           
S0|T15 replica entries to S1|                                                                                     
entrylen:0| matchidx:283| nextidx:284                                                                             
                                                                             S2|T15 is not leader                 
                                       S1|T15 is not leader                                                       
                                                                             S2|T15 save persist| votedFor: 0|    
                                                                             logsLen: 284                         
                                                                             S2|T15 appends logs from S0| logLen: 
                                                                             284[AppendEntry]                     
S0|T15 replica entries to S2|                                                                                     
entrylen:0| matchidx:283| nextidx:284                                                                             
                                       S1|T15 save persist| votedFor: 0|                                          
                                       logsLen: 284                                                               
                                       S1|T15 appends logs from S0| logLen:                                       
                                       284[AppendEntry]                                                           
S0|T15 replica entries to S1|                                                                                     
entrylen:0| matchidx:283| nextidx:284                                                                             
S0 is disconnected                                                                                                
                                                                             S2|T15 is not leader                 
                                       S1|T15 is not leader                                                       
                                                                             S2|T15 is not leader                 
                                       S1|T15 is not leader                                                       
                                                                             S2|T15 is not leader                 
                                       S1|T15 is not leader                                                       
                                                                             S2|T15 is not leader                 
                                       S1|T15 is not leader                                                       
                                                                             S2|T15 is not leader                 
                                       S1|T15 is not leader                                                       
                                                                             S2|T15 is not leader                 
                                       S1|T15 is not leader                                                       
                                                                             S2|T15 is not leader                 
                                       S1|T15 is not leader                                                       
                                                                             S2|T16 starts to join election       
                                                                             S2|T16 save persist| votedFor: 2|    
                                                                             logsLen: 284                         
                                       S1|T16 save persist| votedFor: -1|                                         
                                       logsLen: 284                                                               
                                       S1|T16 save persist| votedFor: 2|                                          
                                       logsLen: 284                                                               
                                       S1|T16 votes for S2[RequestVote]                                           
                                                                             S2|T16 is not leader                 
                                       S1|T16 is not leader                                                       
                                       S1|T16 is not leader                                                       
                                                                             S2|T16 is not leader                 
                                       S1|T16 is not leader                                                       
                                                                             S2|T16 is not leader                 
                                                                             S2|T16 is not leader                 
                                       S1|T16 is not leader                                                       
S0|T15 fails to install snapshot to S1                                                                            
                                                                             S2|T16 is not leader                 
                                       S1|T16 is not leader                                                       
                                       S1|T16 is not leader                                                       
                                                                             S2|T16 is not leader                 
                                                                             S2|T16 is not leader                 
                                       S1|T16 is not leader                                                       
                                       S1|T16 is not leader                                                       
                                                                             S2|T16 is not leader                 
                                       S1|T17 starts to join election                                             
                                       S1|T17 save persist| votedFor: 1|                                          
                                       logsLen: 284                                                               
                                                                             S2|T17 save persist| votedFor: -1|   
                                                                             logsLen: 284                         
                                                                             S2|T17 save persist| votedFor: 1|    
                                                                             logsLen: 284                         
                                                                             S2|T17 votes for S1[RequestVote]     
                                       S1|T17 becomes the leader, and starts                                      
                                       heatbeats                                                                  
                                                                             S2|T17 save persist| votedFor: 1|    
                                                                             logsLen: 284                         
                                                                             S2|T17 appends logs from S1| logLen: 
                                                                             284[AppendEntry]                     
                                       S1|T17 save persist| votedFor: 1|                                          
                                       logsLen: 285                                                               
                                       S1|T17 receive commands | logLen:                                          
                                       285[Start]                                                                 
                                                                             S2|T17 is not leader                 
                                                                             S2|T17 save persist| votedFor: 1|    
                                                                             logsLen: 285                         
                                                                             S2|T17 appends logs from S1| logLen: 
                                                                             285[AppendEntry]                     
                                       S1|T17 replica entries to S2|                                              
                                       entrylen:1| matchidx:284| nextidx:285                                      
                                       S1|T17 update commitIndex as 284                                           
                                       S1|T17 starts to apply entries                                             
                                       [284:284][ApplyEntry]                                                      
                                       S1|T17 finishes applying entries                                           
                                       [284:284][ApplyEntry]                                                      
                                                                             S2|T17 is not leader                 
                                                                             S2|T17 save persist| votedFor: 1|    
                                                                             logsLen: 285                         
                                                                             S2|T17 appends logs from S1| logLen: 
                                                                             285[AppendEntry]                     
                                                                             S2|T17 starts to apply entries       
                                                                             [284:284][ApplyEntry]                
                                                                             S2|T17 finishes applying entries     
                                                                             [284:284][ApplyEntry]                
                                       S1|T17 replica entries to S2|                                              
                                       entrylen:0| matchidx:284| nextidx:285                                      
                                       S1|T17 save persist| votedFor: 1|                                          
                                       logsLen: 286                                                               
                                       S1|T17 receive commands | logLen:                                          
                                       286[Start]                                                                 
                                       S1|T17 save persist| votedFor: 1|                                          
                                       logsLen: 287                                                               
                                       S1|T17 receive commands | logLen:                                          
                                       287[Start]                                                                 
                                       S1|T17 save persist| votedFor: 1|                                          
                                       logsLen: 288                                                               
                                       S1|T17 receive commands | logLen:                                          
                                       288[Start]                                                                 
                                       S1|T17 save persist| votedFor: 1|                                          
                                       logsLen: 289                                                               
                                       S1|T17 receive commands | logLen:                                          
                                       289[Start]                                                                 
                                       S1|T17 save persist| votedFor: 1|                                          
                                       logsLen: 290                                                               
                                       S1|T17 receive commands | logLen:                                          
                                       290[Start]                                                                 
                                       S1|T17 save persist| votedFor: 1|                                          
                                       logsLen: 291                                                               
                                       S1|T17 receive commands | logLen:                                          
                                       291[Start]                                                                 
                                       S1|T17 save persist| votedFor: 1|                                          
                                       logsLen: 292                                                               
                                       S1|T17 receive commands | logLen:                                          
                                       292[Start]                                                                 
                                       S1|T17 save persist| votedFor: 1|                                          
                                       logsLen: 293                                                               
                                       S1|T17 receive commands | logLen:                                          
                                       293[Start]                                                                 
                                       S1|T17 save persist| votedFor: 1|                                          
                                       logsLen: 294                                                               
                                       S1|T17 receive commands | logLen:                                          
                                       294[Start]                                                                 
                                       S1|T17 save persist| votedFor: 1|                                          
                                       logsLen: 295                                                               
                                       S1|T17 receive commands | logLen:                                          
                                       295[Start]                                                                 
                                       S1|T17 save persist| votedFor: 1|                                          
                                       logsLen: 296                                                               
                                       S1|T17 receive commands | logLen:                                          
                                       296[Start]                                                                 
                                       S1|T17 save persist| votedFor: 1|                                          
                                       logsLen: 297                                                               
                                       S1|T17 receive commands | logLen:                                          
                                       297[Start]                                                                 
                                       S1|T17 save persist| votedFor: 1|                                          
                                       logsLen: 298                                                               
                                       S1|T17 receive commands | logLen:                                          
                                       298[Start]                                                                 
                                       S1|T17 save persist| votedFor: 1|                                          
                                       logsLen: 299                                                               
                                       S1|T17 receive commands | logLen:                                          
                                       299[Start]                                                                 
                                       S1|T17 save persist| votedFor: 1|                                          
                                       logsLen: 300                                                               
                                       S1|T17 receive commands | logLen:                                          
                                       300[Start]                                                                 
                                                                             S2|T17 is not leader                 
                                                                             S2|T17 save persist| votedFor: 1|    
                                                                             logsLen: 300                         
                                                                             S2|T17 appends logs from S1| logLen: 
                                                                             300[AppendEntry]                     
                                       S1|T17 replica entries to S2|                                              
                                       entrylen:15| matchidx:299|                                                 
                                       nextidx:300                                                                
                                       S1|T17 update commitIndex as 299                                           
                                       S1|T17 starts to apply entries                                             
                                       [285:299][ApplyEntry]                                                      
                                       S1|T17 Snapshot until index 289|                                           
                                       logLen: 300                                                                
                                       S1|T17 finishes applying entries                                           
                                       [285:299][ApplyEntry]                                                      
                                       S1|T17 Snapshot until index 299|                                           
                                       logLen: 300                                                                
                                       S1|T17 send rpc to S0|base: 299|                                           
                                       next: 284                                                                  
                                                                             S2|T17 is not leader                 
                                                                             S2|T17 save persist| votedFor: 1|    
                                                                             logsLen: 300                         
                                                                             S2|T17 appends logs from S1| logLen: 
                                                                             300[AppendEntry]                     
                                                                             S2|T17 starts to apply entries       
                                                                             [285:299][ApplyEntry]                
                                       S1|T17 replica entries to S2|                                              
                                       entrylen:0| matchidx:299| nextidx:300                                      
                                                                             S2|T17 Snapshot until index 289|     
                                                                             logLen: 300                          
                                                                             S2|T17 finishes applying entries     
                                                                             [285:299][ApplyEntry]                
                                                                             S2|T17 Snapshot until index 299|     
                                                                             logLen: 300                          
S0 is connected again                                                                                             
                                       S1|T17 save persist| votedFor: 1|                                          
                                       logsLen: 301                                                               
                                       S1|T17 receive commands | logLen:                                          
                                       301[Start]                                                                 
                                                                             S2|T17 is not leader                 
                                       S1|T17 send rpc to S0|base: 299|                                           
                                       next: 284                                                                  
                                                                             S2|T17 rejects to append entries from
                                                                             S0 | out of date term[AppendEntry]   
S0|T17 save persist| votedFor: -1|                                                                                
logsLen: 284                                                                                                      
                                       S1|T17 fails to install snapshot to                                        
                                       S0                                                                         
                                       S1|T17 rejects to append entries from                                      
                                       S0 | out of date term[AppendEntry]                                         
S0|T17 lost leadership, state: 0                                                                                  
                                                                             S2|T17 is not leader                 
S0|T17 is not leader                                                                                              
                                       S1|T17 send rpc to S0|base: 299|                                           
                                       next: 284                                                                  
S0|T17 receive rpc from S1                                                                                        
S0|T17 update rfstate| Base:299|                                                                                  
LogLen:300                                                                                                        
S0|T17 applys snapshot from S1                                                                                    
                                       S1|T17 installs snapshot to S0|                                            
                                       nextId:300| matchId:299                                                    
                                                                             S2|T17 save persist| votedFor: 1|    
                                                                             logsLen: 301                         
                                                                             S2|T17 appends logs from S1| logLen: 
                                                                             301[AppendEntry]                     
                                       S1|T17 replica entries to S2|                                              
                                       entrylen:1| matchidx:300| nextidx:301                                      
                                       S1|T17 update commitIndex as 300                                           
                                       S1|T17 starts to apply entries                                             
                                       [300:300][ApplyEntry]                                                      
                                       S1|T17 finishes applying entries                                           
                                       [300:300][ApplyEntry]                                                      
S0|T17 is not leader                                                                                              
                                                                             S2|T17 is not leader                 
S0|T17 save persist| votedFor: -1|                                                                                
logsLen: 301                                                                                                      
S0|T17 appends logs from S1| logLen:                                                                              
301[AppendEntry]                                                                                                  
S0|T17 starts to apply entries                                                                                    
[300:300][ApplyEntry]                                                                                             
S0|T17 finishes applying entries                                                                                  
[300:300][ApplyEntry]                                                                                             
                                       S1|T17 replica entries to S0|                                              
                                       entrylen:1| matchidx:300| nextidx:301                                      
S0|T17 fails to install snapshot to S1                                                                            
S0|T17 is not leader                                                                                              
                                                                             S2|T17 is not leader                 
                                                                             S2|T17 save persist| votedFor: 1|    
                                                                             logsLen: 301                         
                                                                             S2|T17 appends logs from S1| logLen: 
                                                                             301[AppendEntry]                     
                                                                             S2|T17 starts to apply entries       
                                                                             [300:300][ApplyEntry]                
                                                                             S2|T17 finishes applying entries     
                                                                             [300:300][ApplyEntry]                
                                       S1|T17 replica entries to S2|                                              
                                       entrylen:0| matchidx:300| nextidx:301                                      
S0|T17 save persist| votedFor: -1|                                                                                
logsLen: 301                                                                                                      
S0|T17 appends logs from S1| logLen:                                                                              
301[AppendEntry]                                                                                                  
                                       S1|T17 replica entries to S0|                                              
                                       entrylen:0| matchidx:300| nextidx:301                                      
S0|T17 is not leader                                                                                              
                                                                             S2|T17 is not leader                 
S0|T17 save persist| votedFor: -1|                                                                                
logsLen: 301                                                                                                      
S0|T17 appends logs from S1| logLen:                                                                              
301[AppendEntry]                                                                                                  
                                       S1|T17 replica entries to S0|                                              
                                       entrylen:0| matchidx:300| nextidx:301                                      
                                                                             S2|T17 save persist| votedFor: 1|    
                                                                             logsLen: 301                         
                                                                             S2|T17 appends logs from S1| logLen: 
                                                                             301[AppendEntry]                     
                                       S1|T17 replica entries to S2|                                              
                                       entrylen:0| matchidx:300| nextidx:301                                      
                                                                             S2|T17 is not leader                 
S0|T17 is not leader                                                                                              
S0|T17 save persist| votedFor: -1|                                                                                
logsLen: 301                                                                                                      
S0|T17 appends logs from S1| logLen:                                                                              
301[AppendEntry]                                                                                                  
                                       S1|T17 replica entries to S0|                                              
                                       entrylen:0| matchidx:300| nextidx:301                                      
                                                                             S2|T17 save persist| votedFor: 1|    
                                                                             logsLen: 301                         
                                                                             S2|T17 appends logs from S1| logLen: 
                                                                             301[AppendEntry]                     
                                       S1|T17 replica entries to S2|                                              
                                       entrylen:0| matchidx:300| nextidx:301                                      
                                                                             S2|T17 is not leader                 
S0|T17 is not leader                                                                                              
                                                                             S2|T17 save persist| votedFor: 1|    
                                                                             logsLen: 301                         
                                                                             S2|T17 appends logs from S1| logLen: 
                                                                             301[AppendEntry]                     
                                       S1|T17 replica entries to S2|                                              
                                       entrylen:0| matchidx:300| nextidx:301                                      
S0|T17 save persist| votedFor: -1|                                                                                
logsLen: 301                                                                                                      
S0|T17 appends logs from S1| logLen:                                                                              
301[AppendEntry]                                                                                                  
                                       S1|T17 replica entries to S0|                                              
                                       entrylen:0| matchidx:300| nextidx:301                                      
S0|T17 is not leader                                                                                              
                                                                             S2|T17 is not leader                 
S0|T17 save persist| votedFor: -1|                                                                                
logsLen: 301                                                                                                      
S0|T17 appends logs from S1| logLen:                                                                              
301[AppendEntry]                                                                                                  
                                       S1|T17 replica entries to S0|                                              
                                       entrylen:0| matchidx:300| nextidx:301                                      
                                                                             S2 is disconnected                   
                                       S1|T17 save persist| votedFor: 1|                                          
                                       logsLen: 302                                                               
                                       S1|T17 receive commands | logLen:                                          
                                       302[Start]                                                                 
S0|T17 is not leader                                                                                              
                                                                             S2|T17 is not leader                 
S0|T17 save persist| votedFor: -1|                                                                                
logsLen: 302                                                                                                      
S0|T17 appends logs from S1| logLen:                                                                              
302[AppendEntry]                                                                                                  
                                       S1|T17 replica entries to S0|                                              
                                       entrylen:1| matchidx:301| nextidx:302                                      
                                       S1|T17 update commitIndex as 301                                           
                                       S1|T17 starts to apply entries                                             
                                       [301:301][ApplyEntry]                                                      
                                       S1|T17 finishes applying entries                                           
                                       [301:301][ApplyEntry]                                                      
S0|T17 is not leader                                                                                              
                                                                             S2|T17 is not leader                 
S0|T17 save persist| votedFor: -1|                                                                                
logsLen: 302                                                                                                      
S0|T17 appends logs from S1| logLen:                                                                              
302[AppendEntry]                                                                                                  
S0|T17 starts to apply entries                                                                                    
[301:301][ApplyEntry]                                                                                             
S0|T17 finishes applying entries                                                                                  
[301:301][ApplyEntry]                                                                                             
                                       S1|T17 replica entries to S0|                                              
                                       entrylen:0| matchidx:301| nextidx:302                                      
                                       S1|T17 save persist| votedFor: 1|                                          
                                       logsLen: 303                                                               
                                       S1|T17 receive commands | logLen:                                          
                                       303[Start]                                                                 
                                       S1|T17 save persist| votedFor: 1|                                          
                                       logsLen: 304                                                               
                                       S1|T17 receive commands | logLen:                                          
                                       304[Start]                                                                 
                                       S1|T17 save persist| votedFor: 1|                                          
                                       logsLen: 305                                                               
                                       S1|T17 receive commands | logLen:                                          
                                       305[Start]                                                                 
                                       S1|T17 save persist| votedFor: 1|                                          
                                       logsLen: 306                                                               
                                       S1|T17 receive commands | logLen:                                          
                                       306[Start]                                                                 
                                       S1|T17 save persist| votedFor: 1|                                          
                                       logsLen: 307                                                               
                                       S1|T17 receive commands | logLen:                                          
                                       307[Start]                                                                 
                                       S1|T17 save persist| votedFor: 1|                                          
                                       logsLen: 308                                                               
                                       S1|T17 receive commands | logLen:                                          
                                       308[Start]                                                                 
                                       S1|T17 save persist| votedFor: 1|                                          
                                       logsLen: 309                                                               
                                       S1|T17 receive commands | logLen:                                          
                                       309[Start]                                                                 
                                       S1|T17 save persist| votedFor: 1|                                          
                                       logsLen: 310                                                               
                                       S1|T17 receive commands | logLen:                                          
                                       310[Start]                                                                 
                                       S1|T17 save persist| votedFor: 1|                                          
                                       logsLen: 311                                                               
                                       S1|T17 receive commands | logLen:                                          
                                       311[Start]                                                                 
S0|T17 is not leader                                                                                              
                                                                             S2|T17 is not leader                 
S0|T17 save persist| votedFor: -1|                                                                                
logsLen: 311                                                                                                      
S0|T17 appends logs from S1| logLen:                                                                              
311[AppendEntry]                                                                                                  
                                       S1|T17 replica entries to S0|                                              
                                       entrylen:9| matchidx:310| nextidx:311                                      
                                       S1|T17 update commitIndex as 310                                           
                                       S1|T17 starts to apply entries                                             
                                       [302:310][ApplyEntry]                                                      
                                       S1|T17 Snapshot until index 309|                                           
                                       logLen: 311                                                                
                                       S1|T17 finishes applying entries                                           
                                       [302:310][ApplyEntry]                                                      
                                       S1|T17 send rpc to S2|base: 309|                                           
                                       next: 301                                                                  
                                                                             S2|T17 is not leader                 
S0|T17 is not leader                                                                                              
S0|T17 save persist| votedFor: -1|                                                                                
logsLen: 311                                                                                                      
S0|T17 appends logs from S1| logLen:                                                                              
311[AppendEntry]                                                                                                  
S0|T17 starts to apply entries                                                                                    
[302:310][ApplyEntry]                                                                                             
                                       S1|T17 replica entries to S0|                                              
                                       entrylen:0| matchidx:310| nextidx:311                                      
S0|T17 Snapshot until index 309|                                                                                  
logLen: 311                                                                                                       
S0|T17 finishes applying entries                                                                                  
[302:310][ApplyEntry]                                                                                             
                                                                             S2 is connected again                
                                       S1|T17 save persist| votedFor: 1|                                          
                                       logsLen: 312                                                               
                                       S1|T17 receive commands | logLen:                                          
                                       312[Start]                                                                 
S0|T17 is not leader                                                                                              
                                                                             S2|T17 is not leader                 
                                       S1|T17 send rpc to S2|base: 309|                                           
                                       next: 301                                                                  
S0|T17 save persist| votedFor: -1|                                                                                
logsLen: 312                                                                                                      
S0|T17 appends logs from S1| logLen:                                                                              
312[AppendEntry]                                                                                                  
                                       S1|T17 replica entries to S0|                                              
                                       entrylen:1| matchidx:311| nextidx:312                                      
                                       S1|T17 update commitIndex as 311                                           
                                       S1|T17 starts to apply entries                                             
                                       [311:311][ApplyEntry]                                                      
                                       S1|T17 finishes applying entries                                           
                                       [311:311][ApplyEntry]                                                      
                                                                             S2|T17 receive rpc from S1           
                                                                             S2|T17 update rfstate| Base:309|     
                                                                             LogLen:310                           
                                                                             S2|T17 applys snapshot from S1       
                                       S1|T17 installs snapshot to S2|                                            
                                       nextId:310| matchId:309                                                    
                                                                             S2|T17 is not leader                 
S0|T17 is not leader                                                                                              
                                                                             S2|T17 save persist| votedFor: 1|    
                                                                             logsLen: 312                         
                                                                             S2|T17 appends logs from S1| logLen: 
                                                                             312[AppendEntry]                     
                                                                             S2|T17 starts to apply entries       
                                                                             [310:311][ApplyEntry]                
                                                                             S2|T17 finishes applying entries     
                                                                             [310:311][ApplyEntry]                
                                       S1|T17 replica entries to S2|                                              
                                       entrylen:2| matchidx:311| nextidx:312                                      
S0|T17 save persist| votedFor: -1|                                                                                
logsLen: 312                                                                                                      
S0|T17 appends logs from S1| logLen:                                                                              
312[AppendEntry]                                                                                                  
S0|T17 starts to apply entries                                                                                    
[311:311][ApplyEntry]                                                                                             
S0|T17 finishes applying entries                                                                                  
[311:311][ApplyEntry]                                                                                             
                                       S1|T17 replica entries to S0|                                              
                                       entrylen:0| matchidx:311| nextidx:312                                      
S0|T17 is not leader                                                                                              
                                                                             S2|T17 is not leader                 
                                                                             S2|T17 save persist| votedFor: 1|    
                                                                             logsLen: 312                         
                                                                             S2|T17 appends logs from S1| logLen: 
                                                                             312[AppendEntry]                     
                                       S1|T17 replica entries to S2|                                              
                                       entrylen:0| matchidx:311| nextidx:312                                      
S0|T17 save persist| votedFor: -1|                                                                                
logsLen: 312                                                                                                      
S0|T17 appends logs from S1| logLen:                                                                              
312[AppendEntry]                                                                                                  
                                       S1|T17 replica entries to S0|                                              
                                       entrylen:0| matchidx:311| nextidx:312                                      
S0|T17 is not leader                                                                                              
                                                                             S2|T17 is not leader                 
S0|T17 save persist| votedFor: -1|                                                                                
logsLen: 312                                                                                                      
S0|T17 appends logs from S1| logLen:                                                                              
312[AppendEntry]                                                                                                  
                                       S1|T17 replica entries to S0|                                              
                                       entrylen:0| matchidx:311| nextidx:312                                      
                                                                             S2|T17 save persist| votedFor: 1|    
                                                                             logsLen: 312                         
                                                                             S2|T17 appends logs from S1| logLen: 
                                                                             312[AppendEntry]                     
                                       S1|T17 replica entries to S2|                                              
                                       entrylen:0| matchidx:311| nextidx:312                                      
                                       S1|T17 fails to install snapshot to                                        
                                       S0                                                                         
S0|T17 is not leader                                                                                              
                                                                             S2|T17 is not leader                 
S0|T17 save persist| votedFor: -1|                                                                                
logsLen: 312                                                                                                      
S0|T17 appends logs from S1| logLen:                                                                              
312[AppendEntry]                                                                                                  
                                                                             S2|T17 save persist| votedFor: 1|    
                                                                             logsLen: 312                         
                                                                             S2|T17 appends logs from S1| logLen: 
                                                                             312[AppendEntry]                     
                                       S1|T17 replica entries to S0|                                              
                                       entrylen:0| matchidx:311| nextidx:312                                      
                                                                             S2|T17 is not leader                 
S0|T17 is not leader                                                                                              
                                                                             S2|T17 save persist| votedFor: 1|    
                                                                             logsLen: 312                         
                                                                             S2|T17 appends logs from S1| logLen: 
                                                                             312[AppendEntry]                     
                                       S1|T17 replica entries to S2|                                              
                                       entrylen:0| matchidx:311| nextidx:312                                      
S0|T17 save persist| votedFor: -1|                                                                                
logsLen: 312                                                                                                      
S0|T17 appends logs from S1| logLen:                                                                              
312[AppendEntry]                                                                                                  
                                       S1|T17 replica entries to S0|                                              
                                       entrylen:0| matchidx:311| nextidx:312                                      
                                                                             S2 is disconnected                   
                                       S1|T17 save persist| votedFor: 1|                                          
                                       logsLen: 313                                                               
                                       S1|T17 receive commands | logLen:                                          
                                       313[Start]                                                                 
S0|T17 is not leader                                                                                              
                                                                             S2|T17 is not leader                 
S0|T17 save persist| votedFor: -1|                                                                                
logsLen: 313                                                                                                      
S0|T17 appends logs from S1| logLen:                                                                              
313[AppendEntry]                                                                                                  
                                       S1|T17 replica entries to S0|                                              
                                       entrylen:1| matchidx:312| nextidx:313                                      
                                       S1|T17 update commitIndex as 312                                           
                                       S1|T17 starts to apply entries                                             
                                       [312:312][ApplyEntry]                                                      
                                       S1|T17 finishes applying entries                                           
                                       [312:312][ApplyEntry]                                                      
S0|T17 fails to install snapshot to S1                                                                            
                                                                             S2|T17 is not leader                 
S0|T17 is not leader                                                                                              
S0|T17 save persist| votedFor: -1|                                                                                
logsLen: 313                                                                                                      
S0|T17 appends logs from S1| logLen:                                                                              
313[AppendEntry]                                                                                                  
S0|T17 starts to apply entries                                                                                    
[312:312][ApplyEntry]                                                                                             
S0|T17 finishes applying entries                                                                                  
[312:312][ApplyEntry]                                                                                             
                                       S1|T17 save persist| votedFor: 1|                                          
                                       logsLen: 314                                                               
                                       S1|T17 receive commands | logLen:                                          
                                       314[Start]                                                                 
                                       S1|T17 save persist| votedFor: 1|                                          
                                       logsLen: 315                                                               
                                       S1|T17 receive commands | logLen:                                          
                                       315[Start]                                                                 
                                       S1|T17 save persist| votedFor: 1|                                          
                                       logsLen: 316                                                               
                                       S1|T17 receive commands | logLen:                                          
                                       316[Start]                                                                 
                                       S1|T17 save persist| votedFor: 1|                                          
                                       logsLen: 317                                                               
                                       S1|T17 receive commands | logLen:                                          
                                       317[Start]                                                                 
                                       S1|T17 save persist| votedFor: 1|                                          
                                       logsLen: 318                                                               
                                       S1|T17 receive commands | logLen:                                          
                                       318[Start]                                                                 
                                       S1|T17 save persist| votedFor: 1|                                          
                                       logsLen: 319                                                               
                                       S1|T17 receive commands | logLen:                                          
                                       319[Start]                                                                 
                                       S1|T17 save persist| votedFor: 1|                                          
                                       logsLen: 320                                                               
                                       S1|T17 receive commands | logLen:                                          
                                       320[Start]                                                                 
                                       S1|T17 save persist| votedFor: 1|                                          
                                       logsLen: 321                                                               
                                       S1|T17 receive commands | logLen:                                          
                                       321[Start]                                                                 
                                       S1|T17 save persist| votedFor: 1|                                          
                                       logsLen: 322                                                               
                                       S1|T17 receive commands | logLen:                                          
                                       322[Start]                                                                 
                                       S1|T17 save persist| votedFor: 1|                                          
                                       logsLen: 323                                                               
                                       S1|T17 receive commands | logLen:                                          
                                       323[Start]                                                                 
                                       S1|T17 save persist| votedFor: 1|                                          
                                       logsLen: 324                                                               
                                       S1|T17 receive commands | logLen:                                          
                                       324[Start]                                                                 
S0|T17 is not leader                                                                                              
                                                                             S2|T17 is not leader                 
S0|T17 save persist| votedFor: -1|                                                                                
logsLen: 324                                                                                                      
S0|T17 appends logs from S1| logLen:                                                                              
324[AppendEntry]                                                                                                  
                                       S1|T17 replica entries to S0|                                              
                                       entrylen:11| matchidx:323|                                                 
                                       nextidx:324                                                                
                                       S1|T17 update commitIndex as 323                                           
                                       S1|T17 starts to apply entries                                             
                                       [313:323][ApplyEntry]                                                      
                                       S1|T17 Snapshot until index 319|                                           
                                       logLen: 324                                                                
                                       S1|T17 finishes applying entries                                           
                                       [313:323][ApplyEntry]                                                      
                                                                             S2|T17 is not leader                 
S0|T17 is not leader                                                                                              
                                       S1|T17 send rpc to S2|base: 319|                                           
                                       next: 312                                                                  
S0|T17 save persist| votedFor: -1|                                                                                
logsLen: 324                                                                                                      
S0|T17 appends logs from S1| logLen:                                                                              
324[AppendEntry]                                                                                                  
S0|T17 starts to apply entries                                                                                    
[313:323][ApplyEntry]                                                                                             
                                       S1|T17 replica entries to S0|                                              
                                       entrylen:0| matchidx:323| nextidx:324                                      
S0|T17 Snapshot until index 319|                                                                                  
logLen: 324                                                                                                       
S0|T17 finishes applying entries                                                                                  
[313:323][ApplyEntry]                                                                                             
                                                                                             S2 is connected again                        
                                               S1|T17 save persist| votedFor: 1| logsLen:                                                 
                                               325                                                                                        
                                               S1|T17 receive commands | logLen: 325[Start]                                               
S0|T17 is not leader                                                                                                                      
                                                                                             S2|T17 is not leader                         
                                               S1|T17 send rpc to S2|base: 319| next: 312                                                 
                                                                                             S2|T17 receive rpc from S1                   
                                                                                             S2|T17 update rfstate| Base:319| LogLen:320  
                                                                                             S2|T17 applys snapshot from S1               
                                               S1|T17 installs snapshot to S2| nextId:320|                                                
                                               matchId:319                                                                                
S0|T17 save persist| votedFor: -1| logsLen:                                                                                               
325                                                                                                                                       
S0|T17 appends logs from S1| logLen:                                                                                                      
325[AppendEntry]                                                                                                                          
                                               S1|T17 replica entries to S0| entrylen:1|                                                  
                                               matchidx:324| nextidx:325                                                                  
                                               S1|T17 update commitIndex as 324                                                           
                                               S1|T17 starts to apply entries                                                             
                                               [324:324][ApplyEntry]                                                                      
                                               S1|T17 finishes applying entries                                                           
                                               [324:324][ApplyEntry]                                                                      
                                                                                             S2|T17 is not leader                         
S0|T17 is not leader                                                                                                                      
                                                                                             S2|T17 save persist| votedFor: 1| logsLen:   
                                                                                             325                                          
                                                                                             S2|T17 appends logs from S1| logLen:         
                                                                                             325[AppendEntry]                             
                                                                                             S2|T17 starts to apply entries               
                                                                                             [320:324][ApplyEntry]                        
                                                                                             S2|T17 finishes applying entries             
                                                                                             [320:324][ApplyEntry]                        
                                               S1|T17 replica entries to S2| entrylen:5|                                                  
                                               matchidx:324| nextidx:325                                                                  
S0|T17 save persist| votedFor: -1| logsLen:                                                                                               
325                                                                                                                                       
S0|T17 appends logs from S1| logLen:                                                                                                      
325[AppendEntry]                                                                                                                          
S0|T17 starts to apply entries                                                                                                            
[324:324][ApplyEntry]                                                                                                                     
S0|T17 finishes applying entries                                                                                                          
[324:324][ApplyEntry]                                                                                                                     
                                               S1|T17 replica entries to S0| entrylen:0|                                                  
                                               matchidx:324| nextidx:325                                                                  
                                                                                             S2|T17 is not leader                         
S0|T17 is not leader                                                                                                                      
S0|T17 save persist| votedFor: -1| logsLen:                                                                                               
325                                                                                                                                       
S0|T17 appends logs from S1| logLen:                                                                                                      
325[AppendEntry]                                                                                                                          
                                               S1|T17 replica entries to S0| entrylen:0|                                                  
                                               matchidx:324| nextidx:325                                                                  
                                                                                             S2|T17 save persist| votedFor: 1| logsLen:   
                                                                                             325                                          
                                                                                             S2|T17 appends logs from S1| logLen:         
                                                                                             325[AppendEntry]                             
                                               S1|T17 replica entries to S2| entrylen:0|                                                  
                                               matchidx:324| nextidx:325                                                                  
                                                                                             S2|T17 is not leader                         
S0|T17 is not leader                                                                                                                      
S0|T17 save persist| votedFor: -1| logsLen:                                                                                               
325                                                                                                                                       
S0|T17 appends logs from S1| logLen:                                                                                                      
325[AppendEntry]                                                                                                                          
                                               S1|T17 replica entries to S0| entrylen:0|                                                  
                                               matchidx:324| nextidx:325                                                                  
                                                                                             S2|T17 save persist| votedFor: 1| logsLen:   
                                                                                             325                                          
                                                                                             S2|T17 appends logs from S1| logLen:         
                                                                                             325[AppendEntry]                             
S0|T17 is not leader                                                                                                                      
                                                                                             S2|T17 is not leader                         
                                                                                             S2|T17 save persist| votedFor: 1| logsLen:   
                                                                                             325                                          
                                                                                             S2|T17 appends logs from S1| logLen:         
                                                                                             325[AppendEntry]                             
S0|T17 save persist| votedFor: -1| logsLen:                                                                                               
325                                                                                                                                       
S0|T17 appends logs from S1| logLen:                                                                                                      
325[AppendEntry]                                                                                                                          
                                               S1|T17 replica entries to S2| entrylen:0|                                                  
                                               matchidx:324| nextidx:325                                                                  
                                               S1|T17 replica entries to S0| entrylen:0|                                                  
                                               matchidx:324| nextidx:325                                                                  
                                                                                             S2|T17 is not leader                         
S0|T17 is not leader                                                                                                                      
S0|T17 save persist| votedFor: -1| logsLen:                                                                                               
325                                                                                                                                       
S0|T17 appends logs from S1| logLen:                                                                                                      
325[AppendEntry]                                                                                                                          
                                               S1|T17 replica entries to S0| entrylen:0|                                                  
                                               matchidx:324| nextidx:325                                                                  
                                                                                             S2|T17 save persist| votedFor: 1| logsLen:   
                                                                                             325                                          
                                                                                             S2|T17 appends logs from S1| logLen:         
                                                                                             325[AppendEntry]                             
                                               S1|T17 replica entries to S2| entrylen:0|                                                  
                                               matchidx:324| nextidx:325                                                                  
                                                                                             S2|T17 is not leader                         
S0|T17 is not leader                                                                                                                      
                                                                                             S2|T17 save persist| votedFor: 1| logsLen:   
                                                                                             325                                          
                                                                                             S2|T17 appends logs from S1| logLen:         
                                                                                             325[AppendEntry]                             
                                               S1|T17 replica entries to S2| entrylen:0|                                                  
                                               matchidx:324| nextidx:325                                                                  
                                               S1 is disconnected                                                                         
S0|T17 save persist| votedFor: -1| logsLen:                                                                                               
325                                                                                                                                       
S0|T17 appends logs from S1| logLen:                                                                                                      
325[AppendEntry]                                                                                                                          
S0|T17 is not leader                                                                                                                      
                                                                                             S2|T17 is not leader                         
S0|T17 is not leader                                                                                                                      
                                                                                             S2|T17 is not leader                         
S0|T17 is not leader                                                                                                                      
                                                                                             S2|T17 is not leader                         
S0|T17 is not leader                                                                                                                      
                                                                                             S2|T17 is not leader                         
S0|T17 is not leader                                                                                                                      
                                                                                             S2|T17 is not leader                         
                                                                                             S2|T17 is not leader                         
S0|T17 is not leader                                                                                                                      
                                                                                             S2|T17 is not leader                         
S0|T17 is not leader                                                                                                                      
S0|T17 is not leader                                                                                                                      
                                                                                             S2|T17 is not leader                         
                                                                                             S2|T17 is not leader                         
S0|T17 is not leader                                                                                                                      
S0|T18 starts to join election                                                                                                            
S0|T18 save persist| votedFor: 0| logsLen: 325                                                                                            
                                                                                             S2|T18 starts to join election               
                                                                                             S2|T18 save persist| votedFor: 2| logsLen:   
                                                                                             325                                          
                                                                                             S2 rejects to vote for S0 because it has     
                                                                                             voted or it is more up-dated[RequestVote]    
S0 rejects to vote for S2 because it has voted                                                                                            
or it is more up-dated[RequestVote]                                                                                                       
S0|T18 fails to install snapshot to S1                                                                                                    
S0|T18 is not leader                                                                                                                      
                                                                                             S2|T18 is not leader                         
S0|T18 is not leader                                                                                                                      
                                                                                             S2|T18 is not leader                         
S0|T18 is not leader                                                                                                                      
                                                                                             S2|T18 is not leader                         
S0|T18 is not leader                                                                                                                      
                                                                                             S2|T18 is not leader                         
S0|T18 is not leader                                                                                                                      
                                                                                             S2|T18 is not leader                         
                                                                                             S2|T18 is not leader                         
S0|T18 is not leader                                                                                                                      
S0|T18 is not leader                                                                                                                      
                                                                                             S2|T18 is not leader                         
S0|T18 is not leader                                                                                                                      
                                                                                             S2|T18 is not leader                         
S0|T18 is not leader                                                                                                                      
                                                                                             S2|T18 is not leader                         
                                                                                             S2|T18 is not leader                         
S0|T18 is not leader                                                                                                                      
                                                                                             S2|T18 is not leader                         
S0|T18 is not leader                                                                                                                      
                                                                                             S2|T18 is not leader                         
S0|T18 is not leader                                                                                                                      
                                                                                             S2|T19 starts to join election               
                                                                                             S2|T19 save persist| votedFor: 2| logsLen:   
                                                                                             325                                          
S0|T19 save persist| votedFor: -1| logsLen:                                                                                               
325                                                                                                                                       
S0|T19 save persist| votedFor: 2| logsLen: 325                                                                                            
S0|T19 votes for S2[RequestVote]                                                                                                          
                                                                                             S2|T19 becomes the leader, and starts        
                                                                                             heatbeats                                    
S0|T19 save persist| votedFor: 2| logsLen: 325                                                                                            
S0|T19 appends logs from S2| logLen:                                                                                                      
325[AppendEntry]                                                                                                                          
                                                                                             S2|T19 replica entries to S0| entrylen:0|    
                                                                                             matchidx:324| nextidx:325                    
                                                                                             S2|T19 save persist| votedFor: 2| logsLen:   
                                                                                             326                                          
                                                                                             S2|T19 receive commands | logLen: 326[Start] 
S0|T19 is not leader                                                                                                                      
S0|T19 save persist| votedFor: 2| logsLen: 326                                                                                            
S0|T19 appends logs from S2| logLen:                                                                                                      
326[AppendEntry]                                                                                                                          
                                                                                             S2|T19 replica entries to S0| entrylen:1|    
                                                                                             matchidx:325| nextidx:326                    
                                                                                             S2|T19 update commitIndex as 325             
                                                                                             S2|T19 starts to apply entries               
                                                                                             [325:325][ApplyEntry]                        
                                                                                             S2|T19 finishes applying entries             
                                                                                             [325:325][ApplyEntry]                        
S0|T19 is not leader                                                                                                                      
S0|T19 save persist| votedFor: 2| logsLen: 326                                                                                            
S0|T19 appends logs from S2| logLen:                                                                                                      
326[AppendEntry]                                                                                                                          
S0|T19 starts to apply entries                                                                                                            
[325:325][ApplyEntry]                                                                                                                     
S0|T19 finishes applying entries                                                                                                          
[325:325][ApplyEntry]                                                                                                                     
                                                                                             S2|T19 replica entries to S0| entrylen:0|    
                                                                                             matchidx:325| nextidx:326                    
                                                                                             S2|T19 save persist| votedFor: 2| logsLen:   
                                                                                             327                                          
                                                                                             S2|T19 receive commands | logLen: 327[Start] 
                                                                                             S2|T19 save persist| votedFor: 2| logsLen:   
                                                                                             328                                          
                                                                                             S2|T19 receive commands | logLen: 328[Start] 
                                                                                             S2|T19 save persist| votedFor: 2| logsLen:   
                                                                                             329                                          
                                                                                             S2|T19 receive commands | logLen: 329[Start] 
                                                                                             S2|T19 save persist| votedFor: 2| logsLen:   
                                                                                             330                                          
                                                                                             S2|T19 receive commands | logLen: 330[Start] 
                                                                                             S2|T19 save persist| votedFor: 2| logsLen:   
                                                                                             331                                          
                                                                                             S2|T19 receive commands | logLen: 331[Start] 
                                                                                             S2|T19 save persist| votedFor: 2| logsLen:   
                                                                                             332                                          
                                                                                             S2|T19 receive commands | logLen: 332[Start] 
                                                                                             S2|T19 save persist| votedFor: 2| logsLen:   
                                                                                             333                                          
                                                                                             S2|T19 receive commands | logLen: 333[Start] 
                                                                                             S2|T19 save persist| votedFor: 2| logsLen:   
                                                                                             334                                          
                                                                                             S2|T19 receive commands | logLen: 334[Start] 
                                                                                             S2|T19 save persist| votedFor: 2| logsLen:   
                                                                                             335                                          
                                                                                             S2|T19 receive commands | logLen: 335[Start] 
                                                                                             S2|T19 save persist| votedFor: 2| logsLen:   
                                                                                             336                                          
                                                                                             S2|T19 receive commands | logLen: 336[Start] 
                                                                                             S2|T19 save persist| votedFor: 2| logsLen:   
                                                                                             337                                          
                                                                                             S2|T19 receive commands | logLen: 337[Start] 
                                                                                             S2|T19 save persist| votedFor: 2| logsLen:   
                                                                                             338                                          
                                                                                             S2|T19 receive commands | logLen: 338[Start] 
S0|T19 is not leader                                                                                                                      
S0|T19 save persist| votedFor: 2| logsLen: 338                                                                                            
S0|T19 appends logs from S2| logLen:                                                                                                      
338[AppendEntry]                                                                                                                          
                                                                                             S2|T19 replica entries to S0| entrylen:12|   
                                                                                             matchidx:337| nextidx:338                    
                                                                                             S2|T19 update commitIndex as 337             
                                                                                             S2|T19 starts to apply entries               
                                                                                             [326:337][ApplyEntry]                        
                                                                                             S2|T19 Snapshot until index 329| logLen: 338 
                                                                                             S2|T19 finishes applying entries             
                                                                                             [326:337][ApplyEntry]                        
S0|T19 is not leader                                                                                                                      
                                                                                             S2|T19 send rpc to S1|base: 329| next: 325   
S0|T19 save persist| votedFor: 2| logsLen: 338                                                                                            
S0|T19 appends logs from S2| logLen:                                                                                                      
338[AppendEntry]                                                                                                                          
S0|T19 starts to apply entries                                                                                                            
[326:337][ApplyEntry]                                                                                                                     
                                                                                             S2|T19 replica entries to S0| entrylen:0|    
                                                                                             matchidx:337| nextidx:338                    
S0|T19 Snapshot until index 329| logLen: 338                                                                                              
S0|T19 finishes applying entries                                                                                                          
[326:337][ApplyEntry]                                                                                                                     
                                               S1 is connected again                                                                      
                                               S1|T17 save persist| votedFor: 1| logsLen:                                                 
                                               326                                                                                        
                                               S1|T17 receive commands | logLen: 326[Start]                                               
S0|T19 is not leader                                                                                                                      
                                                                                             S2|T19 send rpc to S1|base: 329| next: 325   
S0|T19 rejects to append entries from S1 | out                                                                                            
of date term[AppendEntry]                                                                                                                 
S0|T19 save persist| votedFor: 2| logsLen: 338                                                                                            
S0|T19 appends logs from S2| logLen:                                                                                                      
338[AppendEntry]                                                                                                                          
                                               S1|T19 save persist| votedFor: -1| logsLen:                                                
                                               326                                                                                        
                                                                                             S2|T19 replica entries to S0| entrylen:0|    
                                                                                             matchidx:337| nextidx:338                    
                                                                                             S2|T19 rejects to append entries from S1 |   
                                                                                             out of date term[AppendEntry]                
                                               S1|T19 lost leadership, state: 0                                                           
                                               S1|T19 receive rpc from S2                                                                 
                                               S1|T19 update rfstate| Base:329| LogLen:330                                                
                                               S1|T19 applys snapshot from S2                                                             
                                                                                             S2|T19 installs snapshot to S1| nextId:330|  
                                                                                             matchId:329                                  
S0|T19 is not leader                                                                                                                      
                                               S1|T19 is not leader                                                                       
S0|T19 save persist| votedFor: 2| logsLen: 338                                                                                            
S0|T19 appends logs from S2| logLen:                                                                                                      
338[AppendEntry]                                                                                                                          
                                                                                             S2|T19 replica entries to S0| entrylen:0|    
                                                                                             matchidx:337| nextidx:338                    
                                               S1|T19 save persist| votedFor: -1| logsLen:                                                
                                               338                                                                                        
                                               S1|T19 appends logs from S2| logLen:                                                       
                                               338[AppendEntry]                                                                           
                                               S1|T19 starts to apply entries                                                             
                                               [330:337][ApplyEntry]                                                                      
                                               S1|T19 finishes applying entries                                                           
                                               [330:337][ApplyEntry]                                                                      
                                                                                             S2|T19 replica entries to S1| entrylen:8|    
                                                                                             matchidx:337| nextidx:338                    
                                               S1|T19 is not leader                                                                       
S0|T19 is not leader                                                                                                                      
S0|T19 save persist| votedFor: 2| logsLen: 338                                                                                            
S0|T19 appends logs from S2| logLen:                                                                                                      
338[AppendEntry]                                                                                                                          
                                                                                             S2|T19 replica entries to S0| entrylen:0|    
                                                                                             matchidx:337| nextidx:338                    
                                               S1|T19 save persist| votedFor: -1| logsLen:                                                
                                               338                                                                                        
                                               S1|T19 appends logs from S2| logLen:                                                       
                                               338[AppendEntry]                                                                           
                                                                                             S2|T19 replica entries to S1| entrylen:0|    
                                                                                             matchidx:337| nextidx:338                    
S0|T19 is not leader                                                                                                                      
                                               S1|T19 is not leader                                                                       
S0|T19 save persist| votedFor: 2| logsLen: 338                                                                                            
S0|T19 appends logs from S2| logLen:                                                                                                      
338[AppendEntry]                                                                                                                          
                                                                                             S2|T19 replica entries to S0| entrylen:0|    
                                                                                             matchidx:337| nextidx:338                    
                                               S1|T19 save persist| votedFor: -1| logsLen:                                                
                                               338                                                                                        
                                               S1|T19 appends logs from S2| logLen:                                                       
                                               338[AppendEntry]                                                                           
                                                                                             S2|T19 replica entries to S1| entrylen:0|    
                                                                                             matchidx:337| nextidx:338                    
S0|T19 is not leader                                                                                                                      
                                               S1|T19 is not leader                                                                       
                                               S1|T19 save persist| votedFor: -1| logsLen:                                                
                                               338                                                                                        
                                               S1|T19 appends logs from S2| logLen:                                                       
                                               338[AppendEntry]                                                                           
                                               S1|T19 is not leader                                                                       
S0|T19 is not leader                                                                                                                      
S0|T19 save persist| votedFor: 2| logsLen: 338                                                                                            
S0|T19 appends logs from S2| logLen:                                                                                                      
338[AppendEntry]                                                                                                                          
                                                                                             S2|T19 replica entries to S0| entrylen:0|    
                                                                                             matchidx:337| nextidx:338                    
                                                                                             S2|T19 fails to install snapshot to S1       
                                               S1|T19 is not leader                                                                       
S0|T19 is not leader                                                                                                                      
S0|T19 save persist| votedFor: 2| logsLen: 338                                                                                            
S0|T19 appends logs from S2| logLen:                                                                                                      
338[AppendEntry]                                                                                                                          
                                                                                             S2|T19 replica entries to S0| entrylen:0|    
                                                                                             matchidx:337| nextidx:338                    
                                               S1|T19 save persist| votedFor: -1| logsLen:                                                
                                               338                                                                                        
                                               S1|T19 appends logs from S2| logLen:                                                       
                                               338[AppendEntry]                                                                           
                                                                                             S2|T19 replica entries to S1| entrylen:0|    
                                                                                             matchidx:337| nextidx:338                    
                                               S1|T19 is not leader                                                                       
S0|T19 is not leader                                                                                                                      
                                               S1|T19 save persist| votedFor: -1| logsLen:                                                
                                               338                                                                                        
                                               S1|T19 appends logs from S2| logLen:                                                       
                                               338[AppendEntry]                                                                           
                                                                                             S2|T19 replica entries to S1| entrylen:0|    
                                                                                             matchidx:337| nextidx:338                    
S0|T19 save persist| votedFor: 2| logsLen: 338                                                                                            
S0|T19 appends logs from S2| logLen:                                                                                                      
338[AppendEntry]                                                                                                                          
                                                                                             S2|T19 replica entries to S0| entrylen:0|    
                                                                                             matchidx:337| nextidx:338                    
S0|T19 is not leader                                                                                                                      
                                               S1|T19 is not leader                                                                       
                                               S1|T19 save persist| votedFor: -1| logsLen:                                                
                                               338                                                                                        
                                               S1|T19 appends logs from S2| logLen:                                                       
                                               338[AppendEntry]                                                                           
S0|T19 save persist| votedFor: 2| logsLen: 338                                                                                            
S0|T19 appends logs from S2| logLen:                                                                                                      
338[AppendEntry]                                                                                                                          
                                                                                             S2|T19 replica entries to S1| entrylen:0|    
                                                                                             matchidx:337| nextidx:338                    
                                                                                             S2|T19 replica entries to S0| entrylen:0|    
                                                                                             matchidx:337| nextidx:338                    
S0|T19 is not leader                                                                                                                      
                                               S1|T19 is not leader                                                                       
                                               S1|T19 save persist| votedFor: -1| logsLen:                                                
                                               338                                                                                        
                                               S1|T19 appends logs from S2| logLen:                                                       
                                               338[AppendEntry]                                                                           
                                                                                             S2|T19 replica entries to S1| entrylen:0|    
                                                                                             matchidx:337| nextidx:338                    
S0|T19 save persist| votedFor: 2| logsLen: 338                                                                                            
S0|T19 appends logs from S2| logLen:                                                                                                      
338[AppendEntry]                                                                                                                          
                                                                                             S2|T19 replica entries to S0| entrylen:0|    
                                                                                             matchidx:337| nextidx:338                    
S0|T19 is not leader                                                                                                                      
                                               S1|T19 is not leader                                                                       
S0|T19 save persist| votedFor: 2| logsLen: 338                                                                                            
S0|T19 appends logs from S2| logLen:                                                                                                      
338[AppendEntry]                                                                                                                          
                                                                                             S2|T19 replica entries to S0| entrylen:0|    
                                                                                             matchidx:337| nextidx:338                    
S0|T19 is not leader                                                                                                                      
                                               S1|T19 is not leader                                                                       
                                               S1|T19 save persist| votedFor: -1| logsLen:                                                
                                               338                                                                                        
                                               S1|T19 appends logs from S2| logLen:                                                       
                                               338[AppendEntry]                                                                           
                                                                                             S2|T19 replica entries to S1| entrylen:0|    
                                                                                             matchidx:337| nextidx:338                    
                                               S1|T19 fails to install snapshot to S2                                                     
S0|T19 is not leader                                                                                                                      
                                               S1|T19 is not leader                                                                       
S0|T19 save persist| votedFor: 2| logsLen: 338                                                                                            
S0|T19 appends logs from S2| logLen:                                                                                                      
338[AppendEntry]                                                                                                                          
                                                                                             S2|T19 replica entries to S0| entrylen:0|    
                                                                                             matchidx:337| nextidx:338                    
                                               S1|T19 save persist| votedFor: -1| logsLen:                                                
                                               338                                                                                        
                                               S1|T19 appends logs from S2| logLen:                                                       
                                               338[AppendEntry]                                                                           
                                                                                             S2|T19 replica entries to S1| entrylen:0|    
                                                                                             matchidx:337| nextidx:338                    
                                               S1|T19 is not leader                                                                       
S0|T19 is not leader                                                                                                                      
S0|T19 save persist| votedFor: 2| logsLen: 338                                                                                            
S0|T19 appends logs from S2| logLen:                                                                                                      
338[AppendEntry]                                                                                                                          
                                                                                             S2|T19 replica entries to S0| entrylen:0|    
                                                                                             matchidx:337| nextidx:338                    
                                               S1|T19 save persist| votedFor: -1| logsLen:                                                
                                               338                                                                                        
                                               S1|T19 appends logs from S2| logLen:                                                       
                                               338[AppendEntry]                                                                           
                                                                                             S2|T19 replica entries to S1| entrylen:0|    
                                                                                             matchidx:337| nextidx:338                    
                                               S1|T19 is not leader                                                                       
S0|T19 is not leader                                                                                                                      
                                               S1|T19 save persist| votedFor: -1| logsLen:                                                
                                               338                                                                                        
                                               S1|T19 appends logs from S2| logLen:                                                       
                                               338[AppendEntry]                                                                           
                                                                                             S2|T19 replica entries to S1| entrylen:0|    
                                                                                             matchidx:337| nextidx:338                    
S0|T19 save persist| votedFor: 2| logsLen: 338                                                                                            
S0|T19 appends logs from S2| logLen:                                                                                                      
338[AppendEntry]                                                                                                                          
                                                                                             S2|T19 replica entries to S0| entrylen:0|    
                                                                                             matchidx:337| nextidx:338                    
S0|T19 is not leader                                                                                                                      
                                               S1|T19 is not leader                                                                       
S0|T19 save persist| votedFor: 2| logsLen: 338                                                                                            
S0|T19 appends logs from S2| logLen:                                                                                                      
338[AppendEntry]                                                                                                                          
                                                                                             S2|T19 replica entries to S0| entrylen:0|    
                                                                                             matchidx:337| nextidx:338                    
                                               S1|T19 save persist| votedFor: -1| logsLen:                                                
                                               338                                                                                        
                                               S1|T19 appends logs from S2| logLen:                                                       
                                               338[AppendEntry]                                                                           
                                               S1|T19 is not leader                                                                       
S0|T19 is not leader                                                                                                                      
S0|T19 save persist| votedFor: 2| logsLen: 338                                                                                            
S0|T19 appends logs from S2| logLen:                                                                                                      
338[AppendEntry]                                                                                                                          
                                                                                             S2|T19 replica entries to S0| entrylen:0|    
                                                                                             matchidx:337| nextidx:338                    
                                               S1|T19 save persist| votedFor: -1| logsLen:                                                
                                               338                                                                                        
                                               S1|T19 appends logs from S2| logLen:                                                       
                                               338[AppendEntry]                                                                           
                                                                                             S2|T19 replica entries to S1| entrylen:0|    
                                                                                             matchidx:337| nextidx:338                    
                                               S1|T19 is not leader                                                                       
S0|T19 is not leader                                                                                                                      
S0|T19 save persist| votedFor: 2| logsLen: 338                                                                                            
S0|T19 appends logs from S2| logLen:                                                                                                      
338[AppendEntry]                                                                                                                          
                                                                                             S2|T19 replica entries to S0| entrylen:0|    
                                                                                             matchidx:337| nextidx:338                    
                                               S1|T19 save persist| votedFor: -1| logsLen:                                                
                                               338                                                                                        
                                               S1|T19 appends logs from S2| logLen:                                                       
                                               338[AppendEntry]                                                                           
                                                                                             S2|T19 replica entries to S1| entrylen:0|    
                                                                                             matchidx:337| nextidx:338                    
S0|T19 is not leader                                                                                                                      
                                               S1|T19 is not leader                                                                       
                                               S1|T19 save persist| votedFor: -1| logsLen:                                                
                                               338                                                                                        
                                               S1|T19 appends logs from S2| logLen:                                                       
                                               338[AppendEntry]                                                                           
                                                                                             S2|T19 replica entries to S1| entrylen:0|    
                                                                                             matchidx:337| nextidx:338                    
                                               S1|T19 is not leader                                                                       
S0|T19 is not leader                                                                                                                      
S0|T19 save persist| votedFor: 2| logsLen: 338                                                                                            
S0|T19 appends logs from S2| logLen:                                                                                                      
338[AppendEntry]                                                                                                                          
                                                                                             S2|T19 replica entries to S0| entrylen:0|    
                                                                                             matchidx:337| nextidx:338                    
                                               S1|T19 save persist| votedFor: -1| logsLen:                                                
                                               338                                                                                        
                                               S1|T19 appends logs from S2| logLen:                                                       
                                               338[AppendEntry]                                                                           
                                                                                             S2|T19 replica entries to S1| entrylen:0|    
                                                                                             matchidx:337| nextidx:338                    
                                                                                             S2|T19 save persist| votedFor: 2| logsLen:   
                                                                                             339                                          
                                                                                             S2|T19 receive commands | logLen: 339[Start] 
                                               S1|T19 is not leader                                                                       
S0|T19 is not leader                                                                                                                      
                                               S1|T19 save persist| votedFor: -1| logsLen:                                                
                                               339                                                                                        
                                               S1|T19 appends logs from S2| logLen:                                                       
                                               339[AppendEntry]                                                                           
                                                                                             S2|T19 replica entries to S1| entrylen:1|    
                                                                                             matchidx:338| nextidx:339                    
                                                                                             S2|T19 update commitIndex as 338             
                                                                                             S2|T19 starts to apply entries               
                                                                                             [338:338][ApplyEntry]                        
                                                                                             S2|T19 finishes applying entries             
                                                                                             [338:338][ApplyEntry]                        
S0|T19 save persist| votedFor: 2| logsLen: 339                                                                                            
S0|T19 appends logs from S2| logLen:                                                                                                      
339[AppendEntry]                                                                                                                          
                                               S1|T19 fails to install snapshot to S2                                                     
S0|T19 is not leader                                                                                                                      
                                               S1|T19 is not leader                                                                       
S0|T19 save persist| votedFor: 2| logsLen: 339                                                                                            
S0|T19 appends logs from S2| logLen:                                                                                                      
339[AppendEntry]                                                                                                                          
S0|T19 starts to apply entries                                                                                                            
[338:338][ApplyEntry]                                                                                                                     
S0|T19 finishes applying entries                                                                                                          
[338:338][ApplyEntry]                                                                                                                     
                                                                                             S2|T19 replica entries to S0| entrylen:1|    
                                                                                             matchidx:338| nextidx:339                    
                                               S1|T19 save persist| votedFor: -1| logsLen:                                                
                                               339                                                                                        
                                               S1|T19 appends logs from S2| logLen:                                                       
                                               339[AppendEntry]                                                                           
                                               S1|T19 starts to apply entries                                                             
                                               [338:338][ApplyEntry]                                                                      
                                               S1|T19 finishes applying entries                                                           
                                               [338:338][ApplyEntry]                                                                      
                                                                                             S2|T19 replica entries to S1| entrylen:0|    
                                                                                             matchidx:338| nextidx:339                    
S0|T19 is not leader                                                                                                                      
                                               S1|T19 is not leader                                                                       
                                               S1|T19 save persist| votedFor: -1| logsLen:                                                
                                               339                                                                                        
                                               S1|T19 appends logs from S2| logLen:                                                       
                                               339[AppendEntry]                                                                           
                                                                                             S2|T19 replica entries to S1| entrylen:0|    
                                                                                             matchidx:338| nextidx:339                    
S0|T19 save persist| votedFor: 2| logsLen: 339                                                                                            
S0|T19 appends logs from S2| logLen:                                                                                                      
339[AppendEntry]                                                                                                                          
                                                                                             S2|T19 replica entries to S0| entrylen:0|    
                                                                                             matchidx:338| nextidx:339                    
S0|T19 is not leader                                                                                                                      
                                               S1|T19 is not leader                                                                       
S0|T19 save persist| votedFor: 2| logsLen: 339                                                                                            
S0|T19 appends logs from S2| logLen:                                                                                                      
339[AppendEntry]                                                                                                                          
                                               S1|T19 save persist| votedFor: -1| logsLen:                                                
                                               339                                                                                        
                                               S1|T19 appends logs from S2| logLen:                                                       
                                               339[AppendEntry]                                                                           
                                                                                             S2|T19 replica entries to S0| entrylen:0|    
                                                                                             matchidx:338| nextidx:339                    
                                                                                             S2|T19 replica entries to S1| entrylen:0|    
                                                                                             matchidx:338| nextidx:339                    
                                               S1|T19 is not leader                                                                       
S0|T19 is not leader                                                                                                                      
                                               S1|T19 save persist| votedFor: -1| logsLen:                                                
                                               339                                                                                        
                                               S1|T19 appends logs from S2| logLen:                                                       
                                               339[AppendEntry]                                                                           
                                                                                             S2|T19 replica entries to S1| entrylen:0|    
                                                                                             matchidx:338| nextidx:339                    
S0|T19 save persist| votedFor: 2| logsLen: 339                                                                                            
S0|T19 appends logs from S2| logLen:                                                                                                      
339[AppendEntry]                                                                                                                          
                                                                                             S2|T19 replica entries to S0| entrylen:0|    
                                                                                             matchidx:338| nextidx:339                    
                                               S1|T19 is not leader                                                                       
S0|T19 is not leader                                                                                                                      
S0|T19 save persist| votedFor: 2| logsLen: 339                                                                                            
S0|T19 appends logs from S2| logLen:                                                                                                      
339[AppendEntry]                                                                                                                          
                                                                                             S2|T19 replica entries to S0| entrylen:0|    
                                                                                             matchidx:338| nextidx:339                    
                                               S1|T19 save persist| votedFor: -1| logsLen:                                                
                                               339                                                                                        
                                               S1|T19 appends logs from S2| logLen:                                                       
                                               339[AppendEntry]                                                                           
                                               S1|T19 is not leader                                                                       
S0|T19 is not leader                                                                                                                      
S0|T19 save persist| votedFor: 2| logsLen: 339                                                                                            
                                               S1|T19 save persist| votedFor: -1| logsLen:                                                
                                               339                                                                                        
                                               S1|T19 appends logs from S2| logLen:                                                       
                                               339[AppendEntry]                                                                           
S0|T19 appends logs from S2| logLen:                                                                                                      
339[AppendEntry]                                                                                                                          
                                                                                             S2|T19 replica entries to S1| entrylen:0|    
                                                                                             matchidx:338| nextidx:339                    
S0 is disconnected                                                                                                                        
                                                                                             S2|T19 save persist| votedFor: 2| logsLen:   
                                                                                             340                                          
                                                                                             S2|T19 receive commands | logLen: 340[Start] 
                                               S1|T19 is not leader                                                                       
S0|T19 is not leader                                                                                                                      
                                               S1|T19 save persist| votedFor: -1| logsLen:                                                
                                               340                                                                                        
                                               S1|T19 appends logs from S2| logLen:                                                       
                                               340[AppendEntry]                                                                           
                                                                                             S2|T19 replica entries to S1| entrylen:1|    
                                                                                             matchidx:339| nextidx:340                    
                                                                                             S2|T19 update commitIndex as 339             
                                                                                             S2|T19 starts to apply entries               
                                                                                             [339:339][ApplyEntry]                        
                                                                                             S2|T19 finishes applying entries             
                                                                                             [339:339][ApplyEntry]                        
                                                                                             S2|T19 Snapshot until index 339| logLen: 340 
                                               S1|T19 is not leader                                                                       
S0|T19 is not leader                                                                                                                      
                                                                                             S2|T19 send rpc to S0|base: 339| next: 339   
                                               S1|T19 save persist| votedFor: -1| logsLen:                                                
                                               340                                                                                        
                                               S1|T19 appends logs from S2| logLen:                                                       
                                               340[AppendEntry]                                                                           
                                               S1|T19 starts to apply entries                                                             
                                               [339:339][ApplyEntry]                                                                      
                                               S1|T19 finishes applying entries                                                           
                                               [339:339][ApplyEntry]                                                                      
                                                                                             S2|T19 replica entries to S1| entrylen:0|    
                                                                                             matchidx:339| nextidx:340                    
                                               S1|T19 Snapshot until index 339| logLen: 340                                               
                                                                                             S2|T19 save persist| votedFor: 2| logsLen:   
                                                                                             341                                          
                                                                                             S2|T19 receive commands | logLen: 341[Start] 
                                                                                             S2|T19 save persist| votedFor: 2| logsLen:   
                                                                                             342                                          
                                                                                             S2|T19 receive commands | logLen: 342[Start] 
                                                                                             S2|T19 save persist| votedFor: 2| logsLen:   
                                                                                             343                                          
                                                                                             S2|T19 receive commands | logLen: 343[Start] 
                                                                                             S2|T19 save persist| votedFor: 2| logsLen:   
                                                                                             344                                          
                                                                                             S2|T19 receive commands | logLen: 344[Start] 
                                                                                             S2|T19 save persist| votedFor: 2| logsLen:   
                                                                                             345                                          
                                                                                             S2|T19 receive commands | logLen: 345[Start] 
                                                                                             S2|T19 save persist| votedFor: 2| logsLen:   
                                                                                             346                                          
                                                                                             S2|T19 receive commands | logLen: 346[Start] 
                                                                                             S2|T19 save persist| votedFor: 2| logsLen:   
                                                                                             347                                          
                                                                                             S2|T19 receive commands | logLen: 347[Start] 
                                                                                             S2|T19 save persist| votedFor: 2| logsLen:   
                                                                                             348                                          
                                                                                             S2|T19 receive commands | logLen: 348[Start] 
                                                                                             S2|T19 save persist| votedFor: 2| logsLen:   
                                                                                             349                                          
                                                                                             S2|T19 receive commands | logLen: 349[Start] 
                                                                                             S2|T19 save persist| votedFor: 2| logsLen:   
                                                                                             350                                          
                                                                                             S2|T19 receive commands | logLen: 350[Start] 
S0|T19 is not leader                                                                                                                      
                                               S1|T19 is not leader                                                                       
                                                                                             S2|T19 send rpc to S0|base: 339| next: 339   
                                               S1|T19 save persist| votedFor: -1| logsLen:                                                
                                               350                                                                                        
                                               S1|T19 appends logs from S2| logLen:                                                       
                                               350[AppendEntry]                                                                           
                                                                                             S2|T19 replica entries to S1| entrylen:10|   
                                                                                             matchidx:349| nextidx:350                    
                                                                                             S2|T19 update commitIndex as 349             
                                                                                             S2|T19 starts to apply entries               
                                                                                             [340:349][ApplyEntry]                        
                                                                                             S2|T19 finishes applying entries             
                                                                                             [340:349][ApplyEntry]                        
                                                                                             S2|T19 Snapshot until index 349| logLen: 350 
S0|T19 is not leader                                                                                                                      
                                               S1|T19 is not leader                                                                       
                                                                                             S2|T19 send rpc to S0|base: 349| next: 339   
                                               S1|T19 save persist| votedFor: -1| logsLen:                                                
                                               350                                                                                        
                                               S1|T19 appends logs from S2| logLen:                                                       
                                               350[AppendEntry]                                                                           
                                               S1|T19 starts to apply entries                                                             
                                               [340:349][ApplyEntry]                                                                      
                                               S1|T19 finishes applying entries                                                           
                                               [340:349][ApplyEntry]                                                                      
                                                                                             S2|T19 replica entries to S1| entrylen:0|    
                                                                                             matchidx:349| nextidx:350                    
                                               S1|T19 Snapshot until index 349| logLen: 350                                               
S0 is connected again                                                                                                                     
                                                                                             S2|T19 save persist| votedFor: 2| logsLen:   
                                                                                             351                                          
                                                                                             S2|T19 receive commands | logLen: 351[Start] 
                                               S1|T19 is not leader                                                                       
S0|T19 is not leader                                                                                                                      
                                                                                             S2|T19 send rpc to S0|base: 349| next: 339   
                                               S1|T19 save persist| votedFor: -1| logsLen:                                                
                                               351                                                                                        
                                               S1|T19 appends logs from S2| logLen:                                                       
                                               351[AppendEntry]                                                                           
                                                                                             S2|T19 replica entries to S1| entrylen:1|    
                                                                                             matchidx:350| nextidx:351                    
                                                                                             S2|T19 update commitIndex as 350             
                                                                                             S2|T19 starts to apply entries               
                                                                                             [350:350][ApplyEntry]                        
                                                                                             S2|T19 finishes applying entries             
                                                                                             [350:350][ApplyEntry]                        
S0|T19 receive rpc from S2                                                                                                                
S0|T19 update rfstate| Base:349| LogLen:350                                                                                               
S0|T19 applys snapshot from S2                                                                                                            
                                                                                             S2|T19 installs snapshot to S0| nextId:350|  
                                                                                             matchId:349                                  
S0|T19 is not leader                                                                                                                      
                                               S1|T19 is not leader                                                                       
S0|T19 save persist| votedFor: 2| logsLen: 351                                                                                            
S0|T19 appends logs from S2| logLen:                                                                                                      
351[AppendEntry]                                                                                                                          
S0|T19 starts to apply entries                                                                                                            
[350:350][ApplyEntry]                                                                                                                     
S0|T19 finishes applying entries                                                                                                          
[350:350][ApplyEntry]                                                                                                                     
                                                                                             S2|T19 replica entries to S0| entrylen:1|    
                                                                                             matchidx:350| nextidx:351                    
                                               S1|T19 save persist| votedFor: -1| logsLen:                                                
                                               351                                                                                        
                                               S1|T19 appends logs from S2| logLen:                                                       
                                               351[AppendEntry]                                                                           
                                               S1|T19 starts to apply entries                                                             
                                               [350:350][ApplyEntry]                                                                      
                                               S1|T19 finishes applying entries                                                           
                                               [350:350][ApplyEntry]                                                                      
                                                                                             S2|T19 replica entries to S1| entrylen:0|    
                                                                                             matchidx:350| nextidx:351                    
S0|T19 is not leader                                                                                                                      
                                               S1|T19 is not leader                                                                       
S0|T19 save persist| votedFor: 2| logsLen: 351                                                                                            
S0|T19 appends logs from S2| logLen:                                                                                                      
351[AppendEntry]                                                                                                                          
                                                                                             S2|T19 replica entries to S0| entrylen:0|    
                                                                                             matchidx:350| nextidx:351                    
                                               S1|T19 save persist| votedFor: -1| logsLen:                                                
                                               351                                                                                        
                                               S1|T19 appends logs from S2| logLen:                                                       
                                               351[AppendEntry]                                                                           
                                                                                             S2|T19 replica entries to S1| entrylen:0|    
                                                                                             matchidx:350| nextidx:351                    
S0|T19 is not leader                                                                                                                      
                                               S1|T19 is not leader                                                                       
                                               S1|T19 save persist| votedFor: -1| logsLen:                                                
                                               351                                                                                        
                                               S1|T19 appends logs from S2| logLen:                                                       
                                               351[AppendEntry]                                                                           
                                                                                             S2|T19 replica entries to S1| entrylen:0|    
                                                                                             matchidx:350| nextidx:351                    
S0|T19 save persist| votedFor: 2| logsLen: 351                                                                                            
S0|T19 appends logs from S2| logLen:                                                                                                      
351[AppendEntry]                                                                                                                          
                                                                                             S2|T19 replica entries to S0| entrylen:0|    
                                                                                             matchidx:350| nextidx:351                    
                                               S1|T19 is not leader                                                                       
S0|T19 is not leader                                                                                                                      
                                               S1|T19 save persist| votedFor: -1| logsLen:                                                
                                               351                                                                                        
                                               S1|T19 appends logs from S2| logLen:                                                       
                                               351[AppendEntry]                                                                           
                                                                                             S2|T19 replica entries to S1| entrylen:0|    
                                                                                             matchidx:350| nextidx:351                    
S0|T19 save persist| votedFor: 2| logsLen: 351                                                                                            
S0|T19 appends logs from S2| logLen:                                                                                                      
351[AppendEntry]                                                                                                                          
                                                                                             S2|T19 replica entries to S0| entrylen:0|    
                                                                                             matchidx:350| nextidx:351                    
                                               S1|T19 is not leader                                                                       
S0|T19 is not leader                                                                                                                      
S0|T19 save persist| votedFor: 2| logsLen: 351                                                                                            
S0|T19 appends logs from S2| logLen:                                                                                                      
351[AppendEntry]                                                                                                                          
                                                                                             S2|T19 replica entries to S0| entrylen:0|    
                                                                                             matchidx:350| nextidx:351                    
                                               S1|T19 save persist| votedFor: -1| logsLen:                                                
                                               351                                                                                        
                                               S1|T19 appends logs from S2| logLen:                                                       
                                               351[AppendEntry]                                                                           
                                                                                             S2|T19 replica entries to S1| entrylen:0|    
                                                                                             matchidx:350| nextidx:351                    
S0|T0 is made                                                                                                                             
                                               S1|T0 is made                                                                              
                                                                                             S2|T0 is made                                
                                               S1|T19 is not leader                                                                       
S0|T19 is not leader                                                                                                                      
                                               S1|T0 is not leader                                                                        
                                                                                             S2|T0 is not leader                          
S0|T0 is not leader                                                                                                                       
                                               S1|T0 is not leader                                                                        
                                                                                             S2|T0 is not leader                          
S0|T0 is not leader                                                                                                                       
                                                                                             S2|T0 is not leader                          
S0|T0 is not leader                                                                                                                       
                                               S1|T0 is not leader                                                                        
                                               S1|T0 is not leader                                                                        
                                                                                             S2|T0 is not leader                          
S0|T0 is not leader                                                                                                                       
                                               S1|T0 is not leader                                                                        
                                                                                             S2|T0 is not leader                          
S0|T0 is not leader                                                                                                                       
                                               S1|T1 starts to join election                                                              
                                               S1|T1 save persist| votedFor: 1| logsLen: 1                                                
                                                                                             S2|T1 save persist| votedFor: -1| logsLen: 1 
S0|T1 save persist| votedFor: -1| logsLen: 1                                                                                              
                                                                                             S2|T1 save persist| votedFor: 1| logsLen: 1  
                                                                                             S2|T1 votes for S1[RequestVote]              
S0|T1 save persist| votedFor: 1| logsLen: 1                                                                                               
S0|T1 votes for S1[RequestVote]                                                                                                           
                                               S1|T1 becomes the leader, and starts                                                       
                                               heatbeats                                                                                  
                                               S1|T1 ends this round                                                                      
S0|T1 save persist| votedFor: 1| logsLen: 1                                                                                               
S0|T1 appends logs from S1| logLen:                                                                                                       
1[AppendEntry]                                                                                                                            
                                                                                             S2|T1 save persist| votedFor: 1| logsLen: 1  
                                                                                             S2|T1 appends logs from S1| logLen:          
                                                                                             1[AppendEntry]                               
                                               S1|T1 replica entries to S0| entrylen:0|                                                   
                                               matchidx:0| nextidx:1                                                                      
                                               S1|T1 replica entries to S2| entrylen:0|                                                   
                                               matchidx:0| nextidx:1                                                                      
                                                                                             S2|T1 is not leader                          
S0|T1 is not leader                                                                                                                       
S0|T1 save persist| votedFor: 1| logsLen: 1                                                                                               
S0|T1 appends logs from S1| logLen:                                                                                                       
1[AppendEntry]                                                                                                                            
                                                                                             S2|T1 save persist| votedFor: 1| logsLen: 1  
                                                                                             S2|T1 appends logs from S1| logLen:          
                                                                                             1[AppendEntry]                               
                                               S1|T1 replica entries to S0| entrylen:0|                                                   
                                               matchidx:0| nextidx:1                                                                      
                                               S1|T1 replica entries to S2| entrylen:0|                                                   
                                               matchidx:0| nextidx:1                                                                      
                                               S1|T1 save persist| votedFor: 1| logsLen: 2                                                
                                               S1|T1 receive commands | logLen: 2[Start]                                                  
                                                                                             S2|T1 is not leader                          
S0|T1 is not leader                                                                                                                       
                                                                                             S2|T1 save persist| votedFor: 1| logsLen: 2  
S0|T1 save persist| votedFor: 1| logsLen: 2                                                                                               
S0|T1 appends logs from S1| logLen:                                                                                                       
2[AppendEntry]                                                                                                                            
                                                                                             S2|T1 appends logs from S1| logLen:          
                                                                                             2[AppendEntry]                               
                                               S1|T1 replica entries to S2| entrylen:1|                                                   
                                               matchidx:1| nextidx:2                                                                      
                                               S1|T1 update commitIndex as 1                                                              
                                               S1|T1 replica entries to S0| entrylen:1|                                                   
                                               matchidx:1| nextidx:2                                                                      
                                               S1|T1 starts to apply entries                                                              
                                               [1:1][ApplyEntry]                                                                          
                                               S1|T1 finishes applying entries                                                            
                                               [1:1][ApplyEntry]                                                                          
S0|T1 is not leader                                                                                                                       
                                                                                             S2|T1 is not leader                          
                                                                                             S2|T1 save persist| votedFor: 1| logsLen: 2  
S0|T1 save persist| votedFor: 1| logsLen: 2                                                                                               
S0|T1 appends logs from S1| logLen:                                                                                                       
2[AppendEntry]                                                                                                                            
                                                                                             S2|T1 appends logs from S1| logLen:          
                                                                                             2[AppendEntry]                               
S0|T1 starts to apply entries                                                                                                             
[1:1][ApplyEntry]                                                                                                                         
                                                                                             S2|T1 starts to apply entries                
                                                                                             [1:1][ApplyEntry]                            
                                                                                             S2|T1 finishes applying entries              
                                                                                             [1:1][ApplyEntry]                            
S0|T1 finishes applying entries                                                                                                           
[1:1][ApplyEntry]                                                                                                                         
                                               S1|T1 replica entries to S0| entrylen:0|                                                   
                                               matchidx:1| nextidx:2                                                                      
                                               S1|T1 replica entries to S2| entrylen:0|                                                   
                                               matchidx:1| nextidx:2                                                                      
                                                                                             S2|T1 is not leader                          
S0|T1 is not leader                                                                                                                       
S0|T1 save persist| votedFor: 1| logsLen: 2                                                                                               
                                                                                             S2|T1 save persist| votedFor: 1| logsLen: 2  
S0|T1 appends logs from S1| logLen:                                                                                                       
2[AppendEntry]                                                                                                                            
                                                                                             S2|T1 appends logs from S1| logLen:          
                                                                                             2[AppendEntry]                               
                                               S1|T1 replica entries to S0| entrylen:0|                                                   
                                               matchidx:1| nextidx:2                                                                      
                                               S1|T1 replica entries to S2| entrylen:0|                                                   
                                               matchidx:1| nextidx:2                                                                      
S0|T1 is not leader                                                                                                                       
                                                                                             S2|T1 is not leader                          
                                                                                             S2|T1 save persist| votedFor: 1| logsLen: 2  
S0|T1 save persist| votedFor: 1| logsLen: 2                                                                                               
S0|T1 appends logs from S1| logLen:                                                                                                       
2[AppendEntry]                                                                                                                            
                                                                                             S2|T1 appends logs from S1| logLen:          
                                                                                             2[AppendEntry]                               
                                               S1|T1 replica entries to S0| entrylen:0|                                                   
                                               matchidx:1| nextidx:2                                                                      
                                               S1|T1 replica entries to S2| entrylen:0|                                                   
                                               matchidx:1| nextidx:2                                                                      
                                                                                             S2|T1 is not leader                          
S0|T1 is not leader                                                                                                                       
                                                                                             S2|T1 save persist| votedFor: 1| logsLen: 2  
                                                                                             S2|T1 appends logs from S1| logLen:          
                                                                                             2[AppendEntry]                               
S0|T1 save persist| votedFor: 1| logsLen: 2                                                                                               
S0|T1 appends logs from S1| logLen:                                                                                                       
2[AppendEntry]                                                                                                                            
                                               S1|T1 replica entries to S2| entrylen:0|                                                   
                                               matchidx:1| nextidx:2                                                                      
                                               S1|T1 replica entries to S0| entrylen:0|                                                   
                                               matchidx:1| nextidx:2                                                                      
                                                                                             S2|T1 is not leader                          
S0|T1 is not leader                                                                                                                       
S0|T1 save persist| votedFor: 1| logsLen: 2                                                                                               
                                                                                             S2|T1 save persist| votedFor: 1| logsLen: 2  
S0|T1 appends logs from S1| logLen:                                                                                                       
2[AppendEntry]                                                                                                                            
                                                                                             S2|T1 appends logs from S1| logLen:          
                                                                                             2[AppendEntry]                               
                                               S1|T1 replica entries to S0| entrylen:0|                                                   
                                               matchidx:1| nextidx:2                                                                      
                                               S1|T1 replica entries to S2| entrylen:0|                                                   
                                               matchidx:1| nextidx:2                                                                      
                                               S1|T1 save persist| votedFor: 1| logsLen: 3                                                
                                               S1|T1 receive commands | logLen: 3[Start]                                                  
S0|T1 is not leader                                                                                                                       
                                                                                             S2|T1 is not leader                          
S0|T1 save persist| votedFor: 1| logsLen: 3                                                                                               
S0|T1 appends logs from S1| logLen:                                                                                                       
3[AppendEntry]                                                                                                                            
                                               S1|T1 replica entries to S0| entrylen:1|                                                   
                                               matchidx:2| nextidx:3                                                                      
                                               S1|T1 update commitIndex as 2                                                              
                                               S1|T1 starts to apply entries                                                              
                                               [2:2][ApplyEntry]                                                                          
                                               S1|T1 finishes applying entries                                                            
                                               [2:2][ApplyEntry]                                                                          
S0|T1 is not leader                                                                                                                       
S0|T1 save persist| votedFor: 1| logsLen: 3                                                                                               
S0|T1 appends logs from S1| logLen:                                                                                                       
3[AppendEntry]                                                                                                                            
S0|T1 starts to apply entries                                                                                                             
[2:2][ApplyEntry]                                                                                                                         
S0|T1 finishes applying entries                                                                                                           
[2:2][ApplyEntry]                                                                                                                         
                                               S1|T1 replica entries to S0| entrylen:0|                                                   
                                               matchidx:2| nextidx:3                                                                      
                                               S1|T1 save persist| votedFor: 1| logsLen: 4                                                
                                               S1|T1 receive commands | logLen: 4[Start]                                                  
                                               S1|T1 save persist| votedFor: 1| logsLen: 5                                                
                                               S1|T1 receive commands | logLen: 5[Start]                                                  
                                               S1|T1 save persist| votedFor: 1| logsLen: 6                                                
                                               S1|T1 receive commands | logLen: 6[Start]                                                  
                                               S1|T1 save persist| votedFor: 1| logsLen: 7                                                
                                               S1|T1 receive commands | logLen: 7[Start]                                                  
                                               S1|T1 save persist| votedFor: 1| logsLen: 8                                                
                                               S1|T1 receive commands | logLen: 8[Start]                                                  
                                               S1|T1 save persist| votedFor: 1| logsLen: 9                                                
                                               S1|T1 receive commands | logLen: 9[Start]                                                  
                                               S1|T1 save persist| votedFor: 1| logsLen: 10                                               
                                               S1|T1 receive commands | logLen: 10[Start]                                                 
                                               S1|T1 save persist| votedFor: 1| logsLen: 11                                               
                                               S1|T1 receive commands | logLen: 11[Start]                                                 
                                               S1|T1 save persist| votedFor: 1| logsLen: 12                                               
                                               S1|T1 receive commands | logLen: 12[Start]                                                 
                                               S1|T1 save persist| votedFor: 1| logsLen: 13                                               
                                               S1|T1 receive commands | logLen: 13[Start]                                                 
                                               S1|T1 save persist| votedFor: 1| logsLen: 14                                               
                                               S1|T1 receive commands | logLen: 14[Start]                                                 
                                               S1|T1 save persist| votedFor: 1| logsLen: 15                                               
                                               S1|T1 receive commands | logLen: 15[Start]                                                 
S0|T1 is not leader                                                                                                                       
S0|T1 save persist| votedFor: 1| logsLen: 15                                                                                              
S0|T1 appends logs from S1| logLen:                                                                                                       
15[AppendEntry]                                                                                                                           
                                               S1|T1 replica entries to S0| entrylen:12|                                                  
                                               matchidx:14| nextidx:15                                                                    
                                               S1|T1 update commitIndex as 14                                                             
                                               S1|T1 starts to apply entries                                                              
                                               [3:14][ApplyEntry]                                                                         
                                               S1|T1 Snapshot until index 9| logLen: 15                                                   
                                               S1|T1 finishes applying entries                                                            
                                               [3:14][ApplyEntry]                                                                         
                                                                                             S2|T19 fails to install snapshot to S0       
S0|T1 is not leader                                                                                                                       
                                               S1|T1 send rpc to S2|base: 9| next: 2                                                      
S0|T1 save persist| votedFor: 1| logsLen: 15                                                                                              
S0|T1 appends logs from S1| logLen:                                                                                                       
15[AppendEntry]                                                                                                                           
S0|T1 starts to apply entries                                                                                                             
[3:14][ApplyEntry]                                                                                                                        
                                               S1|T1 replica entries to S0| entrylen:0|                                                   
                                               matchidx:14| nextidx:15                                                                    
S0|T1 Snapshot until index 9| logLen: 15                                                                                                  
S0|T1 finishes applying entries                                                                                                           
[3:14][ApplyEntry]                                                                                                                        
                                                                                             S2|T0 is made                                
                                                                                             S2|T1 read persist| votedFor: 1| logsLen: 2| 
                                                                                             base: 0                                      
                                               S1|T1 save persist| votedFor: 1| logsLen: 16                                               
                                               S1|T1 receive commands | logLen: 16[Start]                                                 
S0|T1 is not leader                                                                                                                       
                                               S1|T1 send rpc to S2|base: 9| next: 2                                                      
                                                                                             S2|T1 receive rpc from S1                    
                                                                                             S2|T1 update rfstate| Base:9| LogLen:10      
S0|T1 save persist| votedFor: 1| logsLen: 16                                                                                              
S0|T1 appends logs from S1| logLen:                                                                                                       
16[AppendEntry]                                                                                                                           
                                                                                             S2|T1 applys snapshot from S1                
                                               S1|T1 installs snapshot to S2| nextId:10|                                                  
                                               matchId:9                                                                                  
                                               S1|T1 replica entries to S0| entrylen:1|                                                   
                                               matchidx:15| nextidx:16                                                                    
                                               S1|T1 update commitIndex as 15                                                             
                                               S1|T1 starts to apply entries                                                              
                                               [15:15][ApplyEntry]                                                                        
                                               S1|T1 finishes applying entries                                                            
                                               [15:15][ApplyEntry]                                                                        
                                                                                             S2|T1 is not leader                          
S0|T1 is not leader                                                                                                                       
                                                                                             S2|T1 save persist| votedFor: 1| logsLen: 16 
                                                                                             S2|T1 appends logs from S1| logLen:          
                                                                                             16[AppendEntry]                              
                                                                                             S2|T1 starts to apply entries                
                                                                                             [10:15][ApplyEntry]                          
S0|T1 save persist| votedFor: 1| logsLen: 16                                                                                              
S0|T1 appends logs from S1| logLen:                                                                                                       
16[AppendEntry]                                                                                                                           
                                                                                             S2|T1 is not leader                          
                                               S1|T1 replica entries to S2| entrylen:6|                                                   
                                               matchidx:15| nextidx:16                                                                    
                                                                                             S2|T1 finishes applying entries              
                                                                                             [10:15][ApplyEntry]                          
S0|T1 starts to apply entries                                                                                                             
[15:15][ApplyEntry]                                                                                                                       
S0|T1 finishes applying entries                                                                                                           
[15:15][ApplyEntry]                                                                                                                       
                                               S1|T1 replica entries to S0| entrylen:0|                                                   
                                               matchidx:15| nextidx:16                                                                    
S0|T1 is not leader                                                                                                                       
S0|T1 save persist| votedFor: 1| logsLen: 16                                                                                              
                                                                                             S2|T1 save persist| votedFor: 1| logsLen: 16 
                                                                                             S2|T1 appends logs from S1| logLen:          
                                                                                             16[AppendEntry]                              
S0|T1 appends logs from S1| logLen:                                                                                                       
16[AppendEntry]                                                                                                                           
                                               S1|T1 replica entries to S2| entrylen:0|                                                   
                                               matchidx:15| nextidx:16                                                                    
                                               S1|T1 replica entries to S0| entrylen:0|                                                   
                                               matchidx:15| nextidx:16                                                                    
                                                                                             S2|T1 is not leader                          
S0|T1 is not leader                                                                                                                       
S0|T1 save persist| votedFor: 1| logsLen: 16                                                                                              
S0|T1 appends logs from S1| logLen:                                                                                                       
16[AppendEntry]                                                                                                                           
                                                                                             S2|T1 save persist| votedFor: 1| logsLen: 16 
                                                                                             S2|T1 appends logs from S1| logLen:          
                                                                                             16[AppendEntry]                              
                                               S1|T1 replica entries to S0| entrylen:0|                                                   
                                               matchidx:15| nextidx:16                                                                    
                                               S1|T1 replica entries to S2| entrylen:0|                                                   
                                               matchidx:15| nextidx:16                                                                    
                                                                                             S2|T1 is not leader                          
S0|T1 is not leader                                                                                                                       
S0|T1 save persist| votedFor: 1| logsLen: 16                                                                                              
                                                                                             S2|T1 save persist| votedFor: 1| logsLen: 16 
S0|T1 appends logs from S1| logLen:                                                                                                       
16[AppendEntry]                                                                                                                           
                                                                                             S2|T1 appends logs from S1| logLen:          
                                                                                             16[AppendEntry]                              
                                               S1|T1 replica entries to S2| entrylen:0|                                                   
                                               matchidx:15| nextidx:16                                                                    
                                               S1|T1 replica entries to S0| entrylen:0|                                                   
                                               matchidx:15| nextidx:16                                                                    
                                                                                             S2|T1 is not leader                          
S0|T1 is not leader                                                                                                                       
S0|T1 save persist| votedFor: 1| logsLen: 16                                                                                              
                                                                                             S2|T1 save persist| votedFor: 1| logsLen: 16 
                                                                                             S2|T1 appends logs from S1| logLen:          
                                                                                             16[AppendEntry]                              
S0|T1 appends logs from S1| logLen:                                                                                                       
16[AppendEntry]                                                                                                                           
                                               S1|T1 replica entries to S2| entrylen:0|                                                   
                                               matchidx:15| nextidx:16                                                                    
                                               S1|T1 replica entries to S0| entrylen:0|                                                   
                                               matchidx:15| nextidx:16                                                                    
                                                                                             S2|T1 is not leader                          
S0|T1 is not leader                                                                                                                       
S0|T1 save persist| votedFor: 1| logsLen: 16                                                                                              
                                                                                             S2|T1 save persist| votedFor: 1| logsLen: 16 
                                                                                             S2|T1 appends logs from S1| logLen:          
                                                                                             16[AppendEntry]                              
S0|T1 appends logs from S1| logLen:                                                                                                       
16[AppendEntry]                                                                                                                           
                                               S1|T1 replica entries to S2| entrylen:0|                                                   
                                               matchidx:15| nextidx:16                                                                    
                                               S1|T1 replica entries to S0| entrylen:0|                                                   
                                               matchidx:15| nextidx:16                                                                    
                                                                                             S2|T1 is not leader                          
S0|T1 is not leader                                                                                                                       
                                                                                             S2|T1 is not leader                          
S0|T1 is not leader                                                                                                                       
                                                                                             S2|T1 is not leader                          
S0|T1 is not leader                                                                                                                       
                                                                                             S2|T1 is not leader                          
S0|T1 is not leader                                                                                                                       
                                                                                             S2|T1 is not leader                          
S0|T1 is not leader                                                                                                                       
                                                                                             S2|T1 is not leader                          
S0|T1 is not leader                                                                                                                       
                                                                                             S2|T1 is not leader                          
S0|T1 is not leader                                                                                                                       
                                                                                             S2|T1 is not leader                          
S0|T1 is not leader                                                                                                                       
                                                                                             S2|T1 is not leader                          
S0|T1 is not leader                                                                                                                       
                                                                                             S2|T1 is not leader                          
S0|T1 is not leader                                                                                                                       
                                                                                             S2|T1 is not leader                          
                                                                                             S2|T2 starts to join election                
                                                                                             S2|T2 save persist| votedFor: 2| logsLen: 16 
S0|T2 save persist| votedFor: -1| logsLen: 16                                                                                             
S0|T2 save persist| votedFor: 2| logsLen: 16                                                                                              
S0|T2 votes for S2[RequestVote]                                                                                                           
                                                                                             S2|T2 becomes the leader, and starts         
                                                                                             heatbeats                                    
S0|T2 save persist| votedFor: 2| logsLen: 16                                                                                              
S0|T2 appends logs from S2| logLen:                                                                                                       
16[AppendEntry]                                                                                                                           
                                                                                             S2|T2 replica entries to S0| entrylen:0|     
                                                                                             matchidx:15| nextidx:16                      
                                                                                             S2|T2 save persist| votedFor: 2| logsLen: 17 
                                                                                             S2|T2 receive commands | logLen: 17[Start]   
S0|T2 is not leader                                                                                                                       
S0|T2 save persist| votedFor: 2| logsLen: 17                                                                                              
S0|T2 appends logs from S2| logLen:                                                                                                       
17[AppendEntry]                                                                                                                           
                                                                                             S2|T2 replica entries to S0| entrylen:1|     
                                                                                             matchidx:16| nextidx:17                      
                                                                                             S2|T2 update commitIndex as 16               
                                                                                             S2|T2 starts to apply entries                
                                                                                             [16:16][ApplyEntry]                          
                                                                                             S2|T2 finishes applying entries              
                                                                                             [16:16][ApplyEntry]                          
S0|T2 is not leader                                                                                                                       
S0|T2 save persist| votedFor: 2| logsLen: 17                                                                                              
S0|T2 appends logs from S2| logLen:                                                                                                       
17[AppendEntry]                                                                                                                           
S0|T2 starts to apply entries                                                                                                             
[16:16][ApplyEntry]                                                                                                                       
S0|T2 finishes applying entries                                                                                                           
[16:16][ApplyEntry]                                                                                                                       
                                                                                             S2|T2 replica entries to S0| entrylen:0|     
                                                                                             matchidx:16| nextidx:17                      
                                                                                             S2|T2 save persist| votedFor: 2| logsLen: 18 
                                                                                             S2|T2 receive commands | logLen: 18[Start]   
                                                                                             S2|T2 save persist| votedFor: 2| logsLen: 19 
                                                                                             S2|T2 receive commands | logLen: 19[Start]   
                                                                                             S2|T2 save persist| votedFor: 2| logsLen: 20 
                                                                                             S2|T2 receive commands | logLen: 20[Start]   
                                                                                             S2|T2 save persist| votedFor: 2| logsLen: 21 
                                                                                             S2|T2 receive commands | logLen: 21[Start]   
                                                                                             S2|T2 save persist| votedFor: 2| logsLen: 22 
                                                                                             S2|T2 receive commands | logLen: 22[Start]   
                                                                                             S2|T2 save persist| votedFor: 2| logsLen: 23 
                                                                                             S2|T2 receive commands | logLen: 23[Start]   
                                                                                             S2|T2 save persist| votedFor: 2| logsLen: 24 
                                                                                             S2|T2 receive commands | logLen: 24[Start]   
                                                                                             S2|T2 save persist| votedFor: 2| logsLen: 25 
                                                                                             S2|T2 receive commands | logLen: 25[Start]   
                                                                                             S2|T2 save persist| votedFor: 2| logsLen: 26 
                                                                                             S2|T2 receive commands | logLen: 26[Start]   
                                                                                             S2|T2 save persist| votedFor: 2| logsLen: 27 
                                                                                             S2|T2 receive commands | logLen: 27[Start]   
                                                                                             S2|T2 save persist| votedFor: 2| logsLen: 28 
                                                                                             S2|T2 receive commands | logLen: 28[Start]   
                                                                                             S2|T2 save persist| votedFor: 2| logsLen: 29 
                                                                                             S2|T2 receive commands | logLen: 29[Start]   
                                                                                             S2|T2 save persist| votedFor: 2| logsLen: 30 
                                                                                             S2|T2 receive commands | logLen: 30[Start]   
                                                                                             S2|T2 save persist| votedFor: 2| logsLen: 31 
                                                                                             S2|T2 receive commands | logLen: 31[Start]   
                                                                                             S2|T2 save persist| votedFor: 2| logsLen: 32 
                                                                                             S2|T2 receive commands | logLen: 32[Start]   
S0|T2 is not leader                                                                                                                       
S0|T2 save persist| votedFor: 2| logsLen: 32                                                                                              
S0|T2 appends logs from S2| logLen:                                                                                                       
32[AppendEntry]                                                                                                                           
                                                                                             S2|T2 replica entries to S0| entrylen:15|    
                                                                                             matchidx:31| nextidx:32                      
                                                                                             S2|T2 update commitIndex as 31               
                                                                                             S2|T2 starts to apply entries                
                                                                                             [17:31][ApplyEntry]                          
                                                                                             S2|T2 Snapshot until index 19| logLen: 32    
                                                                                             S2|T2 Snapshot until index 29| logLen: 32    
                                                                                             S2|T2 finishes applying entries              
                                                                                             [17:31][ApplyEntry]                          
                                                                                             S2|T19 fails to install snapshot to S0       
S0|T2 is not leader                                                                                                                       
                                                                                             S2|T2 send rpc to S1|base: 29| next: 16      
S0|T2 save persist| votedFor: 2| logsLen: 32                                                                                              
S0|T2 appends logs from S2| logLen:                                                                                                       
32[AppendEntry]                                                                                                                           
S0|T2 starts to apply entries                                                                                                             
[17:31][ApplyEntry]                                                                                                                       
                                                                                             S2|T2 replica entries to S0| entrylen:0|     
                                                                                             matchidx:31| nextidx:32                      
S0|T2 Snapshot until index 19| logLen: 32                                                                                                 
S0|T2 Snapshot until index 29| logLen: 32                                                                                                 
S0|T2 finishes applying entries                                                                                                           
[17:31][ApplyEntry]                                                                                                                       
                                               S1|T0 is made                                                                              
                                               S1|T1 read persist| votedFor: 1| logsLen: 16|                                              
                                               base: 9                                                                                    
                                                                                             S2|T2 save persist| votedFor: 2| logsLen: 33 
                                                                                             S2|T2 receive commands | logLen: 33[Start]   
S0|T2 is not leader                                                                                                                       
                                                                                             S2|T2 send rpc to S1|base: 29| next: 16      
                                               S1|T1 receive rpc from S2                                                                  
S0|T2 save persist| votedFor: 2| logsLen: 33                                                                                              
S0|T2 appends logs from S2| logLen:                                                                                                       
33[AppendEntry]                                                                                                                           
                                               S1|T2 save persist| votedFor: 1| logsLen: 16                                               
                                               S1|T2 update rfstate| Base:29| LogLen:30                                                   
                                               S1|T2 applys snapshot from S2                                                              
                                                                                             S2|T2 replica entries to S0| entrylen:1|     
                                                                                             matchidx:32| nextidx:33                      
                                                                                             S2|T2 update commitIndex as 32               
                                                                                             S2|T2 starts to apply entries                
                                                                                             [32:32][ApplyEntry]                          
                                                                                             S2|T2 installs snapshot to S1| nextId:30|    
                                                                                             matchId:29                                   
                                                                                             S2|T2 finishes applying entries              
                                                                                             [32:32][ApplyEntry]                          
                                               S1|T2 is not leader                                                                        
S0|T2 is not leader                                                                                                                       
S0|T2 save persist| votedFor: 2| logsLen: 33                                                                                              
S0|T2 appends logs from S2| logLen:                                                                                                       
33[AppendEntry]                                                                                                                           
                                               S1|T2 save persist| votedFor: 1| logsLen: 33                                               
                                               S1|T2 appends logs from S2| logLen:                                                        
                                               33[AppendEntry]                                                                            
S0|T2 starts to apply entries                                                                                                             
[32:32][ApplyEntry]                                                                                                                       
S0|T2 finishes applying entries                                                                                                           
[32:32][ApplyEntry]                                                                                                                       
                                               S1|T2 starts to apply entries                                                              
                                               [30:32][ApplyEntry]                                                                        
                                                                                             S2|T2 replica entries to S0| entrylen:0|     
                                                                                             matchidx:32| nextidx:33                      
                                               S1|T2 finishes applying entries                                                            
                                               [30:32][ApplyEntry]                                                                        
                                                                                             S2|T2 replica entries to S1| entrylen:3|     
                                                                                             matchidx:32| nextidx:33                      
                                               S1|T2 is not leader                                                                        
S0|T2 is not leader                                                                                                                       
                                                                                             S2|T19 fails to install snapshot to S0       
                                               S1|T2 save persist| votedFor: 1| logsLen: 33                                               
                                               S1|T2 appends logs from S2| logLen:                                                        
                                               33[AppendEntry]                                                                            
S0|T2 save persist| votedFor: 2| logsLen: 33                                                                                              
S0|T2 appends logs from S2| logLen:                                                                                                       
33[AppendEntry]                                                                                                                           
                                                                                             S2|T2 replica entries to S1| entrylen:0|     
                                                                                             matchidx:32| nextidx:33                      
                                                                                             S2|T2 replica entries to S0| entrylen:0|     
                                                                                             matchidx:32| nextidx:33                      
                                               S1|T2 is not leader                                                                        
S0|T2 is not leader                                                                                                                       
                                               S1|T2 save persist| votedFor: 1| logsLen: 33                                               
                                               S1|T2 appends logs from S2| logLen:                                                        
                                               33[AppendEntry]                                                                            
S0|T2 save persist| votedFor: 2| logsLen: 33                                                                                              
S0|T2 appends logs from S2| logLen:                                                                                                       
33[AppendEntry]                                                                                                                           
                                                                                             S2|T2 replica entries to S1| entrylen:0|     
                                                                                             matchidx:32| nextidx:33                      
                                                                                             S2|T2 replica entries to S0| entrylen:0|     
                                                                                             matchidx:32| nextidx:33                      
                                               S1|T2 is not leader                                                                        
S0|T2 is not leader                                                                                                                       
S0|T2 save persist| votedFor: 2| logsLen: 33                                                                                              
S0|T2 appends logs from S2| logLen:                                                                                                       
33[AppendEntry]                                                                                                                           
                                               S1|T2 save persist| votedFor: 1| logsLen: 33                                               
                                               S1|T2 appends logs from S2| logLen:                                                        
                                               33[AppendEntry]                                                                            
                                                                                             S2|T2 replica entries to S0| entrylen:0|     
                                                                                             matchidx:32| nextidx:33                      
                                                                                             S2|T2 replica entries to S1| entrylen:0|     
                                                                                             matchidx:32| nextidx:33                      
                                               S1|T2 is not leader                                                                        
S0|T2 is not leader                                                                                                                       
S0|T2 save persist| votedFor: 2| logsLen: 33                                                                                              
S0|T2 appends logs from S2| logLen:                                                                                                       
33[AppendEntry]                                                                                                                           
                                               S1|T2 save persist| votedFor: 1| logsLen: 33                                               
                                               S1|T2 appends logs from S2| logLen:                                                        
                                               33[AppendEntry]                                                                            
                                                                                             S2|T2 replica entries to S0| entrylen:0|     
                                                                                             matchidx:32| nextidx:33                      
                                                                                             S2|T2 replica entries to S1| entrylen:0|     
                                                                                             matchidx:32| nextidx:33                      
                                               S1|T2 is not leader                                                                        
                                                                                             S2|T2 save persist| votedFor: 2| logsLen: 34 
                                                                                             S2|T2 receive commands | logLen: 34[Start]   
S0|T2 is not leader                                                                                                                       
                                               S1|T2 save persist| votedFor: 1| logsLen: 34                                               
                                               S1|T2 appends logs from S2| logLen:                                                        
                                               34[AppendEntry]                                                                            
                                                                                             S2|T2 replica entries to S1| entrylen:1|     
                                                                                             matchidx:33| nextidx:34                      
                                                                                             S2|T2 update commitIndex as 33               
                                                                                             S2|T2 starts to apply entries                
                                                                                             [33:33][ApplyEntry]                          
                                                                                             S2|T2 finishes applying entries              
                                                                                             [33:33][ApplyEntry]                          
                                               S1|T2 is not leader                                                                        
                                               S1|T2 save persist| votedFor: 1| logsLen: 34                                               
                                               S1|T2 appends logs from S2| logLen:                                                        
                                               34[AppendEntry]                                                                            
                                               S1|T2 starts to apply entries                                                              
                                               [33:33][ApplyEntry]                                                                        
                                               S1|T2 finishes applying entries                                                            
                                               [33:33][ApplyEntry]                                                                        
                                                                                             S2|T2 replica entries to S1| entrylen:0|     
                                                                                             matchidx:33| nextidx:34                      
                                                                                             S2|T2 save persist| votedFor: 2| logsLen: 35 
                                                                                             S2|T2 receive commands | logLen: 35[Start]   
                                                                                             S2|T2 save persist| votedFor: 2| logsLen: 36 
                                                                                             S2|T2 receive commands | logLen: 36[Start]   
                                                                                             S2|T2 save persist| votedFor: 2| logsLen: 37 
                                                                                             S2|T2 receive commands | logLen: 37[Start]   
                                                                                             S2|T2 save persist| votedFor: 2| logsLen: 38 
                                                                                             S2|T2 receive commands | logLen: 38[Start]   
                                                                                             S2|T2 save persist| votedFor: 2| logsLen: 39 
                                                                                             S2|T2 receive commands | logLen: 39[Start]   
                                                                                             S2|T2 save persist| votedFor: 2| logsLen: 40 
                                                                                             S2|T2 receive commands | logLen: 40[Start]   
                                               S1|T2 is not leader                                                                        
                                               S1|T2 save persist| votedFor: 1| logsLen: 40                                               
                                               S1|T2 appends logs from S2| logLen:                                                        
                                               40[AppendEntry]                                                                            
                                                                                             S2|T2 replica entries to S1| entrylen:6|     
                                                                                             matchidx:39| nextidx:40                      
                                                                                             S2|T2 update commitIndex as 39               
                                                                                             S2|T2 starts to apply entries                
                                                                                             [34:39][ApplyEntry]                          
                                                                                             S2|T2 finishes applying entries              
                                                                                             [34:39][ApplyEntry]                          
                                                                                             S2|T2 Snapshot until index 39| logLen: 40    
                                               S1|T2 is not leader                                                                        
                                                                                             S2|T2 send rpc to S0|base: 39| next: 33      
                                               S1|T2 save persist| votedFor: 1| logsLen: 40                                               
                                               S1|T2 appends logs from S2| logLen:                                                        
                                               40[AppendEntry]                                                                            
                                               S1|T2 starts to apply entries                                                              
                                               [34:39][ApplyEntry]                                                                        
                                               S1|T2 finishes applying entries                                                            
                                               [34:39][ApplyEntry]                                                                        
                                                                                             S2|T2 replica entries to S1| entrylen:0|     
                                                                                             matchidx:39| nextidx:40                      
                                               S1|T2 Snapshot until index 39| logLen: 40                                                  
S0|T0 is made                                                                                                                             
S0|T2 read persist| votedFor: 2| logsLen: 33|                                                                                             
base: 29                                                                                                                                  
                                                                                             S2|T2 save persist| votedFor: 2| logsLen: 41 
                                                                                             S2|T2 receive commands | logLen: 41[Start]   
                                               S1|T2 is not leader                                                                        
                                                                                             S2|T2 send rpc to S0|base: 39| next: 33      
S0|T2 receive rpc from S2                                                                                                                 
S0|T2 update rfstate| Base:39| LogLen:40                                                                                                  
                                               S1|T2 save persist| votedFor: 1| logsLen: 41                                               
S0|T2 applys snapshot from S2                                                                                                             
                                               S1|T2 appends logs from S2| logLen:                                                        
                                               41[AppendEntry]                                                                            
                                                                                             S2|T2 installs snapshot to S0| nextId:40|    
                                                                                             matchId:39                                   
                                                                                             S2|T2 replica entries to S1| entrylen:1|     
                                                                                             matchidx:40| nextidx:41                      
                                                                                             S2|T2 update commitIndex as 40               
                                                                                             S2|T2 starts to apply entries                
                                                                                             [40:40][ApplyEntry]                          
                                                                                             S2|T2 finishes applying entries              
                                                                                             [40:40][ApplyEntry]                          
S0|T2 is not leader                                                                                                                       
                                               S1|T2 is not leader                                                                        
                                               S1|T2 save persist| votedFor: 1| logsLen: 41                                               
                                               S1|T2 appends logs from S2| logLen:                                                        
                                               41[AppendEntry]                                                                            
S0|T2 save persist| votedFor: 2| logsLen: 41                                                                                              
S0|T2 appends logs from S2| logLen:                                                                                                       
41[AppendEntry]                                                                                                                           
                                               S1|T2 starts to apply entries                                                              
                                               [40:40][ApplyEntry]                                                                        
                                               S1|T2 finishes applying entries                                                            
                                               [40:40][ApplyEntry]                                                                        
S0|T2 starts to apply entries                                                                                                             
[40:40][ApplyEntry]                                                                                                                       
S0|T2 finishes applying entries                                                                                                           
[40:40][ApplyEntry]                                                                                                                       
                                                                                             S2|T2 replica entries to S1| entrylen:0|     
                                                                                             matchidx:40| nextidx:41                      
                                                                                             S2|T2 replica entries to S0| entrylen:1|     
                                                                                             matchidx:40| nextidx:41                      
S0|T2 is not leader                                                                                                                       
                                               S1|T2 is not leader                                                                        
                                               S1|T2 save persist| votedFor: 1| logsLen: 41                                               
                                               S1|T2 appends logs from S2| logLen:                                                        
                                               41[AppendEntry]                                                                            
S0|T2 save persist| votedFor: 2| logsLen: 41                                                                                              
S0|T2 appends logs from S2| logLen:                                                                                                       
41[AppendEntry]                                                                                                                           
                                                                                             S2|T2 replica entries to S1| entrylen:0|     
                                                                                             matchidx:40| nextidx:41                      
                                                                                             S2|T2 replica entries to S0| entrylen:0|     
                                                                                             matchidx:40| nextidx:41                      
S0|T2 is not leader                                                                                                                       
                                               S1|T2 is not leader                                                                        
                                               S1|T2 save persist| votedFor: 1| logsLen: 41                                               
                                               S1|T2 appends logs from S2| logLen:                                                        
                                               41[AppendEntry]                                                                            
S0|T2 save persist| votedFor: 2| logsLen: 41                                                                                              
S0|T2 appends logs from S2| logLen:                                                                                                       
41[AppendEntry]                                                                                                                           
                                                                                             S2|T2 replica entries to S1| entrylen:0|     
                                                                                             matchidx:40| nextidx:41                      
                                                                                             S2|T2 replica entries to S0| entrylen:0|     
                                                                                             matchidx:40| nextidx:41                      
S0|T2 is not leader                                                                                                                       
                                               S1|T2 is not leader                                                                        
S0|T2 save persist| votedFor: 2| logsLen: 41                                                                                              
S0|T2 appends logs from S2| logLen:                                                                                                       
41[AppendEntry]                                                                                                                           
                                               S1|T2 save persist| votedFor: 1| logsLen: 41                                               
                                               S1|T2 appends logs from S2| logLen:                                                        
                                               41[AppendEntry]                                                                            
                                                                                             S2|T2 replica entries to S0| entrylen:0|     
                                                                                             matchidx:40| nextidx:41                      
                                                                                             S2|T2 replica entries to S1| entrylen:0|     
                                                                                             matchidx:40| nextidx:41                      
S0|T2 is not leader                                                                                                                       
                                               S1|T2 is not leader                                                                        
S0|T2 save persist| votedFor: 2| logsLen: 41                                                                                              
                                               S1|T2 save persist| votedFor: 1| logsLen: 41                                               
                                               S1|T2 appends logs from S2| logLen:                                                        
                                               41[AppendEntry]                                                                            
S0|T2 appends logs from S2| logLen:                                                                                                       
41[AppendEntry]                                                                                                                           
                                                                                             S2|T2 replica entries to S1| entrylen:0|     
                                                                                             matchidx:40| nextidx:41                      
                                                                                             S2|T2 replica entries to S0| entrylen:0|     
                                                                                             matchidx:40| nextidx:41                      
S0|T2 is not leader                                                                                                                       
                                               S1|T2 is not leader                                                                        
S0|T2 save persist| votedFor: 2| logsLen: 41                                                                                              
                                               S1|T2 save persist| votedFor: 1| logsLen: 41                                               
S0|T2 appends logs from S2| logLen:                                                                                                       
41[AppendEntry]                                                                                                                           
                                               S1|T2 appends logs from S2| logLen:                                                        
                                               41[AppendEntry]                                                                            
                                                                                             S2|T2 replica entries to S0| entrylen:0|     
                                                                                             matchidx:40| nextidx:41                      
                                                                                             S2|T2 replica entries to S1| entrylen:0|     
                                                                                             matchidx:40| nextidx:41                      
                                                                                             S2|T2 save persist| votedFor: 2| logsLen: 42 
                                                                                             S2|T2 receive commands | logLen: 42[Start]   
S0|T2 is not leader                                                                                                                       
                                               S1|T2 is not leader                                                                        
                                               S1|T2 save persist| votedFor: 1| logsLen: 42                                               
                                               S1|T2 appends logs from S2| logLen:                                                        
                                               42[AppendEntry]                                                                            
                                                                                             S2|T2 replica entries to S1| entrylen:1|     
                                                                                             matchidx:41| nextidx:42                      
                                                                                             S2|T2 update commitIndex as 41               
                                                                                             S2|T2 starts to apply entries                
                                                                                             [41:41][ApplyEntry]                          
                                                                                             S2|T2 finishes applying entries              
                                                                                             [41:41][ApplyEntry]                          
                                               S1|T2 is not leader                                                                        
                                               S1|T2 save persist| votedFor: 1| logsLen: 42                                               
                                               S1|T2 appends logs from S2| logLen:                                                        
                                               42[AppendEntry]                                                                            
                                               S1|T2 starts to apply entries                                                              
                                               [41:41][ApplyEntry]                                                                        
                                               S1|T2 finishes applying entries                                                            
                                               [41:41][ApplyEntry]                                                                        
                                                                                             S2|T2 replica entries to S1| entrylen:0|     
                                                                                             matchidx:41| nextidx:42                      
                                                                                             S2|T2 save persist| votedFor: 2| logsLen: 43 
                                                                                             S2|T2 receive commands | logLen: 43[Start]   
                                                                                             S2|T2 save persist| votedFor: 2| logsLen: 44 
                                                                                             S2|T2 receive commands | logLen: 44[Start]   
                                                                                             S2|T2 save persist| votedFor: 2| logsLen: 45 
                                                                                             S2|T2 receive commands | logLen: 45[Start]   
                                                                                             S2|T2 save persist| votedFor: 2| logsLen: 46 
                                                                                             S2|T2 receive commands | logLen: 46[Start]   
                                                                                             S2|T2 save persist| votedFor: 2| logsLen: 47 
                                                                                             S2|T2 receive commands | logLen: 47[Start]   
                                                                                             S2|T2 save persist| votedFor: 2| logsLen: 48 
                                                                                             S2|T2 receive commands | logLen: 48[Start]   
                                               S1|T2 is not leader                                                                        
                                               S1|T2 save persist| votedFor: 1| logsLen: 48                                               
                                               S1|T2 appends logs from S2| logLen:                                                        
                                               48[AppendEntry]                                                                            
                                                                                             S2|T2 replica entries to S1| entrylen:6|     
                                                                                             matchidx:47| nextidx:48                      
                                                                                             S2|T2 update commitIndex as 47               
                                                                                             S2|T2 starts to apply entries                
                                                                                             [42:47][ApplyEntry]                          
                                                                                             S2|T2 finishes applying entries              
                                                                                             [42:47][ApplyEntry]                          
                                               S1|T2 is not leader                                                                        
                                                                                             S2|T2 fails to install snapshot to S1        
                                               S1|T2 save persist| votedFor: 1| logsLen: 48                                               
                                               S1|T2 appends logs from S2| logLen:                                                        
                                               48[AppendEntry]                                                                            
                                               S1|T2 starts to apply entries                                                              
                                               [42:47][ApplyEntry]                                                                        
                                               S1|T2 finishes applying entries                                                            
                                               [42:47][ApplyEntry]                                                                        
                                                                                             S2|T2 replica entries to S1| entrylen:0|     
                                                                                             matchidx:47| nextidx:48                      
S0|T0 is made                                                                                                                             
S0|T2 read persist| votedFor: 2| logsLen: 41|                                                                                             
base: 39                                                                                                                                  
                                                                                             S2|T2 save persist| votedFor: 2| logsLen: 49 
                                                                                             S2|T2 receive commands | logLen: 49[Start]   
                                               S1|T2 is not leader                                                                        
                                               S1|T2 save persist| votedFor: 1| logsLen: 49                                               
                                               S1|T2 appends logs from S2| logLen:                                                        
                                               49[AppendEntry]                                                                            
S0|T2 save persist| votedFor: 2| logsLen: 49                                                                                              
S0|T2 appends logs from S2| logLen:                                                                                                       
49[AppendEntry]                                                                                                                           
S0|T2 starts to apply entries                                                                                                             
[1:47][ApplyEntry]                                                                                                                        
##########################################################################################################################################

##########################################################################################################################################
6.824/raft.(*Raft).applyEntries(0xc0005288c0)
##########################################################################################################################################
FAIL    6.824/raft      125.116s
